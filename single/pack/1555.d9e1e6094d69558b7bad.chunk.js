"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[1555],{11555:(Le,ne,r)=>{r.r(ne),r.d(ne,{StateChartContent:()=>Ft,default:()=>Rt});var ae=r(66814),fe=r(91880),_=r.n(fe),ge=r(48388),w=r(29914),ee=r.n(w),M=r(33867),N=r(52945),k=r.n(N),L=r(88239),D=r(12424),U=r(20148),F=r(60385),H=r.n(F),Z=r(86735),e=r(67294),K=r(53242),re=r(22010),W=r(82986),oe=r(71893),pe=r(93967),G=r.n(pe),xe=r(7452),we=r(42723),Be=r(25087),Fe=r(11875),T=r(90570),Ue=r(15577),He=r(15742),Ke=r(91088),Xe=r(96486),i=r.n(Xe),Qe=(0,Z.Z)([`
  flex: 1;
  .showTotalHeight {
    height: 100%;
  }
`],[`
  flex: 1;
  .showTotalHeight {
    height: 100%;
  }
`]),Je=oe.ZP.div(Qe);function qe(t){var a=t.data,o=t.mobileCount,n=t.mobileFontSize,c=t.isHorizontal,l=t.projectId,d=t.themeColor,s=t.pageConfig,m=s===void 0?{}:s,f=t.linkageMatch,g=t.onUpdateLinkageFiltersGroup;if(a.status<=0)return e.createElement(Fe.hO,{status:a.status});var h=i().isEmpty(a.map),y=i().isEmpty(a.contrastMap),p=Be.Z[a.reportType],u=e.createElement(Fe.Ll,null),x=a.country||{},b=x.drillParticleSizeType,v=a.filter||{},E=v.filterRangeId,O=v.rangeType,j=v.rangeValue,I=v.dynamicFilter,R=v.today,C=R===void 0?!1:R,Q=v.customRangeValue,V=m.filters,le=m.filtersGroup,J=m.autoLinkage,ie=function(Se){xe.Z.getReportSingleCacheId((0,L.default)({},Se,{appId:a.appId,filterRangeId:E,rangeType:O,rangeValue:j,dynamicFilter:I,today:C,customRangeValue:Q,filters:[V,le].filter(function(se){return se}),particleSizeType:b,isPersonal:!0,reportId:a.reportId})).then(function(se){if(se.id){var ce=a.appId;if(window.isMingDaoApp){var $="/worksheet/"+ce+"/view/"+v.viewId+"?chartId="+se.id+"&"+(0,Ue.tQ)();window.location.href=$}else Ke.Z.getAppSimpleInfo({workSheetId:ce}).then(function(Ce){var Ee="/mobile/recordList/"+Ce.appId+"/"+Ce.appSectionId+"/"+ce+"/"+v.viewId+"?chartId="+se.id;window.mobileNavigateTo(Ee)})}})},te=window.shareAuthor||i().get(window,"shareState.shareId"),me=v.viewId&&[He.B.sheet].includes(v.viewType.toString())&&!te,A=e.createElement(p,{reportData:a,isThumbnail:!0,isViewOriginalData:me,isLinkageData:J,onOpenChartDialog:ie,onUpdateLinkageFiltersGroup:g,linkageMatch:f,mobileCount:o,mobileFontSize:n,isHorizontal:c,projectId:l,themeColor:d,customPageConfig:m});switch(a.reportType){case T.f0.BarChart:case T.f0.PieChart:case T.f0.RadarChart:case T.f0.FunnelChart:case T.f0.CountryLayer:case T.f0.WordCloudChart:case T.f0.BidirectionalBarChart:case T.f0.ScatterChart:case T.f0.TopChart:case T.f0.GaugeChart:case T.f0.ProgressChart:return h?u:A;case T.f0.DualAxes:case T.f0.LineChart:return h&&y?u:A;case T.f0.NumberChart:return A;case T.f0.PivotTable:return i().isEmpty(a.data.data)?u:A;default:return A}}function _e(t){var a=t.loading,o=t.pageComponents,n=o===void 0?[]:o,c=t.onOpenFilterModal,l=t.onOpenZoomModal,d=t.onLoadBeforeData,s=t.onLoadNextData,m=(0,we.Z)(t,["loading","pageComponents","onOpenFilterModal","onOpenZoomModal","onLoadBeforeData","onLoadNextData"]),f=m.data,g=m.isHorizontal,h=window.orientation===0,y=location.href.includes("mobileChart"),p=i().findIndex(n,{value:f.reportId}),u=n.length-p<n.length,x=p<n.length-1;return e.createElement(e.Fragment,null,e.createElement("div",{className:G()("mBottom10 flexRow valignWrapper",{mRight20:g})},e.createElement("div",{className:"Font17 Gray ellipsis name flex"},f.name),f.status>0&&e.createElement(e.Fragment,null,g&&e.createElement(e.Fragment,null,e.createElement(M.Z,{icon:"navigate_before",className:G()("Font24 Gray_9e mRight10",{allow:u}),onClick:u&&d.bind(this,p-1)}),e.createElement(M.Z,{icon:"navigate_next",className:G()("Font24 Gray_9e mRight20",{allow:x}),onClick:x&&s.bind(this,p+1)})),e.createElement(M.Z,{className:"Font20 Gray_9e mRight10",icon:"swap_vert",onClick:c}),g?e.createElement(M.Z,{className:"Font20 Gray_9e",icon:"close",onClick:l}):h&&e.createElement(M.Z,{className:G()("Font18 Gray_9e",{Visibility:y}),icon:"task-new-fullscreen",onClick:l}))),e.createElement(Je,{className:G()("flexColumn overflowHidden","statisticsCard-"+f.reportId)},a?e.createElement(_(),{justify:"center",align:"center",className:"h100"},e.createElement(ee(),{size:"large"})):e.createElement(qe,m)))}const Re=_e;var zt=r(62455),et=r(59868),De=r.n(et),tt=r(3540),nt=r(30381),X=r.n(nt),S=r(729),at=(0,Z.Z)([`
  width: 100%;
  border-radius: 18px !important;
  border: none !important;
  background-color: #f5f5f5;
`],[`
  width: 100%;
  border-radius: 18px !important;
  border: none !important;
  background-color: #f5f5f5;
`]),rt=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21],be=(0,oe.ZP)(tt.Z)(at);function ot(t){var a=t.data.xaxes,o=t.defaultData.xaxes,n=a.controlType===16?S._5:S._5.filter(function(d){return![6,7].includes(d.value)}),c=i().findIndex(n,{value:o.particleSizeType}),l=i().findIndex(S.x9,{value:o.particleSizeType});return e.createElement(e.Fragment,null,e.createElement("div",{className:"flexRow valignWrapper Font13 Gray_75 mBottom16"},_l("\u5F52\u7EC4")),e.createElement("div",{className:"itemWrapper flexRow valignWrapper"},i().find(n,{value:o.particleSizeType})&&n.filter(function(d,s){return s>=c}).map(function(d){return e.createElement("div",{key:d.value,className:G()("item Font12 Gray",{active:a.particleSizeType===d.value}),onClick:function(){t.onChange({particleSizeType:d.value})}},d.text)}),i().find(S.x9,{value:a.particleSizeType})&&S.x9.filter(function(d,s){return s>=l}).map(function(d){return e.createElement("div",{key:d.value,className:G()("item Font12 Gray",{active:a.particleSizeType===d.value}),onClick:function(){t.onChange({particleSizeType:d.value})}},d.text)})))}function lt(t){var a=S.p3.filter(function(u){return![20,21].includes(u.value)}),o=t.data,n=o.reportType,c=o.xaxes,l=o.rangeValue,d=o.rangeType,s=t.defaultData,m=s.rangeValue,f=s.rangeType,g=s.filter,h=(0,S.$$)(c.controlType),y=!0,p=function(){var x=f===20,b=i().find(S.p3,{value:f})||{},v=x?m.split("-").map(function(A){return X()(A)}):[X()(g.startDate),X()(g.endDate)],E=(0,D.Z)(v,2),O=E[0],j=E[1],I=O?X()(O).toDate():null,R=j?X()(j).toDate():null,C=(0,e.useState)(null),Q=(0,D.Z)(C,2),V=Q[0],le=Q[1],J=(0,e.useState)(null),ie=(0,D.Z)(J,2),te=ie[0],me=ie[1];return(0,e.useEffect)(function(){var A=X()(V||I).format("YYYY/MM/DD"),P=X()(te||R).format("YYYY/MM/DD");t.onChange({rangeType:20,rangeValue:A+"-"+P})},[V,te]),e.createElement("div",{className:"flexRow mBottom16"},e.createElement("div",{className:"flex"},e.createElement(De(),{mode:"date",minDate:I,maxDate:R,title:_l("\u5F00\u59CB\u65F6\u95F4"),value:V||I,onChange:function(P){le(P)}},e.createElement(be,{readOnly:!0,className:"centerAlign",placeholder:_l("\u5F00\u59CB"),value:X()(V||O).format("YYYY-MM-DD")||""}))),e.createElement("div",{className:"flexRow valignWrapper mLeft7 mRight7"},"-"),e.createElement("div",{className:"flex"},e.createElement(De(),{mode:"date",minDate:I,maxDate:R,title:_l("\u7ED3\u675F\u65F6\u95F4"),value:te||R,onChange:function(P){me(P)}},e.createElement(be,{readOnly:!0,className:"centerAlign",placeholder:_l("\u7ED3\u675F"),value:X()(te||j).format("YYYY-MM-DD")||""}))))};return e.createElement("div",{className:"filterWrapper pAll15 mBottom20"},e.createElement("div",{className:"flexRow valignWrapper Font13 Gray_75 mBottom16"},e.createElement("div",{className:"flex"},_l("\u65F6\u95F4\u5468\u671F"),"("+i().find(S.p3,{value:f}).text+")")),rt.includes(f)&&p(),f===0&&e.createElement(e.Fragment,null,e.createElement("div",{className:"itemWrapper flexRow valignWrapper"},(y?a:a.slice(0,6)).map(function(u,x){return e.createElement("div",{key:u.value,className:G()("item Font12 Gray",{active:d===u.value}),onClick:function(){t.onChange({rangeType:u.value,rangeValue:(0,S.HZ)(u.value)?7:null})}},u.text)})),(0,S.HZ)(d)&&e.createElement(e.Fragment,null,e.createElement("div",{className:"flexRow valignWrapper Font13 Gray_75 mBottom16"},i().find(S.p3,{value:d}).text),e.createElement("div",{className:"itemWrapper flexRow valignWrapper"},S.E5.map(function(u,x){return e.createElement("div",{key:u.value,className:G()("item Font12 Gray",{active:l==u.value}),onClick:function(){t.onChange({rangeValue:u.value})}},u.text)})))),(0,S.HZ)(f)&&e.createElement("div",{className:"itemWrapper flexRow valignWrapper"},S.E5.filter(function(u){return u.value<=m}).map(function(u,x){return e.createElement("div",{key:u.value,className:G()("item Font12 Gray",{active:l==u.value}),onClick:function(){t.onChange({rangeValue:u.value})}},u.text)})),n!==T.f0.NumberChart&&h&&e.createElement(ot,t))}const it=lt;var he=r(88106),ue=r(85315),st=r(85105),ut=r.n(st),ct=r(99663),dt=r(22600),ft=r(49135),pt=r(93196),mt,Ne,Ge,vt={value:0,text:_l("\u4E0D\u6392\u5E8F")},Pe={value:3,text:_l("\u81EA\u5B9A\u4E49")},gt=(Ne=mt=function(t){(0,pt.default)(a,t);function a(o){(0,ct.default)(this,a);var n=(0,ft.default)(this,(a.__proto__||ut()(a)).call(this,o));Ge.call(n);var c=o.currentReport.rightY;return n.state={visible:!1,currentCustomSort:null,sortList:[],customSortLoading:!1,rightYaxisList:c?n.setYaxisList(c.yaxisList):[]},n}return(0,dt.default)(a,[{key:"componentWillReceiveProps",value:function(n){var c=n.currentReport.rightY;this.setState({rightYaxisList:c?this.setYaxisList(c.yaxisList):[]})}},{key:"renderItem",value:function(n,c){var l=this,d=this.props.currentReport,s=d.sorts,m=(0,S.Zv)(n),f=i().find(s,n.controlId),g=f?f[n.controlId]:0;return!i().isEmpty(m)&&e.createElement("div",{key:n.controlId},e.createElement("div",{className:"flexRow valignWrapper Font13 Gray_75 mBottom16"},n.particleSizeType?n.controlName+"("+i().find(S.qp,{value:n.particleSizeType}).text+")":n.controlName),e.createElement("div",{className:"itemWrapper flexRow valignWrapper"},[vt].concat((0,ue.Z)(m)).map(function(h){return e.createElement("div",{key:h.value,className:G()("item Font12 Gray",{active:(i().isArray(g)?Pe.value:g)===h.value}),onClick:function(){h.value==Pe.value?l.setState({currentCustomSort:n.controlId,visible:!1}):c(h.value,n)}},h.text)})))}},{key:"render",value:function(){var n=this,c=this.state.rightYaxisList,l=this.props.currentReport,d=l.xaxes,s=l.yaxisList,m=l.split,f=l.rightY,g=l.reportType,h=i().get(m,["controlId"]),y=i().get(f,["split","controlId"]);return e.createElement("div",{className:"sortWrapper pAll15"},d&&g!==T.f0.PivotTable&&this.renderItem((0,L.default)({},d,{originalControlId:d.controlId,controlId:d.particleSizeType?d.controlId+"-"+d.particleSizeType:d.controlId,particleSizeType:d.particleSizeType}),this.handleChangeXSort),g==T.f0.PivotTable&&e.createElement(e.Fragment,null,l.lines.map(function(p){return n.renderItem((0,L.default)({},p,{originalControlId:p.controlId,controlId:(0,S.$$)(p.controlType)?p.controlId+"-"+p.particleSizeType:p.controlId}),n.handleChangePivotTableSort)}),l.columns.map(function(p){return n.renderItem((0,L.default)({},p,{originalControlId:p.controlId,controlId:(0,S.$$)(p.controlType)?p.controlId+"-"+p.particleSizeType:p.controlId}),n.handleChangePivotTableSort)})),s.map(function(p){return n.renderItem(p,n.handleChangeYSort)}),h&&this.renderItem((0,L.default)({},m,{originalControlId:h,controlId:m.particleSizeType?h+"-"+m.particleSizeType:h}),this.handleChangeYSort),c.map(function(p){return n.renderItem(p,n.handleChangeYSort)}),y&&this.renderItem((0,L.default)({},f.split,{originalControlId:y,controlId:f.split.particleSizeType?y+"-"+f.split.particleSizeType:y}),this.handleChangeYSort))}}]),a}(e.Component),Ge=function(){var a=this;this.setYaxisList=function(o){var n=a.props.currentReport,c=n.yaxisList,l=n.rightY,d=i().filter(c,function(s){return i().find(l.yaxisList,{controlId:s.controlId})}).map(function(s){return s.controlId});return i().cloneDeep(o).map(function(s){return d.includes(s.controlId)&&(s.originalControlId=s.controlId,s.controlId=s.controlId+"-right"),s})},this.handleChangeSorts=function(o){var n=a.props.currentReport,c=n.xaxes,l=c===void 0?{}:c,d=n.yaxisList,s=n.rightY,m=n.split,f=m===void 0?{}:m,g=n.reportType,h=n.lines,y=n.columns,p=g===T.f0.PivotTable,u=d.map(function(C){return C.controlId});if(p){var x=h.map(function(C){return(0,S.$$)(C.controlType)?C.controlId+"-"+C.particleSizeType:C.controlId}),b=y.map(function(C){return(0,S.$$)(C.controlType)?C.controlId+"-"+C.particleSizeType:C.controlId});o=(0,S.Cg)(o,[].concat((0,ue.Z)(x),(0,ue.Z)(b),(0,ue.Z)(u)))}else{var v=l.particleSizeType?l.controlId+"-"+l.particleSizeType:l.controlId,E=s?s.yaxisList.map(function(C){return C.controlId}):[],O=f.particleSizeType?f.controlId+"-"+f.particleSizeType:f.controlId,j=s?s.split.particleSizeType?s.split.controlId+"-"+s.split.particleSizeType:s.split.controlId:null,I=i().filter(u,function(C){return E.includes(C)}).map(function(C){return C}),R=E.map(function(C){return I.includes(C)?C+"-right":C});o=(0,S.Cg)(o,[v].concat((0,ue.Z)(u),[O],(0,ue.Z)(R),[j]),I)}a.props.onChangeCurrentReport({sorts:o})},this.handleSaveSortList=function(){var o=a.props.currentReport,n=o.xaxes,c=o.sorts,l=o.split,d=o.yaxisList,s=o.rightY,m=o.reportType,f=a.state,g=f.currentCustomSort,h=f.sortList,y=h.map(function(v){return v.originalName}),p=m===T.f0.PivotTable,u=i().get(l,["controlId"]),x=i().get(s,["split","controlId"]);if(p)a.handleChangePivotTableSort(y,{controlId:g});else if(g===n.controlId&&a.handleChangeXSort(y,{controlId:n.controlId}),g===u&&a.handleChangeYSort(y,{controlId:u}),x){var b=i().filter(d,function(v){return i().find(s.yaxisList,{controlId:v.controlId})}).map(function(v){return v.controlId});a.handleChangeYSort(y,{controlId:b.includes(x)?x+"-right":x})}a.setState({currentCustomSort:null,visible:!0})},this.handleChangeVisible=function(){var o=a.state.visible;a.setState({visible:!o})},this.createSortItem=function(o,n){var c=(0,he.default)({},o,n);a.handleChangeSorts([c])},this.handleChangeXSort=function(o,n){var c=n.controlId,l=a.props.currentReport,d=l.xaxes,s=l.yaxisList,m=l.split,f=l.sorts,g=l.displaySetup,h=l.reportType,y=h===T.f0.DualAxes,p=i().get(m,["controlId"]),u=i().isEmpty(p)||y;if(f.length){var x=i().isEmpty(i().find(f,c));x&&f.push((0,he.default)({},c,o));var b=f.map(function(v,E){return v[c]?o?(v[c]=o,v):null:g.isPile&&s[0].controlId==i().findKey(v)?u||g.isPile?null:v:u?null:v}).filter(function(v){return v});a.handleChangeSorts(b)}else o&&a.createSortItem(c,o)},this.handleChangeYSort=function(o,n){var c=n.controlId,l=a.props.currentReport,d=l.yaxisList,s=l.split,m=l.sorts,f=l.xaxes,g=l.displaySetup,h=l.reportType,y=h===T.f0.DualAxes,p=h===T.f0.PivotTable,u=i().get(s,["controlId"]),x=i().isEmpty(u)||y;if(m.length){var b=i().isEmpty(i().find(m,c));b&&m.push((0,he.default)({},c,o));var v=m.map(function(E){if(E[c])return o?(E[c]=o,E):null;if(E[f.controlId])return g.isPile&&d[0].controlId==c?x||g.isPile?null:E:x?null:E;if(p){var O=i().findLast(l.lines)||{},j=i().findLast(l.columns)||{},I=i().findKey(E);return i().find(d,{controlId:I})||[O.controlId,j.controlId].includes(I)?null:E}else return g.isPile?E:null});a.handleChangeSorts(v.filter(function(E){return E}))}else o&&a.createSortItem(c,o)},this.handleChangePivotTableSort=function(o,n){var c=n.controlId,l=a.props.currentReport,d=l.yaxisList,s=l.sorts,m=l.lines,f=l.columns;if(s.length){var g=i().findLast(m)||{},h=i().findLast(f)||{},y=i().isEmpty(i().find(s,c));y&&s.push((0,he.default)({},c,o));var p=s.map(function(u){if(u[c])return o?(u[c]=o,u):null;var x=i().findKey(u);return[g.controlId,h.controlId].includes(c)&&i().find(d,{controlId:x})?null:u});a.handleChangeSorts(p.filter(function(u){return u}))}else o&&a.createSortItem(c,o)}},Ne),ht=r(50533),Ct=r(93582),yt=r(18484),It=(0,Z.Z)([`
  background-color: #fff;
  .itemWrapper {
    flex-wrap: wrap;
    justify-content: flex-start;
    .item {
      width: 30%;
      margin-right: 3%;
      margin-bottom: 10px;
      padding: 6px 0;
      text-align: center;
      border-radius: 14px;
      background-color: #f5f5f5;
    }
    .active {
      color: rgba(33, 150, 243, 1) !important;
      background-color: rgba(33, 150, 243, 0.1);
    }
  }
  .scrollView {
    overflow: auto;
    max-height: 400px;
  }
`],[`
  background-color: #fff;
  .itemWrapper {
    flex-wrap: wrap;
    justify-content: flex-start;
    .item {
      width: 30%;
      margin-right: 3%;
      margin-bottom: 10px;
      padding: 6px 0;
      text-align: center;
      border-radius: 14px;
      background-color: #f5f5f5;
    }
    .active {
      color: rgba(33, 150, 243, 1) !important;
      background-color: rgba(33, 150, 243, 0.1);
    }
  }
  .scrollView {
    overflow: auto;
    max-height: 400px;
  }
`]),xt=(0,Z.Z)([`
  .am-modal-body {
    overflow: hidden;
  }
`],[`
  .am-modal-body {
    overflow: hidden;
  }
`]),St=(0,Z.Z)([`
  position: relative;
  display: flex;
  flex-direction: column;
  transform: rotate(90deg);
  transform-origin: top left;
  height: `,`;
  width: `,`;
  left: `,`;
  .count {
    color: #333;
    font-weight: 500;
    font-size: 20px;
    font-family: system-ui, BlinkMacSystemFont, segoe ui, Roboto, Helvetica, Arial, sans-serif, apple color emoji,
      segoe ui emoji, segoe ui symbol;
  }
  .allow {
    border-radius: 50%;
    background: #f8f8f9;
  }
`],[`
  position: relative;
  display: flex;
  flex-direction: column;
  transform: rotate(90deg);
  transform-origin: top left;
  height: `,`;
  width: `,`;
  left: `,`;
  .count {
    color: #333;
    font-weight: 500;
    font-size: 20px;
    font-family: system-ui, BlinkMacSystemFont, segoe ui, Roboto, Helvetica, Arial, sans-serif, apple color emoji,
      segoe ui emoji, segoe ui symbol;
  }
  .allow {
    border-radius: 50%;
    background: #f8f8f9;
  }
`]),ze=oe.ZP.div(It),Et=(0,oe.ZP)(H())(xt),Me=oe.ZP.div(St,function(t){return t.height+"px"},function(t){return t.width+"px"},function(t){return t.height+"px"});function ke(t){var a=t.linkageFiltersGroup,o=a===void 0?[]:a,n=t.linkageMatch,c=n===void 0?{}:n,l=t.onUpdateLinkageFiltersGroup,d=l===void 0?i().noop:l,s=t.widget,m=t.reportId,f=t.name,g=t.accessToken,h=t.filters,y=h===void 0?[]:h,p=t.pageComponents,u=t.projectId,x=t.themeColor,b=t.filtersGroup,v=b===void 0?[]:b,E=t.onLoad,O=t.isHorizontal,j=i().get(s,"config.mobileCount"),I=i().get(s,"config.mobileFontSize"),R=(0,e.useState)(!0),C=(0,D.Z)(R,2),Q=C[0],V=C[1],le=(0,e.useState)(!1),J=(0,D.Z)(le,2),ie=J[0],te=J[1],me=(0,e.useState)(!1),A=(0,D.Z)(me,2),P=A[0],Se=A[1],se=(0,e.useState)({name:f}),ce=(0,D.Z)(se,2),$=ce[0],Ce=ce[1],Ee=(0,e.useState)({name:f}),Ze=(0,D.Z)(Ee,2),B=Ze[0],Oe=Ze[1],Dt=(0,e.useState)(),Ae=(0,D.Z)(Dt,2),je=Ae[0],bt=Ae[1],Nt=(0,L.default)({},t.pageConfig,{filters:y.length?y:void 0,filtersGroup:v.length?v:void 0});g&&(window.access_token=g);var Ve=(0,e.useRef)(null);(0,K.Z)(function(){Te()},[m,v,o]);var Te=function(Y){var z={reportId:m,version:S.i8,filters:[y.length?y:void 0,v.length?v:void 0,o.length?o:void 0].filter(function(q){return q})};Y&&k()(z,{rangeType:$.rangeType,filterRangeId:$.filterRangeId,particleSizeType:$.xaxes.particleSizeType||null,rangeValue:$.rangeValue,sorts:$.sorts},Y),V(!0),Ve.current=xe.Z.getData(z),Ve.current.then(function(q){q.reportId=m;var ve=(0,S.$Q)(q);Ce(ve),Oe(ve),i().isEmpty(je)&&bt(q),V(!1),E&&E(q)})},ye=function(Y,z){var q={reportId:Y,version:S.i8};z&&k()(q,{rangeType:B.rangeType,filterRangeId:B.filterRangeId,particleSizeType:B.xaxes.particleSizeType||null,rangeValue:B.rangeValue,sorts:B.sorts},z),V(!0),xe.Z.getData(q).then(function(ve){ve.reportId=Y;var Pt=(0,S.$Q)(ve);Oe(Pt)}).finally(function(){return V(!1)})},Ie=function(){var Y=!ie;te(Y)},Ye=function(){Se(!P)},We=function(){return e.createElement(e.Fragment,null,e.createElement("div",{className:"titleWrapper flexRow valignWrapper pAll15"},e.createElement("div",{className:"Font13 Gray_9e flex Bold"},_l("\u7B5B\u9009\u4E0E\u6392\u5E8F")),e.createElement(M.Z,{className:"Font20",icon:"closeelement-bg-circle",onClick:Ie})),e.createElement("div",{className:"flex scrollView"},e.createElement(it,{data:P?B:$,defaultData:je,onChange:function(z){P?ye(B.reportId,z):Te(z)}}),![T.f0.CountryLayer,T.f0.NumberChart].includes($.reportType)&&e.createElement(e.Fragment,null,e.createElement(gt,{currentReport:P?B:$,onChangeCurrentReport:function(z){P?ye(B.reportId,z):Te(z)}}))))},Gt=location.href.includes("mobileChart"),$e={projectId:u,linkageMatch:c,onUpdateLinkageFiltersGroup:d,loading:Q,pageConfig:Nt,themeColor:x,mobileFontSize:I,onOpenFilterModal:Ie,onOpenZoomModal:Ye};return e.createElement(e.Fragment,null,e.createElement(Re,(0,L.default)({data:$,mobileCount:j,onOpenFilterModal:Ie},$e)),e.createElement(H(),{popup:!0,style:{height:Gt?"80%":null},visible:ie,onClose:Ie,className:G()("mobileNewRecordDialog",{horizontalChartDialog:P}),animationType:"slide-up"},P?e.createElement(Me,{height:document.documentElement.clientWidth,width:document.documentElement.clientHeight/2},e.createElement(ze,{className:"leftAlign flexColumn h100"},We())):e.createElement(ze,{className:"leftAlign flexColumn h100"},We())),e.createElement(Et,{popup:!0,visible:P,onClose:Ye,className:"h100",transitionName:"null",maskTransitionName:"null"},e.createElement(Me,{className:"leftAlign pAll20",height:document.documentElement.clientWidth,width:document.documentElement.clientHeight},P&&e.createElement(Re,(0,L.default)({isHorizontal:i().isUndefined(O)?!0:O,pageComponents:p,data:B},$e,{onLoadBeforeData:function(Y){var z=p[Y];ye(z.value)},onLoadNextData:function(Y){var z=p[Y];ye(z.value)}})))))}var Tt=[];function Lt(t){var a=t.widget,o=t.filterComponents,n=t.loadFilterComponentCount,c=i().get(a,"config.columnWidthConfig"),l=i().get(a,"config.objectId"),d=(0,e.useState)(!1),s=(0,D.Z)(d,2),m=s[0],f=s[1],g=(0,e.useState)(null),h=(0,D.Z)(g,2),y=h[0],p=h[1],u=(0,Ct.X)(l,t.filtersGroup),x=y?(0,yt.Uf)({sheetId:y,reportId:a.value,objectId:l},t.linkageFiltersGroup):{},b=x.linkageFiltersGroup,v=b===void 0?[]:b,E=x.initiateChartIds,O=E===void 0?[]:E;if((0,e.useEffect)(function(){var I=document.querySelector("#componentsWrap");if(!I){f(!0);return}var R=I.querySelector(".widgetContent .analysis-"+a.id),C=function(){if(!m){var V=I.getBoundingClientRect(),le=R.getBoundingClientRect(),J=le.top<=V.bottom;J&&f(J)}};return I.addEventListener("scroll",C,!1),C(),c&&sessionStorage.setItem("pivotTableColumnWidthConfig-"+a.value,c),function(){I.removeEventListener("scroll",C,!1)}},[]),!i().get(window,"shareState.shareId")&&o.length&&n<o.length)return e.createElement(_(),{justify:"center",align:"center",className:"h100 w100"},e.createElement(ee(),{size:"large"}));var j=!!o.map(function(I){var R=I.filters,C=I.advancedSetting,Q=i().find(R,{objectId:l});return Q&&C.clicksearch==="1"}).filter(function(I){return I}).length;return j&&!u.length?e.createElement(_(),{justify:"center",align:"center",className:"h100 w100"},e.createElement("span",{className:"Font15 bold Gray_9e"},_l("\u6267\u884C\u67E5\u8BE2\u540E\u663E\u793A\u7ED3\u679C"))):m?e.createElement(ke,(0,L.default)({},t,{linkageMatch:t.linkageFiltersGroup[a.id],filtersGroup:u.length?u:Tt,linkageFiltersGroup:v.length?v:void 0,initiateChartInfo:O.map(function(I){return t.linkageFiltersGroup[I]}),onUpdateLinkageFiltersGroup:function(R){R.objectId=l,R.widgetId=a.id,t.updateLinkageFiltersGroup(a.id,R)},onLoad:function(R){return p(R.appId)}})):e.createElement(_(),{justify:"center",align:"center",className:"h100 w100"},e.createElement(ee(),{size:"large"}))}var Ft=(0,ht.$j)(function(t){return{filtersGroup:t.mobile.filtersGroup,linkageFiltersGroup:t.mobile.linkageFiltersGroup,filterComponents:t.mobile.filterComponents,loadFilterComponentCount:t.mobile.loadFilterComponentCount}},function(t){return(0,re.DE)(i().pick(W,["updateLinkageFiltersGroup"]),t)})(Lt);const Rt=ke},82986:(Le,ne,r)=>{r.r(ne),r.d(ne,{deleteAllLinkageFiltersGroup:()=>ge,deleteLinkageFiltersGroup:()=>_,updateFilterComponents:()=>w,updateFiltersGroup:()=>ae,updateLinkageFiltersGroup:()=>fe,updateLoadFilterComponentCount:()=>ee});var ae=function(N){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(L,D){L({type:"MOBILE_UPDATE_ALL_FILTERS_GROUP",id:N,filters:k})}},fe=function(N){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(L,D){L({type:"MOBILE_UPDATE_LINKAGE_FILTERS_GROUP",id:N,filters:k})}},_=function(N){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(L,D){L({type:"MOBILE_DELETE_LINKAGE_FILTERS_GROUP",id:N})}},ge=function(N){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(L,D){L({type:"MOBILE_DELETE_ALL_LINKAGE_FILTERS_GROUP",id:N})}},w=function(N){return function(k,L){k({type:"MOBILE_UPDATE_FILTER_COMPONENTS",value:N})}},ee=function(N){return function(k,L){k({type:"MOBILE_UPDATE_LOAD_FILTER_COMPONENT_COUNT",value:N})}}},93582:(Le,ne,r)=>{r.d(ne,{U:()=>L,X:()=>M});var ae=r(88239),fe=r(88902),_=r.n(fe),ge=r(96486),w=r.n(ge);if(/^(2634|7375|8695)$/.test(r.j))var ee=r(86674);var M=function(U,F){var H=w().flatten(_()(F).map(function(e){return F[e]})).filter(function(e){return w().find(e.objectControls,{objectId:U})}),Z=H.map(function(e){var K=w().find(e.objectControls,{objectId:U}),re=K.controlId,W=w().pick(e,["dataType","filterType","dateRange","value","values","minValue","maxValue"]);return(0,ae.default)({},W,{spliceType:1,controlId:re})}).filter(function(e){return e.controlId});return Z},N=function(U){return w().get(U,"advancedSetting.showtype")},k=function(U){var F=U||{},H=F.dataType,Z=F.objectControls,e=Z===void 0?[]:Z;if([ee.DN.DATE].includes(H)){var K={5:3,4:2,3:1},re=e.sort(function(pe,G){return K[N(pe.control)]-K[N(G.control)]});return re[0]}if([ee.DN.DATE_TIME].includes(H)){var W={2:3,1:2,6:1},oe=e.sort(function(pe,G){return W[N(pe.control)]-W[N(G.control)]});return oe[0]}return e[0]||{}},L=function(U){return U.map(function(F){var H=26,Z=k(F)||{},e=F.control?F.control:Z.control,K=!Z.controlId||!e,re=(0,ae.default)({},e,{controlId:Z.controlId||F.filterId,controlName:F.name,type:e?e.type:H}),W=F.advancedSetting;return(0,ae.default)({control:re,controlId:F.filterId,dataType:F.dataType,fid:F.filterId,type:F.dataType,advancedSetting:(0,ae.default)({},W,{navfilters:W.showNavfilters?W.showNavfilters:W.navfilters}),className:K?"disable":"",objectControls:F.objectControls},w().pick(F,["value","minValue","maxValue","dateRange","filterType","dateRangeType"]),{values:K?[]:F.values})})}}}]);
