"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[811],{26319:(P,h,t)=>{t.d(h,{Z:()=>i});var T=t(20148),C=t(60385),I=t.n(C),U=t(77040),A=t(94301),m=t.n(A),E=t(33867),z=t(39216),S=t(48272),d=t.n(S),j=t(85105),D=t.n(j),x=t(99663),B=t(22600),L=t(49135),R=t(93196),W=t(88239),N=t(42723),s=t(67294),l=t(21),u=t(5274),Z=t(96486),F=t.n(Z),f,H=function(a){return function(e){var n=e.getRef,o=(0,N.Z)(e,["getRef"]);return s.createElement(a,(0,W.default)({ref:n},o))}},b=(0,l.Z)(f=H(f=function(r){(0,R.default)(a,r);function a(e){(0,x.default)(this,a);var n=(0,L.default)(this,(a.__proto__||D()(a)).call(this,e));return n.installApp=function(o,c){if((F().find(md.global.Account.projects,function(g){return g.projectId===o})||{}).cannotCreateApp){d().catch(_l("\u60A8\u6CA1\u6709\u6743\u9650\u5B89\u88C5\u5E94\u7528"),2);return}d().loading(_l("\u6B63\u5728\u6DFB\u52A0"),0),n.props.onCancel();var M=md&&md.global&&md.global.SysSettings&&md.global.SysSettings.templateLibraryTypes==="2"?__api_server__.main:"https://pd.mingdao.com/api/";u.Z.post(M+"AppManagement/GetLibraryToken",{projectId:o,libraryId:c}).then(function(g){var p=g.data.data;if(!p){d().catch(_l("\u5B89\u88C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),2);return}u.Z.post(md.global.Config.AppFileServer+"Library/InstallApp",{fileUrl:p,projectId:o,id:c,accountId:md.global.Account.accountId}).then(function(v){var y=v.data.appId;if(!y){d().catch(_l("\u5B89\u88C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),2);return}d().success(_l("\u6DFB\u52A0\u6210\u529F"),2,function(){n.props.history.push("/mobile/app/"+y+"/true")})},function(v){d().hide(),n.props.onCancel()})})},n}return(0,B.default)(a,[{key:"render",value:function(){var n=this,o=this.props,c=o.onCancel,M=o.visible,g=o.projectId,p=md.global.Account.projects.length;return s.createElement(I(),{popup:!0,visible:M,onClose:c,animationType:"slide-up"},s.createElement(m(),{renderHeader:function(){return s.createElement("div",null,_l("\u5B89\u88C5\u5230"))},style:{maxHeight:390}},md.global.Account.projects.map(function(v,y){return s.createElement(m().Item,{key:v.projectId,thumb:s.createElement(E.Z,{className:"Font20",icon:"chatnetwork-type"+((p-1-y)%6+1)}),onClick:function(){n.installApp(v.projectId,n.props.libraryId)}},v.companyName)})))}}]),a}(s.Component))||f)||f;const i=b},30811:(P,h,t)=>{t.r(h),t.d(h,{default:()=>H});var T=t(66814),C=t(91880),I=t.n(C),U=t(48388),A=t(29914),m=t.n(A),E=t(6100),z=t(39216),S=t(48272),d=t.n(S),j=t(85105),D=t.n(j),x=t(99663),B=t(22600),L=t(49135),R=t(93196),W=t(77040),N=t(94301),s=t.n(N),l=t(67294),u=t(26319),Z=t(5274),F=t(96486),f=s().Item,H=function(b){(0,R.default)(i,b);function i(r){(0,x.default)(this,i);var a=(0,L.default)(this,(i.__proto__||D()(i)).call(this,r));return a.handleAddProject=function(e){if(window.isWxWork){var n=md.global.Account.projects;n.length?a.addDialogEl.installApp(n[0].projectId,e.libraryId):d().info(_l("\u60A8\u6CA1\u6709\u53EF\u5B89\u88C5\u6A21\u677F\u7684\u7EC4\u7EC7"),3)}else a.setState({showDialog:!0,libraryId:e.libraryId})},a.state={data:[],loading:!0,dataBysearch:[],libraryId:"",showDialog:!1},a}return(0,B.default)(i,[{key:"componentDidMount",value:function(){var a=this.props.match.params;this.getlibraryByCategory(a.categoryId)}},{key:"getlibraryByCategory",value:function(a){var e=this;this.setState({loading:!0});var n=md&&md.global&&md.global.SysSettings&&md.global.SysSettings.templateLibraryTypes==="2"?__api_server__.main:"https://pd.mingdao.com/api/";Z.Z.post(n+"AppManagement/GetAppsLibraryInfo",{categoryId:a}).then(function(o){var c=o.data.data;c&&e.setState({dataBysearch:c,loading:!1})})}},{key:"renderAppsInfo",value:function(){var a=this,e=this.state.dataBysearch;return l.createElement(s(),{className:"appsLibraryList"},e.map(function(n){return l.createElement(f,{key:n.libraryId,thumb:l.createElement("div",{className:"iconWrapper",style:{backgroundColor:n.iconColor}},l.createElement(E.Z,{url:n.iconUrl,fill:"#fff",size:34})),extra:l.createElement("div",{className:"valignWrapper install bold",onClick:function(){a.handleAddProject(n)}},_l("\u6DFB\u52A0")),onClick:function(){event.target.classList.contains("install")||a.props.history.push("/mobile/appBoxInfo/"+n.libraryId)}},l.createElement("div",{className:"bold Font16"},n.name))}))}},{key:"renderHome",value:function(){var a=this.state.loading;return l.createElement(l.Fragment,null,a?l.createElement(I(),{justify:"center",align:"center",className:"h100"},l.createElement(m(),{size:"large"})):this.renderAppsInfo())}},{key:"render",value:function(){var a=this;return l.createElement("div",{className:"appBox h100"},l.createElement("div",{className:"content"},this.renderHome(),l.createElement(u.Z,{getRef:function(n){return a.addDialogEl=n},visible:this.state.showDialog,isMobile:!0,onCancel:function(){return a.setState({showDialog:!1})},libraryId:this.state.libraryId})))}}]),i}(l.Component)}}]);
