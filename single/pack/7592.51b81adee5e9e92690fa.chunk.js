"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[7592],{6917:(Ge,Se,u)=>{u.d(Se,{BD:()=>Te});var oe=u(30381),Me=u.n(oe),J=u(96486),q=u.n(J),_e=u(89499),me={REQUIRED:"REQUIRED",MOBILE_PHONE:"MOBILE_PHONE",TEL_PHONE:"TEL_PHONE",EMAIL:"EMAIL",ID_CARD:"ID_CARD",PASSPORT:"PASSPORT",HK_PASSPORT:"HK_PASSPORT",TW_PASSPORT:"TW_PASSPORT",UNIQUE:"UNIQUE",NUMBER_RANGE:"NUMBER_RANGE",MULTI_SELECT_RANGE:"MULTI_SELECT_RANGE",DATE:"DATE",DATE_TIME:"DATE_TIME",TEXT_RANGE:"TEXT_RANGE",CUSTOM:"CUSTOM",DATE_TIME_RANGE:"DATE_TIME_RANGE",RULE_ERROR:"RULE_ERROR",OTHER_ERROR:"OTHER_ERROR",RULE_REQUIRED:"RULE_REQUIRED",OTHER_REQUIRED:"OTHER_REQUIRED",CHILD_TABLE_ROWS_LIMIT:"CHILD_TABLE_ROWS_LIMIT"},Pe={REQUIRED:function(G){var D=G.controlName,Y=G.advancedSetting,U=G.type;if(U===36){if(Y.showtype==="1")return _l("\u8BF7\u5F00\u542F\u6B64\u9879");if(Y.showtype==="2"){var W=safeParse((Y||{}).itemnames||"[]");return _l("\u8BF7\u9009\u62E9%0",q().get(q().find(W,function(te){return te.key==="1"}),"value"))}else return _l("\u8BF7\u52FE\u9009\u6B64\u9879")}return""+_l("\u8BF7\u586B\u5199%0",D)},REQUIRED_SELECT:function(G){var D=G.controlName;return""+_l("\u8BF7\u9009\u62E9%0",D)},MOBILE_PHONE:_l("\u4E0D\u662F\u6709\u6548\u7684\u624B\u673A\u53F7\u7801"),TEL_PHONE:_l("\u4E0D\u662F\u6709\u6548\u7684\u5EA7\u673A\u53F7\u7801"),EMAIL:_l("\u4E0D\u662F\u6709\u6548\u7684\u90AE\u7BB1\u5730\u5740"),ID_CARD:_l("\u4E0D\u662F\u6709\u6548\u7684\u8EAB\u4EFD\u8BC1\u53F7\u7801"),PASSPORT:_l("\u4E0D\u662F\u6709\u6548\u7684\u62A4\u7167\u53F7\u7801"),HK_PASSPORT:_l("\u4E0D\u662F\u6709\u6548\u7684\u6E2F\u6FB3\u901A\u884C\u8BC1\u53F7\u7801"),TW_PASSPORT:_l("\u4E0D\u662F\u6709\u6548\u7684\u53F0\u6E7E\u901A\u884C\u8BC1\u53F7\u7801"),OTHER_REQUIRED:function(G){var D=G.options,Y=D===void 0?[]:D,U=q().get(q().find(Y,function(W){return W.key==="other"&&!W.isDeleted}),"value");return _l("\u8BF7\u586B\u5199%0",U||"\u5176\u4ED6")},CHILD_TABLE_ROWS_LIMIT:function(G){var D=G.value,Y=G.advancedSetting,U=Y.min,W=Y.max,te=Y.enablelimit;if(String(te)==="1"){var ne=Number(q().get(D,"rows")&&(0,_e.CD)(D.rows).length||(q().isObject(D)?0:D)||0);if(q().isNumber(ne)&&!q().isNaN(ne)){if(q().isNumber(Number(U))&&!q().isNaN(Number(U))&&ne<Number(U))return""+_l("\u8BF7\u81F3\u5C11\u8F93\u5165%0\u6761\u8BB0\u5F55",U);if(q().isNumber(Number(W))&&!q().isNaN(Number(W))&&ne>Number(W))return""+_l("\u6700\u591A\u8F93\u5165%0\u6761\u8BB0\u5F55",W)}}},UNIQUE:function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=G.uniqueInRecord,Y=arguments[1];return Y?D?_l("\u672C\u8BB0\u5F55\u5185\u4E0D\u5141\u8BB8\u91CD\u590D"):_l("\u5168\u5C40\u4E0D\u5141\u8BB8\u91CD\u590D"):_l("\u4E0D\u5141\u8BB8\u91CD\u590D")},NUMBER_RANGE:function(G){var D=G.value,Y=G.advancedSetting,U=Y.min,W=Y.max,te=Y.numshow,ne=te==="1"?Number(U||0)*100+"%":U,j=te==="1"?Number(W||0)*100+"%":W;if(W===U)return _l("\u8BF7\u8F93\u5165%0",ne);if(W&&U&&(+D>+W||+D<+U))return _l("\u8BF7\u8F93\u5165%0\u5230%1\u4E4B\u95F4\u7684\u6570\u503C",ne,j);if(U&&+D<+U)return _l("\u8BF7\u8F93\u5165\u5927\u4E8E\u7B49\u4E8E%0\u7684\u6570",ne);if(W&&+D>+W)return _l("\u8BF7\u8F93\u5165\u5C0F\u4E8E\u7B49\u4E8E%0\u7684\u6570",j)},MULTI_SELECT_RANGE:function(G){var D=G.value,Y=G.advancedSetting,U=Y.min,W=Y.max,te=JSON.parse(D||"[]").length;if(W===U)return _l("\u8BF7\u9009\u62E9%0\u9879",U);if(W&&U)return te>+W||te<+U?_l("\u8BF7\u9009\u62E9%0~%1\u9879",U,W):void 0;if(U&&te<+U)return _l("\u6700\u5C11\u9009\u62E9%0\u9879",U);if(W&&te>+W)return _l("\u6700\u591A\u9009\u62E9%0\u9879",W)},DATE:function(G){var D=G.advancedSetting,Y=D.allowweek||"1234567",U="1234567",W=["",_l("\u5468\u4E00"),_l("\u5468\u4E8C"),_l("\u5468\u4E09"),_l("\u5468\u56DB"),_l("\u5468\u4E94"),_l("\u5468\u516D"),_l("\u5468\u65E5")];return Y&&q().isArray(Y)&&Y.length<=4?_l("\u8BF7\u9009\u62E9%0\u5BF9\u5E94\u7684\u65E5\u671F",Y.split("").map(function(te){return W[te]}).join("\u3001")):_l("\u8BF7\u9009\u62E9\u9664%0\u4EE5\u5916\u7684\u65E5\u671F",U.split("").filter(function(te){return!(Y.indexOf(te)>-1)}).map(function(te){return W[te]}).join("\u3001"))},DATE_TIME:function(G){var D=G.advancedSetting;return _l("\u8BF7\u586B\u5199\uFF08%0 ~ %1\uFF09\u8303\u56F4\u5185\u7684\u65F6\u95F4",D.allowtime.split("-")[0],D.allowtime.split("-")[1])},TEXT_RANGE:function(G){var D=G.value,Y=G.advancedSetting,U=Y.min,W=Y.max,te=(D||"").length;if(W===U)return _l("\u8BF7\u8F93\u5165%0\u4E2A\u5B57",U);if(W&&U)return te>+W||te<+U?_l("\u8BF7\u8F93\u5165%0~%1\u4E2A\u5B57",U,W):void 0;if(U&&te<+U)return _l("\u6700\u5C11\u8F93\u5165%0\u4E2A\u5B57",U);if(W&&te>+W)return _l("\u6700\u591A\u8F93\u5165%0\u4E2A\u5B57",W)},CUSTOM:function(G){var D=G.advancedSetting;return JSON.parse(D.regex).err},DATE_TIME_RANGE:function(G,D,Y,U){function W(te){var ne=U?"HH:mm:ss":"YYYY-MM-DD HH:mm:ss";return Me()(te,ne)}if(Y===D)return _l("\u8BF7\u586B\u5199%0",D);if(Y&&D)return W(G)>W(Y)||W(G)<W(D)?_l("\u8BF7\u586B\u5199%0 ~ %1\u8303\u56F4\u5185\u7684\u65F6\u95F4",D,Y):void 0;if(D&&W(G)<W(D))return _l("\u65F6\u95F4\u4E0D\u80FD\u65E9\u4E8E%0",D);if(Y&&W(G)>W(Y))return _l("\u65F6\u95F4\u4E0D\u80FD\u665A\u4E8E%0",Y)}},Te={DEFAULT:0,SHARE:1,NEWRECORD:2,RECORDINFO:3,PUBLIC_ADD:4,H5_ADD:5,H5_EDIT:6,WORKFLOW:7,CUSTOM_BUTTON:8,PUBLIC_EDIT:9,DRAFT:21},ye={1:"m",2:"h",3:"d",4:"M",5:"y",6:"s"},De=null,Ie=null},73820:(Ge,Se,u)=>{u.d(Se,{fy:()=>q,ih:()=>oe,r4:()=>_e,vB:()=>J,zp:()=>Me});var oe="CHANGE_NAV_COLOR",Me="CHANGE_APP_COLOR",J="UPDATE_APP_GROUP",q="SET_APP_STATUS",_e="SYNC_APP_DETAIL",me=function(X){return{type:_e,detail:X}},Pe=function(X){return{type:Me,iconColor:X}},Te=function(X){return{type:oe,navColor:X}},ye=function(X){return{type:J,appGroups:X}},De=function(X){return{type:q,status:X}}},50380:(Ge,Se,u)=>{u.d(Se,{FB:()=>me});var oe=100,Me=function(Te){return[0].includes(Te.memberType)?"business":[1,2].includes(Te.memberType)?"department1":[4].includes(Te.memberType)?"limit-principal":[3].includes(Te.memberType)?"user":""},J=function(Te){return[0,1].includes(Te.memberType)?"#2196f3":[3].includes(Te.memberType)?"#ffad00":"#eaeaea"},q=function(Te){return[0,1,3].includes(Te.memberType)?"White":"Gray_9e"},_e=[{value:0,tag:_l("\u5168\u7EC4\u7EC7"),text:_l("\u90E8\u95E8"),key:50},{value:1,tag:_l("\u90E8\u95E8\u6811"),text:_l("\u90E8\u95E8"),key:21},{value:2,text:_l("\u90E8\u95E8"),key:20},{value:3,text:_l("\u7EC4\u7EC7\u89D2\u8272"),key:40},{value:4,text:_l("\u804C\u4F4D"),key:30},{value:5,text:_l("\u4EBA\u5458"),key:10}],me={pageIndex:1,pageSize:oe,keywords:"",searchMemberType:0,sort:[]}},25265:(Ge,Se,u)=>{u.d(Se,{Pr:()=>W,Wu:()=>te});var oe=u(88106),Me=u(88239),J=u(52945),q=u.n(J),_e=u(48645),me=u(30429),Pe=u(69277),Te=u(35356),ye=u(15577),De=u(96486),Ie=u.n(De),X=function(e){return{type:"SET_SESSION_LIST",result:utils.sortSession(utils.formatSessionList(e))}},G=function(e){return{type:"ADD_SESSION_LIST",result:utils.sortSession(utils.formatSessionList(e))}},D=function(e){return function(i,T){var c=T().chat,d=c.sessionList,I=c.currentSessionList,g=Ie().cloneDeep(d),N=e.id,P=[];if(g.forEach(function(R){if(R.value===N){if("sendMsg"in e&&(R.sendMsg=e.sendMsg?e.sendMsg:null,e.sendMsg&&P.push(R)),"count"in e&&(R.count="weak"in e?R.count:(R.count||0)+e.count,R.time=me.nr((0,ye.LX)(e.time||me.Xn())),R.msg.con=e.msg,R.id=e.msgId,R.isPush=e.isPush,P.push(R),"weak"in e&&(e.weak?(R.weak_count=e.count,R.isPush=!!R.count):(R.count=R.count+e.count,R.isPush=!0))),"clearCount"in e&&(R.count=0,R.messageCount=e.clearCount,"weak_count"in R&&(R.weak_count=0)),"messageCount"in e&&(R.messageCount=0,R.messageAtlist=[]),"addMsg"in e){R.time=me.nr((0,ye.LX)(e.time||me.Xn())),R.msg.con=e.addMsg,P.push(R),delete R.isSession;var V=!1,He=I.map(function(xe){return xe.id===R.value&&"isSession"in xe&&(V=!0,xe.isTop=!1,delete xe.isSession),xe});V&&i({type:"UPDATE_CURRENT_SESSION",result:He})}"atlist"in e&&(R.atlist=e.atlist,e.atlist.length?R.messageAtlist=e.atlist:e.isWithdraw&&(R.messageAtlist=[]),e.at_msg&&(R.at_msg=e.at_msg)),"refer"in e&&(R.refer=e.refer),"reflist"in e&&(R.reflist=e.reflist),"isTop"in e&&(R.top_info={isTop:e.isTop,time:e.time},P.push(R)),"isContact"in e&&(R.isContact=e.isContact),"showBadge"in e&&(R.showBadge=e.showBadge)}}),P.length){var M=P[0].value,se=g.filter(function(R){return M!==R.value});i({type:"SET_SESSION_LIST",result:me.oY(P.concat(se),M)})}else i({type:"SET_SESSION_LIST",result:g})}},Y=function(e){return{type:"REMOVE_SESSION",id:e}},U=function(e,i){return function(T,c){var d=c().chat.sessionList;if(i){var I=d.filter(function(M){return M.value===i})[0],g=md.global.Account.accountId===e.from,N=g?_l("\u6211"):e.uname,P={count:0,id:i,msg:N+": "+e.msg.con,isPush:e.isPush};if(I){T(D(P));return}}e=me.T6(e),e.id||(e.isSession=!1),T({type:"ADD_SESSION",result:[e]})}},W=function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function(c,d){var I=d().chat.sessionList,g=I.filter(function(P){return P.value==e})[0];if(g)T&&c(ve(e));else if(i.avatar){var N=q()({count:0,isGroup:!0,sysType:1},i);c(U(N)),T&&(c(ve(e)),Pe.r8.recordAction({id:e,type:2}))}else _e.my({type:Te.Z.SESSIONTYPE_GROUP,value:e}).then(function(P){var M=q()({isGroup:!0,count:0,to:e,avatar:P.avatar,groupname:P.name,msg:{con:""},sysType:1},i);c(U(M,e)),T&&(c(ve(e)),Pe.r8.recordAction({id:e,type:2}))})}},te=function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=arguments[3];return function(d,I){var g=I().chat.sessionList,N=g.filter(function(M){return M.value==e})[0];if(N)T&&d(ve(e)),c&&c();else if(i.logo){var P=q()({count:0,from:e,msg:{con:""},isGroup:!1},i);d(U(P)),T&&(d(ve(e)),Pe.r8.recordAction({id:e,type:1})),c&&c()}else _e.my({type:Te.Z.SESSIONTYPE_USER,value:e}).then(function(M){var se=q()({count:0,from:e,logo:M.avatar,uname:M.fullname,msg:{con:""},isGroup:!1,sysType:1,isPush:!0},i);d(U(se,e)),T&&(d(ve(e)),Pe.r8.recordAction({id:e,type:1})),c&&c()})}},ne=function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(T,c){var d=c().chat.sessionList,I=d.filter(function(g){return g.value==e})[0];I||T(U(i)),T(ve(e))}},j=function(e){return function(i,T){var c=T().chat.sessionList,d=e.contact,I=e.isclose,g=e.isopen,N=c.filter(function(M){return M.value===d.id})[0];if("showBadge"in d&&(N.showBadge=d.showBadge),I)i(ee({}));else if(g)if(N)i(ee(N));else if(d.type===1)i(te(d.id,{msg:{con:""},sysType:1}));else if(d.type===2)i(W(d.id));else{var P=d.id;i(ne(P.dtype,P))}}},A=function(e){return function(i,T){var c=T().chat.sessionList,d=e.isTop,I=c.reduce(function(g,N){var P=N.top_info,M=P&&P.isTop?1:0;return g+M},0);I>=10&&d?alert(_l("\u7F6E\u9876\u6570\u6700\u591A10\u6761"),3):socket.Contact.setTop(e)}},C=function(e){return function(i,T){var c=T().chat,d=c.currentSessionList,I=c.sessionList,g=c.currentSession,N=I.filter(function(V){return V.value===e.value})[0],P=e.top_info?e.top_info.isTop:!1,M=e.top_info?e.top_info.time:"";if(N){var se=d.map(function(V){return V.id===e.value&&(V.isTop=P,delete V.isSession),V});if(i({type:"UPDATE_CURRENT_SESSION",result:se}),i(D({id:e.value,isTop:P,time:M})),e.value===g.value){var R=I.find(function(V){return V.value===e.value});i(ee(_extends({},R,{top_info:_extends({},R.top_info,{isTop:P})})))}}}},f=function(e){return function(i,T){var c=e.id,d=e.type,I=T().chat,g=I.currentSession,N=I.sessionList,P=d>2?utils.getInboxId(d):c;i(Y(P)),i(ie(P)),i(Je(P)),P===g.value&&i(ee({})),utils.removeFlashTitle(P,N)}},O=function(e){return function(i,T){var c=T().chat.sessionList,d=e.id;i(D({id:d,clearCount:0})),i(D({id:d,atlist:[]})),i(D({id:d,reflist:[]})),i(D({id:d,refer:null})),utils.removeFlashTitle(d,c)}},K=function(){return function(e,i){var T=i().chat.sessionList,c=_.cloneDeep(T).map(function(d){return d.count&&(d.count=0),d.atlist&&d.atlist.length&&(d.atlist=[]),d.reflist&&d.reflist.length&&(d.reflist=[]),d.refer&&(d.refer=null),d});utils.removeFlashTitle("",c),e({type:"UPDATE_SESSION_LIST",result:c})}},x=function(e){return function(i,T){var c=T().chat.sessionList,d=e.type;i(D({id:d,clearCount:0})),utils.removeFlashTitle(d,c)}},k=function(e){return function(i,T){var c=T().chat.currentSession,d=e.id;c.value===d&&i(ee({})),i(ie(d)),i(Y(d)),i(Je(d))}},re=function(e){var i=$(".ChatPanel-wrapper");return e?(i.removeClass("ChatPanel-up"),safeLocalStorageSetItem("chatList_isUp",!0)):(i.addClass("ChatPanel-up"),safeLocalStorageSetItem("chatList_isUp",!1)),{type:"SET_VISIBLE",visible:e}},ee=function(e){return socket.Contact.setCurrentChat(e),{type:"SET_CURRENT_SESSION",result:e}},ve=function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(T,c){var d=c().chat.sessionList,I=d.filter(function(g){return g.value===e})[0];Pe.r8.setCurrentChat(I),T({type:"SET_CURRENT_SESSION",result:q()(I,i)})}},Ae=function(e){return function(i,T){var c=T().chat,d=c.currentSessionList,I=c.sessionList;if(e.isGroup="isPost"in e,e.id=e.isGroup?e.groupId:e.accountId,d.length>=2){var g=d[0].id;i(ie(g)),i(Je(g))}var N=_.filter(I,{value:e.id})[0],P=N.top_info?N.top_info.isTop:!1;e.isTop=P,"isSession"in N&&(e.isSession=N.isSession),i({type:"ADD_CURRENT_SESSION",result:e})}},ie=function(e){return{type:"REMOVE_CURRENT_SESSION",id:e}},ge=function(e,i){return function(T,c){var d=c().chat,I=d.currentSessionList,g=d.sessionList,N=I.map(function(M){return M.id===e&&(M.name=i),M}),P=g.map(function(M){return M.value===e&&(M.name=i),M});T({type:"UPDATE_CURRENT_SESSION",result:N}),T({type:"UPDATE_SESSION_LIST",result:P})}},Ne=function(e,i){return function(T,c){var d=c().chat.sessionList,I=d.map(function(g){return g.value===e&&(g.logo=i),g});T({type:"UPDATE_SESSION_LIST",result:I})}},ke=function(e,i){return function(T,c){var d=c().chat.currentSessionList,I=d.map(function(g){return g.id===e&&(g.about=i),g});T({type:"UPDATE_CURRENT_SESSION",result:I})}},Le=function(e,i){return function(T,c){var d=c().chat,I=d.currentSessionList,g=d.sessionList,N=I.map(function(M){return M.id===e&&(M.isPushNotice=i),M}),P=g.map(function(M){return M.value===e&&(M.isPush=i),M});T({type:"UPDATE_CURRENT_SESSION",result:N}),T({type:"UPDATE_SESSION_LIST",result:P})}},pe=function(e,i){return function(T,c){var d=c().chat.currentSessionList,I=d.map(function(g){return g.id===e&&(g.isForbidInvite=i),g});T({type:"UPDATE_CURRENT_SESSION",result:I})}},b=function(e,i){return function(T,c){var d=c().chat.currentSessionList,I=d.map(function(g){return g.id===e&&(g.isAdmin=i),g});T({type:"UPDATE_CURRENT_SESSION",result:I})}},be=function(e,i){return function(T,c){var d=c().chat,I=d.currentSessionList,g=d.currentSession,N=g.iconType,P=I.map(function(M){return M.id===e&&(M.groupMemberCount=M.groupMemberCount+i),M});N&&(g.isRender=!1,T({type:"SET_CURRENT_SESSION",result:g})),T({type:"UPDATE_CURRENT_SESSION",result:P})}},Ue=function(e,i){return function(T,c){var d=c().chat.messages;T({type:d[e]?"ADD_PAGE_MESSAGE":"SET_MESSAGE",id:e,result:i})}},Ke=function(e,i){return{type:"SET_MESSAGE",id:e,result:i}},le=function(e,i){return{type:"ADD_PAGE_MESSAGE",id:e,result:i}},Ve=function(e,i){return{type:"PUSH_PAGE_MESSAGE",id:e,result:i}},Ye=function(e,i){return function(T,c){var d=md.global.Account,I={waitingId:e.waitingid,from:d.accountId,fromAccount:{email:d.email,id:d.accountId,logo:d.avatar,name:d.fullname},msg:{con:e.msg},to:e.togroup||e.touser,type:e.type,time:utils.getCurrentTime(),iswd:!1,sendMsg:e,isMineMessage:!0};if(e.sysType&&(I.sysType=e.sysType),e.refer){var g=e.referMessage;I.refer={msg:g.msg.con,type:g.type,user:{full_name:g.fromAccount.name}}}e.type===Constant.MSGTYPE_CARD?I.card=e.card:e.type===Constant.MSGTYPE_PIC?(e.file.url=window.config.FilePath+e.file.key,I.msg.files=e.file,I.isPrepare=e.isPrepare||!1):(e.type===Constant.MSGTYPE_FILE||e.type===Constant.MSGTYPE_APP_VIDEO)&&(I.msg.files=e.file,I.isPrepare=e.isPrepare||!1);var N=e.togroup||e.touser;_.isEmpty(N)||T(i?{type:"ADD_MESSAGE",id:N,result:utils.formatMessage(I,i)}:{type:"SET_MESSAGE",id:N,result:[utils.formatMessage(I,i)]})}},We=function(e,i){return{type:"REMOVE_MESSAGE",id:e,messageId:i}},Je=function(e){return{type:"REMOVE_MESSAGES",id:e}},qe=function(e){return function(i,T){var c=T().chat.messages,d=e.to,I=e.waitingid,g=e.socket,N=c[d]||[],P=N.filter(function(M){return M}).map(function(M,se){if(M.waitingId===I){if(M.id=e.id,g&&g.time&&(M.timestamp=createTimeSpan(dateConvertToUserZone(g.time))),M.refer){var R=e.referMessage;M.refer={msgid:R.id,msg:R.msg.con,msgdetail:g.refer.msgdetail,type:R.type,time:R.time,iswd:R.iswd,user:{account_id:R.fromAccount.id,full_name:R.fromAccount.name,avatar:R.fromAccount.logo}}}"isContact"in e&&(M.sysType=Constant.MSGTYPE_SYSTEM_ERROR,M.msg={con:""},M.isContact=!1),g&&g.msg.files&&(M.msg.files.url=g.msg.files.url)}return M});i({type:"SET_MESSAGE",id:d,result:P})}},et=function(e,i){return function(T,c){var d=c().chat.messages,I=e.id,g=d[i],N=g.map(function(P,M){return P.id===I?e:P});T({type:"SET_MESSAGE",id:i,result:N})}},y=function(e,i){return function(T,c){var d=c().chat,I=d.messages,g=d.referMessage,N=d.bottomUnreadMessage,P=i.id,M=i.msg,se=I[e],R=N[e]||[];se&&(se.forEach(function(V,He){if(V.id==P){var xe=se[He+1];V.iswd=!0,V.msg.con=M.con,xe&&(xe.isDuplicated=!1)}V.refer&&V.refer.msgid==P&&(V.refer.iswd=!0)}),R.forEach(function(V,He){if(V.id==P){var xe=R[He+1];V.iswd=!0,V.msg.con=M.con,xe&&(xe.isDuplicated=!1)}V.refer&&V.refer.msgid==P&&(V.refer.iswd=!0)}),g[e]&&g[e].id==P&&T(F(e)),T({type:"UPDATE_BOTTOM_UNREAD_MESSAGE",id:e,message:R}),T({type:"SET_MESSAGE",id:e,result:se}))}},r=function(e,i){return function(T,c){var d=c().chat.messages,I=d[e],g=_.findIndex(I,{id:i.id})!==-1;if(I&&!g){i=utils.formatNewMessage(i,I[I.length-1]);var N="groupname"in i,P=N||i.isMine?i.to:i.from,M=$("#ChatPanel-"+P).data("isBottom"),se=M==null?!0:M;if(!i.isMine&&!se){T(fe(P,i));return}else setTimeout(function(){utils.scrollEnd(i.to,!0)},100);T({type:"ADD_MESSAGE",id:e,result:i})}}},S=function(e){return function(i,T){var c=T().chat,d=c.currentSession,I=c.sessionList,g=[0,1].includes(e.type)?e.type+1:0;switch(e.dtype){case 0:e.id="post",e.type=Constant.SESSIONTYPE_POST;break;case 1:e.id="system",e.type=Constant.SESSIONTYPE_SYSTEM;break;case 2:e.id="calendar",e.type=Constant.SESSIONTYPE_CALENDAR;break;case 3:e.id="task",e.type=Constant.SESSIONTYPE_TASK;break;case 4:e.id="knowledge",e.type=Constant.SESSIONTYPE_KNOWLEDGE;break;case 5:e.id="hr",e.type=Constant.SESSIONTYPE_HR;break;case 6:e.id="worksheet",e.type=Constant.SESSIONTYPE_WORKSHEET;break;case 7:e.id="workflow",e.type=Constant.SESSIONTYPE_WORKFLOW;break;default:break}e.name&&e.type!==Constant.SESSIONTYPE_WORKSHEET&&(e.msg=e.name+": "+e.msg);var N=I.filter(function(P){return P.value===e.id});N.length?i(D({id:e.id,count:1,time:utils.getCurrentTime(),msg:e.msg,isPush:!e.weak,weak:e.weak,showBadge:g})):(e.count=1,i(U(e))),("isSilent"in e?(!e.isSilent||[1,2].includes(g))&&!e.weak:!e.weak)&&(utils.flashTitle(),utils.playSystemNewMsgAudio())}},m=function(e){return function(i,T){var c=T().chat,d=c.currentSession,I=c.sessionList,g=c.isWindow,N=md.global.Account.accountId===e.from?e.to:e.from,P=md.global.Account.accountId===e.from,M=I.filter(function(He){return He.value===N}),se=utils.chatWindow.is(N);if(!(g&&!M.length))if(M.length){var R=P?_l("\u6211"):e.uname,V=se||d.value===N||P?0:1;i(r(N,e)),i(D({id:N,count:V,time:e.time,msg:R+": "+e.msg.con,msgId:e.id,isPush:!0})),V&&(utils.flashTitle(),utils.playSessionNewMsgAudio(),utils.sessionListScrollTop())}else P?i(te(N,{sysType:0,msg:e.msg,from:e.from,to:e.to,id:e.id},!1)):(e.count=se?0:1,e.isGroup=!1,i(U(e,N)),e.count&&(utils.flashTitle(),utils.playSessionNewMsgAudio(),utils.sessionListScrollTop()))}},l=function(e){return function(i,T){var c=function(){var I=T().chat,g=I.currentSession,N=I.messages,P=I.sessionList;if(g.value===e.aid){var M=N[e.aid]||[],se={waitingid:utils.getUUID(),msg:_l("\u4F60\u6536\u5230\u4E86\u4E00\u4E2A\u6296\u52A8"),sysType:Constant.MSGTYPE_SYSTEM_SUCCESS,touser:e.aid};utils.shake(e.aid),socket.Contact.clearUnread({type:1,value:e.aid}).then(function(R){i(D({id:e.aid,clearCount:0}))}),i(Ye(se,M[M.length-1]));return}};i(te(e.aid,{},!0,function(){var d=T().chat.currentSessionList,I=d.filter(function(g){return g.id==e.aid})[0];I?c():setTimeout(c,1e3)}))}},v=function(e){return function(i,T){var c=e.admins,d=_.findIndex(c,{aid:md.global.Account.accountId}),I=d!==-1,g=!!$("#easyDialogBoxMDUpdater_container").size();i(W(e.id,{to:e.id,avatar:e.logo,groupname:e.name,isPost:e.isPost,isPush:e.isPush,msg:{con:_l("\u6211")+"\uFF1A"+_l("\u7FA4\u7EC4\u521B\u5EFA\u6210\u529F")}},g?!1:I))}},p=function(e){return function(i,T){var c=T().chat,d=c.currentSession,I=c.sessionList,g=c.isWindow,N=I.filter(function(V){return V.value===e.to}),P=utils.chatWindow.is(e.to);if(!(g&&!N.length))if(N.length){var M=md.global.Account.accountId===e.from,se=M?_l("\u6211"):e.uname,R=P||d.value===e.to||M?0:1;i(r(e.to,e)),i(D({id:e.to,count:e.sysType?0:R,time:e.time,msg:e.sysType?e.msg.con:se+": "+e.msg.con,msgId:e.id,isPush:e.isPush,refer:d.value===e.to?null:e.refer})),e.isPush&&R&&!("sysType"in e)&&(utils.flashTitle(),utils.playSessionNewMsgAudio(),utils.sessionListScrollTop())}else e.count=e.sysType||P?0:1,e.isGroup=!0,e.isPush=e.sysType?!0:e.isPush,i(U(e,e.to)),e.isPush&&e.count&&!("sysType"in e)&&(utils.flashTitle(),utils.playSessionNewMsgAudio(),utils.sessionListScrollTop())}},h=function(e){return function(i,T){var c=T().chat,d=c.currentSession,I=c.sessionList,g=I.filter(function(R){return R.value===e.gid})[0],N=utils.chatWindow.is(e.gid),P=e.msg;if(d.value===e.gid)utils.shake(e.gid);else{var M=g.atlist?g.atlist.filter(function(R){return R!==e.id}):[],se={id:e.gid,atlist:N?[]:M.concat(P.msgid),at_msg:{time:P.time,message_id:P.msgid,msgid:P.msgid}};i(D(se))}}},H=function(e){return function(i,T){var c=T().chat.sessionList,d=c.filter(function(g){return g.value===e.gid})[0];if(i(y(e.gid,e)),i(D({id:e.gid,addMsg:e.msg.con})),d&&d.atlist){var I=d.atlist.filter(function(g){return g!==e.id});i(D({id:e.gid,atlist:I,isWithdraw:!0}))}d&&d.refer&&i(D({id:e.gid,refer:null,isWithdraw:!0})),d&&d.reflist&&i(D({id:e.gid,reflist:[],isWithdraw:!0}))}},ae=function(e,i){return{type:"SET_REFER_MESSAGE",id:e,message:i}},fe=function(e,i){return function(T,c){var d=c().chat.bottomUnreadMessage,I=d[e];T(I?{type:"ADD_BOTTOM_UNREAD_MESSAGE",id:e,message:i}:{type:"SET_BOTTOM_UNREAD_MESSAGE",id:e,message:i})}},Ee=function(e){return{type:"REMOVE_BOTTOM_UNREAD_MESSAGE",id:e}},F=function(e){return{type:"REMOVE_REFER_MESSAGE",id:e}},ce=function(e,i){return{type:"SET_GOTO_MESSAGE",id:e,messageId:i}},he=function(e){return{type:"REMOVE_GOTO_MESSAGE",id:e}},we=function(e){return{type:"UPDATE_IS_WINDOW",result:e}},de=function(e){return{type:"UPDATE_SHOW_ADD_RESSBOOK",result:e}},Fe=function(){return function(e,i){var T=i().chat,c=T.messages,d=T.currentSession,I=T.currentSessionList,g=d.id;ajax.chatSessionList({pageIndex:1,pageSize:30}).then(function(N){if(g){N.forEach(function(se){se&&se.value==g&&(se.count=0)}),e(X(N));var P=I.filter(function(se){return se.id===g})[0];if(!P)return;var M=P.isGroup;ajax.getMessage({id:g,type:M?Constant.SESSIONTYPE_GROUP:Constant.SESSIONTYPE_USER}).then(function(se){se=$.isArray(se)?se.reverse():[];var R=_defineProperty({},g,utils.formatMessages(se));e({type:"UPDATE_CURRENT_SESSION",result:[P]}),e({type:"UPDATE_MESSAGE",result:R})})}else e(X(N)),e({type:"UPDATE_CURRENT_SESSION",result:[]}),e({type:"SET_CURRENT_SESSION",result:{}}),e({type:"UPDATE_MESSAGE",result:{}})})}},Ze=function(e){return function(i,T){socket.Contact.setSlience(e)}},je=function(e){return function(i,T){var c=T().chat,d=c.currentSessionList,I=c.sessionList,g=c.currentSession,N=e.isSilent?e.isSilent:!1,P=e.showBadge?e.showBadge:0,M=d.map(function(V){return V.value===e.value&&(V.isSilent=N,V.showBadge=P),V}),se=I.map(function(V){return V.value===e.value&&(V.isSilent=N,V.showBadge=P),V});if(i({type:"UPDATE_CURRENT_SESSION",result:M}),i({type:"UPDATE_SESSION_LIST",result:se}),e.value===g.value){var R=se.find(function(V){return V.value===e.value});i(ee(R))}}}},48645:(Ge,Se,u)=>{u.d(Se,{my:()=>ye});var oe=u(63239),Me=u.n(oe),J=u(46593),q=u.n(J),_e=u(22731),me=u(67460),Pe=u(35356),Te=function(f){return $.ajax({url:_.get(window,"config.HTTP_SERVER")+"/chat_list",data:$.extend(f,{pss_id:getPssId()}),dataType:"jsonp",jsonp:"cb"})},ye=function(f){var O=3e3,K={timeout:O};if(f.type==Pe.Z.SESSIONTYPE_GROUP)return me.Z.getGroupInfo({groupId:f.value},{ajaxOptions:K});if(f.type==Pe.Z.SESSIONTYPE_USER)return _e.Z.getAccountBaseInfo({accountId:f.value},{ajaxOptions:K})},De=function(f){var O={};if(O.sincetime=f.sincetime||"",O.page=f.page||1,O.num=f.num?f.num+chatConfig.MSG_LENGTH_MORE:chatConfig.MSG_LENGTH_MORE,O.pss_id=getPssId(),O.keyword=f.keyword||"",O.direction=f.direction||"",f.type===Constant.SESSIONTYPE_GROUP)return O.groupid=f.id,$.ajax({url:_.get(window,"config.HTTP_SERVER")+"/group_messages",data:O,type:"get",dataType:"jsonp",jsonp:"cb",timeout:5e3});if(f.type===Constant.SESSIONTYPE_USER)return O.accountid=f.id,$.ajax({url:_.get(window,"config.HTTP_SERVER")+"/messages",data:O,type:"get",dataType:"jsonp",jsonp:"cb",timeout:5e3})},Ie=function(f){var O={},K="";return f.type===Constant.SESSIONTYPE_GROUP?(O.groupid=f.id||"",K="/group_messages_byid"):f.type===Constant.SESSIONTYPE_USER&&(O.accountId=f.id||"",K="/messages_byid"),O.pss_id=getPssId(),O.msgid=f.msgid||"",O.size=f.size||21,$.ajax({url:_.get(window,"config.HTTP_SERVER")+K,data:O,type:"get",dataType:"jsonp",jsonp:"cb"})},X=function(f){var O={},K="";return f.isGroup?(O.groupid=f.id||0,K="/group_files_byid"):(O.accountid=f.id||0,K="/user_files_byid"),O.pss_id=getPssId(),O.msgid=f.msgid||"",O.size=f.size||20,O.type=f.type||0,$.ajax({url:_.get(window,"config.HTTP_SERVER")+K,data:O,type:"get",dataType:"jsonp",jsonp:"cb"}).then(function(x){return $.isArray(x)||(x=[]),x})},G=function(f){return f.postType=-1,f.fType=f.fType?f.fType:"feed",f.lType=f.lType?f.lType:"group",f._=new Date().getTime(),PostController.getPostListByLegacyPara(f)},D=function(f){return f.fileType=f.fileType||-1,f.groupId?ChatController.getGroupFileList(f):ChatController.getUserFileList(f)},Y=function(f){return f.groupId?(f.loadTabType=7,ChatController.getGroupCountByTabName(f)):(f.loadTabType=6,ChatController.getUserCountByTabName(f))},U=function(f){return CommonAjax.getAllChatAddressbookByKeywords({keywords:f})},W=function(f){return new _Promise(function(O,K){GroupController.getGroupInfo({groupId:f}).then(function(x){for(var k=[],re=0;re<x.groupUsers.length;re++){var ee=x.groupUsers[re];ee!==null&&k.push(ee)}x.users=k,O(x)})})},te=function(f){return new _Promise(function(O,K){var x={sourceId:f.groupId,fromType:1};f.accountIds&&(x.accountIds=f.accountIds),f.accounts&&(x.accounts=f.accounts),CommonAjaxInvitation.inviteUser(x).then(function(k){O(k)}).catch(function(k){K(k)})})},ne=function(f){return new _Promise(function(O,K){GroupController.addGroup({groupName:f.groupname,accountIds:_JSON$stringify(f.useridlist)}).then(function(x){x.msg==1?O(x.data):K(x.msg)}).catch(function(x){K(x)})})},j=function(f){return new _Promise(function(O,K){GroupController.addDiscussionGroup({accountIds:f.accountIds}).then(function(x){O(x)}).catch(function(x){K(x)})})},A=function(f){return new _Promise(function(O,K){$.ajax({url:f}).then(function(x){O(x)})})}},30429:(Ge,Se,u)=>{u.d(Se,{T6:()=>j,VU:()=>U,Xn:()=>C,nr:()=>De,oY:()=>G,yx:()=>et});var oe=u(63239),Me=u.n(oe),J=u(96486),q=u.n(J),_e=u(35356),me=u(15577),Pe=u(30381),Te=u.n(Pe),ye=function(r){if(!r)return r;var S=new Date,m=r.split(" ")[0],l=m.split("-")[0],v=m.split("-")[1]-1,p=m.split("-")[2],h=r.split(" ")[1],H=h.split(":")[0],ae=h.split(":")[1],fe=h.split(":")[2];S.setFullYear(l),S.setMonth(v),S.setDate(p),S.setHours(H),S.setMinutes(ae),S.setSeconds(fe);var Ee=new Date,F=new Date;F.setFullYear(Ee.getFullYear()),F.setMonth(Ee.getMonth()),F.setDate(Ee.getDate()),F.setHours(0),F.setMinutes(0),F.setSeconds(0);var ce=0,he=void 0;return S-F>=0?he=H+":"+ae:(ce=F-S,ce<864e5?he=_l("\u6628\u5929")+" "+H+":"+ae:ce>864e5&&l==F.getFullYear()?he=_l("%0\u6708%1\u65E5",v+1,p)+" "+H+":"+ae:he=l+"/"+(v+1)+"/"+p+" "+H+":"+ae),he},De=function(r){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=new Date,l=r.split(" ")[0],v=l.split("-")[0],p=l.split("-")[1]-1,h=l.split("-")[2],H=r.split(" ")[1],ae=H.split(":")[0],fe=H.split(":")[1],Ee=H.split(":")[2];m.setFullYear(v),m.setMonth(p),m.setDate(h),m.setHours(ae),m.setMinutes(fe),m.setSeconds(Ee);var F=new Date,ce=new Date;ce.setFullYear(F.getFullYear()),ce.setMonth(F.getMonth()),ce.setDate(F.getDate()),ce.setHours(0),ce.setMinutes(0),ce.setSeconds(0);var he=0,we=void 0;if(m-ce>=0)we=ae+":"+fe;else if(he=ce-m,he<864e5)we=_l("\u6628\u5929")+" "+ae+":"+fe;else if(he>864e5&&v==ce.getFullYear())we=_l("%0\u6708%1\u65E5",p+1,h);else{var de=S?"%0\u5E74%1\u6708%2\u65E5":"%0/%1/%2";we=_l(de,v,p+1,h)}return we},Ie=function(r,S,m){var l=r;if(m=m===!0,l&&typeof l!="number"){l=l.replace(/-/g,"/");var v=Number(l.substring(l.lastIndexOf(".")+1));l=new Date(l.substring(0,l.lastIndexOf("."))).getTime()+v}else l=moment(C()).toDate().getTime();var p="",h=moment(C()).toDate();return S=S||0,(Math.abs(l-S)>1e3*60||m)&&(p=ye(moment(l).format("YYYY-MM-DD HH:mm:ss.S")),S=l),p.replace(_l("\u521A\u521A"),h.getHours()+":"+(h.getMinutes()<10?"0":"")+h.getMinutes())},X=function(r,S){var m=[],l=r.filter(function(h){return h.count}),v=r.filter(function(h){return!h.count});if(r=l.concat(v),S){var p=[];return r.forEach(function(h){h.value==S?p.push(h):m.push(h)}),p.concat(m)}else return r},G=function(r,S){r=q().orderBy(r,["sendMsg"]);var m=[],l=[];return r.forEach(function(v){var p=v.top_info?v.top_info.isTop:!1;p?l.push(v):m.push(v)}),X(l,S).concat(m)},D=function(r){return r=r.filter(function(S){return S}),r.map(function(S){return Y(S)})},Y=function(r){if(r.from&&!r.sysType){var S=r.iswd,m=r.from.id===md.global.Account.accountId,l=r.wdAdminid===md.global.Account.accountId,v=r.wdAdminid;if(m){var p="";S?p=v?""+_l("\u7BA1\u7406\u5458\u64A4\u56DE\u4E86\u4E00\u6761\u4F60\u7684\u6D88\u606F"):""+_l("\u4F60")+r.msg.con:p=_l("\u6211")+": "+r.msg.con,r.msg.con=p}else{var h="";S?v?h=l?""+_l("\u4F60\u64A4\u56DE\u4E86\u6210\u5458\u201C%0\u201D\u7684\u4E00\u6761\u6D88\u606F",r.from.name):""+_l("\u7BA1\u7406\u5458\u64A4\u56DE\u4E86\u4E00\u6761\u6210\u5458\u6D88\u606F"):h='"'+r.from.name+'"'+r.msg.con:h=r.from.name+": "+r.msg.con,r.msg.con=h}}else switch(r.type){case _e.Z.SESSIONTYPE_SYSTEM:r.name=_l("\u7CFB\u7EDF"),r.iconType="system";break;case _e.Z.SESSIONTYPE_POST:r.name=_l("\u52A8\u6001"),r.iconType="post";break;case _e.Z.SESSIONTYPE_CALENDAR:r.name=_l("\u65E5\u7A0B"),r.iconType="calendar";break;case _e.Z.SESSIONTYPE_TASK:r.name=_l("\u4EFB\u52A1"),r.iconType="task";break;case _e.Z.SESSIONTYPE_KNOWLEDGE:r.name=_l("\u77E5\u8BC6"),r.iconType="knowledge";break;case _e.Z.SESSIONTYPE_HR:r.name=_l("\u4EBA\u4E8B"),r.iconType="hr";break;case _e.Z.SESSIONTYPE_WORKSHEET:r.name=_l("\u5E94\u7528"),r.iconType="worksheet";break;case _e.Z.SESSIONTYPE_WORKFLOW:r.name=_l("\u5DE5\u4F5C\u6D41"),r.iconType="workflow";break;default:break}return r._time=r.time,r.time=De((0,me.LX)(r.time)),r.type=Number(r.type),r.messageAtlist=r.atlist,r.sendMsg=localStorage.getItem("textareaValue"+r.value),r.msg.con=(0,me.Qu)(r.msg.con),r},U=function(r){return r=q()(r).groupBy("value").map(function(S,m){return S[0]}).value(),r},W=function(r){return r.map(function(S,m){return te(S,r[m-1])})},te=function(r,S){if(r.timestamp=ye(dateConvertToUserZone(r.time)),r.isMine=r.from===md.global.Account.accountId,r&&S&&r.from===S.from&&moment(r.time).valueOf()-moment(S.time).valueOf()<=60*3e3){if(r.timestamp=null,S.iswd||S.sysType)r.isDuplicated=!1;else{var m=r.type===Constant.MSGTYPE_TEXT;r.isDuplicated=m,m&&(r.timestamp=null)}r.unreadLine&&(r.isDuplicated=!1)}return r},ne=function(r,S){return r.iswd=!1,r.fromAccount={id:r.from,name:r.uname,logo:r.logo},te(r,S)},j=function(r){return"dtype"in r?(r.count=r.count,r.msg={con:r.msg},r.time=C(),r.value=r.id):(r.iswd=!1,r.name=r.isGroup?r.groupname:r.uname,r.msgid=r.id,r.count=r.count,r.value=r.isGroup||md.global.Account.accountId===r.from?r.to:r.from,r.logo=r.isGroup?r.avatar:r.logo,r.type=r.isGroup?_e.Z.SESSIONTYPE_GROUP:_e.Z.SESSIONTYPE_USER,r.time=r.time?r.time:C(),r.from={id:r.from,name:r.uname,avatar:r.logo}),Y(r)},A=function(){function y(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return function(){return y()+y()+"-"+y()+"-"+y()+"-"+y()+"-"+y()+y()+y()}}(),C=function(){return Te()().format("YYYY-MM-DD HH:mm:ss.SSS")},f=function(r){var S=r.md,m=r.entityid,l=r.extra;switch(S){case"task":return{name:_l("\u4EFB\u52A1"),param:{task:m}};case"calendar":return{name:_l("\u65E5\u7A0B"),param:{calendar:m}};case"post":return{name:_l("\u52A8\u6001"),noTiele:!0,isPost:!0,param:{post:m}};case"vote":return{name:_l("\u6295\u7968"),noTiele:!0,param:{post:m}};case"kcfile":return{name:_l("\u77E5\u8BC6")};case"kcfolder":return{name:_l("\u77E5\u8BC6\u6587\u4EF6\u5939"),noTiele:!0};case"url":return{name:_l("\u94FE\u63A5")};case"worksheetrow":var v=l||{},p=v.rowId;return{param:{worksheetrow:m+">"+p}};case"worksheet":return{name:_l("\u5E94\u7528")};default:return{name:_l("\u94FE\u63A5")}}},O=function(r){var S=/((http|https|ftp):\/\/|w{1,3}\.)[^\s\|<\|\u4E00-\u9FA5]+/gi;return r.replace(S,function(m){var l=m;return m.match(/^w{1,3}/)&&(l="http://"+m),'<a class="convertLink" target="_blank" href="'+l+'">'+m.replace("&","&amp;")+"</a>"})},K=function(r){return r.replace(/</g,"&lt").replace(/>/g,"&gt;")},x=function(r){return Emotion.parse(O(K(r)).replace(/\n/g,"<br>").replace(/\s{2}/g," &nbsp;"))},k=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=Math.round(r/1024*100)/100,m="K";return S>1024?(S=Math.round(S/1024*100)/100,m="M"):S=Number(S).toFixed(0),S+m},re=function(r){var S=$("#ChatPanel-"+r).find(".ChatPanel-sessionList");S.addClass("ChatPanel-shake").on("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",function(){$(this).removeClass("ChatPanel-shake")})},ee=function(r){setTimeout(function(){var S=$("#ChatPanel-"+r).find(".ChatPanel-MessageRefer");Ae(S)},0)},ve=function(r){var S=$("#Message-"+r).find(".Message-container");Ae(S)},Ae=function(r){var S=(window.isFirefox,"highlight");r.addClass(S).on("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",function(){$(this).removeClass(S)})},ie=function(r){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=$("#ChatPanel-"+r).find(".ChatPanel-sessionList .has-scrollbar");if(m.size()){var l=m.get(0),v=l.nanoscroller,p=v||{},h=p.maxScrollTop,H=p.contentScrollTop;v&&(S||h-H<50)&&m.nanoScroller({flash:!0}).nanoScroller({scroll:"bottom"})}},ge=function(){var r=$(".ChatList-sessionList-wrapper .nano");r.nanoScroller({flash:!0}).nanoScroller({scroll:"top"})},Ne=null,ke=function(){window.isOpenMessageTwinkle&&(Ne||(Ne=window.setInterval(function(){var r=window.document.title;r.indexOf("\u3010"+_l("\u65B0\u6D88\u606F")+"\u3011")===-1?window.document.title="\u3010"+_l("\u65B0\u6D88\u606F")+"\u3011"+r.replace("\u3010\u3000\u3000\u3000\u3011",""):window.document.title="\u3010\u3000\u3000\u3000\u3011"+r.replace("\u3010"+_l("\u65B0\u6D88\u606F")+"\u3011",""),r=window.document.title},600)))},Le=function(r,S){var m=S.filter(function(l){return l.value!==r});qe(m)||(window.clearInterval(Ne),Ne=null,window.document.title=window.document.title.replace("\u3010"+_l("\u65B0\u6D88\u606F")+"\u3011","").replace("\u3010\u3000\u3000\u3000\u3011",""))},pe=Date.now().toString(),b=JSON.parse(localStorage.getItem("tabIds"))||[];localStorage.setItem("tabIds",Me()(b.concat(pe)));var be=function(){var r=JSON.parse(localStorage.getItem("tabIds"))||[],S=_.max(r);return S===pe};window.addEventListener("beforeunload",function(){var y=JSON.parse(localStorage.getItem("tabIds"))||[],r=y.filter(function(S){return S!==pe});localStorage.setItem("tabIds",Me()(r))});var Ue=function(){!window.isOpenMessageSound||!be()||document.getElementById("sessionNewMsgAudio").play()},Ke=function(){!window.isOpenMessageSound||!be()||document.getElementById("systemNewMsgAudio").play()},le=function(r,S,m){var l=m?Constant.SESSIONTYPE_GROUP:Constant.SESSIONTYPE_USER,v=(window.screen.availHeight-660)/2,p=(window.screen.availWidth-930)/2,h="width=930,height=598,toolbar=no,menubar=no,location=no,status=no,top="+v+",left="+p;window.open("/chat_window?id="+r+"&name="+S+"&type="+l,"_blank",h)},Ve={set:function(r){safeLocalStorageSetItem("chat_window_"+r,!0)},remove:function(r){localStorage.removeItem("chat_window_"+r)},is:function(r){return!!localStorage.getItem("chat_window_"+r)}},Ye=function(r){var S=0;if(document.selection){r.focus();var m=document.selection.createRange();m.moveStart("character",-r.value.length),S=m.text.length}else(r.selectionStart||r.selectionStart==0)&&(S=r.selectionStart);return S},We=function(r){var S=$("#ChatPanel-"+r+" textarea");window.currentCursortPosition=Ye(S.get(0))},Je=function(r){switch(r*1){case Constant.SESSIONTYPE_SYSTEM:return"system";case Constant.SESSIONTYPE_POST:return"post";case Constant.SESSIONTYPE_CALENDAR:return"calendar";case Constant.SESSIONTYPE_TASK:return"task";case Constant.SESSIONTYPE_KNOWLEDGE:return"knowledge";case Constant.SESSIONTYPE_HR:return"hr";case Constant.SESSIONTYPE_WORKSHEET:return"worksheet";case Constant.SESSIONTYPE_WORKFLOW:return"workflow";default:return""}},qe=function(r,S){for(var m=!1,l=0;l<r.length;l++){var v=r[l]||{},p="isPush"in v?v.isPush:!0,h="isSilent"in v?!v.isSilent||[1,2].includes(v.showBadge):!0;if(v&&v.count&&p&&h){m=!0;continue}}return m},et=function(){var r=localStorage.getItem("chatList_isUp");return r==="true"?!0:(r==="false"||safeLocalStorageSetItem("chatList_isUp",!1),!1)}},18484:(Ge,Se,u)=>{u.d(Se,{Cw:()=>re,GV:()=>x,uy:()=>ee});var oe=u(12424),Me=u(63239),J=u.n(Me),q=u(88239),_e=u(94942),me=u.n(_e),Pe=u(36803),Te=u(85315),ye=u(46593),De=u.n(ye),Ie=u(86735),X=u(71893),G=u(84753),D=u.n(G),Y=u(96486),U=u.n(Y),W=u(29306),te=u.n(W),ne=u(92138),j=u(30381),A=u.n(j),C=null,f=(0,Ie.Z)([`
  display: flex;
  align-items: center;
`],[`
  display: flex;
  align-items: center;
`]),O=X.ZP.div(f),K=function(l){return _.keys(l).forEach(function(v){return l[l[v]]=v}),l},x=K({analysis:1,richText:2,embedUrl:3,button:4,view:5,filter:6,carousel:7,ai:8}),k=function(l){return typeof l=="number"?x[l]:l},re=function(l){var v=l.component,p=l.components,h=v.id||v.uuid;return _.findIndex(p,function(H){return H.id===h||H.uuid===h})},ee=function(l){var v=l.components,p=v===void 0?[]:v,h=l.index,H=h===void 0?p.length:h,ae=l.layoutType,fe=ae===void 0?"web":ae,Ee=l.titleVisible,F=l.type,ce=l.config,he=ce===void 0?{}:ce;if(F==="ai"&&he.showType==="suspension")return null;if(fe==="web")return F==="view"?{x:p.length*6%12,y:1/0,w:12,h:10,minW:2,minH:6}:F==="filter"?{x:p.length*6%12,y:1/0,w:12,h:2,minW:2,minH:2}:{x:p.length*6%12,y:1/0,w:6,h:6,minW:2,minH:2};if(fe==="mobile"){var we=_.pick(p[H],"type"),de=we.type,Fe=D()(p,function(c){return(0,Y.get)(c,["mobile","layout","y"])})||{},Ze=Fe.y,je=Ze===void 0?0:Ze,L=Fe.h,e=L===void 0?6:L,i=k(de),T=_.includes(["button"],i)?2:1;return i==="view"?{x:0,y:je+e,w:2,h:Ee?9:8,minW:T,minH:4}:i==="filter"?{x:0,y:je+e,w:2,h:1,minW:T,minH:1}:{x:0,y:je+e,w:2,h:Ee?7:6,minW:T,minH:2}}},ve=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return l.filter(function(v){return v.type===1||v.type==="analysis"}).length},Ae=function(l){return!0},ie=function(l){return _.get(widgets[k(l)],"icon")},ge=/<.+?>/g,Ne=function(l){var v=l.value,p=v===void 0?"":v,h=l.type,H=l.name,ae=l.button,fe=l.config,Ee=fe===void 0?{}:fe,F=k(h);return F==="analysis"?H||_l("\u672A\u547D\u540D\u56FE\u8868"):F==="richText"?p.replace(ge,""):F==="button"?_.get(ae,["buttonList","0","name"]):F==="view"?Ee.name:F==="filter"?_l("\u7B5B\u9009\u7EC4\u4EF6"):F==="carousel"?_l("\u8F6E\u64AD\u56FE"):(_.includes(["embedUrl","ai"],F),p)},ke=function(l){if(_.every(l,function(p){return _.get(p,["mobile","layout"])}))return!1;var v=_.groupBy(l,function(p){return _.get(p,["web","layout","y"])});return _.flattenDeep(_.sortBy(_.keys(v),function(p){return+p}).map(function(p){var h=v[p];return _.sortBy(h,function(H){return _.get(H,["web","layout","x"])})}))},Le=function(l){var v=l.width,p=l.count,h=l.margin,H=h===void 0?20:h;return{width:"calc("+100/p+"% - "+H+"px)"}},pe=function(l,v,p){if(v=v||[],!l||v.length<1)return l;var h=function(fe){var Ee=fe.type,F=fe.data;if(Ee==="static")return F;var ce=_.get(md,["global","Account"]),he=ce.mobilePhone,we=ce.accountId,de=ce.email;switch(F){case"userId":return we;case"phone":return he;case"email":return de;case"ua":return navigator.userAgent;case"timestamp":return Date.now();default:return p[F]||""}},H=v.reduce(function(ae,fe){var Ee=fe.key,F=fe.value,ce=encodeURIComponent(h(F));if(!ce)return ae;var he=ae?"&"+encodeURIComponent(Ee)+"="+ce:encodeURIComponent(Ee)+"="+ce;return l.includes(he)?ae:ae+=he},"");return H?l.includes("?")?l+"&"+H:l+"?"+H:l},b=function(l){return new _Promise(function(v,p){var h=new FileReader;h.addEventListener("load",function(){var H=new Image;H.src=h.result,H.addEventListener("load",function(){return v(H)})}),h.readAsDataURL(l)})},be=function(l){var v=document.createElement("canvas");v.width=l.width,v.height=l.height;var p=v.getContext("2d");return p.drawImage(l,0,0),v},Ue=function(l,v){return new _Promise(function(p,h){var H=_l("\u4E0D\u652F\u6301\u6253\u5370"),ae=l.getContext("2d");ae.font="40px",ae.fillStyle="#757575",ae.textAlign="center",v.forEach(function(fe){var Ee=fe.left,F=fe.top;ae.fillText(H,Ee,F)}),l.toBlob(function(fe){return p(fe)})})},Ke=function(){return new _Promise(function(l,v){var p=document.createElement("link");p.onload=l,p.setAttribute("class","fontlinksheet"),p.setAttribute("rel","stylesheet"),p.setAttribute("type","text/css"),p.setAttribute("href","/staticfiles/iconfont/iconfont.css"),document.head.appendChild(p)})},le=function(l){return new _Promise(function(v,p){var h=document.querySelector(".componentsWrap .react-grid-layout")||document.querySelector(".customPageContent"),H=h.getBoundingClientRect(),ae=H.left,fe=H.top,Ee=h.querySelectorAll(".widgetContent.embedUrl"),F=[].concat(_toConsumableArray(h.querySelectorAll(".statisticsCard-"+reportTypes.CountryLayer))).map(function(de){return de.parentNode.parentNode}),ce=h.offsetWidth,he=h.offsetHeight,we=document.querySelector(".fontlinksheet");document.querySelectorAll(".mapboxgl-ctrl").forEach(function(de){de.remove()}),domtoimage.toBlob(h,{bgcolor:l||"#f5f5f5",width:ce,height:he}).then(function(){var de=_asyncToGenerator(_regeneratorRuntime.mark(function Fe(Ze){var je,L,e,i;return _regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,b(Ze);case 2:return je=c.sent,L=be(je),e=[].concat(_toConsumableArray(Ee),_toConsumableArray(F)).map(function(d){var I=d.getBoundingClientRect(),g=I.left,N=I.width,P=I.top,M=I.height;return{left:g-ae+N/2,top:P-fe+M/2}}),c.next=7,Ue(L,e);case 7:i=c.sent,we&&we.remove(),v(i);case 10:case"end":return c.stop()}},Fe,C)}));return function(Fe){return de.apply(this,arguments)}}()).catch(function(de,Fe){we&&we.remove(),console.log(de,Fe)})})},Ve=function(l,v){var p=pe(l,v);return/^https?:\/\//.test(p)?p:"https://"+p},Ye=function(l){return l.map(function(v){if([x.analysis,x.view].includes(v.type)){var p=_.get(v,"config")||{};return p.objectId?v:_extends({},v,{config:_extends({},p,{objectId:uuidv4()})})}return v})},We=function(l){return l.filter(function(v){if(x.ai===v.type||v.type==="ai"){var p=_.get(v,"config")||{};return p.showType==="embed"}return!0})},Je=function(l){return l.filter(function(v){if(x.ai===v.type||v.type==="ai"){var p=_.get(v,"config")||{};return p.showType==="suspension"}return!1})[0]},qe=function(l){var v=l.dataType,p=l.advancedSetting,h=p.navshow,H=p.navfilters,ae=p.showNavfilters;if(h==="2"&&v===29&&H&&!ae){var fe=JSON.parse(H);return _JSON$stringify(fe.map(function(F){return JSON.parse(F).id}))}if(h==="3"&&v===29&&H&&!ae){var Ee=JSON.parse(H);return _JSON$stringify(Ee.map(handleCondition))}return H},et=function(l,v){var p=v&&generate(v)[0],h=_extends({},l);return h.pageBgColor==="iconColor"&&(h.pageBgColor=v,h.darkenPageBgColor=tinycolor(v).darken(6).toRgbString()),h.pageBgColor==="lightColor"&&(h.pageBgColor=p),h.pivoTableColor==="iconColor"&&(h.pivoTableColor=v),h.pivoTableColor==="lightColor"&&(h.pivoTableColor=p),h.numberChartColor==="iconColor"&&(h.numberChartColor=v),h.numberChartColor==="lightColor"&&(h.numberChartColor=p),h},y=function(l){return _.find(SYS_COLOR,{color:l.toLocaleUpperCase()})?!1:utils.isLightColor(l)};function r(m,l){var v=void 0,p=void 0;switch(l){case 1:v=1,p=3;break;case 2:v=4,p=6;break;case 3:v=7,p=9;break;case 4:v=10,p=12;break;default:throw new Error("Invalid quarter")}var h=moment().year(m).month(v-1).startOf("month"),H=moment().year(m).month(p-1).endOf("month");return[h,H]}var S=function(l,v){var p=l.sheetId,h=l.reportId,H=l.objectId,ae=[];for(var fe in v){var Ee=v[fe],F=Ee.onlyChartIds,ce=F===void 0?[]:F;Ee.sheetId===p&&h!==Ee.reportId&&(!ce.length||ce.includes(H))&&ae.push(_extends({},Ee,{filters:Ee.filters.map(function(de){var Fe=de.control,Ze=formatConditionForSave(getDefaultCondition(redefineComplexControl(de))),je=Ze.dataType,L=Ze.filterType,e=_extends({},de,{type:void 0,controlName:void 0,controlValue:void 0,control:void 0,spliceType:1,dataType:je,filterType:L});if(_.isNull(e.values[0])||_.isUndefined(e.values[0])||e.values[0]==="")return e.filterType=FILTER_CONDITION_TYPE.ISNULL,e.values=[],e;if(de.type===WIDGETS_TO_API_TYPE_ENUM.NUMBER||de.type===WIDGETS_TO_API_TYPE_ENUM.MONEY||de.type===WIDGETS_TO_API_TYPE_ENUM.FORMULA_NUMBER)return e.filterType=FILTER_CONDITION_TYPE.EQ,e.value=e.values[0],e.values=[],e;if(de.type===WIDGETS_TO_API_TYPE_ENUM.SUB_LIST||de.type===WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET)return e.dataType=WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET,e.filterType=FILTER_CONDITION_TYPE.RCEQ,e;if(de.type===WIDGETS_TO_API_TYPE_ENUM.DATE||de.type===WIDGETS_TO_API_TYPE_ENUM.DATE_TIME&&Fe){var i=Fe.particleSizeType,T=i===void 0?1:i,c=e.values[0];if([1,7,13].includes(T)&&(e.dateRangeType=1,e.filterType=FILTER_CONDITION_TYPE.DATE_EQ,e.value=moment(c).format("YYYY-MM-DD"),e.values=[]),T===2){var d=c.split("W"),I=_slicedToArray(d,2),g=I[0],N=I[1],P=moment().year(g).week(N).startOf("week"),M=moment().year(g).week(N).endOf("week");e.filterType=FILTER_CONDITION_TYPE.DATE_BETWEEN,e.minValue=P.format("YYYY-MM-DD"),e.maxValue=M.format("YYYY-MM-DD"),e.values=[]}if(T===3){var se=c.split("/"),R=_slicedToArray(se,2),V=R[0],He=R[1],xe=moment().year(V).month(He-1).startOf("month"),ft=moment().year(V).month(He-1).endOf("month");e.filterType=FILTER_CONDITION_TYPE.DATE_BETWEEN,e.minValue=xe.format("YYYY-MM-DD"),e.maxValue=ft.format("YYYY-MM-DD"),e.values=[]}if(T===4){var at=c.split("Q"),ot=_slicedToArray(at,2),it=ot[0],st=ot[1],ut=r(it,Number(st)),lt=_slicedToArray(ut,2),ct=lt[0],_t=lt[1];e.filterType=FILTER_CONDITION_TYPE.DATE_BETWEEN,e.minValue=ct.format("YYYY-MM-DD"),e.maxValue=_t.format("YYYY-MM-DD"),e.values=[]}if(T===5){var dt=c,Et=moment().year(dt).startOf("year"),vt=moment().year(dt).endOf("year");e.filterType=FILTER_CONDITION_TYPE.DATE_BETWEEN,e.minValue=Et.format("YYYY-MM-DD"),e.maxValue=vt.format("YYYY-MM-DD"),e.values=[]}return T===6&&(e.dateRangeType=1,e.filterType=FILTER_CONDITION_TYPE.DATE_EQ,e.value=moment(c+":00").format("YYYY-MM-DD"),e.values=[]),e}if(de.type===WIDGETS_TO_API_TYPE_ENUM.TIME){var Tt=e.values[0];e.filterType=FILTER_CONDITION_TYPE.DATEENUM,e.value=Tt,e.values=[]}return(de.type===WIDGETS_TO_API_TYPE_ENUM.AREA_CITY||de.type===WIDGETS_TO_API_TYPE_ENUM.AREA_COUNTY||de.type===WIDGETS_TO_API_TYPE_ENUM.AREA_PROVINCE)&&(e.filterType=FILTER_CONDITION_TYPE.BETWEEN),de.type===WIDGETS_TO_API_TYPE_ENUM.CASCADER&&(e.filterType=FILTER_CONDITION_TYPE.BETWEEN),e})}))}var he=_.flatten(ae.map(function(de){return de.filters})),we=ae.map(function(de){return de.widgetId});return{linkageFiltersGroup:he,initiateChartIds:we}}},51443:(Ge,Se,u)=>{u.d(Se,{ZP:()=>Me});var oe={defaultState:{viewType:1,projectId:"",lastMyProjectId:"all",attachmentViewType:1,folderId:"",filterUserId:"",taskFilter:6,listStatus:0,listSort:10,completeTime:"",keyWords:"",searchKeyWords:"",isSubUser:!1,filterSettings:{tags:[],customFilter:{},selectChargeIds:[],folderSearchRange:6}},isGetData:!1,clearFilterSettings:{keyWords:"",searchKeyWords:"",filterSettings:{tags:[],customFilter:{},selectChargeIds:[],folderSearchRange:6}},folderViewType:{treeView:1,stageView:2,folderDetail:3,attachment:4,folderChart:5,taskGantt:6},taskFilterDict:{6:"all",2:"responsible",3:"trust",1:"participate",7:"otherAndMe",8:"star",9:"subordinate",10:"visibleOtherResponsible"},MYTASKTYPES:{0:_l("\u5F85\u5B8C\u6210"),1:_l("\u4ECA\u5929\u8981\u505A"),2:_l("\u6700\u8FD1\u8981\u505A"),3:_l("\u4EE5\u540E\u8003\u8651")},TIPS:{0:_l("\u5F85\u5B8C\u6210\u7684\u4EFB\u52A1\uFF0C\u70B9\u51FB\u4EFB\u52A1\u524D\u7684\u6309\u94AE\u5206\u914D\u4F55\u65F6\u5F00\u59CB\u4EFB\u52A1"),1:_l("\u8FD9\u4E2A\u5206\u7C7B\u4E0B\u662F\u4F60\u8BA1\u5212\u4ECA\u5929\u8981\u505A\u7684\u4EFB\u52A1"),2:_l("\u8FD9\u4E2A\u5206\u7C7B\u4E0B\u662F\u4F60\u8BA1\u5212\u8FD1\u671F\u5F00\u59CB\u8981\u505A\u7684\u4EFB\u52A1"),3:_l("\u8FD9\u4E2A\u5206\u7C7B\u4E0B\u662F\u4F60\u8BA1\u5212\u4EE5\u540E\u8981\u505A\u7684\u4EFB\u52A1")},auth:{None:0,Charger:1,Member:2,Look:3,Null:4,FolderCharger:5,FolderMember:6,SubordinateUsers:7,FolderAdmin:8,VisibleGroup:9},structure:{list:0,folderList:1,myClassify:2},isDrop:!1,$prevNode:null,pageSize:Math.ceil(($(window).height()-140)/48)+5>20?Math.ceil(($(window).height()-140)/48)+5:20,selectize:"",isMyTask:!0,FilterMeTaskClassify:[3],FilterTaskID:[],BrowserScrollWidth:0,groundGlassHtml:'<div class="ThemeBG taskGroundGlass"></div>',detailDescMaxLength:2e4,configHtml:{searchNullHtml:'<div id="taskSearchNullTask"><div class="searchNullTip boderRadAll_3"><i class="taskNullSearch"></i><div>'+_l("\u6CA1\u6709\u641C\u7D22\u5230\u76F8\u5173\u4EFB\u52A1")+'</div></div><div class="ThemeBG taskGroundGlass"></div></div>',filterNullHtml:'<div id="taskSearchNullTask"> <div class="filterNullTip boderRadAll_3"><i class="taskNullFilter"></i><div>'+_l("\u6CA1\u6709\u7B5B\u9009\u7ED3\u679C")+'</div></div><div class="ThemeBG taskGroundGlass"></div></div>',noCompleteNullHtml:'<div id="taskSearchNullTask"><div class="noCompleteTip boderRadAll_3"><i class="taskNullFilter"></i><div>'+_l("\u6CA1\u6709\u5DF2\u5B8C\u6210\u4EFB\u52A1")+'</div></div><div class="ThemeBG taskGroundGlass"></div></div>'}};const Me=oe;var J={slide:1,detail:2,dialog:3},q={task:1,folder:2}},42541:(Ge,Se,u)=>{u.d(Se,{XX:()=>ie,al:()=>b,go:()=>Ne,gx:()=>Ue,lP:()=>Le,p7:()=>f,xw:()=>be});var oe=u(86735),Me=u(67294),J=u(71893),q=(0,oe.Z)([`
  color: #333;
  font-weight: bold;
  vertical-align: middle;
  margin: 16px 0;
`],[`
  color: #333;
  font-weight: bold;
  vertical-align: middle;
  margin: 16px 0;
`]),_e=(0,oe.Z)([`
  font-size: 17px;
`],[`
  font-size: 17px;
`]),me=(0,oe.Z)([`
  font-size: 15px;
`],[`
  font-size: 15px;
`]),Pe=(0,oe.Z)([`
  font-size: 13px;
  margin: 20px 0 10px;
`],[`
  font-size: 13px;
  margin: 20px 0 10px;
`]),Te=(0,oe.Z)([`
  font-weight: 600;
`],[`
  font-weight: 600;
`]),ye=(0,oe.Z)([`
  color: #757575;
  font-size: 13px;
`],[`
  color: #757575;
  font-size: 13px;
`]),De=(0,oe.Z)([`
  color: #9e9e9e;
  font-size: 13px;
`],[`
  color: #9e9e9e;
  font-size: 13px;
`]),Ie=(0,oe.Z)([`
  color: #999999;
  font-size: 13px;
`],[`
  color: #999999;
  font-size: 13px;
`]),X=(0,oe.Z)([`
  color: #bdbdbd;
  font-size: 13px;
`],[`
  color: #bdbdbd;
  font-size: 13px;
`]),G=(0,oe.Z)([`
  border-radius: 3px;
  height: 36px;
  line-height: 36px;
  background-color: #f1f1f1;
  color: #333;
  font-size: 14px;
  padding: 0 10px;
`],[`
  border-radius: 3px;
  height: 36px;
  line-height: 36px;
  background-color: #f1f1f1;
  color: #333;
  font-size: 14px;
  padding: 0 10px;
`]),D=(0,oe.Z)([`
  `,`
  input {
    border: none;
    background: inherit;
    font-size: inherit;
    width: 100%;
    margin-left: -1px;
  }
`],[`
  `,`
  input {
    border: none;
    background: inherit;
    font-size: inherit;
    width: 100%;
    margin-left: -1px;
  }
`]),Y=(0,oe.Z)([`
  `,`
`],[`
  `,`
`]),U=(0,oe.Z)([`
  display: inline-block;
  cursor: pointer;
  font-size: 13px;
  margin-left: 16px;
  border-radius: 17px;
  padding: 0 12px;
  height: 32px;
  line-height: 32px;
  color: #fff;
  background-color: rgba(0, 0, 0, 0.2);
  .icon {
    position: relative;
    top: 2px;
    font-size: 18px;
    margin-right: 6px;
  }
  :hover {
    background-color: rgba(0, 0, 0, 0.25);
  }
`],[`
  display: inline-block;
  cursor: pointer;
  font-size: 13px;
  margin-left: 16px;
  border-radius: 17px;
  padding: 0 12px;
  height: 32px;
  line-height: 32px;
  color: #fff;
  background-color: rgba(0, 0, 0, 0.2);
  .icon {
    position: relative;
    top: 2px;
    font-size: 18px;
    margin-right: 6px;
  }
  :hover {
    background-color: rgba(0, 0, 0, 0.25);
  }
`]),W=(0,oe.Z)([`
  display: flex;
  align-items: center;
`],[`
  display: flex;
  align-items: center;
`]),te=(0,oe.Z)([`
  display: flex;
  align-items: center;
  justify-content: center;
`],[`
  display: flex;
  align-items: center;
  justify-content: center;
`]),ne=(0,oe.Z)([`
  flex: 1;
`],[`
  flex: 1;
`]),j=(0,oe.Z)([`
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
`],[`
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
`]),A=(0,oe.Z)([`
  cursor: pointer;
  width: 22px;
  height: 22px;
  font-size: 14px;
  border-radius: 22px;
  background: #fff;
  color: #757575;
  box-shadow: 0px 1px 2px 1px rgba(0, 0, 0, 0.16);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #f5f5f5;
  &:hover {
    color: #333;
    box-shadow: 0px 2px 8px 1px rgba(0, 0, 0, 0.16);
  }
  &.red:hover {
    color: #f44336;
  }
`],[`
  cursor: pointer;
  width: 22px;
  height: 22px;
  font-size: 14px;
  border-radius: 22px;
  background: #fff;
  color: #757575;
  box-shadow: 0px 1px 2px 1px rgba(0, 0, 0, 0.16);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #f5f5f5;
  &:hover {
    color: #333;
    box-shadow: 0px 2px 8px 1px rgba(0, 0, 0, 0.16);
  }
  &.red:hover {
    color: #f44336;
  }
`]),C=`
  border: 1px solid #ddd;
  border-radius: 3px;
  background: #fff;
  resize: none;
  width: 100%;
  padding: 10px;
  font-size: 13px;
  &::placeholder {
    color: #bdbdbd;
  }
`,f=`
  box-shadow: 0px 4px 18px rgba(0, 0, 0, 0.16);
`,O=function(r){return r?r+"px":""},K=J.ZP.div(function(y){var r=y.width,S=r===void 0?20:r;return`
  display: inline-block;
  width: `+S+`px;
  height: `+S+`px;
  border-radius: `+S/2+`px;
`}),x=J.ZP.div(function(y){var r=y.fontSize,S=r===void 0?13:r,m=y.height,l=m===void 0?36:m,v=y.borderRadius,p=v===void 0?3:v,h=y.padding,H=h===void 0?"0 16px":h,ae=y.bg,fe=ae===void 0?"#F8F8F8":ae,Ee=y.color,F=Ee===void 0?"#757575":Ee,ce=y.hoverBg,he=y.hoverColor;return`
  cursor: pointer;
  font-size: `+S+`px;
  height: `+l+`px;
  line-height: `+l+`px;
  border-radius: `+p+`px;
  padding: `+H+`;
  background-color: `+fe+`;
  color: `+F+`;
  &:hover {
    background-color: `+(ce||fe)+`;
    color: `+(he||F)+`;
  }
`}),k=J.ZP.div(function(y){var r=y.color,S=r===void 0?"#E8E8E8":r;return"border: none; border-top: 1px solid "+S+"; margin: 20px 0;"}),re=J.ZP.div(q),ee=(0,J.ZP)(re)(_e),ve=(0,J.ZP)(re)(me),Ae=(0,J.ZP)(re)(Pe),ie=J.ZP.div(Te),ge=J.ZP.div(ye),Ne=J.ZP.div(De),ke=J.ZP.div(Ie),Le=J.ZP.div(X),pe=J.ZP.div(function(y){var r=y.color,S=r===void 0?"#9e9e9e":r,m=y.bgcolor,l=m===void 0?"#f5f5f5":m;return`
  color: `+S+`;
  font-size: 13px;
  background-color: `+l+`;
  padding: 12px;
`}),b=J.ZP.div(G),be=(0,J.ZP)(b)(D,C),Ue=J.ZP.textarea(Y,C),Ke=J.ZP.div(function(y){var r=y.top,S=y.bottom,m=y.left,l=y.right,v=y.children;return`
  position: absolute;
  top: `+O(r)+`;
  bottom: `+O(S)+`;
  left: `+O(m)+`;
  right: `+O(l)+`;
`}),le=J.ZP.div(function(y){var r=y.top,S=y.bottom,m=y.left,l=y.right,v=y.children;return`
  position: fixed;
  top: `+O(r)+`;
  bottom: `+O(S)+`;
  left: `+O(m)+`;
  right: `+O(l)+`;
`}),Ve=J.ZP.span(U),Ye=J.ZP.div(W),We=J.ZP.div(te),Je=J.ZP.div(ne),qe=(0,J.F4)(j),et=J.ZP.span(A)},5631:(Ge,Se,u)=>{u.d(Se,{Kj:()=>j});var oe=u(88902),Me=u.n(oe),J=u(88239),q=u(63239),_e=u.n(q),me=u(46593),Pe=u.n(me),Te=u(94942),ye=u.n(Te),De=u(36803),Ie=u(45231),X=u(48446),G=u(98306),D=u(96486),Y=u.n(D),U=function(){var A=(0,De.Z)(ye().mark(function C(f){var O=f.fileId,K=f.refId,x=f.worksheetId,k=x===void 0?void 0:x,re=f.rowId,ee=f.controlId,ve;return ye().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(ie.prev=0,!(!O&&!K)){ie.next=3;break}throw new Error;case 3:if(ve=void 0,!K){ie.next=10;break}return ie.next=7,X.Z.getNodeDetail({actionType:14,id:K,worksheetId:k});case 7:ve=ie.sent,ie.next=13;break;case 10:return ie.next=12,G.Z.getAttachmentDetail({fileId:O,worksheetId:k,rowId:re,controlId:ee});case 12:ve=ie.sent;case 13:window.open(ve.downloadUrl),ie.next=20;break;case 16:ie.prev=16,ie.t0=ie.catch(0),console.error(ie.t0),alert(_l("\u4E0B\u8F7D\u9644\u4EF6\u5931\u8D25"),3);case 20:case"end":return ie.stop()}},C,this,[[0,16]])}));return function(f){return A.apply(this,arguments)}}();function W(A){var C=A.isCustomButton,f=A.worksheetInfo,O=A.defaultRelatedSheet,K=O===void 0?{}:O,x=A.defaultFormData,k=x===void 0?{}:x,re=A.defaultFormDataEditable,ee=A.writeControls,ve=ee===void 0?[]:ee;return new _Promise(function(Ae,ie){var ge=_.cloneDeep(f.template.controls);function Ne(){try{ge=ge.filter(function(b){return!_.includes(FORM_HIDDEN_CONTROL_IDS,b.controlId)}).map(function(b){if(b.type===29&&Number(b.advancedSetting.showtype)!==RELATE_RECORD_SHOW_TYPE.LIST&&b.sourceControlId===K.relateSheetControlId&&b.dataSource===K.worksheetId)try{b.advancedSetting=_.assign({},b.advancedSetting,{defsource:_JSON$stringify([{staticValue:_JSON$stringify([_JSON$stringify(_extends({},JSON.parse(K.value.sourcevalue),{name:K.value.name}))])}])}),b.fieldPermission?b.fieldPermission=b.fieldPermission.replace(/(\w)(\w)(\w)/g,"$10$3"):b.fieldPermission="101"}catch(be){}return k[b.controlId]&&(b.value=k[b.controlId],re||(b.fieldPermission?b.fieldPermission=b.fieldPermission.replace(/(\w)(\w)(\w)/g,"$10$3"):b.fieldPermission="101")),_extends({},b)}),ge=ge.map(function(b){var be=_.find(ve,function(We){return b.controlId===We.controlId})||{};if(be.defsource&&(b.value="",_.includes([9,10,11],b.type)?b.value=b.default=safeParse(be.defsource)[0].staticValue:b.advancedSetting=_extends({},b.advancedSetting||{},{defsource:be.defsource})),b.type===30&&!b.value){var Ue=_.find(f.template.controls,function(We){return We.controlId===b.dataSource.slice(1,-1)}),Ke=Ue&&_.find(Ue.relationControls,function(We){return We.controlId===b.sourceControlId});if(!Ue)return b;if(Ue.value){var le=JSON.parse(Ue.value)[0];if(!le.sourcevalue)return _extends({},b);if(Ke&&Ke.type===29)try{var Ve=JSON.parse(le.sourcevalue)[b.sourceControlId],Ye=JSON.parse(Ve)[0];Ye&&(b.value=Ye.name)}catch(We){}else b.value=JSON.parse(le.sourcevalue)[b.sourceControlId]}}return _extends({},b)})}catch(b){ie(b)}Ae(ge)}var ke=_Object$keys(k);if(ke.length===1){var Le=_.find(ge,function(b){return b.controlId===ke[0]});if(Le&&Le.type===29&&_.find(ge,function(b){return b.dataSource==="$"+Le.controlId+"$"})){var pe=safeParse(k[Le.controlId]);if(pe.length&&pe[0].sid&&!pe[0].sourcevalue){worksheetAjax.getRowDetail({worksheetId:Le.dataSource,rowId:pe[0].sid}).then(function(b){pe[0].sourcevalue=b.rowData,k[Le.controlId]=_JSON$stringify(pe),Ne()}).catch(function(b){Ne()});return}}}Ne()})}function te(A){var C=A.appId,f=A.projectId,O=A.addType,K=A.viewId,x=A.worksheetId,k=A.masterRecord,re=A.formdata,ee=A.customBtn,ve=A.updateWorksheetControls,Ae=A.onSubmitEnd,ie=Ae===void 0?function(){}:Ae,ge=A.onSubmitSuccess,Ne=ge===void 0?function(){}:ge,ke=A.customwidget,Le=A.setRequesting,pe=A.rowStatus,b=A.setSubListUniqueError,be=A.setRuleError,Ue=re.filter(function(le){return le.type!==30&&le.type!==31&&le.type!==32&&le.type!==51}).map(function(le){return formatControlToServer(le,{isNewRecord:!0})}).filter(function(le){return!checkCellIsEmpty(le.value)}),Ke=_extends({silent:!0,receiveControls:Ue,appId:C,projectId:f,viewId:K,worksheetId:x,masterRecord:k,pushUniqueId:md.global.Config.pushUniqueId,rowStatus:pe||1},ee);Ke.masterRecord&&!Ke.masterRecord.rowId&&delete Ke.masterRecord,worksheetAjax.addWorksheetRow(Ke).then(function(le){if(pe===21){if(le.resultCode===20){ie(),Le(!1),Ne({isOverLimit:!0,rowData:[]});return}else le.data?(alert(_l("\u4FDD\u5B58\u8349\u7A3F\u6210\u529F")),Ne({rowData:[]}),ie(),Le(!1)):alert(_l("\u4FDD\u5B58\u8349\u7A3F\u5931\u8D25"),2);return}if(le.resultCode===1&&!le.data){alert(_l("\u8BB0\u5F55\u6DFB\u52A0\u6210\u529F")),ie(),Le(!1);return}if(le.resultCode===1){var Ve=void 0,Ye=updateOptionsOfControls(re,le.data);Ye.length&&_.isFunction(ve)&&(ve(Ye),Ve=Ye.map(function(We){return _extends({},We,{value:le.data[We.controlId]})})),Ne({rowData:le.data,newControls:Ve})}else le.resultCode===11?ke.current&&_.isFunction(ke.current.uniqueErrorUpdate)&&ke.current.uniqueErrorUpdate(le.badData):le.resultCode===22?(b(le.badData),handleRecordError(le.resultCode)):le.resultCode===32?be(le.badData):handleRecordError(le.resultCode);ie(),Le(!1)}).catch(function(le){ie(),_.isObject(le)?alert(le.errorMessage||_l("\u8BB0\u5F55\u6DFB\u52A0\u5931\u8D25"),3):alert(le||_l("\u8BB0\u5F55\u6DFB\u52A0\u5931\u8D25"),3)})}function ne(A){var C=A.worksheetId,f=A.viewId,O=A.rowIds,K=A.relateRecordControlId,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};worksheetAjax.copyRow({worksheetId:C,viewId:f,rowIds:O,copyRelationControlId:K}).then(function(k){k&&k.resultCode===1&&k.data.length?(k.data.length<O.length?alert(_l("%0\u6761\u590D\u5236\u5931\u8D25\uFF08\u53EF\u80FD\u6709\u5FC5\u586B\u9879\u4E3A\u7A7A\uFF0C\u8BBE\u7F6E\u4E0D\u5141\u8BB8\u91CD\u590D\u6216\u6570\u636E\u8D85\u91CF\uFF09",O.length-k.data.length),3):alert(_l("\u590D\u5236\u6210\u529F")),x(k.data)):k&&k.resultCode===7?alert(_l("\u590D\u5236\u5931\u8D25\uFF0C\u6743\u9650\u4E0D\u8DB3\uFF01"),3):k&&k.resultCode===9?alert(_l("\u590D\u5236\u5931\u8D25\uFF0C\u8D85\u8FC7\u6700\u5927\u6570\u91CF\uFF01"),3):k&&k.resultCode===11?alert(_l("\u590D\u5236\u5931\u8D25\uFF0C\u5F53\u524D\u8868\u5B58\u5728\u552F\u4E00\u5B57\u6BB5"),3):alert(k&&k.resultCode===1?_l("\u590D\u5236\u5931\u8D25\uFF08\u53EF\u80FD\u6709\u5FC5\u586B\u9879\u4E3A\u7A7A\uFF0C\u8BBE\u7F6E\u4E0D\u5141\u8BB8\u91CD\u590D\u6216\u6570\u636E\u8D85\u91CF\uFF09"):_l("\u590D\u5236\u5931\u8D25\uFF01"),2)}).catch(function(k){console.log(k),alert(_l("\u590D\u5236\u5931\u8D25\uFF01"),3)})}var j=function(){var A=(0,De.Z)(ye().mark(function C(f){var O=f.appId,K=f.controlId,x=f.fileId,k=f.recordId,re=f.viewId,ee=f.worksheetId,ve=f.getType,Ae;return ye().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!(!K||!x||!k||!ee)){ge.next=3;break}return console.error("\u53C2\u6570\u4E0D\u5168"),ge.abrupt("return");case 3:return ge.next=5,Ie.Z.getAttachmentShareId({appId:O,controlId:K,fileId:x,rowId:k,viewId:re,worksheetId:ee,getType:ve});case 5:Ae=ge.sent,Ae&&window.open((window.subPath?window.subPath:"")+"/recordfile/"+Ae+"/"+(ve||""));case 7:case"end":return ge.stop()}},C,this)}));return function(f){return A.apply(this,arguments)}}()},70973:(Ge,Se,u)=>{u.d(Se,{W_:()=>U});var oe=u(88239),Me=u(52367),J=u.n(Me),q=u(26378),_e=u.n(q),me=u(96486),Pe=u.n(me),Te=function(j){var A={};return j.forEach(function(C){A[C.rowid]=C}),A},ye=function(j){var A=_.get(j,"base"),C=A.appId,f=A.worksheetId,O=A.viewId;return{appId:C,worksheetId:f,viewId:O}},De=function(j){var A=j.base,C=j.views;return find(C,function(f){return f.viewId===A.viewId})||{}},Ie=function(j){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],C=_.get(j,"base"),f=C.appId,O=C.worksheetId,K=C.viewId,x=De(j),k=x.childType,re=x.viewControls;if(k===2&&A.length>0){var ee=re[A.length-1];return{appId:f,worksheetId:ee.worksheetId}}return{appId:f,worksheetId:O,viewId:K}},X=function(j,A){var C=G(j,A),f=C.isAdmin,O=C.isOwner;return!!f||!!O},G=function(j,A){var C={};return j===APP_ROLE_TYPE.POSSESS_ROLE&&(C.isOwner=!A),j===APP_ROLE_TYPE.MAP_OWNER&&(C.isOwner=!0),j===APP_ROLE_TYPE.ADMIN_ROLE&&(C.isAdmin=!A),j===APP_ROLE_TYPE.DEVELOPERS_ROLE&&(C.isDeveloper=!A),j===APP_ROLE_TYPE.RUNNER_ROLE&&(C.isRunner=!A),j===APP_ROLE_TYPE.RUNNER_DEVELOPERS_ROLE&&(C.isRunner=!A,C.isDeveloper=!A),C},D=function(j,A){var C=G(j,A),f=C.isAdmin,O=C.isOwner,K=C.isDeveloper;return!!f||!!O||!!K},Y=function(j){var A=G(j),C=A.isAdmin,f=A.isOwner,O=A.isRunner;return!!C||!!f||!!O};function U(ne){var j={};return function(){return j[ne.name]&&j[ne.name].abort(),j[ne.name]=ne.apply(void 0,arguments),j[ne.name]}}function W(){var ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(ne){var A=function C(f){var O=!0,K=!1,x=void 0;try{for(var k=_getIterator(f),re;!(O=(re=k.next()).done);O=!0){var ee=re.value;if(ee.rowId===ne)return ee;if(ee.children&&ee.children.length>0){var ve=C(ee.children);if(ve)return ve}}}catch(Ae){K=!0,x=Ae}finally{try{!O&&k.return&&k.return()}finally{if(K)throw x}}return null};return A(j)}}function te(ne){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],C=safeParse(_.get(j,"advancedSetting.customitems"),"array");_.get(j,"advancedSetting.navshow")==="2"&&(C=safeParse(_.get(j,"advancedSetting.navfilters"),"array"));var f=_.find(A,function(re){return re.controlId===j.viewControl});if(!_.isEmpty(C)&&f){var O=C.map(function(re){var ee=safeParse(re);return _.includes([9,10,11,28],f.type)?re:ee.id||ee.accountId}),K=new _Map(O.map(function(re,ee){return[re,ee]})),x=_.sortBy(ne,"sort"),k=_.sortBy(x,function(re){return re.key==="-1"?-999:K.get(re.key)});return k.map(function(re,ee){return _extends({},re,{sort:ee+1})})}return ne}},89499:(Ge,Se,u)=>{u.d(Se,{CD:()=>tt});var oe=u(12424),Me=u(52945),J=u.n(Me),q=u(46593),_e=u.n(q),me=u(99663),Pe=u(22600),Te=u(72444),ye=u(94942),De=u.n(ye),Ie=u(88239),X=u(36803),G=u(63239),D=u.n(G),Y=u(88902),U=u.n(Y),W=u(88106),te=u(17187),ne=u.n(te),j=u(30381),A=u.n(j),C=u(68924),f=u.n(C),O=u(20640),K=u.n(O),x=u(5274),k=u(92138),re=u(49365),ee=u(5505),ve=u(75599),Ae=u(96486),ie=u.n(Ae),ge=u(19575),Ne=u.n(ge),ke=new(ne());window.onresize=function(){return ke.emit("WINDOW_RESIZE")};function Le(t){return t.map(function(n){var a={};return n.forEach(function(o){a[o.controlId]=o.value}),a})}var pe={HIDDEN:0,COMPLETED:1,INCOMPLETE:2,SUM:3,AVERAGE:4,MAXIMUM:5,MINIMUM:6},b=[{type:"COMMON",value:pe.HIDDEN,label:_l("\u4E0D\u663E\u793A")},{type:"COMMON",value:pe.COMPLETED,label:_l("\u5DF2\u586B\u5199")},{type:"COMMON",value:pe.INCOMPLETE,label:_l("\u672A\u586B\u5199")},{type:"NUMBER",value:pe.SUM,label:_l("\u6C42\u548C")},{type:"NUMBER",value:pe.AVERAGE,label:_l("\u5E73\u5747\u503C")},{type:"NUMBER",value:pe.MAXIMUM,label:_l("\u6700\u5927\u503C")},{type:"NUMBER",value:pe.MINIMUM,label:_l("\u6700\u5C0F\u503C")}];function be(t){var n=b.filter(function(a){return a.value===t})[0];return n?n.label:""}function Ue(t,n){return t===37&&(t=n.enumDefault2),t===6||t===8||t===31||t===28||t===38&&n&&n.enumDefault===1?{list:b.filter(function(a){return a.type==="COMMON"}).concat(void 0).concat(b.filter(function(a){return a.type==="NUMBER"})),default:3}:{list:b.filter(function(a){return a.type==="COMMON"}),default:1}}function Ke(t,n){var a=[],o={};try{o=JSON.parse(ae("WORKSHEET_VIEW_SUMMARY_TYPES",t))}catch(s){}return n.forEach(function(s){var E=s.type===30?s.sourceControlType:s.type;a.push({controlId:s.controlId,rptType:parseInt(o[s.controlId]||_.includes([6,8,31],E)?3:2,10)})}),a}function le(t){var n=_.uniqBy(t.map(function(o){return o.projectId})),a=md.global.Account.projects.filter(function(o){return n.indexOf(o.projectId)>-1});return[{companyName:_l("\u4E2A\u4EBA"),projectId:""}].concat(a).map(function(o){return{project:o,list:t.filter(function(s){return s.projectId===o.projectId})}}).filter(function(o){return o.list.length})}function Ve(t,n){return n.typeArr?n.typeArr.map(function(a){return a.type}).indexOf(t)>-1:n.data&&t===n.data.type}function Ye(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=[2,3,4,5,6,7,8,9,10,11,15,16,26,27,28,29,30,31,32,33,34,36,37,38,42,46,48,50];return n.type===30&&n.strDefault==="10"?!1:_.includes(a,t)}function We(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=1,o=2;if(t===6||t===8||t===33||t===34||t===29&&n.enumDefault===2)return[{text:"1 \u2192 9",value:o},{text:"9 \u2192 1",value:a}];if(t===2||t===29||t===32)return[{text:"A \u2192 Z",value:o},{text:"Z \u2192 A",value:a}];if(t===15||t===16||t===17||t===18)return[{text:_l("\u6700\u65B0\u7684\u5728\u524D%05029"),value:a},{text:_l("\u6700\u65E7\u7684\u5728\u524D%05030"),value:o}];if(t===36){var s=[_l("\u672A\u9009\u4E2D \u2192 \u9009\u4E2D"),_l("\u9009\u4E2D \u2192 \u672A\u9009\u4E2D")];return n.advancedSetting&&(n.advancedSetting.showtype==="1"&&(s=[_l("\u5173\u95ED \u2192 \u5F00\u542F"),_l("\u5F00\u542F \u2192 \u5173\u95ED")]),n.advancedSetting.showtype==="2"&&(s=[_l("\u5426 \u2192 \u662F"),_l("\u662F \u2192 \u5426")])),[{text:s[0],value:o},{text:s[1],value:a}]}else return[{text:_l("\u5347\u5E8F%05031"),value:o},{text:_l("\u964D\u5E8F%05032"),value:a}]}function Je(t){if(!t.length)return[];var n=t.filter(function(B){return B.type===29&&B.enumDefault===2}),a=t.filter(function(B){return B.type===30}),o=!_.isEmpty(n),s=t.slice(0);if(o){var E=n.map(function(B){return B.controlId}),w=a.filter(function(B){return _.find(E,function(Z){return B.dataSource.slice(1,-1)===Z})});s=s.filter(function(B){return!_.find(w,function(Z){return Z.controlId===B.controlId})})}return s}function qe(t){var n=t.value,a=t.unit,o=a===void 0?"6":a,s=t.hideUnitStr,E=t.dot,w=E===void 0?0:E,B=n<0;n=toFixed(Math.floor(n*Math.pow(10,w))/Math.pow(10,w),w),B&&(n=-1*n);var Z=_.find(UNIT_TYPE,function(ze){return ze.value===o});if(!Z)return n;var z=Z.text,Q={6:1,5:365*24*60*60,4:30*24*60*60,3:24*60*60,2:60*60,1:60},ue=Number(n)*Q[o],Oe=Math.floor(ue/Q[5]);ue-=Oe*Q[5];var Re=Math.floor(ue/Q[4]);ue-=Re*Q[4];var Be=Math.floor(ue/Q[3]);ue-=Be*Q[3];var $e=Math.floor(ue/Q[2]);ue-=$e*Q[2];var nt=Math.floor(ue/Q[1]);ue-=nt*Q[1];var Xe=[{value:Oe,unit:_l("\u5E74")},{value:Re,unit:_l("\u6708")},{value:Be,unit:_l("\u5929")},{value:$e,unit:_l("\u65F6")},{value:nt,unit:_l("\u5206")},{value:ue,unit:_l("\u79D2")}].slice(0,6-Number(o)||6).filter(function(ze){return ze.value!==0||ze.unit===z}).map(function(ze){return ze.value+ze.unit}).join("");return s&&(Xe=Xe.slice(0,-1)),Xe&&(B?"-":"")+Xe}function et(t){return filterXss(t).replace(/(<([^>]+)>)/gi,"")}function y(t){try{var n=new DOMParser().parseFromString(t,"text/html");return n.body.textContent||""}catch(a){return t}}function r(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return t.filter(function(o){return!_.find(n,function(s){return o.controlId===s&&!(a&&_.find(["ownerid","caid","ctime","utime"],function(E){return E===s}))})})}function S(t){var n=t.cid,a=t.data;return(_.find(a,function(o){return o.controlId===n})||{}).value}var m=null,l=null;function v(t){var n=m.concat(l);return _.includes(n,t)}function p(t){return _.includes(l,t)}function h(t,n,a){if(_.isObject(a))throw new Error("\u53EA\u652F\u6301\u5B58\u50A8\u5B57\u7B26\u4E32");var o=30,s={};if(localStorage.getItem(t))try{s=JSON.parse(localStorage.getItem(t))}catch(w){}var E=_.assign({},s,_defineProperty({},n,a));_Object$keys(E).length>o&&delete E[_Object$keys(E).pop],safeLocalStorageSetItem(t,_JSON$stringify(E))}function H(t,n){var a={};if(localStorage.getItem(t))try{a=JSON.parse(localStorage.getItem(t))}catch(o){}delete a[n],safeLocalStorageSetItem(t,_JSON$stringify(a))}function ae(t,n){var a=[];if(localStorage.getItem(t))try{a=JSON.parse(localStorage.getItem(t))}catch(o){return}return a[n]}function fe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(!n.length)return t;n=n.filter(_.identity);var a=t.filter(function(o){return!_.find(n,function(s){return(o.controlId||o.data.controlId)===s})});return n.map(function(o){return _.find(t,function(s){return(s.controlId||s.data.controlId)===o})}).filter(_.identity).concat(a)}function Ee(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(!n.length)return t.map(function(o){return o.controlId||o.data.controlId}).filter(function(o){return _.identity});n=n.filter(function(o){return _.find(t,function(s){return(s.controlId||s.data.controlId)===o})}).filter(_.identity);var a=t.filter(function(o){return!_.find(n,function(s){return(o.controlId||o.data.controlId)===s})}).map(function(o){return o.controlId||o.data.controlId}).filter(function(o){return _.identity});return n.concat(a)}function F(t){return typeof t>"u"||t===""||t==="[]"||t==='["",""]'||t===null}function ce(t){t=t+"";var n=_.find([{text:_l("\u5E74"),value:"5"},{text:_l("\u6708"),value:"4"},{text:_l("\u5929"),value:"3"},{text:_l("\u5C0F\u65F6"),value:"2"},{text:_l("\u5206\u949F"),value:"1"}],function(a){return a.value===t});return n?n.text:""}function he(t){var n=t.sourceControlType||t.type;return n===6||n===8||n===31||n===36?"NUMBER":"STRING"}function we(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.addedIds,s=o===void 0?[]:o,E=a.deletedIds,w=E===void 0?[]:E,B=a.count,Z=B===void 0?0:B,z=a.isFromDefault;_.isArray(n)||(n=[]);var Q=_.find(t,function(Oe){return Oe.attribute===1}),ue=n.map(function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Re=Q?Oe[Q.controlId]:"";if(Q&&Q.type===29&&Re)try{var Be=JSON.parse(Oe[Q.controlId]);Re=Be[0].name}catch($e){Re=""}return{name:Re,sid:Oe.rowid,type:8,sourcevalue:_JSON$stringify(Oe),row:Oe,isNew:_.includes(s,Oe.rowid)||z,isFromDefault:z,deletedIds:w,count:Z}});return ue}function de(t,n){return t.type===26?safeParse(n,"array").map(function(a){return a.accountId}).sort().join(""):t.type===29?safeParse(n,"array").map(function(a){return a.sid}).sort().join(""):n}function Fe(t){var n=t.rows,a=t.rules,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=this,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:3,B={};try{tt(n).forEach(function(){var z=_asyncToGenerator(_regeneratorRuntime.mark(function Q(ue){var Oe,Re,Be,$e,nt,Xe;return _regeneratorRuntime.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:if(Oe=V({from:w,rules:a,controls:o.filter(function(Ce){return _.find(E,function(Qe){return Qe===Ce.controlId})}),row:ue}),Re=Oe.errors,Be=Oe.formData.filter(function(Ce){return _.find(E,function(Qe){return Qe===Ce.controlId})&&controlState(Ce).visible&&controlState(Ce).editable}),$e=checkRuleLocked(a,Oe.formData.filter(function(Ce){return _.find(E,function(Qe){return Qe===Ce.controlId})&&controlState(Ce).visible}),ue.rowid),!$e){rt.next=6;break}return rt.abrupt("return");case 6:nt=new DataFormat({data:Be.map(function(Ce){return _extends({},Ce,{isSubList:!0})}),from:FROM.NEWRECORD}),Xe=nt.getErrorControls(),Re.forEach(function(Ce){_.includes(E,Ce.controlId)&&(B[ue.rowid+"-"+Ce.controlId]=Ce.errorMessage)}),Xe.forEach(function(Ce){B[ue.rowid+"-"+Ce.controlId]=typeof FORM_ERROR_TYPE_TEXT[Ce.errorType]=="string"?FORM_ERROR_TYPE_TEXT[Ce.errorType]:FORM_ERROR_TYPE_TEXT[Ce.errorType](_.find(Be,function(Qe){return Qe.controlId===Ce.controlId}))});case 10:case"end":return rt.stop()}},Q,s)}));return function(Q){return z.apply(this,arguments)}}());var Z=o.filter(function(z){return _.find(E,function(Q){return Q===z.controlId})&&(z.unique||z.uniqueInRecord)});return Z.forEach(function(z){var Q=n.filter(function(Re){return typeof Re[z.controlId]<"u"&&!Re[z.controlId].startsWith("deleteRowIds")&&!F(Re[z.controlId])}),ue=_.uniqBy(Q,function(Re){return de(z,Re[z.controlId])});if(Q.length!==ue.length){var Oe=Q.filter(function(Re){return!_.find(ue,function(Be){return Be.rowid===Re.rowid})});Oe.forEach(function(Re){var Be=Q.filter(function($e){return de(z,$e[z.controlId])===de(z,Re[z.controlId])});Be.length>1&&Be.forEach(function($e){B[$e.rowid+"-"+z.controlId]=FORM_ERROR_TYPE_TEXT.UNIQUE(z,!0)})})}}),B}catch(z){throw alert(_l("\u5931\u8D25"),3),console.log(z),z}}var Ze=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=arguments[1];return n.filter(function(o){return o.type===34&&controlState(o,a).visible&&controlState(o,a).editable})};function je(t){var n=t.type,a=t.sourceControlType,o=t.enumDefault,s=t.enumDefault2;return n===6||n===8||n===31||n===37&&je({type:s})||n===30&&je({type:a,enumDefault:o})||n===38&&(o===1||o===3)}function L(t){var n=t.type,a=t.enumDefault,o=t.advancedSetting,s=o===void 0?{}:o,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w=E.ignoreInFormTable,B=w===void 0?!1:w;return n===29&&a===2&&_.includes(B?[String(RELATE_RECORD_SHOW_TYPE.LIST),String(RELATE_RECORD_SHOW_TYPE.TAB_TABLE)]:[String(RELATE_RECORD_SHOW_TYPE.LIST),String(RELATE_RECORD_SHOW_TYPE.TABLE),String(RELATE_RECORD_SHOW_TYPE.TAB_TABLE)],s.showtype)||n===51&&s.showtype===String(RELATION_SEARCH_SHOW_TYPE.LIST)}function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"111",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return t.substring(0,n)+a+t.substring(n+1)}function i(t){try{var n=JSON.parse(t);if(Array.isArray(n)){var a=head(n);return(typeof a>"u"?"undefined":_typeof(a))==="object"?a.sid:a}return n||"-1"}catch(o){return"-1"}}function T(t,n,a){var o=safeParse(n),s=void 0;if(o.length>1){var E=safeParse(a);s=o.map(function(w,B){return{index:t.options.length+B+1,isDeleted:!1,key:E[B],color:"#2196f3",value:w&&(w.match(/add_(.*)/)||"")[1]}}).filter(function(w){return w.value})}else s={index:t.options.length+1,isDeleted:!1,key:_.last(JSON.parse(a)),color:"#2196f3",value:n&&(n.match(/"add_(.*)"]/)||"")[1]};return _extends({},t,{options:t.options.concat(s)})}function c(t,n){var a=[];try{a=_.filter(t,function(o){return _.includes([10,11],o.type)&&/"add_/.test(o.value)}).map(function(o){return T(o,o.value,n[o.controlId])})}catch(o){}return a}function d(t,n){if(F(n))return n;switch(t.type){case WIDGETS_TO_API_TYPE_ENUM.TEXT:case WIDGETS_TO_API_TYPE_ENUM.MOBILE_PHONE:case WIDGETS_TO_API_TYPE_ENUM.TELEPHONE:case WIDGETS_TO_API_TYPE_ENUM.EMAIL:case WIDGETS_TO_API_TYPE_ENUM.NUMBER:case WIDGETS_TO_API_TYPE_ENUM.CRED:case WIDGETS_TO_API_TYPE_ENUM.MONEY:case WIDGETS_TO_API_TYPE_ENUM.FLAT_MENU:case WIDGETS_TO_API_TYPE_ENUM.MULTI_SELECT:case WIDGETS_TO_API_TYPE_ENUM.DROP_DOWN:case WIDGETS_TO_API_TYPE_ENUM.DATE:case WIDGETS_TO_API_TYPE_ENUM.DATE_TIME:case WIDGETS_TO_API_TYPE_ENUM.RELATION:case WIDGETS_TO_API_TYPE_ENUM.MONEY_CN:case WIDGETS_TO_API_TYPE_ENUM.USER_PICKER:case WIDGETS_TO_API_TYPE_ENUM.DEPARTMENT:case WIDGETS_TO_API_TYPE_ENUM.SCORE:case WIDGETS_TO_API_TYPE_ENUM.FORMULA_NUMBER:case WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET:case WIDGETS_TO_API_TYPE_ENUM.SWITCH:case WIDGETS_TO_API_TYPE_ENUM.RICH_TEXT:case WIDGETS_TO_API_TYPE_ENUM.CASCADER:case WIDGETS_TO_API_TYPE_ENUM.LOCATION:case WIDGETS_TO_API_TYPE_ENUM.ATTACHMENT:case WIDGETS_TO_API_TYPE_ENUM.AREA_PROVINCE:case WIDGETS_TO_API_TYPE_ENUM.AREA_CITY:case WIDGETS_TO_API_TYPE_ENUM.AREA_COUNTY:case WIDGETS_TO_API_TYPE_ENUM.SHEET_FIELD:case WIDGETS_TO_API_TYPE_ENUM.ORG_ROLE:case WIDGETS_TO_API_TYPE_ENUM.TIME:case WIDGETS_TO_API_TYPE_ENUM.CONCATENATE:case WIDGETS_TO_API_TYPE_ENUM.SIGNATURE:return n;default:return}}function I(t,n){var a={};return t.forEach(function(o){a[o.controlId]=d(o,n[o.controlId])}),a}function g(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.updateControlIds,s={};return t.filter(function(E){return(o?_.includes(o,E.controlId):!F(E.value))&&E.controlId.length===24}).forEach(function(E){if(E.type===WIDGETS_TO_API_TYPE_ENUM.SUB_LIST)E.value&&E.value.rows&&tt(E.value.rows).length&&(s[E.controlId]=tt(E.value.rows).map(function(w){var B=_.pickBy(w,function(z){return!F(z)}),Z=_.keys(_.pickBy(w,function(z){return typeof z=="string"&&z.indexOf("sourcevalue")>-1}));return Z.forEach(function(z){try{var Q=JSON.parse([B[z]]);B[z]=_JSON$stringify(Q.map(function(ue){return _extends({},ue,{sourcevalue:_JSON$stringify(_.pickBy(JSON.parse(ue.sourcevalue),function(Oe){return!F(Oe)&&(typeof Oe!="string"||Oe.indexOf("sourcevalue")<0)}))})}))}catch(ue){delete B[z]}}),B}));else if(E.type===WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET)try{s[E.controlId]=_JSON$stringify(JSON.parse(E.value).map(function(w){return{type:w.type,sid:w.sid,name:getTitleTextFromRelateControl(E,w.name?w:w.row||safeParse(w.sourcevalue))}}))}catch(w){}else E.type!==WIDGETS_TO_API_TYPE_ENUM.SUB_LIST&&_.includes(["string","number"],_typeof(E.value))&&(s[E.controlId]=E.value)}),_Object$keys(n).forEach(function(E){var w=n[E];w&&(s[w.controlId]=w.value)}),s}function N(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=[],s={};try{o=n.map(function(E){if(E.type===WIDGETS_TO_API_TYPE_ENUM.SUB_LIST&&t[E.controlId])return _extends({},E,{value:{isAdd:!0,rows:t[E.controlId],action:"clearAndSet"}});if(E.sourceControlId===a.relateSheetControlId)try{return _extends({},E,{value:_JSON$stringify([a.value])})}catch(w){return _extends({},E,{value:t[E.controlId]})}else return _extends({},E,{value:t[E.controlId]})}),n.forEach(function(E){E.type===WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET&&E.enumDefault===2&&t[E.controlId]&&(s[E.controlId]=_extends({},E,{value:t[E.controlId]}))})}catch(E){}return{formdata:o,relateRecordData:s}}var P=ie().debounce(St,1e3);function M(t,n,a){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;if(window.isWxWork)return P(""+md.global.Account.accountId+n+"-"+t,a),P;var s=[];if(localStorage.getItem(t))try{s=JSON.parse(localStorage.getItem(t))||[],s=s.filter(function(E){return E!==n})}catch(E){}s.push(n),s.length>o&&(localStorage.removeItem(t+"_"+s[0],a),s=s.slice(1));try{safeLocalStorageSetItem(t,_JSON$stringify(s)),safeLocalStorageSetItem(t+"_"+n,a)}catch(E){_Object$keys(localStorage).filter(function(w){return w.startsWith(t)}).forEach(function(w){return localStorage.removeItem(w)}),safeLocalStorageSetItem(t,_JSON$stringify(s)),safeLocalStorageSetItem(t+"_"+n,a)}}function se(t,n){if(window.isWxWork){It(""+md.global.Account.accountId+n+"-"+t);return}var a=[];if(localStorage.getItem(t))try{a=JSON.parse(localStorage.getItem(t))||[],a=a.filter(function(o){return o!==n})}catch(o){}a&&a.length?safeLocalStorageSetItem(t,_JSON$stringify(a)):localStorage.removeItem(t),localStorage.removeItem(t+"_"+n)}function R(t){return/^\w{24}$/.test(t)}function V(t){var n=t.from,a=t.rules,o=t.controls,s=t.control,E=t.row,w=[],B=updateRulesData({from:n,rules:a,recordId:E.rowid,data:o.map(function(Z){return _extends({},Z,{value:E[Z.controlId]})}),updateControlIds:s?[s.controlId]:[],checkAllUpdate:!s,checkRuleValidator:function(z,Q,ue){ue&&w.push({controlId:z,errorType:Q,errorMessage:ue})}});return{formData:B,errors:w}}function He(t){var n=t.from,a=t.rules,o=t.controls,s=t.control,E=t.row,w=V({from:n,rules:a,controls:o,control:s,row:E}).errors;return _.find(w,function(B){return B.controlId===s.controlId})}function xe(t){t=typeof t=="number"?{typeof:t}:t;var n=t,a=n.type;return a===WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET||a===WIDGETS_TO_API_TYPE_ENUM.USER_PICKER||a===WIDGETS_TO_API_TYPE_ENUM.DEPARTMENT?"array":a===WIDGETS_TO_API_TYPE_ENUM.NUMBER?"number":"string"}function ft(t){switch(t.sourceControlType||t.type){case WIDGETS_TO_API_TYPE_ENUM.TEXT:return"1";case WIDGETS_TO_API_TYPE_ENUM.NUMBER:case WIDGETS_TO_API_TYPE_ENUM.MONEY:return 1;case WIDGETS_TO_API_TYPE_ENUM.EMAIL:return"a#b.com".replace("#","@");case WIDGETS_TO_API_TYPE_ENUM.MOBILE_PHONE:return"+8618799999999";case WIDGETS_TO_API_TYPE_ENUM.DATE:return moment().format("YYYY-MM-DD");case WIDGETS_TO_API_TYPE_ENUM.DATE_TIME:return moment().format("YYYY-MM-DD HH:mm");case WIDGETS_TO_API_TYPE_ENUM.FLAT_MENU:case WIDGETS_TO_API_TYPE_ENUM.MULTI_SELECT:case WIDGETS_TO_API_TYPE_ENUM.USER_PICKER:case WIDGETS_TO_API_TYPE_ENUM.DEPARTMENT:case WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET:return"[]";case WIDGETS_TO_API_TYPE_ENUM.AREA_PROVINCE:case WIDGETS_TO_API_TYPE_ENUM.AREA_CITY:return'{name: "china"}';case WIDGETS_TO_API_TYPE_ENUM.SUB_LIST:case WIDGETS_TO_API_TYPE_ENUM.SWITCH:return 1;default:return"1"}}function at(t){return new vm.Script(t).runInNewContext()}var ot=`onmessage = function (e) {
  try {
  const result = new Function(e.data)();
  if (typeof result === 'object' && typeof result.then === 'function') {
      postMessage('promise begin');
      Promise.all([result]).then(function ([value]) {
        postMessage('promise value ' + value);
        postMessage({
          type: 'over',
          value,
        });
      });
    } else {
      postMessage({
        type: 'over',
        value: new Function(e.data)(),
      });
    }
  } catch (err) {
    postMessage({
      type: 'error',
      err,
    });
  }
};
`;function it(){return new Worker("data:application/javascript,"+encodeURIComponent(ot))}var st=function(){function t(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.max,o=a===void 0?10:a;(0,me.default)(this,t),this.max=o,this.runningCount=0,this.queue=[],this.workers=[],this.list=[],this.isRunning=!1}return(0,Pe.default)(t,[{key:"getWorker",value:function(){var a=this.workers.filter(function(s){return s.idle})[0];if(a)return a;if(this.workers.length<this.max){var o={worker:it(),idle:!1,id:Math.random()};return this.workers.push(o),o}}},{key:"run",value:function(){var a=this,o=this.getWorker();if(o){var s=this.list.shift();if(!s){this.isRunning=!1;return}var E=s.code,w=s.cb,B=s.timeout;o.idle=!1,this.isRunning=!0,this.runningCount++;var Z=function(){o.idle=!0,a.runningCount--,a.run()},z=void 0;o.worker.onmessage=function(Q){Q.data.type==="begin"&&(z=setTimeout(function(){o.worker.terminate(),a.workers=a.workers.filter(function(ue){return ue.id!==o.id}),Z(),w(B+"ms time out")},B)),Q.data.type==="over"&&(Z(),w(null,Q.data.value),clearTimeout(z)),Q.data.type==="error"&&(console.error(Q.err),Z(),w(Q.err),clearTimeout(z))},o.worker.postMessage(E)}}},{key:"push",value:function(a){var o=a.code,s=a.cb,E=a.timeout;this.list.push({code:o,cb:s,timeout:E}),this.runningCount<this.max&&this.run()}}]),t}(),ut=new st;function lt(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.timeout,s=o===void 0?1e3:o;ut.push({code:t,cb:n,timeout:s})}function ct(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"mdfunction";try{return t=t.replace(/\$(.+?)\$/g,'"1"'),n==="mdfunction"?(t=t.replace(/[\r\r\n ]/g,""),t=t.replace(/([A-Z]+)(?=\()/g,"test"),at("function test() {return '-';}"+t)):n==="javascript"&&at("function test() {"+t+" }"),!0}catch(a){return!1}}function _t(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{allowadd:t.allowadd==="1",allowcancel:t.allowcancel==="1",allowedit:t.allowedit==="1",allowsingle:t.allowsingle==="1",batchcids:safeParseArray(t.batchcids),hidenumber:t.hidenumber==="1",rowheight:Number(t.rowheight||0),blankrow:Number(t.blankrow||1),enablelimit:t.enablelimit==="1",min:t.enablelimit==="1"?Number(t.min||0):void 0,max:t.enablelimit==="1"?Number(t.max||1e3):void 0,rownum:Number(t.rownum||15),showtype:t.showtype||"1",uniqueControlIds:safeParse(t.uniquecontrols,"arrray")}}function dt(t){var n=SYSTEM_CONTROLS.map(function(a){return a.controlId});return _.some(t.map(function(a){return _.includes(n,a.controlId)}))||(t=t.concat(SYSTEM_CONTROLS)),t}function Et(t){var n=t.appId,a=t.worksheetId,o=t.viewId;return md.global.Config.WebUrl+"app/"+n+"/newrecord/"+a+"/"+o+"/"}function vt(t,n,a){var o=he(n);if(_.isUndefined(a))return _.sortBy(t,"addTime");var s=_.sortBy(t,function(E){return o==="NUMBER"?parseFloat(E[n.controlId]):renderCellText(_extends({},n,{value:E[n.controlId]}))});return a||(s=s.reverse()),s}function Tt(t){return`1234567890-=!@#$%^&*()_+[];',./{}|:"<>?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz`.indexOf(t)>-1}function gt(t){var n=void 0;try{_.includes([WIDGETS_TO_API_TYPE_ENUM.SIGNATURE,WIDGETS_TO_API_TYPE_ENUM.SUB_LIST],t.type)?n=t.value:t.type===WIDGETS_TO_API_TYPE_ENUM.ATTACHMENT?n=safeParse(t.value).map(function(a){return""+a.originalFilename+a.ext+"("+a.previewUrl+")"}).join(","):t.type===WIDGETS_TO_API_TYPE_ENUM.RELATION?n=safeParse(t.value).map(function(a){return"["+{1:_l("\u4EFB\u52A1"),2:_l("\u9879\u76EE"),3:_l("\u65E5\u7A0B"),4:_l("\u6587\u4EF6"),5:_l("\u7533\u8BF7\u5355"),6:"",7:_l("\u65E5\u7A0B")}[a.type]+"]"+a.name+"("+a.link+")"}).join(","):_.includes([WIDGETS_TO_API_TYPE_ENUM.SCORE],t.type)?n=t.value:n=renderCellText(t)}catch(a){}return n}function Pt(t,n){var a=gt(t);window.tempCopyForSheetView=_JSON$stringify({type:"text",value:a,controlType:t.type,tableId:n}),copy(a)}function Ot(t,n){return _.includes([15,16],t)&&_.includes([15,16],n)?!0:t===n}function yt(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};_.includes([WIDGETS_TO_API_TYPE_ENUM.MOBILE_PHONE,WIDGETS_TO_API_TYPE_ENUM.NUMBER,WIDGETS_TO_API_TYPE_ENUM.FLAT_MENU,WIDGETS_TO_API_TYPE_ENUM.MULTI_SELECT,WIDGETS_TO_API_TYPE_ENUM.DROP_DOWN,WIDGETS_TO_API_TYPE_ENUM.DATE,WIDGETS_TO_API_TYPE_ENUM.DATE_TIME,WIDGETS_TO_API_TYPE_ENUM.USER_PICKER,WIDGETS_TO_API_TYPE_ENUM.DEPARTMENT,WIDGETS_TO_API_TYPE_ENUM.SCORE,WIDGETS_TO_API_TYPE_ENUM.RELATE_SHEET,WIDGETS_TO_API_TYPE_ENUM.CASCADER,WIDGETS_TO_API_TYPE_ENUM.SWITCH,WIDGETS_TO_API_TYPE_ENUM.RICH_TEXT,WIDGETS_TO_API_TYPE_ENUM.TIME,WIDGETS_TO_API_TYPE_ENUM.ORG_ROLE,WIDGETS_TO_API_TYPE_ENUM.LOCATION],t.type)?a(n.value):_.includes([WIDGETS_TO_API_TYPE_ENUM.AREA_PROVINCE,WIDGETS_TO_API_TYPE_ENUM.AREA_CITY,WIDGETS_TO_API_TYPE_ENUM.AREA_COUNTY],t.type)&&a(safeParse(n.value).code)}function Mt(){var t=void 0,n=document.createElement("div");return n.style="position: absolute; left: -10000px; top: -10000px; width: 100px; height: 100px; overflow: scroll;",n.innerHTML='<div style="width: 100px;height:200px"></div>',document.body.appendChild(n),t=n.offsetWidth-n.clientWidth,document.body.removeChild(n),t||10}function Dt(t){return t==21?21:t===RECORD_INFO_FROM.CHAT||t===RECORD_INFO_FROM.WORKSHEET_ROW_LAND&&location.search&&location.search.indexOf("share")>-1||_.get(window,"shareState.isPublicView")||_.get(window,"shareState.isPublicPage")||_.get(window,"shareState.isPublicWorkflowRecord")||_.get(window,"shareState.isPublicRecord")||_.get(window,"shareState.isPublicPrint")?3:1}function mt(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=null,o=0;o<n.length;o++){var s=n[o];if(s.workSheetId==t){a=s;break}if(s.type===2&&(a=mt(t,s.items),a))break}return a}function pt(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=null,o=0;o<t.length;o++){var s=t[o];if(s.type===2){if(a=pt(s.items,n),a)break}else if(n||[1,4].includes(s.status)&&!s.navigateHide){a=s.workSheetId;break}}return a}function Rt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(function(n){return _.pick(n,["controlId","dataType","spliceType","filterType","dateRange","value","values","minValue","maxValue"])})}function Ct(t,n){var a=0;try{var o=void 0,s=safeParse(t,"array");_.isUndefined(_.get(s,"0.count"))?_.isUndefined(n)?o=s[0].count||s.length:o=n:o=s[0].count,!_.isUndefined(o)&&!_.isNaN(Number(o))&&(a=Number(o))}catch(E){}return String(t).startsWith("deleteRowIds")?0:a}var At=function(){var t=(0,X.Z)(De().mark(function n(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},w;return De().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(ie().get(window,"shareState.isPublicForm")?ee.Z:re.Z).getToken(o);case 2:if(w=Z.sent,w){Z.next=5;break}return Z.abrupt("return",_e().reject("\u83B7\u53D6token\u5931\u8D25"));case 5:return Z.abrupt("return",x.Z.post(a,J()({},s,{token:w,accountId:ie().get(window,"shareState.isPublicForm")?"user-publicform":md.global.Account.accountId}),E));case 6:case"end":return Z.stop()}},n,this)}));return function(a){return t.apply(this,arguments)}}(),wt=function(){var t=(0,X.Z)(De().mark(function n(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},w;return De().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(ie().get(window,"shareState.isPublicForm")?ee.Z:re.Z).getToken(o);case 2:if(w=Z.sent,w){Z.next=5;break}return Z.abrupt("return",_e().reject("\u83B7\u53D6token\u5931\u8D25"));case 5:return Z.abrupt("return",x.Z.get(a,(0,Ie.default)({},E,{params:(0,Ie.default)({},s,{token:w,accountId:ie().get(window,"shareState.isPublicForm")?"user-publicform":md.global.Account.accountId})})));case 6:case"end":return Z.stop()}},n,this)}));return function(a){return t.apply(this,arguments)}}();function Nt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments[1];n=n||t.name||"file";function a(o){var s=document.createElement("a");s.href=o,s.download=n,s.click()}a(typeof t=="string"?t:URL.createObjectURL(t))}var Lt=function(n,a){var o=JSON.parse(localStorage.getItem("mdAppCache_"+md.global.Account.accountId+"_"+n))||{},s=o.worksheets.map(function(E){return E.groupId===a&&(E.worksheetId=""),E});o.worksheets=s,o.lastWorksheetId="",safeLocalStorageSetItem("mdAppCache_"+md.global.Account.accountId+"_"+n,_JSON$stringify(o))};function bt(t){var n=t.controlId,a=t.controls,o=t.colorItems,s=t.row,E=_.find(a,{controlId:n});if(!(!E||E.enumDefault2!==1)&&s[E.controlId]){var w=safeParse(s[E.controlId])[0];w&&typeof w=="string"&&w.startsWith("other")&&(w="other");var B=E.options.find(function(z){return z.key===w&&(o===""||_.includes(o,z.key))}),Z=B&&B.color&&generate(B.color)[0];return B&&B.color&&{color:B.color,lightColor:isLightColor(B.color)?Z:tinycolor(Z).setAlpha(.8).toRgbString()}}}function Ut(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=_.get(t,"advancedSetting.colorid"),a=_.get(t,"advancedSetting.coloritems")?safeParse(_.get(t,"advancedSetting.coloritems"),"array"):"",o=_.get(t,"advancedSetting.colortype");return n&&{controlId:n,colorItems:a,showLine:_.includes([RECORD_COLOR_SHOW_TYPE.LINE,RECORD_COLOR_SHOW_TYPE.LINE_BG],o),showBg:_.includes([RECORD_COLOR_SHOW_TYPE.BG,RECORD_COLOR_SHOW_TYPE.LINE_BG],o)}}function Wt(t){var n=t.rows,a=t.keywords,o=a===void 0?"":a,s=t.controls;return o?n.filter(function(E){return s.filter(function(w){return w.controlId.length===24}).map(function(w){return renderCellText(_extends({},w,{value:E[w.controlId]||""}))}).join("").toLocaleLowerCase().indexOf(o.toLocaleLowerCase())>-1}):n}function St(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.needEncode,s=o===void 0?!0:o,E=a.expireTime,w=t,B=n;return s&&(w=ge.Base64.encode(t),B=ge.Base64.encode(n)),ve.Z.add({key:w,value:B,expireTime:E||A()(new Date(Date.now()+3*24*60*60*1e3)).format("YYYY-MM-DD HH:mm:ss")})}function xt(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.needEncode,o=a===void 0?!0:a,s=t;return o&&(s=Base64.encode(t)),webCache.get({key:s}).then(function(E){return E?Base64.decode(E):""})}function It(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.needEncode,o=a===void 0?!0:a,s=t;return o&&(s=Base64.encode(t)),webCache.clear({key:s},{silent:!0})}var Yt=function(n){var a=getRequest(),o=_.isObject(n.requestParams)?_extends({},n.requestParams):{};return _.isEmpty(a)?n:(_Object$keys(a).forEach(function(s){_.isArray(a[s])?o[s.trim()]=a[s][a[s].length-1]:a[s]!==null&&(o[s.trim()]=a[s])}),_extends({},n,{requestParams:o}))},Bt=function(n){var a=n,o="#fff";return n==="transparent"&&(o="#333",a="#ccc"),{backgroundColor:n||"#2196f3",borderColor:a,color:o}},ht=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n){var o=a[n];o&&/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(o.replace(/\? /,""))&&window.open(o)}},Gt=function(n,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},s=_.get(n,"advancedSetting.clicktype")||VIEW_CONFIG_RECORD_CLICK_ACTION.OPEN_RECORD;if(s===VIEW_CONFIG_RECORD_CLICK_ACTION.OPEN_RECORD)o();else if(s===VIEW_CONFIG_RECORD_CLICK_ACTION.OPEN_LINK){var E=_.get(n,"advancedSetting.clickcid");ht(E,a)}};function tt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];try{return t.filter(function(n){return!(n.rowid||"").startsWith("empty")})}catch(n){return console.error(n),[]}}function kt(t,n){alert(t===11?_l("\u7F16\u8F91\u5931\u8D25\uFF0C%0\u4E0D\u5141\u8BB8\u91CD\u590D",n?n.controlName:""):t===31?_l("\u8BB0\u5F55\u63D0\u4EA4\u5931\u8D25\uFF1A\u6709\u5FC5\u586B\u5B57\u6BB5\u672A\u586B\u5199"):t===22?_l("\u8BB0\u5F55\u63D0\u4EA4\u5931\u8D25\uFF1A\u5B50\u8868\u5B57\u6BB5\u5B58\u5728\u91CD\u590D\u6570\u636E"):_l("\u7F16\u8F91\u5931\u8D25\uFF01"),2)}function Kt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.control,a=t.badData,o=a===void 0?[]:a;if(o[0]){var s=o[0].split(":"),E=_slicedToArray(s,3),w=E[0],B=E[1],Z=E[2],z=n.store.getState().rows,Q=tt(z).filter(function(ue){return Z.indexOf("-")>-1?(ue[B]||"").indexOf(Z)>-1:(ue[B]||"")===Z}).map(function(ue){return ue.rowid});return Q.length?{controlId:w,error:Q.map(function(ue){return _defineProperty({},ue+"-"+B,FORM_ERROR_TYPE_TEXT.UNIQUE())}).reduce(function(ue,Oe){return _extends({},ue,Oe)})}:{}}}var Ft=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return window["langData-"+n]?a.map(function(o){var s=getTranslateInfo(n,o.controlId),E=_extends({},o,{controlName:s.name||o.controlName,hint:s.hintText||o.hint});return o.type===10010?E.dataSource=s.remark||o.dataSource:E.desc=s.description||o.desc,E}):a},jt=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return window["langData-"+n]?a.map(function(o){var s=getTranslateInfo(n,o.btnId);return _extends({},o,{name:s.name||o.name,desc:s.description||o.desc})}):a};function Ht(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function $t(t){return t.filter(function(n){return _.includes(HAVE_VALUE_STYLE_WIDGET,n.type===30?n.sourceControlType:n.type)}).map(function(n){return{controlId:n.controlId,valueStyle:getValueStyle(_extends({},n,{value:" "})).valueStyle}}).filter(function(n){return n.valueStyle}).map(function(n){return`
    .control-val-`+n.controlId+` {
      > span:not(.editIcon), > a, .worksheetCellPureString, .titleText, &.titleText {
        `+n.valueStyle+`
      }
    }
  `})}function Vt(t){return String(t.viewType)===VIEW_DISPLAY_TYPE.structure&&_.includes([0,1],Number(t.childType))||String(t.viewType)===VIEW_DISPLAY_TYPE.gunter}},22013:(Ge,Se,u)=>{u.d(Se,{Z:()=>De});var oe=u(17187),Me=u.n(oe),J=u(53894),q=u(22010),_e=u(88613);function me(Ie){var X=Ie.dispatch;return function(G){return function(D){return D&&D.then?D.then(X):G(D)}}}function Pe(Ie){return function(X){var G=X.dispatch;return function(D){return function(Y){D(Y),Ie.emit(Y.type,Y)}}}}var Te={post:{fontSize:parseInt(window.localStorage.getItem(md.global.Account.accountId+"_fontsize")||13,10)},appPkg:{}};function ye(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Te,X=new(Me()),G=[J.Z,me,Pe(X)],D=[];if(0)var Y;var U=(0,q.MT)((0,_e.R)(),Ie,q.qC.apply(void 0,[q.md.apply(void 0,G)].concat(D)));return U.emitter=X,U}const De=ye()}}]);
