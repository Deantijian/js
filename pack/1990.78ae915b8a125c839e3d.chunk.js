"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[1990],{21990:(qe,P,d)=>{d.r(P),d.d(P,{default:()=>Le});var oe=d(8177),le=d.n(oe),se=d(63239),ie=d.n(se),ce=d(88902),A=d.n(ce),L=d(85315),fe=d(52945),S=d.n(fe),ue=d(12424),pe=d(46593),H=d.n(pe),de=d(85105),Y=d.n(de),W=d(99663),j=d(22600),U=d(49135),z=d(93196),me=d(45697),N=d.n(me),t=d(67294),he=d(33867),ve=d(47426),F=d(54208),ge=d(43727),ye=d(93967),y=d.n(ye),ke=d(30381),I=d.n(ke),Ne=d(99924),x=d(45231),Ee=d(96213),J=d(83298),we=d(63047),Z,Q,G,Ie=(Q=Z=function(T){(0,z.default)(m,T);function m(o){(0,W.default)(this,m);var n=(0,U.default)(this,(m.__proto__||Y()(m)).call(this,o));G.call(n);var s=[];if(o.controlOption==="all"){s.splice(0,s.length);var i=o.reqInfo,e=i===void 0?{}:i,a=e.controls,r=a===void 0?[]:a,f=e.formControls,l=f===void 0?[]:f;r.filter(function(u){return!u.printHide}).forEach(function(u,c){u&&u.controlId&&s.push(u.controlId)}),n.props.worksheetId||l.forEach(function(u){u.tempControls.filter(function(c){return c.needEvaluate}).length>0&&s.push("formDetailEvaluate-"+u.formId)})}else s=o.controlOption;return n.state={controlOption:s,options:o.options||{},printCheckAll:n.props.printCheckAll!==!1,processOption:window.localStorage.getItem("hrPrintProcessOption")||"all",reqInfo:o.reqInfo||{},task:o.task,workflow:o.workflow},n}return(0,j.default)(m,[{key:"toggleTaskCheckItem",value:function(n){var s=this.state.task,i=s.map(function(e){return e.key===n&&(e.show=!e.show),e});this.setState({task:i})}},{key:"toggleWorkflowCheckItem",value:function(n){var s=this.state.workflow,i=s.map(function(e){return e.flowNode.id===n&&(e.show=!e.show),e});this.setState({workflow:i})}},{key:"renderApprovalFlow",value:function(){var n=this;return t.createElement("div",{className:"processOption"},t.createElement("span",{className:"Block Font13 Gray_9e mBottom16"},_l("\u6253\u5370\u6D41\u7A0B")),t.createElement("div",{className:"processOptionItem mBottom6 pointer",onClick:function(){n.setState({processOption:"all"})}},t.createElement("input",{type:"radio",className:"mRight6 TxtMiddle",name:"processOption",checked:this.state.processOption==="all"}),t.createElement("span",{className:"Font13 Gray mRight10 TxtMiddle"},_l("\u5B8C\u6574\u6A21\u5F0F")),t.createElement("span",{className:"Font12 Gray_9e TxtMiddle"},_l('\u4F1A\u4FDD\u7559\u5B8C\u6574\u7684\u6D41\u7A0B\u5185\u5BB9\uFF0C\u5305\u62EC"\u67E5\u770B\u7533\u8BF7"\u7B49\u8282\u70B9\u4FE1\u606F'))),t.createElement("div",{className:"processOptionItem mBottom6 pointer",onClick:function(){n.setState({processOption:"some"})}},t.createElement("input",{type:"radio",className:"mRight6 TxtMiddle",name:"processOption",checked:this.state.processOption==="some"}),t.createElement("span",{className:"Font13 Gray TxtMiddle mRight10"},_l("\u7CBE\u7B80\u6A21\u5F0F")),t.createElement("span",{className:"Font12 Gray_9e TxtMiddle"},_l('\u53EA\u4F1A\u4FDD\u7559\u6D41\u7A0B\u7684\u5173\u952E\u5185\u5BB9\uFF0C\u7C7B\u4F3C"\u901A\u8FC7\u5BA1\u6279"\u6216"\u5426\u51B3\u5BA1\u6279"\u7B49\u5173\u952E\u8282\u70B9\u4FE1\u606F'))),t.createElement("div",{className:"processOptionItem Pointer pointer",onClick:function(){n.setState({processOption:"no"})}},t.createElement("input",{type:"radio",className:"mRight6 TxtMiddle",name:"processOption",checked:this.state.processOption==="no"}),t.createElement("span",{className:"Font13 Gray TxtMiddle mRight10"},_l("\u4E0D\u6253\u5370"))))}},{key:"renderWorkflow",value:function(){var n=this,s=this.state.workflow;return t.createElement("div",{className:"controlOption mBottom32"},t.createElement("span",{className:"Block Font13 Gray_9e mBottom16"},""+_l("\u6D41\u7A0B\u4E2D\u7684\u8282\u70B9\u5185\u5BB9")),s.map(function(i){return t.createElement("div",{className:"controlOptionItem mBottom15 InlineBlock pointer",key:i.flowNode.id,title:i.flowNode.name,onClick:function(){n.toggleWorkflowCheckItem(i.flowNode.id)}},t.createElement("input",{type:"checkbox",onChange:function(){},checked:i.show,className:"TxtMiddle"}),t.createElement("span",{className:"TxtMiddle"},i.flowNode.name))}))}},{key:"renderTask",value:function(){var n=this,s=this.state.task;return t.createElement("div",{className:"controlOption mBottom32"},t.createElement("span",{className:"Block Font13 Gray_9e mBottom16"},_l("\u4EFB\u52A1")),s.map(function(i){return t.createElement("div",{className:"controlOptionItem mBottom15 InlineBlock pointer",key:i.key,title:i.name,onClick:function(){n.toggleTaskCheckItem(i.key)}},t.createElement("input",{type:"checkbox",onChange:function(){},checked:i.show,className:"TxtMiddle"}),t.createElement("span",{className:"TxtMiddle"},i.name))}))}},{key:"render",value:function(){var n=this,s=this.state.options,i=this.props.type;return t.createElement(we.Z,{className:"approvalPrintDialog",visible:this.props.visible,width:760,overlayClosable:!1,title:_l("\u8BBE\u7F6E\u6253\u5370\u5185\u5BB9\u663E\u9690"),okText:_l("\u786E\u8BA4"),onOk:function(){var a=[],r=0;if(n.state.reqInfo.formControls&&n.state.reqInfo.formControls.forEach(function(f){f.tempControls.filter(function(l){return l.needEvaluate}).length>0&&r++}),n.state.controlOption.length===n.state.reqInfo.controls.filter(function(f){return!f.printHide}).length+r?a="all":a=n.state.controlOption,a!=="all"&&a.length===0)return alert(_l("\u6253\u5370\u5B57\u6BB5\u4E0D\u53EF\u4E3A\u7A7A"),3),!1;safeLocalStorageSetItem("hrPrintProcessOption",n.state.processOption),n.props.changePrintVisible(n.state.processOption,n.state.printCheckAll,n.state.controlOption,s),i==="task"&&n.props.onUpdateTask(n.state.task),i==="workflow"&&n.props.onUpdateWorkflow(n.state.workflow),alert(_l("\u4FEE\u6539\u6210\u529F"))},onCancel:function(){n.props.hidePrintOptDialog()}},this.props.type==="task"&&this.renderTask(),this.state.reqInfo.controls.filter(function(e){return!e.printHide}).length>0&&t.createElement("div",{className:"controlOption mBottom32"},t.createElement("span",{className:"Block Font13 Gray_9e mBottom16"},_l("\u81EA\u5B9A\u4E49\u5B57\u6BB5\u5185\u5BB9")),this.state.reqInfo.controls.sort(function(e,a){return e.row===a.row?e.col-a.col:e.row-a.row}).map(function(e,a){return!e.printHide&&t.createElement("div",{className:"controlOptionItem mBottom15 InlineBlock pointer",key:a,title:e.type===22?_l("\u5206\u6BB5"):e.controlName,onClick:function(){n.toggleCheckItem(e.controlId)}},t.createElement("input",{type:"checkbox",onChange:function(){},checked:n.state.controlOption.indexOf(e.controlId)>-1,className:"TxtMiddle"}),t.createElement("span",{className:"TxtMiddle"},e.type===22?e.controlName?e.controlName:_l("\u5206\u6BB5"):e.controlName))}),this.props.worksheetId&&t.createElement("div",{className:"controlOptionItem mBottom15 InlineBlock pointer",onClick:function(){n.setState({options:S()({},s,{showWorkflowQrCode:!s.showWorkflowQrCode})})}},t.createElement("input",{type:"checkbox",onChange:function(){},checked:s.showWorkflowQrCode}),t.createElement("span",{className:"TxtMiddle"},_l("\u4E8C\u7EF4\u7801"))),t.createElement("div",{className:"formDetailEvaluate"},this.state.reqInfo.formControls&&this.state.reqInfo.formControls.map(function(e,a){return e.tempControls.filter(function(r){return r.needEvaluate}).length>0&&e.tempControls.filter(function(r){return!r.printHide}).length>0&&t.createElement("div",{className:"controlOptionItem mBottom15 InlineBlock pointer",key:a,title:n.state.reqInfo.controls.filter(function(r){return r.controlId===e.formId}).length>0&&n.state.reqInfo.controls.filter(function(r){return r.controlId===e.formId})[0].controlName+"\u7EDF\u8BA1",onClick:function(){n.toggleCheckItem("formDetailEvaluate-"+e.formId)}},t.createElement("input",{type:"checkbox",onChange:function(){},checked:n.state.controlOption.indexOf("formDetailEvaluate-"+e.formId)>-1,className:"TxtMiddle"}),t.createElement("span",{className:"TxtMiddle"},n.state.reqInfo.controls.filter(function(r){return r.controlId===e.formId}).length>0&&n.state.reqInfo.controls.filter(function(r){return r.controlId===e.formId})[0].controlName+"\u7EDF\u8BA1"))}))),this.props.type==="hr"&&this.renderApprovalFlow(),this.props.type==="workflow"&&this.renderWorkflow())}}]),m}(t.Component),Z.propTypes={visible:N().any,reqInfo:N().any,printCheckAll:N().any,controlOption:N().any,changePrintVisible:N().any,processOption:N().any,worksheetId:N().string,hidePrintOptDialog:N().func,type:N().string,task:N().any,workflow:N().any,options:N().any},G=function(){this.toggleCheckItem=function(m){var o=this.state.controlOption,n=o.indexOf(m),s=0,i=this.state.reqInfo,e=i===void 0?{}:i;e.formControls&&e.formControls.forEach(function(a){a.tempControls.filter(function(r){return r.needEvaluate}).length>0&&s++}),n>-1?o.splice(n,1):o.push(m),o.length===(e.controls||[]).filter(function(a){return!a.printHide}).length+s?this.setState({controlOption:o,printCheckAll:!0}):this.setState({controlOption:o,printCheckAll:!1})}.bind(this),this.toggleCheckAll=function(){var m=this.state.controlOption;this.state.printCheckAll?this.setState({controlOption:[],printCheckAll:!1}):(m.splice(0,m.length),this.state.reqInfo.controls.filter(function(o){return!o.printHide}).forEach(function(o,n){o&&o.controlId&&m.push(o.controlId)}),this.state.reqInfo.formControls&&this.state.reqInfo.formControls.forEach(function(o){o.tempControls.filter(function(n){return n.needEvaluate}).length>0&&m.push("formDetailEvaluate-"+o.formId)}),this.setState({controlOption:m,printCheckAll:!0}))}.bind(this)},Q),Te=d(89499),Se=[{key:"parent",name:_l("\u6BCD\u4EFB\u52A1"),show:!0,independent:!1,value:""},{key:"startTime",name:_l("\u8BA1\u5212\u5F00\u59CB")+"-"+_l("\u8BA1\u5212\u7ED3\u675F"),show:!0,independent:!1,value:""},{key:"actualStartTime",name:_l("\u5B9E\u9645\u5F00\u59CB")+"-"+_l("\u5B9E\u9645\u7ED3\u675F"),show:!0,independent:!1,value:""},{key:"charger",name:_l("\u4E3B\u8D1F\u8D23\u4EBA"),show:!0,independent:!1,value:""},{key:"member",name:_l("\u4EFB\u52A1\u53C2\u4E0E\u8005"),show:!0,independent:!1,value:""},{key:"tag",name:_l("\u6807\u7B7E"),show:!0,independent:!1,value:""},{key:"desc",name:_l("\u4EFB\u52A1\u63CF\u8FF0"),show:!0,independent:!1,value:""},{key:"checklist",name:_l("\u68C0\u67E5\u6E05\u5355"),show:!0,independent:!0,value:""},{key:"subTask",name:_l("\u5B50\u4EFB\u52A1"),show:!0,independent:!0,value:""},{key:"code",name:_l("\u4E8C\u7EF4\u7801"),show:!0,independent:!0,value:""}];const Ce={task:Se};var De=d(3177),be=d.n(De),C=d(15577),xe=d(96486),E=d.n(xe),Ke,Xe,b,q,K,X;function Oe(T,m,o,n,s){var i={};return Object.keys(n).forEach(function(e){i[e]=n[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce(function(e,a){return a(T,m,e)||e},i),s&&i.initializer!==void 0&&(i.value=i.initializer?i.initializer.call(s):void 0,i.initializer=void 0),i.initializer===void 0&&(Object.defineProperty(T,m,i),i=null),i}var Me=be().cn,Re=Ce.task,Be=[{controlId:"ownerid",controlName:_l("\u62E5\u6709\u8005"),type:26},{controlId:"caid",controlName:_l("\u521B\u5EFA\u4EBA"),type:26},{controlId:"ctime",controlName:_l("\u521B\u5EFA\u65F6\u95F4"),type:16},{controlId:"utime",controlName:_l("\u6700\u8FD1\u4FEE\u6539\u65F6\u95F4"),type:16}],Pe=function(m){return Re.map(function(o){return o.key==="startTime"?o.value=m.startTime+" - "+m.deadline:o.key==="actualStartTime"?o.value=m.actualStartTime+" - "+m.completedTime:o.key==="member"?o.value=m.member.join("\u3001"):o.key==="tag"?o.value=m.tag.join("\u3001"):o.key==="desc"?o.value=t.createElement("span",{dangerouslySetInnerHTML:{__html:(0,C.Qu)(m.desc)}}):o.value=m[o.key],o})},Ae=(b=(K=q=function(T){(0,z.default)(m,T);function m(o){(0,W.default)(this,m);var n=(0,U.default)(this,(m.__proto__||Y()(m)).call(this,o));X.call(n);var s=o.match.params;return n.state={reqId:s.typeId,type:s.printType,processOption:window.localStorage.getItem("hrPrintProcessOption")||"all",configOptions:{showWorkflowQrCode:!0},formDetail:{},workList:[],controls:[],signatureControls:[],formControls:[],logo:"",detailsType:2,showPrintDialog:!1,controlOption:"all",reqInfo:{},reqWorks:{},printCheckAll:!0,fontSize:14,appId:window.location.search.slice(1).split("&&")[0],viewId:window.location.search.slice(1).split("&&")[1],worksheetId:window.location.search.slice(1).split("&&")[2],projectId:window.location.search.slice(1).split("&&")[3],workSheetGetType:window.location.search.slice(1).split("&&")[4]||1,sheetInfo:{},rowInfo:[],task:[],workflow:[]},n}return(0,j.default)(m,[{key:"initWorksheet",value:function(){var n=this;document.title=_l("\u8BB0\u5F55\u6253\u5370")+" - "+_l("\u5DE5\u4F5C\u8868");var s={worksheetId:this.state.worksheetId,getTemplate:!1},i={rowId:this.state.reqId,appId:this.state.appId,viewId:this.state.viewId,worksheetId:this.state.worksheetId,getType:this.state.workSheetGetType},e=this.state.projectId&&E().find(md.global.Account.projects,function(a){return a.projectId===n.state.projectId})?Ne.Z.getSysColor({projectId:this.state.projectId}):H().resolve({logo:md.global.Config.Logo});H().all([x.Z.getWorksheetInfo(s),x.Z.getRowByID(i),e]).then(function(a){var r=(0,ue.Z)(a,3),f=r[0],l=r[1],u=r[2],c=l.receiveControls.filter(function(g){return g.type===42});l.receiveControls=l.receiveControls.filter(function(g){return g.type!==42});var p=E().groupBy(l.receiveControls,function(g){return g.row}),v=E().find(l.receiveControls,function(g){return g.attribute===1}),k=l.receiveControls.filter(function(g){return g.type===29&&g.enumDefault===2});k.forEach(function(g){return n.loadRowRelationRows({appId:n.state.appId,worksheetId:n.state.worksheetId,rowId:n.state.reqId,control:g})}),n.setState({logo:u.logo,rowInfo:{controls:l.receiveControls,shortUrl:l.shortUrl},printTitle:v&&(0,J.Z)(v)||_l("\u672A\u547D\u540D"),controls:p,signatureControls:c,sheetInfo:{name:f.name,ownerAccount:l.ownerAccount,updateTime:l.updateTime},reqInfo:{title:l.titleName},relateRecords:{}}),n.loadWorksheetShortUrl(n.state.appId,i.worksheetId,n.state.viewId,i.rowId)})}},{key:"loadRowRelationRows",value:function(n){var s=this,i=n.appId,e=n.worksheetId,a=n.rowId,r=n.control;x.Z.getRowRelationRows({appId:i,worksheetId:e,rowId:a,controlId:r.controlId,pageIndex:1,pageSize:1e5,getWorksheet:!0}).then(function(f){var l=S()({},s.state.relateRecords);l[r.controlId]=f,s.setState({relateRecords:l})}).catch(function(f){})}},{key:"loadWorksheetShortUrl",value:function(n,s,i,e){var a=this;x.Z.getWorksheetShareUrl({worksheetId:s,appId:n,viewId:i,rowId:e,objectType:2}).then(function(r){a.setState({rowInfo:S()({},a.state.rowInfo,{shortUrl:r})})})}},{key:"initTask",value:function(){var n=this;document.title=_l("\u4EFB\u52A1\u6253\u5370"),Ee.Z.getTaskDetail4Print({taskId:this.state.reqId}).then(function(s){var i=s.data,e=E().groupBy(i.controls,"row"),a=md.global.Config.AjaxApiUrl+"code/CreateQrCodeImage?url="+encodeURIComponent(md.global.Config.WebUrl+"apps/task/task_"+n.state.reqId);n.setState({task:Pe(i),logo:a,reqInfo:{title:(0,C.Qu)(i.taskName),reqNo:(0,C.Qu)(i.folder)||_l("\u672A\u5173\u8054\u9879\u76EE"),controls:i.controls,formControls:[]},controls:e})})}},{key:"renderRecordAttachments",value:function(n,s){var i=void 0;try{i=JSON.parse(n)}catch(r){return t.createElement("span",{className:"mBottom5 InlineBlock",dangerouslySetInnerHTML:{__html:"&nbsp;"}})}var e=i.filter(function(r){return File.isPicture(r.ext)}),a=i.filter(function(r){return!File.isPicture(r.ext)});return t.createElement("div",{className:y()("recordAttachments",{isMultiple:s})},!!e.length&&t.createElement("div",{className:y()("recordAttachmentPictures",{bottomNoLine:!a.length})},[].concat((0,L.Z)(new Array(s?e.length:Math.ceil(e.length/2)*2))).map(function(r,f){return t.createElement("div",{className:"pictureAttachment"},e[f]&&t.createElement("div",{className:"imgCon"},t.createElement("img",{src:e[f].previewUrl.slice(0,e[f].previewUrl.indexOf("?"))+"?imageMogr2/auto-orient/thumbnail/1200x600/q/90",alt:""})))})),s?t.createElement("div",{className:"recordAttachmentPictures"},a.map(function(r){return t.createElement("div",{className:"pictureAttachment onlyText"},t.createElement("p",{className:"imageAttachmentName ellipsis"}," ",r.originalFilename+r.ext," "))})):t.createElement("div",{className:"otherAttachments mTop4"},t.createElement("div",{className:"pictureAttachment"},a.map(function(r){return r.originalFilename+r.ext}).join(", "))))}},{key:"renderTable",value:function(n,s){var i=this,e=this.state.detailsType,a=s.showControls.map(function(r){return E().find(n.template.controls.concat(Be),function(f){return f.controlId===r})}).filter(function(r){return r&&!(r.type===29&&r.enumDefault===2||r.type===41)});return e===2?t.createElement("table",{className:"detailsTable",style:{tableLayout:"fixed"},cellpadding:"0",cellspacing:"0"},t.createElement("tr",null,[t.createElement("td",{width:"20"})].concat(a.map(function(r){return t.createElement("th",{style:r.type===14?{width:200}:{}},r.controlName||"")}))),n.data.map(function(r,f){return t.createElement("tr",null,[t.createElement("td",null," ",f+1," ")].concat(a.map(function(l){return t.createElement("td",{className:"textPreLine"},i.getShowContent(S()({},l,{value:r[l.controlId],isRelateMultipleSheet:!0})))})))})):t.createElement("div",{className:"verticalLayout"},n.data.map(function(r,f){return t.createElement("table",{className:"detailItem",cellpadding:"0",cellspacing:"0",style:{tableLayout:"fixed"}},E().chunk(a,4).map(function(l,u){return t.createElement("tr",{className:"detailItemControlRow"},u===0&&t.createElement("td",{rowSpan:Math.ceil(a.length/4),width:"30",className:"detailRowItem verticalLayoutRowNum"},f+1),[].concat((0,L.Z)(new Array(4))).map(function(c,p){return t.createElement("td",{className:"detailRowItem"},t.createElement("span",{className:"Bold TxtMiddle mLeft10"},l[p]&&(l[p].controlName||"")),t.createElement("span",{className:"detailValue TxtMiddle mLeft20"},l[p]&&i.getShowContent(S()({},l[p],{value:r[l[p].controlId],isRelateMultipleSheet:!0}))))}))}))}))}},{key:"renderTaskItem",value:function(n,s,i,e){return t.createElement("tr",{className:"row clearfix Relative notDetails",key:i},t.createElement("td",{className:"noHalf rowItem BorderRight0 taskRowItem",colSpan:1},t.createElement("span",{className:"controlName TxtMiddle"},n),t.createElement("span",{className:y()("controlValue TxtMiddle",e),style:{width:"calc(100% - 150px)"}},s)))}},{key:"renderTaskHeader",value:function(){var n=this,s=this.state.task;return t.createElement("table",{className:"formDetail mBottom32",cellPadding:"0",cellSpacing:"0",style:{fontSize:this.state.fontSize}},t.createElement("tbody",null,s.map(function(i){return i.show&&!i.independent&&n.renderTaskItem(i.name,i.value,i.key)})))}},{key:"renderTaskInventory",value:function(){var n=this,s=this.state.task,i=s.filter(function(a){return a.key==="checklist"})[0],e=i.value;return e.map(function(a,r){return t.createElement("div",{className:"workDetail clearfix",style:{display:i.show?"block":"none"},key:r},t.createElement("div",{className:"workName Bold"},t.createElement("h3",null,a.checkListName+" "+a.checkListData.reduce(function(f,l){return f+(l.status?1:0)},0)+"/"+a.checkListData.length)),t.createElement("div",{className:"workPersons"},t.createElement("table",{className:"formDetail taskInventory",cellPadding:"0",cellSpacing:"0",style:{fontSize:n.state.fontSize}},t.createElement("tbody",null,a.checkListData.map(function(f,l){return n.renderTaskItem(l+1,f.name,l,f.status?"lineThrough":"")}))),a.checkListData.length?void 0:t.createElement("div",{style:{borderBottom:"1px solid #555"}})))})}},{key:"renderTaskSubTask",value:function(){var n=this,s=this.state.task,i=s.filter(function(r){return r.key==="subTask"})[0],e=i.value,a=e.reduce(function(r,f){return r+(f.status?1:0)},0);return t.createElement("div",{className:"workDetail clearfix",style:{display:i.show?"block":"none"}},t.createElement("div",{className:"workName Bold"},t.createElement("h3",null,i.name+" "+a+"/"+e.length)),t.createElement("div",{className:"workPersons"},t.createElement("table",{className:"formDetail taskSubTask",cellPadding:"0",cellSpacing:"0",style:{fontSize:this.state.fontSize}},t.createElement("tbody",null,e.map(function(r,f){return n.renderTaskItem(f+1,r.name,f,r.status?"lineThrough":"")}))),e.length?void 0:t.createElement("div",{style:{borderBottom:"1px solid #555"}})))}},{key:"renderControls",value:function(){var n=this,s=A()(this.state.controls).filter(function(e){return n.state.controls[e].length>1}).length>0?2:1,i=this.props.match.params;return t.createElement("table",{className:"formDetail",cellPadding:"0",cellSpacing:"0",id:"formDetail",style:{fontSize:this.state.fontSize}},t.createElement("tbody",null,i.printType==="hr"&&t.createElement("tr",{className:"row clearfix Relative notDetails"},t.createElement("td",{className:"noHalf rowItem BorderRight0",colSpan:s},t.createElement("span",{className:"controlName TxtMiddle"},_l("\u6807\u9898")),t.createElement("span",{className:"controlValue TxtMiddle",style:{width:"calc(100% - 105px)"}},this.state.reqInfo.reqTitle))),A()(this.state.controls).map(function(e){var a=n.state.controls[e];if(a.length===1){if(a[0].type===0&&!a[0].printHide)return n.state.detailsType===2?t.createElement("tr",{key:e,className:y()("details row clearfix",e!=="0"&&n.beforeControlIsDetail(e)&&"borderTop0")},t.createElement("td",{className:"rowItem detailsRowItem",colSpan:s},t.createElement("div",{className:y()("detailsName Bold",e!=="0"&&n.beforeControlIsDetail(e)&&"mTop0")},a[0].controlName),t.createElement("table",{className:"detailsTable",cellPadding:"0",cellSpacing:"0"},t.createElement("tbody",null,t.createElement("tr",null,t.createElement("th",{className:"titleTd",style:{width:25}}),n.state.formControls.filter(function(r){return r.formId===a[0].formId})[0].tempControls.sort(function(r,f){return r.innerRow-f.innerRow}).map(function(r,f){return(r.type===17||r.type===18)&&r.dataSource&&r.dataSource!==0&&typeof r.value!="string"?r.value.map(function(l,u){return t.createElement("th",{style:{width:975/(n.state.formControls.filter(function(c){return c.formId===a[0].formId})[0].tempControls.length+n.state.formControls.filter(function(c){return c.formId===a[0].formId})[0].tempControls.filter(function(c){return(c.type===17||c.type===18)&&c.dataSource&&c.dataSource!==0&&typeof c.value!="string"}).length*3)},key:e+"th"+f+"dataTh"+u},l.controlName)}):t.createElement("th",{style:{width:975/(n.state.formControls.filter(function(l){return l.formId===a[0].formId})[0].tempControls.length+n.state.formControls.filter(function(l){return l.formId===a[0].formId})[0].tempControls.filter(function(l){return(l.type===17||l.type===18)&&l.dataSource&&l.dataSource!==0&&typeof l.value!="string"}).length*3)},key:e+"th"+f},r.controlName)})),(a[0].printDetailType===1||a[0].printDetailType===2)&&n.state.formControls.filter(function(r){return r.formId===a[0].formId})[0].controls.map(function(r,f){return t.createElement("tr",{key:e+"tr"+f},t.createElement("td",{className:"titleTd"},f+1),r.sort(function(l,u){return l.innerRow-u.innerRow}).map(function(l,u){return(l.type===17||l.type===18)&&l.dataSource&&l.dataSource!==0&&typeof l.value!="string"?l.value.map(function(c,p){return t.createElement("td",{className:y()((l.type===6||l.type===8||l.type===20)&&"TxtRight"),style:{width:975/r.length},key:e+"td"+u+"dataTd"+p},n.getShowContent(c))}):t.createElement("td",{className:y()((l.type===6||l.type===8||l.type===20)&&"TxtRight"),style:{width:975/r.length},key:e+"td"+u},n.getShowContent(l))}))}),n.state.formControls.filter(function(r){return r.formId===a[0].formId})[0].tempControls.filter(function(r){return r.needEvaluate}).length>0&&(a[0].printDetailType===1||a[0].printDetailType===3)&&t.createElement("tr",{key:e+"evaluateTr",className:"evaluateTr"},t.createElement("td",{className:"titleTd"},"="),n.state.formControls.filter(function(r){return r.formId===a[0].formId})[0].tempControls.map(function(r,f){return t.createElement("td",{style:{width:975/n.state.formControls.filter(function(l){return l.formId===a[0].formId})[0].tempControls.length},key:e+"evaluateTd"+f},r.needEvaluate?n.getEvaluateType(r)+":":"",r.needEvaluate?n.getEvaluateValue(n.state.formControls.filter(function(l){return l.formId===a[0].formId})[0].controls,r,r.controlId,r.enumDefault2,r.unit,r.dot,r.enumDefault):"")})))))):t.createElement("tr",{key:e,className:y()("details row clearfix",e!=="0"&&n.beforeControlIsDetail(e)&&"borderTop0")},t.createElement("td",{className:"rowItem detailsRowItem",colSpan:s},t.createElement("div",{className:y()("detailsName Bold",e!=="0"&&n.beforeControlIsDetail(e)&&"mTop0")},a[0].controlName),function(){if(a[0].printDetailType===1||a[0].printDetailType===2)return n.state.formControls.filter(function(r){return r.formId===a[0].formId})[0].controls.map(function(r,f){return t.createElement("table",{className:"detailItem",key:f,cellPadding:"0",cellSpacing:"0"},t.createElement("tbody",null,function(){var l=[];r.forEach(function(c){(c.type===17||c.type===18)&&c.dataSource&&c.dataSource!==0&&typeof c.value!="string"&&(c.innerRow=-1)}),r.filter(function(c){return c.innerRow<0}).map(function(c){return l.push(c.value)});var u=r.filter(function(c){return c.innerRow>=0});return u.sort(function(c,p){return c.innerRow-p.innerRow}).forEach(function(c,p){p%4===0&&(u[p+1]&&u[p+2]&&u[p+3]?l.push([c,u[p+1],u[p+2],u[p+3]]):u[p+1]&&u[p+2]?l.push([c,u[p+1],u[p+2]]):u[p+1]?l.push([c,u[p+1]]):l.push([c]))}),l.map(function(c,p){return t.createElement("tr",{className:"clearfix detailItemControlRow",key:"newControlRow"+p},p===0&&t.createElement("td",{className:"detailItemName",rowSpan:l.length},f+1),c.map(function(v,k){return t.createElement("td",{style:{width:c.length===1?"97.5%":c.length===2?"48.75%":"24.375%"},className:"clearfix detailRowItem",colSpan:c.length===2?"2":c.length===1?"4":"1",key:"newControlRowItem"+k},t.createElement("span",{className:"detailName TxtMiddle"},v.controlName),t.createElement("span",{className:"detailValue TxtMiddle",style:{width:"calc(100% - 105px)"}},n.getShowContent(v)))}),c.length===3&&t.createElement("td",{style:{width:"24.375%"}}))})}()))})}(),n.state.formControls.filter(function(r){return r.formId===a[0].formId})[0].tempControls.filter(function(r){return r.needEvaluate}).length>0&&(a[0].printDetailType===1||a[0].printDetailType===3)&&t.createElement("div",{className:"evaluateItemBox"},function(){var r=n.state.formControls.filter(function(l){return l.formId===a[0].formId})[0].tempControls.filter(function(l){return l.needEvaluate}),f=[];return r.sort(function(l,u){return l.innerRow-u.innerRow}).forEach(function(l,u){u%4===0&&(r[u+1]&&r[u+2]&&r[u+3]?f.push([l,r[u+1],r[u+2],r[u+3]]):r[u+1]&&r[u+2]?f.push([l,r[u+1],r[u+2]]):r[u+1]?f.push([l,r[u+1]]):f.push([l]))}),t.createElement("table",{className:"evaluateItem",cellPadding:"0",cellSpacing:"0"},t.createElement("tbody",null,f.map(function(l,u){return t.createElement("tr",{className:"clearfix detailEvaluateRow",key:"newTempControlRow"+u},u===0&&t.createElement("td",{className:"evaluateItemName",rowSpan:f.length},"="),l.map(function(c,p){return t.createElement("td",{style:{width:l.length===1?"97.5%":l.length===2?"48.75%":"24.375%"},className:"clearfix detailEvaluateRowItem",colSpan:l.length===2?"2":l.length===1?"4":"1",key:"newTempControlRowItem"+p},t.createElement("span",{className:"evaluateName Bold TxtMiddle"},c.controlName,n.getEvaluateType(c)),t.createElement("span",{style:{width:"calc(100% - 105px)"},className:"evaluateValue TxtMiddle"},n.getEvaluateValue(n.state.formControls.filter(function(v){return v.formId===a[0].formId})[0].controls,c,c.controlId,c.enumDefault2,c.unit,c.dot)))}),l.length===3&&t.createElement("td",{style:{width:"24.375%"}}))})))}())));if(a[0].type===29&&a[0].enumDefault===2)return t.createElement("tr",{key:e,className:y()("details row clearfix",e!=="0"&&n.beforeControlIsDetail(e)&&"borderTop0")},t.createElement("td",{className:"rowItem detailsRowItem",colSpan:s},t.createElement("div",{className:y()("detailsName Bold",e!=="0"&&n.beforeControlIsDetail(e)&&"mTop0")},a[0].controlName),n.getShowContent(a[0])));if((a[0].type===17||a[0].type===18)&&typeof a[0].value!="string"&&!a[0].printHide)return a[0].dataSource&&a[0].dataSource!==0?a[0].value.map(function(r,f){return t.createElement("tr",{key:"dataTime"+f,className:"row clearfix Relative notDetails"},t.createElement("td",{style:{borderTopColor:e!=="0"&&f===0&&n.beforeControlIsDetail(e)?"#555":"#bbb"},className:"noHalf rowItem BorderRight0",colSpan:s},t.createElement("span",{className:"controlName TxtMiddle"},r.controlName),t.createElement("span",{style:{width:"calc(100% - 105px)"},className:"controlValue TxtMiddle"},n.getShowContent(r))))}):t.createElement("tr",{key:e,className:y()("row clearfix Relative notDetails",a[0].type===10010&&"remarks")},t.createElement("td",{style:{borderTopColor:e!=="0"&&n.beforeControlIsDetail(e)?"#555":"#bbb"},className:"noHalf rowItem BorderRight0",colSpan:s},t.createElement("span",{className:"controlName TxtMiddle"},a[0].controlName),t.createElement("span",{style:{width:"calc(100% - 105px)"},className:y()("controlValue TxtMiddle",a[0].type===2&&"textPreLine")},n.getShowContent(a[0]))));if(a[0].type===22&&!a[0].printHide)return t.createElement("tr",{key:e,className:"noneContent clearfix"},t.createElement("td",{colSpan:s},a[0].controlName?a[0].controlName:""));if(a[0].type===14&&!a[0].printHide)return n.state.type==="worksheet"||n.state.type==="workflow"?t.createElement("tr",{key:e,className:y()("row clearfix Relative notDetails",a[0].type===10010&&"remarks")},t.createElement("td",{style:{borderTopColor:e!=="0"&&n.beforeControlIsDetail(e)?"#555":"#bbb",paddingLeft:105},className:"noHalf rowItem BorderRight0 pLeft0",colSpan:s},t.createElement("span",{className:"controlName TxtMiddle Left",style:{top:6,left:0}},a[0].controlName),t.createElement("span",{className:y()("controlValue TxtMiddle Block",a[0].type===2&&"textPreLine"),style:{width:"100%"}},n.getShowContent(a[0])))):null;if(a[0].printHide){if(a[0].printHide&&a[0].printHide)return null}else return t.createElement("tr",{key:e,className:y()("row clearfix Relative notDetails",a[0].type===10010&&"remarks")},t.createElement("td",{style:{borderTopColor:e!=="0"&&n.beforeControlIsDetail(e)||n.state.type!=="hr"&&e==="0"?"#555":"#bbb"},className:"noHalf rowItem BorderRight0",colSpan:s},a[0].type!==10010&&t.createElement("span",{className:"controlName TxtMiddle"},a[0].controlName),t.createElement("span",{style:{width:"calc(100% - 105px)"},className:y()("controlValue TxtMiddle",a[0].type===2&&"textPreLine")},n.getShowContent(a[0]))))}return a.filter(function(r){return!r.printHide}).length>0&&t.createElement("tr",{key:e,className:"row clearfix Relative notDetails"},!a.filter(function(r){return r.col===0})[0].printHide&&t.createElement("td",{style:{borderTopColor:e!=="0"&&n.beforeControlIsDetail(e)?"#555":"#bbb"},className:"half rowItem"},t.createElement("span",{className:"controlName TxtMiddle"},a.filter(function(r){return r.col===0})[0].controlName),t.createElement("span",{style:{width:"calc(100% - 105px)"},className:y()("controlValue TxtMiddle",a[0].type===2&&"textPreLine")},n.getShowContent(a.filter(function(r){return r.col===0})[0]))),!(a.filter(function(r){return r.col===1})[0]?a.filter(function(r){return r.col===1})[0].printHide:a.filter(function(r){return r.col===0})[1].printHide)&&t.createElement("td",{style:{borderTopColor:e!=="0"&&n.beforeControlIsDetail(e)?"#555":"#bbb"},className:"half rowItem Relative"},t.createElement("span",{className:"controlName TxtMiddle"},a.filter(function(r){return r.col===1})[0]?a.filter(function(r){return r.col===1})[0].controlName:a.filter(function(r){return r.col===0})[1].controlName),t.createElement("span",{style:{width:"calc(100% - 105px)"},className:y()("controlValue TxtMiddle",a[1].type===2&&"textPreLine")},n.getShowContent(a.filter(function(r){return r.col===1})[0]?a.filter(function(r){return r.col===1})[0]:a.filter(function(r){return r.col===0})[1]))))})))}},{key:"render",value:function(){var n=this,s=this.props.match.params,i=this.state,e=i.task,a=i.configOptions,r=i.rowInfo,f=this.state.logo,l=e.filter(function(u){return u.key==="code"})[0]||{};return this.state.worksheetId&&a.showWorkflowQrCode&&r&&r.shortUrl&&(f=md.global.Config.AjaxApiUrl+"code/CreateQrCodeImage?url="+r.shortUrl),setInterval(function(){$(".kf5-support-chat, #containerBg, #topBarContainer").length>0&&$(".kf5-support-chat, #containerBg, #topBarContainer").remove()},1e3),t.createElement("div",{className:"printBox",id:"hrApprovalPrint"},this.state.showPrintDialog&&t.createElement(Ie,{visible:this.state.showPrintDialog,changePrintVisible:this.changePrintVisible,options:{showWorkflowQrCode:a.showWorkflowQrCode},hidePrintOptDialog:function(){n.setState({showPrintDialog:!1})},reqInfo:this.state.worksheetId?this.state.rowInfo:this.state.reqInfo,controlOption:this.state.controlOption,printCheckAll:this.state.printCheckAll,worksheetId:this.state.worksheetId,type:s.printType,task:E().cloneDeep(this.state.task),onUpdateTask:function(c){n.setState({task:c})},workflow:E().cloneDeep(this.state.workflow),onUpdateWorkflow:function(c){n.setState({workflow:c})}}),t.createElement("div",{className:"printStartBox clearfix"},t.createElement("div",{className:"width1000"},t.createElement("span",{className:"contentHide InlineBlock pointer TxtMiddle",onClick:this.showPrintDialog},t.createElement(he.Z,{icon:"circulated",className:"Gray_9e font14 mRight8 InlineBlock TxtMiddle"}),t.createElement("span",{className:"TxtMiddle"},_l("\u8BBE\u7F6E\u6253\u5370\u5185\u5BB9\u663E\u9690"))),(s.printType==="hr"||s.printType==="worksheet")&&t.createElement("span",{className:"TxtMiddle InlineBlock mRight60"},t.createElement("span",{className:"TxtMiddle"},_l("\u660E\u7EC6\u663E\u793A\u65B9\u5F0F\uFF1A")),t.createElement(ve.ZP,{className:"TxtMiddle InlineBlock",data:[{text:_l("\u7EB5\u5411(\u5355\u6761\u660E\u7EC6)"),value:1},{text:_l("\u6A2A\u5411(\u5217\u8868)"),value:2}],size:"small",checkedValue:this.state.detailsType,onChange:function(c){n.setState({detailsType:c})}})),t.createElement("span",{className:"TxtMiddle InlineBlock mRight60"},t.createElement("span",{className:"TxtMiddle"},_l("\u6587\u5B57\u5927\u5C0F\uFF1A")),t.createElement(ge.Z,{style:{width:140},menuStyle:{width:140},value:this.state.fontSize||14,onChange:function(c){n.setState({fontSize:c})},data:[{text:_l("\u6807\u51C6"),value:14},{text:_l("\u4E2D"),value:16},{text:_l("\u5927"),value:18}]})),t.createElement("div",{className:"printButton Right pointer",onClick:function(){return window.print(),!1}},t.createElement("i",{className:"icon-print"}),_l("\u6253\u5370")))),!this.state.reqInfo&&!this.state.temControl||s.printType==="hr"&&this.state.workList.length<=0?t.createElement(F.Z,{className:"mTop64"}):t.createElement("div",{className:"printContent clearfix pTop20",id:"printContent"},t.createElement("div",{className:"titleContent clearfix mBottom32"},t.createElement("div",{className:"title TxtLeft mTop5"},t.createElement("span",{className:"font24 reqTitle mBottom5"},this.state.printTitle||this.state.reqInfo.title),t.createElement("span",{className:"font15 reqNo",title:this.state.reqInfo.reqNo},s.printType==="hr"&&_l("\u5355\u636E\u7F16\u53F7\uFF1A"),(s.printType==="hr"||s.printType==="task"||s.printType==="workflow")&&this.state.reqInfo.reqNo,s.printType==="worksheet"&&this.state.sheetInfo.name)),t.createElement("div",{className:"logo",style:{display:s.printType==="task"?l.show?"":"none":""}},t.createElement("img",{className:"img",src:f,alt:"",style:{height:s.printType==="task"||s.printType==="worksheet"&&a.showWorkflowQrCode?100:60}}))),s.printType==="task"&&this.renderTaskHeader(),E().isEmpty(this.state.controls)?void 0:this.renderControls(),s.printType==="task"&&this.state.task.length&&this.renderTaskInventory(),s.printType==="task"&&this.state.task.length&&this.renderTaskSubTask(),this.state.signatureControls.length?t.createElement("div",{className:"flexRow pTop30 pBottom30 signatureContentWrapper"},this.state.signatureControls.map(function(u){return t.createElement("div",{key:u.controlId},t.createElement("div",{className:"bold"},u.controlName),t.createElement("img",{className:"mTop10",src:u.value}))})):null,t.createElement("div",{className:"clearfix createBy Font14 mTop15"},t.createElement("span",{className:"mBottom10 Right"},_l("\u6253\u5370\u65F6\u95F4\uFF1A"),I()().format("YYYY-MM-DD HH:mm:ss")))))}}]),m}(t.Component),q.propTypes={reqId:N().string},X=function(){var m=this;this.componentWillMount=function(){var o=m.props.match.params;o.printType==="worksheet"?m.initWorksheet():o.printType==="task"&&m.initTask()},this.componentDidUpdate=function(){$("#container, .AppHr form").addClass("hrApprovalBox"),$("html.AppHr").addClass("hrApprovalAppHr")},this.getShowContent=function(o,n,s,i){var e=n?s:o.value,a=n||o.type;switch(a){case 1:case 2:case 3:case 4:case 5:case 7:case 19:case 23:case 24:case 25:case 32:case 33:case 10001:case 10002:case 10003:case 10004:case 10005:case 10006:case 10007:case 10008:case 10009:return e||"";case 15:return e?I()(e).format("YYYY-MM-DD"):"";case 16:return e?I()(e).format("YYYY-MM-DD HH:mm"):"";case 36:return e==="1"?"\u2713":"";case 6:case 8:var r=e?Number(e).toFixed(o.dot):"";return t.createElement("div",{style:{textAlign:o.isRelateMultipleSheet?"right":"left"}},r?(r.indexOf(".")>-1?r.toString().replace(/(\d)(?=(\d{3})+\.)/g,"$1,"):r.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1,"))+(o.unit?o.unit:""):"");case 20:case 31:case 37:var f=e?Number(e).toFixed(o.dot):"";return f?(f.indexOf(".")>-1?f.toString().replace(/(\d)(?=(\d{3})+\.)/g,"$1,"):f.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1,"))+(o.unit?o.unit:""):"";case 9:{var l=o.options.filter(function(h){return h.key==e});return l.length>0?l[0].value:""}case 11:{if(e&&o.dataSource&&!o.sourceControlId)try{return JSON.parse(JSON.parse(e).label).join(" / ")||""}catch(h){return JSON.parse(e).label||""}var u=o.options.filter(function(h){return h.key==e});return u.length>0?u[0].value:""}case 10:{var c="";if(e){for(var p=[],v=0;v<e.length;v++)e[v]!=="0"&&p.push("1"+e.slice(v+1).replace(/1/g,0));c=o.options.filter(function(h){return p.indexOf(h.key)>-1}).map(function(h){return h.value}).join(",")}return c}case 14:return this.state.type==="worksheet"||this.state.type==="workflow"?this.renderRecordAttachments(e,o.isRelateMultipleSheet):e?JSON.parse(e).map(function(h){return h.originalFilename}).join(","):" ";case 17:{var k="";if(e){var g="";if(this.state.type==="worksheet"||this.state.type==="workflow")try{g=JSON.parse(e).filter(function(h){return h}).length>0?JSON.parse(e).map(function(h){return h?I()(h).format("x"):""}):""}catch(h){g=e}else g=e.split(",");var He=I()(new Date(Number(g[1]))).diff(I()(new Date(Number(g[0]))),"days")+1;return o.enumDefault2===1&&(k="    "+_l("\u65F6\u957F:  %0\u5929",He)),e&&g?_l("%0 \u81F3 %1",g[0]?I()(Number(g[0])).format("YYYY-MM-DD"):"-",g[1]?I()(Number(g[1])).format("YYYY-MM-DD"):"-")+k:""}return null}case 18:{var O="";if(e){var w="";if(this.state.type==="worksheet"||this.state.type==="workflow")try{w=JSON.parse(e).filter(function(h){return h}).length>0?JSON.parse(e).map(function(h){return h?I()(h).format("x"):""}):""}catch(h){w=e}else w=e.split(",");var Ye=Number(w[1])-Number(w[0]),We=Number(Ye/(3600*1e3)).toFixed(1);if(o.enumDefault2===1&&(O="    "+_l("\u65F6\u957F")+": "+_l("%0\u5C0F\u65F6",We),this.state.type==="worksheet"||this.state.type==="workflow")){var V=Number(w[1])-Number(w[0]),_=Math.floor(V/(24*3600*1e3)),ee=V%(24*3600*1e3),te=Math.floor(ee/(3600*1e3)),re=ee%(3600*1e3),ne=Math.floor(re/(60*1e3)),je=re%(60*1e3),Ve=Math.round(je/1e3);O="    "+_l("\u65F6\u957F")+": "+(_>0?_l("%0\u5929",_):"")+" "+(te>0?_l("%0\u5C0F\u65F6",te):"")+" "+(ne>0?_l("%0\u5206\u949F",ne):"")+" "}return e&&w?_l("%0 \u81F3 %1",w[0]?I()(Number(w[0])).format("YYYY-MM-DD HH:mm"):"-",w[1]?I()(Number(w[1])).format("YYYY-MM-DD HH:mm"):"-")+O:""}return null}case 20:return e?o.value+o.unit:"";case 21:{if(e){var Ue=function(D){switch(D){case 1:return _l("\u4EFB\u52A1")+"\uFF1A";case 2:return _l("\u9879\u76EE")+"\uFF1A";case 3:return _l("\u65E5\u7A0B")+"\uFF1A";case 4:return _l("\u6587\u4EF6")+"\uFF1A";case 5:return _l("\u7533\u8BF7\u5355")+"\uFF1A";case 7:return _l("\u91CD\u590D\u65E5\u7A0B")+"\uFF1A"}},ze=function(D,$e){return t.createElement("div",{className:"relationshipItem",key:o.controlId+"-relationValueItem-"+$e},t.createElement("span",{className:"typeName"},Ue(D.type)),t.createElement("span",{className:"name"},D.name," "))},Fe=JSON.parse(e),Je=t.createElement("div",{key:i||o.controlId,className:"relationshipBox"},Fe.map(function(h,D){return ze(h,D)}));return Je}return""}case 26:return e?this.state.type==="worksheet"||this.state.type==="workflow"?JSON.parse(e).map(function(h){return h.fullname}).join(","):JSON.parse(e).fullname:"";case 27:return e?E().isArray(JSON.parse(e))?JSON.parse(e)[0]?JSON.parse(e)[0].departmentName:"":JSON.parse(e).departmentName:"";case 28:return e?o.enumDefault===1?e+"\u661F":e+"/10":"";case 29:if(o.enumDefault===1){var ae=[];try{ae=JSON.parse(e)}catch(h){}return ae.map(function(h){return(0,J.Z)(S()({},o,{value:h.name,type:o.sourceControlType}))||_l("\u672A\u547D\u540D")||_l("\u672A\u547D\u540D")}).join("\uFF0C")}else{var M=this.state.relateRecords;return M&&M[o.controlId]?this.renderTable(M[o.controlId],o):t.createElement("div",{className:"textCenter"},t.createElement(F.Z,null))}case 30:{var Ze=this.getShowContent(o,o.sourceControlType,e,o.controlId);return Ze||""}case 40:{var R=void 0;try{R=JSON.parse(e)}catch(h){return""}return R.title+" "+R.address}case 38:{var Qe=o.enumDefault,Ge=o.unit,B=void 0;return e?B=Qe===1?(0,Te.UM)({value:e,unit:Ge}):e:B="",B}case 41:return t.createElement("div",{className:"richText",dangerouslySetInnerHTML:{__html:e}});case 42:return t.createElement("img",{src:e,style:{width:168}});case 10010:return t.createElement("div",{className:"richText",dangerouslySetInnerHTML:{__html:e}});default:break}},this.getEvaluateValue=function(o,n){var s=n.controlId,i=n.enumDefault2,e=n.enumDefault,a=n.unit,r=n.dot,f=[];o.forEach(function(k){f.push(Number((k.filter(function(g){return g.controlId===s})[0]||{value:""}).value))});var l=void 0;switch(i){case 2:{var u=0;f.forEach(function(k){u=(0,C.p4)(u,k)}),l=u;break}case 3:{var c=0;f.forEach(function(k){c=(0,C.p4)(c,k)}),l=(0,C.IQ)(c,f.length);break}case 4:{l=E().min(f);break}case 5:{l=E().max(f);break}case 6:{var p=1;f.forEach(function(k){p=(0,C.pc)(p,k)}),l=p;break}}l=i!==2?l.toFixed(r).toString():l.toString();var v=n.type===8&&e?Me.toMoney(l).substring(3):"";return l=(l.indexOf(".")>-1?l.toString().replace(/(\d)(?=(\d{3})+\.)/g,"$1,"):l.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1,"))+(a||""),t.createElement("span",null,l,t.createElement("span",{className:"Block"},v))},this.showPrintDialog=function(){var o=this.state.controlOption||[];o.length===0&&(this.state.reqInfo.controls.filter(function(n){return!n.printHide}).forEach(function(n,s){n&&n.controlId&&o.push(n.controlId)}),this.state.reqInfo.formControls.forEach(function(n){n.tempControls.filter(function(s){return s.needEvaluate}).length>0&&o.push("formDetailEvaluate-"+n.formId)})),this.setState({showPrintDialog:!0,printCheckAll:this.state.printCheckAll,controlOption:o})}.bind(this),this.changePrintVisible=function(o,n,s,i){var e=[];this.state.type==="worksheet"?e=this.state.rowInfo.controls:e=this.state.reqInfo.controls;var a=[];if(s.filter(function(c){return c.indexOf("formDetailEvaluate-")>-1}).forEach(function(c){a.push(c.split("-")[1])}),s!=="all"){var r=e.filter(function(c){return s.indexOf(c.controlId)>-1});r.forEach(function(c,p){c.type===0&&(r[p].printDetailType=2)}),a.forEach(function(c){if(r.filter(function(v){return v.controlId===c}).length>0)r.forEach(function(v,k){v.controlId===c&&(r[k].printDetailType=1)});else{var p=e.filter(function(v){return v.controlId===c})[0];p.printDetailType=3,r.push(p)}}),e=r}else e.forEach(function(c,p){c.type===0&&(e[p].printDetailType=1)});var f=E().groupBy(e,"row");if(this.state.type==="worksheet"||this.state.type==="task"||this.state.type==="workflow")this.setState({showPrintDialog:!1,configOptions:S()({},this.state.configOptions,i),controlOption:s,printCheckAll:n,controls:f});else if(this.state.type==="hr"){this.state.reqWorks.manageList.forEach(function(c){c.workType=2});var l=JSON.parse(ie()(this.state.reqWorks));o==="some"&&(l.taskList.forEach(function(c){c.countersignType?c.workItems.forEach(function(p){p.workItemLogList=p.workItemLogList.filter(function(v){return v.action===4||v.action===5||v.action===8||v.action===16||v.action===17||v.action===18})}):c.workItemLogList=c.workItemLogList.filter(function(p){return p.action===4||p.action===5||p.action===8||p.action===16||p.action===17||p.action===18})}),l.manageList.forEach(function(c){c.workItemLogList=c.workItemLogList.filter(function(p){return p.action===12||p.action===14||p.action===15||p.action===20||p.action===21})}));var u=l.taskList.concat(l.manageList);this.setState({showPrintDialog:!1,processOption:o,controlOption:s,printCheckAll:n,taskList:o==="no"?[]:l.taskList,manageList:o==="no"?[]:l.manageList,printWorkList:u,controls:f})}}.bind(this),this.getEvaluateType=function(o){switch(o.enumDefault2){case 2:return _l("\u6C42\u548C");case 3:return _l("\u5E73\u5747\u503C");case 4:return _l("\u6700\u5C0F\u503C");case 5:return _l("\u6700\u5927\u503C");case 6:return _l("\u4E58\u79EF")}},this.beforeControlIsDetail=function(o){var n=this.state.type;if(n!=="hr")return!1;if(this.state.controls[Number(o)-1])return this.state.controls[Number(o)-1][0].type===0;if(Number(o)-1>=0)return this.beforeControlIsDetail(Number(o)-1)}.bind(this)},K),Oe(b.prototype,"loadRowRelationRows",[autobind],le()(b.prototype,"loadRowRelationRows"),b.prototype),b);const Le=Ae}}]);
