(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[4383],{93943:function(yo){(function(wn,Nt){yo.exports=Nt()})(this,function(){"use strict";var wn=function(M){return M instanceof Uint8Array||M instanceof Uint16Array||M instanceof Uint32Array||M instanceof Int8Array||M instanceof Int16Array||M instanceof Int32Array||M instanceof Float32Array||M instanceof Float64Array||M instanceof Uint8ClampedArray},Nt=function(M,G){for(var tt=Object.keys(G),wt=0;wt<tt.length;++wt)M[tt[wt]]=G[tt[wt]];return M},Lt=`
`;function mn(M){return typeof atob<"u"?atob(M):"base64:"+M}function An(M){var G=new Error("(regl) "+M);throw console.error(G),G}function Te(M,G){M||An(G)}function Be(M){return M?": "+M:""}function Jt(M,G,tt){M in G||An("unknown parameter ("+M+")"+Be(tt)+". possible values: "+Object.keys(G).join())}function kt(M,G){wn(M)||An("invalid parameter type"+Be(G)+". must be a typed array")}function te(M,G){switch(G){case"number":return typeof M=="number";case"object":return typeof M=="object";case"string":return typeof M=="string";case"boolean":return typeof M=="boolean";case"function":return typeof M=="function";case"undefined":return typeof M>"u";case"symbol":return typeof M=="symbol"}}function Y(M,G,tt){te(M,G)||An("invalid parameter type"+Be(tt)+". expected "+G+", got "+typeof M)}function Q(M,G){M>=0&&(M|0)===M||An("invalid parameter type, ("+M+")"+Be(G)+". must be a nonnegative integer")}function st(M,G,tt){G.indexOf(M)<0&&An("invalid value"+Be(tt)+". must be one of: "+G)}var at=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function jt(M){Object.keys(M).forEach(function(G){at.indexOf(G)<0&&An('invalid regl constructor argument "'+G+'". must be one of '+at)})}function Ht(M,G){for(M=M+"";M.length<G;)M=" "+M;return M}function Xt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function De(M,G){this.number=M,this.line=G,this.errors=[]}function Ze(M,G,tt){this.file=M,this.line=G,this.message=tt}function hn(){var M=new Error,G=(M.stack||M).toString(),tt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(G);if(tt)return tt[1];var wt=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(G);return wt?wt[1]:"unknown"}function Ce(){var M=new Error,G=(M.stack||M).toString(),tt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(G);if(tt)return tt[1];var wt=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(G);return wt?wt[1]:"unknown"}function Me(M,G){var tt=M.split(`
`),wt=1,Dt=0,xt={unknown:new Xt,0:new Xt};xt.unknown.name=xt[0].name=G||hn(),xt.unknown.lines.push(new De(0,""));for(var Tt=0;Tt<tt.length;++Tt){var $t=tt[Tt],Wt=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec($t);if(Wt)switch(Wt[1]){case"line":var Kt=/(\d+)(\s+\d+)?/.exec(Wt[2]);Kt&&(wt=Kt[1]|0,Kt[2]&&(Dt=Kt[2]|0,Dt in xt||(xt[Dt]=new Xt)));break;case"define":var Yt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Wt[2]);Yt&&(xt[Dt].name=Yt[1]?mn(Yt[2]):Yt[2]);break}xt[Dt].lines.push(new De(wt++,$t))}return Object.keys(xt).forEach(function(re){var ce=xt[re];ce.lines.forEach(function(Zt){ce.index[Zt.number]=Zt})}),xt}function tn(M){var G=[];return M.split(`
`).forEach(function(tt){if(!(tt.length<5)){var wt=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(tt);wt?G.push(new Ze(wt[1]|0,wt[2]|0,wt[3].trim())):tt.length>0&&G.push(new Ze("unknown",0,tt))}}),G}function fe(M,G){G.forEach(function(tt){var wt=M[tt.file];if(wt){var Dt=wt.index[tt.line];if(Dt){Dt.errors.push(tt),wt.hasErrors=!0;return}}M.unknown.hasErrors=!0,M.unknown.lines[0].errors.push(tt)})}function Se(M,G,tt,wt,Dt){if(!M.getShaderParameter(G,M.COMPILE_STATUS)){var xt=M.getShaderInfoLog(G),Tt=wt===M.FRAGMENT_SHADER?"fragment":"vertex";xi(tt,"string",Tt+" shader source must be a string",Dt);var $t=Me(tt,Dt),Wt=tn(xt);fe($t,Wt),Object.keys($t).forEach(function(Kt){var Yt=$t[Kt];if(!Yt.hasErrors)return;var re=[""],ce=[""];function Zt(ie,ft){re.push(ie),ce.push(ft||"")}Zt("file number "+Kt+": "+Yt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Yt.lines.forEach(function(ie){if(ie.errors.length>0){Zt(Ht(ie.number,4)+"|  ","background-color:yellow; font-weight:bold"),Zt(ie.line+Lt,"color:red; background-color:yellow; font-weight:bold");var ft=0;ie.errors.forEach(function(St){var ee=St.message,ue=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ee);if(ue){var Ft=ue[1];switch(ee=ue[2],Ft){case"assign":Ft="=";break}ft=Math.max(ie.line.indexOf(Ft,ft),0)}else ft=0;Zt(Ht("| ",6)),Zt(Ht("^^^",ft+3)+Lt,"font-weight:bold"),Zt(Ht("| ",6)),Zt(ee+Lt,"font-weight:bold")}),Zt(Ht("| ",6)+Lt)}else Zt(Ht(ie.number,4)+"|  "),Zt(ie.line+Lt,"color:red")}),typeof document<"u"&&!window.chrome?(ce[0]=re.join("%c"),console.log.apply(console,ce)):console.log(re.join(""))}),Te.raise("Error compiling "+Tt+" shader, "+$t[0].name)}}function Ve(M,G,tt,wt,Dt){if(!M.getProgramParameter(G,M.LINK_STATUS)){var xt=M.getProgramInfoLog(G),Tt=Me(tt,Dt),$t=Me(wt,Dt),Wt='Error linking program with vertex shader, "'+$t[0].name+'", and fragment shader "'+Tt[0].name+'"';typeof document<"u"?console.log("%c"+Wt+Lt+"%c"+xt,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Wt+Lt+xt),Te.raise(Wt)}}function rn(M){M._commandRef=hn()}function Ue(M,G,tt,wt){rn(M);function Dt(Wt){return Wt?wt.id(Wt):0}M._fragId=Dt(M.static.frag),M._vertId=Dt(M.static.vert);function xt(Wt,Kt){Object.keys(Kt).forEach(function(Yt){Wt[wt.id(Yt)]=!0})}var Tt=M._uniformSet={};xt(Tt,G.static),xt(Tt,G.dynamic);var $t=M._attributeSet={};xt($t,tt.static),xt($t,tt.dynamic),M._hasCount="count"in M.static||"count"in M.dynamic||"elements"in M.static||"elements"in M.dynamic}function Tn(M,G){var tt=Ce();An(M+" in command "+(G||hn())+(tt==="unknown"?"":" called from "+tt))}function Qn(M,G,tt){M||Tn(G,tt||hn())}function Zn(M,G,tt,wt){M in G||Tn("unknown parameter ("+M+")"+Be(tt)+". possible values: "+Object.keys(G).join(),wt||hn())}function xi(M,G,tt,wt){te(M,G)||Tn("invalid parameter type"+Be(tt)+". expected "+G+", got "+typeof M,wt||hn())}function Or(M){M()}function ki(M,G,tt){M.texture?st(M.texture._texture.internalformat,G,"unsupported texture format for attachment"):st(M.renderbuffer._renderbuffer.format,tt,"unsupported renderbuffer format for attachment")}var vn=33071,Bn=9728,oi=9984,dr=9985,ar=9986,jo=9987,da=5120,Ir=5121,bo=5122,Cs=5123,cr=5124,Fo=5125,Go=5126,xo=32819,wi=32820,Jr=33635,Yi=34042,_d=36193,si={};si[da]=si[Ir]=1,si[bo]=si[Cs]=si[_d]=si[Jr]=si[xo]=si[wi]=2,si[cr]=si[Fo]=si[Go]=si[Yi]=4;function Bl(M,G){return M===wi||M===xo||M===Jr?2:M===Yi?4:si[M]*G}function fc(M){return!(M&M-1)&&!!M}function Sd(M,G,tt){var wt,Dt=G.width,xt=G.height,Tt=G.channels;Te(Dt>0&&Dt<=tt.maxTextureSize&&xt>0&&xt<=tt.maxTextureSize,"invalid texture shape"),(M.wrapS!==vn||M.wrapT!==vn)&&Te(fc(Dt)&&fc(xt),"incompatible wrap mode for texture, both width and height must be power of 2"),G.mipmask===1?Dt!==1&&xt!==1&&Te(M.minFilter!==oi&&M.minFilter!==ar&&M.minFilter!==dr&&M.minFilter!==jo,"min filter requires mipmap"):(Te(fc(Dt)&&fc(xt),"texture must be a square power of 2 to support mipmapping"),Te(G.mipmask===(Dt<<1)-1,"missing or incomplete mipmap data")),G.type===Go&&(tt.extensions.indexOf("oes_texture_float_linear")<0&&Te(M.minFilter===Bn&&M.magFilter===Bn,"filter not supported, must enable oes_texture_float_linear"),Te(!M.genMipmaps,"mipmap generation not supported with float textures"));var $t=G.images;for(wt=0;wt<16;++wt)if($t[wt]){var Wt=Dt>>wt,Kt=xt>>wt;Te(G.mipmask&1<<wt,"missing mipmap data");var Yt=$t[wt];if(Te(Yt.width===Wt&&Yt.height===Kt,"invalid shape for mip images"),Te(Yt.format===G.format&&Yt.internalformat===G.internalformat&&Yt.type===G.type,"incompatible type for mip image"),!Yt.compressed)if(Yt.data){var re=Math.ceil(Bl(Yt.type,Tt)*Wt/Yt.unpackAlignment)*Yt.unpackAlignment;Te(Yt.data.byteLength===re*Kt,"invalid data for image, buffer size is inconsistent with image format")}else Yt.element||Yt.copy}else M.genMipmaps||Te((G.mipmask&1<<wt)===0,"extra mipmap data");G.compressed&&Te(!M.genMipmaps,"mipmap generation for compressed images not supported")}function ga(M,G,tt,wt){var Dt=M.width,xt=M.height,Tt=M.channels;Te(Dt>0&&Dt<=wt.maxTextureSize&&xt>0&&xt<=wt.maxTextureSize,"invalid texture shape"),Te(Dt===xt,"cube map must be square"),Te(G.wrapS===vn&&G.wrapT===vn,"wrap mode not supported by cube map");for(var $t=0;$t<tt.length;++$t){var Wt=tt[$t];Te(Wt.width===Dt&&Wt.height===xt,"inconsistent cube map face shape"),G.genMipmaps&&(Te(!Wt.compressed,"can not generate mipmap for compressed textures"),Te(Wt.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Kt=Wt.images,Yt=0;Yt<16;++Yt){var re=Kt[Yt];if(re){var ce=Dt>>Yt,Zt=xt>>Yt;Te(Wt.mipmask&1<<Yt,"missing mipmap data"),Te(re.width===ce&&re.height===Zt,"invalid shape for mip images"),Te(re.format===M.format&&re.internalformat===M.internalformat&&re.type===M.type,"incompatible type for mip image"),re.compressed||(re.data?Te(re.data.byteLength===ce*Zt*Math.max(Bl(re.type,Tt),re.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):re.element||re.copy)}}}}var $=Nt(Te,{optional:Or,raise:An,commandRaise:Tn,command:Qn,parameter:Jt,commandParameter:Zn,constructor:jt,type:Y,commandType:xi,isTypedArray:kt,nni:Q,oneOf:st,shaderError:Se,linkError:Ve,callSite:Ce,saveCommandRef:rn,saveDrawInfo:Ue,framebufferFormat:ki,guessCommand:hn,texture2D:Sd,textureCube:ga}),Ke=0,Br=0,jl=5,pa=6;function zo(M,G){this.id=Ke++,this.type=M,this.data=G}function dc(M){return M.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ma(M){if(M.length===0)return[];var G=M.charAt(0),tt=M.charAt(M.length-1);if(M.length>1&&G===tt&&(G==='"'||G==="'"))return['"'+dc(M.substr(1,M.length-2))+'"'];var wt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(M);if(wt)return ma(M.substr(0,wt.index)).concat(ma(wt[1])).concat(ma(M.substr(wt.index+wt[0].length)));var Dt=M.split(".");if(Dt.length===1)return['"'+dc(M)+'"'];for(var xt=[],Tt=0;Tt<Dt.length;++Tt)xt=xt.concat(ma(Dt[Tt]));return xt}function oh(M){return"["+ma(M).join("][")+"]"}function Fl(M,G){return new zo(M,oh(G+""))}function Ad(M){return typeof M=="function"&&!M._reglType||M instanceof zo}function jr(M,G){if(typeof M=="function")return new zo(Br,M);if(typeof M=="number"||typeof M=="boolean")return new zo(jl,M);if(Array.isArray(M))return new zo(pa,M.map((tt,wt)=>jr(tt,G+"["+wt+"]")));if(M instanceof zo)return M;$(!1,"invalid option type in uniform "+G)}var gr={DynamicVariable:zo,define:Fl,isDynamic:Ad,unbox:jr,accessor:oh},wr={next:typeof requestAnimationFrame=="function"?function(M){return requestAnimationFrame(M)}:function(M){return setTimeout(M,16)},cancel:typeof cancelAnimationFrame=="function"?function(M){return cancelAnimationFrame(M)}:clearTimeout},Gl=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function gc(){var M={"":0},G=[""];return{id:function(tt){var wt=M[tt];return wt||(wt=M[tt]=G.length,G.push(tt),wt)},str:function(tt){return G[tt]}}}function Td(M,G,tt){var wt=document.createElement("canvas");Nt(wt.style,{border:0,margin:0,padding:0,top:0,left:0}),M.appendChild(wt),M===document.body&&(wt.style.position="absolute",Nt(M.style,{margin:0,padding:0}));function Dt(){var $t=window.innerWidth,Wt=window.innerHeight;if(M!==document.body){var Kt=M.getBoundingClientRect();$t=Kt.right-Kt.left,Wt=Kt.bottom-Kt.top}wt.width=tt*$t,wt.height=tt*Wt,Nt(wt.style,{width:$t+"px",height:Wt+"px"})}var xt;M!==document.body&&typeof ResizeObserver=="function"?(xt=new ResizeObserver(function(){setTimeout(Dt)}),xt.observe(M)):window.addEventListener("resize",Dt,!1);function Tt(){xt?xt.disconnect():window.removeEventListener("resize",Dt),M.removeChild(wt)}return Dt(),{canvas:wt,onDestroy:Tt}}function zl(M,G){function tt(wt){try{return M.getContext(wt,G)}catch(Dt){return null}}return tt("webgl")||tt("experimental-webgl")||tt("webgl-experimental")}function sh(M){return typeof M.nodeName=="string"&&typeof M.appendChild=="function"&&typeof M.getBoundingClientRect=="function"}function Cd(M){return typeof M.drawArrays=="function"||typeof M.drawElements=="function"}function Uo(M){return typeof M=="string"?M.split():($(Array.isArray(M),"invalid extension array"),M)}function Os(M){return typeof M=="string"?($(typeof document<"u","not supported outside of DOM"),document.querySelector(M)):M}function va(M){var G=M||{},tt,wt,Dt,xt,Tt={},$t=[],Wt=[],Kt=typeof window>"u"?1:window.devicePixelRatio,Yt=!1,re=function(ie){ie&&$.raise(ie)},ce=function(){};if(typeof G=="string"?($(typeof document<"u","selector queries only supported in DOM enviroments"),tt=document.querySelector(G),$(tt,"invalid query string for element")):typeof G=="object"?sh(G)?tt=G:Cd(G)?(xt=G,Dt=xt.canvas):($.constructor(G),"gl"in G?xt=G.gl:"canvas"in G?Dt=Os(G.canvas):"container"in G&&(wt=Os(G.container)),"attributes"in G&&(Tt=G.attributes,$.type(Tt,"object","invalid context attributes")),"extensions"in G&&($t=Uo(G.extensions)),"optionalExtensions"in G&&(Wt=Uo(G.optionalExtensions)),"onDone"in G&&($.type(G.onDone,"function","invalid or missing onDone callback"),re=G.onDone),"profile"in G&&(Yt=!!G.profile),"pixelRatio"in G&&(Kt=+G.pixelRatio,$(Kt>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),tt&&(tt.nodeName.toLowerCase()==="canvas"?Dt=tt:wt=tt),!xt){if(!Dt){$(typeof document<"u","must manually specify webgl context outside of DOM environments");var Zt=Td(wt||document.body,re,Kt);if(!Zt)return null;Dt=Zt.canvas,ce=Zt.onDestroy}Tt.premultipliedAlpha===void 0&&(Tt.premultipliedAlpha=!0),xt=zl(Dt,Tt)}return xt?{gl:xt,canvas:Dt,container:wt,extensions:$t,optionalExtensions:Wt,pixelRatio:Kt,profile:Yt,onDone:re,onDestroy:ce}:(ce(),re("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function pc(M,G){var tt={};function wt(Tt){$.type(Tt,"string","extension name must be string");var $t=Tt.toLowerCase(),Wt;try{Wt=tt[$t]=M.getExtension($t)}catch(Kt){}return!!Wt}for(var Dt=0;Dt<G.extensions.length;++Dt){var xt=G.extensions[Dt];if(!wt(xt))return G.onDestroy(),G.onDone('"'+xt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return G.optionalExtensions.forEach(wt),{extensions:tt,restore:function(){Object.keys(tt).forEach(function(Tt){if(tt[Tt]&&!wt(Tt))throw new Error("(regl): error restoring extension "+Tt)})}}}function Mr(M,G){for(var tt=Array(M),wt=0;wt<M;++wt)tt[wt]=G(wt);return tt}var Vo=5120,ya=5121,Ho=5122,mc=5123,ba=5124,ah=5125,ch=5126;function $o(M){for(var G=16;G<=1<<28;G*=16)if(M<=G)return G;return 0}function vc(M){var G,tt;return G=(M>65535)<<4,M>>>=G,tt=(M>255)<<3,M>>>=tt,G|=tt,tt=(M>15)<<2,M>>>=tt,G|=tt,tt=(M>3)<<1,M>>>=tt,G|=tt,G|M>>1}function Ul(){var M=Mr(8,function(){return[]});function G(xt){var Tt=$o(xt),$t=M[vc(Tt)>>2];return $t.length>0?$t.pop():new ArrayBuffer(Tt)}function tt(xt){M[vc(xt.byteLength)>>2].push(xt)}function wt(xt,Tt){var $t=null;switch(xt){case Vo:$t=new Int8Array(G(Tt),0,Tt);break;case ya:$t=new Uint8Array(G(Tt),0,Tt);break;case Ho:$t=new Int16Array(G(2*Tt),0,Tt);break;case mc:$t=new Uint16Array(G(2*Tt),0,Tt);break;case ba:$t=new Int32Array(G(4*Tt),0,Tt);break;case ah:$t=new Uint32Array(G(4*Tt),0,Tt);break;case ch:$t=new Float32Array(G(4*Tt),0,Tt);break;default:return null}return $t.length!==Tt?$t.subarray(0,Tt):$t}function Dt(xt){tt(xt.buffer)}return{alloc:G,free:tt,allocType:wt,freeType:Dt}}var tr=Ul();tr.zero=Ul();var lh=3408,Od=3410,Id=3411,Vl=3412,Md=3413,Nd=3414,uh=3415,Pd=33901,Dd=33902,Wo=3379,Rd=3386,xa=34921,Hl=36347,$l=36348,hh=35661,Ld=35660,fh=34930,yc=36349,kd=34076,Bd=34024,dh=7936,gh=7937,ph=7938,jd=35724,Wl=34047,Fd=36063,Gd=34852,bc=3553,Xo=34067,mh=34069,zd=33984,wa=6408,Xl=5126,Zo=5121,xc=36160,wc=36053,Is=36064,vh=16384,yh=function(M,G){var tt=1;G.ext_texture_filter_anisotropic&&(tt=M.getParameter(Wl));var wt=1,Dt=1;G.webgl_draw_buffers&&(wt=M.getParameter(Gd),Dt=M.getParameter(Fd));var xt=!!G.oes_texture_float;if(xt){var Tt=M.createTexture();M.bindTexture(bc,Tt),M.texImage2D(bc,0,wa,1,1,0,wa,Xl,null);var $t=M.createFramebuffer();if(M.bindFramebuffer(xc,$t),M.framebufferTexture2D(xc,Is,bc,Tt,0),M.bindTexture(bc,null),M.checkFramebufferStatus(xc)!==wc)xt=!1;else{M.viewport(0,0,1,1),M.clearColor(1,0,0,1),M.clear(vh);var Wt=tr.allocType(Xl,4);M.readPixels(0,0,1,1,wa,Xl,Wt),M.getError()?xt=!1:(M.deleteFramebuffer($t),M.deleteTexture(Tt),xt=Wt[0]===1),tr.freeType(Wt)}}var Kt=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Yt=!0;if(!Kt){var re=M.createTexture(),ce=tr.allocType(Zo,36);M.activeTexture(zd),M.bindTexture(Xo,re),M.texImage2D(mh,0,wa,3,3,0,wa,Zo,ce),tr.freeType(ce),M.bindTexture(Xo,null),M.deleteTexture(re),Yt=!M.getError()}return{colorBits:[M.getParameter(Od),M.getParameter(Id),M.getParameter(Vl),M.getParameter(Md)],depthBits:M.getParameter(Nd),stencilBits:M.getParameter(uh),subpixelBits:M.getParameter(lh),extensions:Object.keys(G).filter(function(Zt){return!!G[Zt]}),maxAnisotropic:tt,maxDrawbuffers:wt,maxColorAttachments:Dt,pointSizeDims:M.getParameter(Pd),lineWidthDims:M.getParameter(Dd),maxViewportDims:M.getParameter(Rd),maxCombinedTextureUnits:M.getParameter(hh),maxCubeMapSize:M.getParameter(kd),maxRenderbufferSize:M.getParameter(Bd),maxTextureUnits:M.getParameter(fh),maxTextureSize:M.getParameter(Wo),maxAttributes:M.getParameter(xa),maxVertexUniforms:M.getParameter(Hl),maxVertexTextureUnits:M.getParameter(Ld),maxVaryingVectors:M.getParameter($l),maxFragmentUniforms:M.getParameter(yc),glsl:M.getParameter(jd),renderer:M.getParameter(gh),vendor:M.getParameter(dh),version:M.getParameter(ph),readFloat:xt,npotTextureCube:Yt}};function hi(M){return!!M&&typeof M=="object"&&Array.isArray(M.shape)&&Array.isArray(M.stride)&&typeof M.offset=="number"&&M.shape.length===M.stride.length&&(Array.isArray(M.data)||wn(M.data))}var Kr=function(M){return Object.keys(M).map(function(G){return M[G]})},Ms={shape:Ea,flatten:Ns};function bh(M,G,tt){for(var wt=0;wt<G;++wt)tt[wt]=M[wt]}function Ud(M,G,tt,wt){for(var Dt=0,xt=0;xt<G;++xt)for(var Tt=M[xt],$t=0;$t<tt;++$t)wt[Dt++]=Tt[$t]}function xh(M,G,tt,wt,Dt,xt){for(var Tt=xt,$t=0;$t<G;++$t)for(var Wt=M[$t],Kt=0;Kt<tt;++Kt)for(var Yt=Wt[Kt],re=0;re<wt;++re)Dt[Tt++]=Yt[re]}function wh(M,G,tt,wt,Dt){for(var xt=1,Tt=tt+1;Tt<G.length;++Tt)xt*=G[Tt];var $t=G[tt];if(G.length-tt===4){var Wt=G[tt+1],Kt=G[tt+2],Yt=G[tt+3];for(Tt=0;Tt<$t;++Tt)xh(M[Tt],Wt,Kt,Yt,wt,Dt),Dt+=xt}else for(Tt=0;Tt<$t;++Tt)wh(M[Tt],G,tt+1,wt,Dt),Dt+=xt}function Ns(M,G,tt,wt){var Dt=1;if(G.length)for(var xt=0;xt<G.length;++xt)Dt*=G[xt];else Dt=0;var Tt=wt||tr.allocType(tt,Dt);switch(G.length){case 0:break;case 1:bh(M,G[0],Tt);break;case 2:Ud(M,G[0],G[1],Tt);break;case 3:xh(M,G[0],G[1],G[2],Tt,0);break;default:wh(M,G,0,Tt,0)}return Tt}function Ea(M){for(var G=[],tt=M;tt.length;tt=tt[0])G.push(tt.length);return G}var Ec={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},_a=5120,Vd=5122,Eh=5124,Hd=5121,$d=5123,Sa=5125,Ps=5126,lm=5126,wo={int8:_a,int16:Vd,int32:Eh,uint8:Hd,uint16:$d,uint32:Sa,float:Ps,float32:lm},um=35048,Zl=35040,_c={dynamic:um,stream:Zl,static:35044},_h=Ms.flatten,Sc=Ms.shape,Wd=35044,Ds=35040,Rs=5121,ql=5126,Qr=[];Qr[5120]=1,Qr[5122]=2,Qr[5124]=4,Qr[5121]=1,Qr[5123]=2,Qr[5125]=4,Qr[5126]=4;function Yl(M){return Ec[Object.prototype.toString.call(M)]|0}function Xd(M,G){for(var tt=0;tt<G.length;++tt)M[tt]=G[tt]}function Zd(M,G,tt,wt,Dt,xt,Tt){for(var $t=0,Wt=0;Wt<tt;++Wt)for(var Kt=0;Kt<wt;++Kt)M[$t++]=G[Dt*Wt+xt*Kt+Tt]}function qd(M,G,tt,wt){var Dt=0,xt={};function Tt(ft){this.id=Dt++,this.buffer=M.createBuffer(),this.type=ft,this.usage=Wd,this.byteLength=0,this.dimension=1,this.dtype=Rs,this.persistentData=null,tt.profile&&(this.stats={size:0})}Tt.prototype.bind=function(){M.bindBuffer(this.type,this.buffer)},Tt.prototype.destroy=function(){ce(this)};var $t=[];function Wt(ft,St){var ee=$t.pop();return ee||(ee=new Tt(ft)),ee.bind(),re(ee,St,Ds,0,1,!1),ee}function Kt(ft){$t.push(ft)}function Yt(ft,St,ee){ft.byteLength=St.byteLength,M.bufferData(ft.type,St,ee)}function re(ft,St,ee,ue,Ft,ge){var Vt;if(ft.usage=ee,Array.isArray(St)){if(ft.dtype=ue||ql,St.length>0){var se;if(Array.isArray(St[0])){Vt=Sc(St);for(var zt=1,oe=1;oe<Vt.length;++oe)zt*=Vt[oe];ft.dimension=zt,se=_h(St,Vt,ft.dtype),Yt(ft,se,ee),ge?ft.persistentData=se:tr.freeType(se)}else if(typeof St[0]=="number"){ft.dimension=Ft;var Pe=tr.allocType(ft.dtype,St.length);Xd(Pe,St),Yt(ft,Pe,ee),ge?ft.persistentData=Pe:tr.freeType(Pe)}else wn(St[0])?(ft.dimension=St[0].length,ft.dtype=ue||Yl(St[0])||ql,se=_h(St,[St.length,St[0].length],ft.dtype),Yt(ft,se,ee),ge?ft.persistentData=se:tr.freeType(se)):$.raise("invalid buffer data")}}else if(wn(St))ft.dtype=ue||Yl(St),ft.dimension=Ft,Yt(ft,St,ee),ge&&(ft.persistentData=new Uint8Array(new Uint8Array(St.buffer)));else if(hi(St)){Vt=St.shape;var ze=St.stride,ae=St.offset,ne=0,Gt=0,je=0,qe=0;Vt.length===1?(ne=Vt[0],Gt=1,je=ze[0],qe=0):Vt.length===2?(ne=Vt[0],Gt=Vt[1],je=ze[0],qe=ze[1]):$.raise("invalid shape"),ft.dtype=ue||Yl(St.data)||ql,ft.dimension=Gt;var we=tr.allocType(ft.dtype,ne*Gt);Zd(we,St.data,ne,Gt,je,qe,ae),Yt(ft,we,ee),ge?ft.persistentData=we:tr.freeType(we)}else St instanceof ArrayBuffer?(ft.dtype=Rs,ft.dimension=Ft,Yt(ft,St,ee),ge&&(ft.persistentData=new Uint8Array(new Uint8Array(St)))):$.raise("invalid buffer data")}function ce(ft){G.bufferCount--,wt(ft);var St=ft.buffer;$(St,"buffer must not be deleted already"),M.deleteBuffer(St),ft.buffer=null,delete xt[ft.id]}function Zt(ft,St,ee,ue){G.bufferCount++;var Ft=new Tt(St);xt[Ft.id]=Ft;function ge(zt){var oe=Wd,Pe=null,ze=0,ae=0,ne=1;return Array.isArray(zt)||wn(zt)||hi(zt)||zt instanceof ArrayBuffer?Pe=zt:typeof zt=="number"?ze=zt|0:zt&&($.type(zt,"object","buffer arguments must be an object, a number or an array"),"data"in zt&&($(Pe===null||Array.isArray(Pe)||wn(Pe)||hi(Pe),"invalid data for buffer"),Pe=zt.data),"usage"in zt&&($.parameter(zt.usage,_c,"invalid buffer usage"),oe=_c[zt.usage]),"type"in zt&&($.parameter(zt.type,wo,"invalid buffer type"),ae=wo[zt.type]),"dimension"in zt&&($.type(zt.dimension,"number","invalid dimension"),ne=zt.dimension|0),"length"in zt&&($.nni(ze,"buffer length must be a nonnegative integer"),ze=zt.length|0)),Ft.bind(),Pe?re(Ft,Pe,oe,ae,ne,ue):(ze&&M.bufferData(Ft.type,ze,oe),Ft.dtype=ae||Rs,Ft.usage=oe,Ft.dimension=ne,Ft.byteLength=ze),tt.profile&&(Ft.stats.size=Ft.byteLength*Qr[Ft.dtype]),ge}function Vt(zt,oe){$(oe+zt.byteLength<=Ft.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+zt.byteLength+" starting from offset "+oe+" to a buffer of size "+Ft.byteLength),M.bufferSubData(Ft.type,oe,zt)}function se(zt,oe){var Pe=(oe||0)|0,ze;if(Ft.bind(),wn(zt)||zt instanceof ArrayBuffer)Vt(zt,Pe);else if(Array.isArray(zt)){if(zt.length>0)if(typeof zt[0]=="number"){var ae=tr.allocType(Ft.dtype,zt.length);Xd(ae,zt),Vt(ae,Pe),tr.freeType(ae)}else if(Array.isArray(zt[0])||wn(zt[0])){ze=Sc(zt);var ne=_h(zt,ze,Ft.dtype);Vt(ne,Pe),tr.freeType(ne)}else $.raise("invalid buffer data")}else if(hi(zt)){ze=zt.shape;var Gt=zt.stride,je=0,qe=0,we=0,on=0;ze.length===1?(je=ze[0],qe=1,we=Gt[0],on=0):ze.length===2?(je=ze[0],qe=ze[1],we=Gt[0],on=Gt[1]):$.raise("invalid shape");var He=Array.isArray(zt.data)?Ft.dtype:Yl(zt.data),en=tr.allocType(He,je*qe);Zd(en,zt.data,je,qe,we,on,zt.offset),Vt(en,Pe),tr.freeType(en)}else $.raise("invalid data for buffer subdata");return ge}return ee||ge(ft),ge._reglType="buffer",ge._buffer=Ft,ge.subdata=se,tt.profile&&(ge.stats=Ft.stats),ge.destroy=function(){ce(Ft)},ge}function ie(){Kr(xt).forEach(function(ft){ft.buffer=M.createBuffer(),M.bindBuffer(ft.type,ft.buffer),M.bufferData(ft.type,ft.persistentData||ft.byteLength,ft.usage)})}return tt.profile&&(G.getTotalBufferSize=function(){var ft=0;return Object.keys(xt).forEach(function(St){ft+=xt[St].stats.size}),ft}),{create:Zt,createStream:Wt,destroyStream:Kt,clear:function(){Kr(xt).forEach(ce),$t.forEach(ce)},getBuffer:function(ft){return ft&&ft._buffer instanceof Tt?ft._buffer:null},restore:ie,_initBuffer:re}}var Yd=0,Sh=0,Jd=1,Kd=1,Eo=4,Qd=4,Bi={points:Yd,point:Sh,lines:Jd,line:Kd,triangles:Eo,triangle:Qd,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},tg=0,Ah=1,qo=4,Th=5120,Ls=5121,eg=5122,ji=5123,ng=5124,Ji=5125,Ch=34963,hm=35040,Oh=35044;function Ih(M,G,tt,wt){var Dt={},xt=0,Tt={uint8:Ls,uint16:ji};G.oes_element_index_uint&&(Tt.uint32=Ji);function $t(ie){this.id=xt++,Dt[this.id]=this,this.buffer=ie,this.primType=qo,this.vertCount=0,this.type=0}$t.prototype.bind=function(){this.buffer.bind()};var Wt=[];function Kt(ie){var ft=Wt.pop();return ft||(ft=new $t(tt.create(null,Ch,!0,!1)._buffer)),re(ft,ie,hm,-1,-1,0,0),ft}function Yt(ie){Wt.push(ie)}function re(ie,ft,St,ee,ue,Ft,ge){ie.buffer.bind();var Vt;if(ft){var se=ge;!ge&&(!wn(ft)||hi(ft)&&!wn(ft.data))&&(se=G.oes_element_index_uint?Ji:ji),tt._initBuffer(ie.buffer,ft,St,se,3)}else M.bufferData(Ch,Ft,St),ie.buffer.dtype=Vt||Ls,ie.buffer.usage=St,ie.buffer.dimension=3,ie.buffer.byteLength=Ft;if(Vt=ge,!ge){switch(ie.buffer.dtype){case Ls:case Th:Vt=Ls;break;case ji:case eg:Vt=ji;break;case Ji:case ng:Vt=Ji;break;default:$.raise("unsupported type for element array")}ie.buffer.dtype=Vt}ie.type=Vt,$(Vt!==Ji||!!G.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var zt=ue;zt<0&&(zt=ie.buffer.byteLength,Vt===ji?zt>>=1:Vt===Ji&&(zt>>=2)),ie.vertCount=zt;var oe=ee;if(ee<0){oe=qo;var Pe=ie.buffer.dimension;Pe===1&&(oe=tg),Pe===2&&(oe=Ah),Pe===3&&(oe=qo)}ie.primType=oe}function ce(ie){wt.elementsCount--,$(ie.buffer!==null,"must not double destroy elements"),delete Dt[ie.id],ie.buffer.destroy(),ie.buffer=null}function Zt(ie,ft){var St=tt.create(null,Ch,!0),ee=new $t(St._buffer);wt.elementsCount++;function ue(Ft){if(!Ft)St(),ee.primType=qo,ee.vertCount=0,ee.type=Ls;else if(typeof Ft=="number")St(Ft),ee.primType=qo,ee.vertCount=Ft|0,ee.type=Ls;else{var ge=null,Vt=Oh,se=-1,zt=-1,oe=0,Pe=0;Array.isArray(Ft)||wn(Ft)||hi(Ft)?ge=Ft:($.type(Ft,"object","invalid arguments for elements"),"data"in Ft&&(ge=Ft.data,$(Array.isArray(ge)||wn(ge)||hi(ge),"invalid data for element buffer")),"usage"in Ft&&($.parameter(Ft.usage,_c,"invalid element buffer usage"),Vt=_c[Ft.usage]),"primitive"in Ft&&($.parameter(Ft.primitive,Bi,"invalid element buffer primitive"),se=Bi[Ft.primitive]),"count"in Ft&&($(typeof Ft.count=="number"&&Ft.count>=0,"invalid vertex count for elements"),zt=Ft.count|0),"type"in Ft&&($.parameter(Ft.type,Tt,"invalid buffer type"),Pe=Tt[Ft.type]),"length"in Ft?oe=Ft.length|0:(oe=zt,Pe===ji||Pe===eg?oe*=2:(Pe===Ji||Pe===ng)&&(oe*=4))),re(ee,ge,Vt,se,zt,oe,Pe)}return ue}return ue(ie),ue._reglType="elements",ue._elements=ee,ue.subdata=function(Ft,ge){return St.subdata(Ft,ge),ue},ue.destroy=function(){ce(ee)},ue}return{create:Zt,createStream:Kt,destroyStream:Yt,getElements:function(ie){return typeof ie=="function"&&ie._elements instanceof $t?ie._elements:null},clear:function(){Kr(Dt).forEach(ce)}}}var Mh=new Float32Array(1),rg=new Uint32Array(Mh.buffer),ig=5123;function Ki(M){for(var G=tr.allocType(ig,M.length),tt=0;tt<M.length;++tt)if(isNaN(M[tt]))G[tt]=65535;else if(M[tt]===1/0)G[tt]=31744;else if(M[tt]===-1/0)G[tt]=64512;else{Mh[0]=M[tt];var wt=rg[0],Dt=wt>>>31<<15,xt=(wt<<1>>>24)-127,Tt=wt>>13&1023;if(xt<-24)G[tt]=Dt;else if(xt<-14){var $t=-14-xt;G[tt]=Dt+(Tt+1024>>$t)}else xt>15?G[tt]=Dt+31744:G[tt]=Dt+(xt+15<<10)+Tt}return G}function qn(M){return Array.isArray(M)||wn(M)}var Ac=function(M){return!(M&M-1)&&!!M},og=34467,ai=3553,Jl=34067,Kl=34069,Fi=6408,Ei=6406,Tc=6407,ti=6409,Cc=6410,Oc=32854,Ic=32855,Aa=36194,fm=32819,Ta=32820,Ca=33635,Mc=34042,Ql=6402,_o=34041,Nc=35904,tu=35906,Yo=36193,ks=33776,Oa=33777,eu=33778,nu=33779,sg=35986,ru=35987,Pc=34798,iu=35840,_i=35841,ag=35842,ou=35843,Nh=36196,Qi=5121,Dc=5123,Rc=5125,Bs=5126,cg=10242,Lc=10243,lg=10497,su=33071,Ph=33648,Dh=10240,Rh=10241,kc=9728,au=9729,cu=9984,Lh=9985,kh=9986,So=9987,ug=33170,Ia=4352,hg=4353,fg=4354,dg=34046,Bh=3317,dm=37440,gg=37441,jh=37443,Fh=37444,lu=33984,pg=[cu,kh,Lh,So],Bc=[0,ti,Cc,Tc,Fi],ci={};ci[ti]=ci[Ei]=ci[Ql]=1,ci[_o]=ci[Cc]=2,ci[Tc]=ci[Nc]=3,ci[Fi]=ci[tu]=4;function js(M){return"[object "+M+"]"}var Gh=js("HTMLCanvasElement"),mg=js("OffscreenCanvas"),uu=js("CanvasRenderingContext2D"),zh=js("ImageBitmap"),hu=js("HTMLImageElement"),Uh=js("HTMLVideoElement"),vg=Object.keys(Ec).concat([Gh,mg,uu,zh,hu,Uh]),Fs=[];Fs[Qi]=1,Fs[Bs]=4,Fs[Yo]=2,Fs[Dc]=2,Fs[Rc]=4;var br=[];br[Oc]=2,br[Ic]=2,br[Aa]=2,br[_o]=4,br[ks]=.5,br[Oa]=.5,br[eu]=1,br[nu]=1,br[sg]=.5,br[ru]=1,br[Pc]=1,br[iu]=.5,br[_i]=.25,br[ag]=.5,br[ou]=.25,br[Nh]=.5;function Ao(M){return Array.isArray(M)&&(M.length===0||typeof M[0]=="number")}function Jo(M){if(!Array.isArray(M))return!1;var G=M.length;return!(G===0||!qn(M[0]))}function to(M){return Object.prototype.toString.call(M)}function jc(M){return to(M)===Gh}function Fc(M){return to(M)===mg}function yg(M){return to(M)===uu}function fu(M){return to(M)===zh}function bg(M){return to(M)===hu}function du(M){return to(M)===Uh}function Gc(M){if(!M)return!1;var G=to(M);return vg.indexOf(G)>=0?!0:Ao(M)||Jo(M)||hi(M)}function xg(M){return Ec[Object.prototype.toString.call(M)]|0}function gu(M,G){var tt=G.length;switch(M.type){case Qi:case Dc:case Rc:case Bs:var wt=tr.allocType(M.type,tt);wt.set(G),M.data=wt;break;case Yo:M.data=Ki(G);break;default:$.raise("unsupported texture type, must specify a typed array")}}function pu(M,G){return tr.allocType(M.type===Yo?Bs:M.type,G)}function Vh(M,G){M.type===Yo?(M.data=Ki(G),tr.freeType(G)):M.data=G}function Hh(M,G,tt,wt,Dt,xt){for(var Tt=M.width,$t=M.height,Wt=M.channels,Kt=Tt*$t*Wt,Yt=pu(M,Kt),re=0,ce=0;ce<$t;++ce)for(var Zt=0;Zt<Tt;++Zt)for(var ie=0;ie<Wt;++ie)Yt[re++]=G[tt*Zt+wt*ce+Dt*ie+xt];Vh(M,Yt)}function mu(M,G,tt,wt,Dt,xt){var Tt;if(typeof br[M]<"u"?Tt=br[M]:Tt=ci[M]*Fs[G],xt&&(Tt*=6),Dt){for(var $t=0,Wt=tt;Wt>=1;)$t+=Tt*Wt*Wt,Wt/=2;return $t}else return Tt*tt*wt}function zc(M,G,tt,wt,Dt,xt,Tt){var $t={"don't care":Ia,"dont care":Ia,nice:fg,fast:hg},Wt={repeat:lg,clamp:su,mirror:Ph},Kt={nearest:kc,linear:au},Yt=Nt({mipmap:So,"nearest mipmap nearest":cu,"linear mipmap nearest":Lh,"nearest mipmap linear":kh,"linear mipmap linear":So},Kt),re={none:0,browser:Fh},ce={uint8:Qi,rgba4:fm,rgb565:Ca,"rgb5 a1":Ta},Zt={alpha:Ei,luminance:ti,"luminance alpha":Cc,rgb:Tc,rgba:Fi,rgba4:Oc,"rgb5 a1":Ic,rgb565:Aa},ie={};G.ext_srgb&&(Zt.srgb=Nc,Zt.srgba=tu),G.oes_texture_float&&(ce.float32=ce.float=Bs),G.oes_texture_half_float&&(ce.float16=ce["half float"]=Yo),G.webgl_depth_texture&&(Nt(Zt,{depth:Ql,"depth stencil":_o}),Nt(ce,{uint16:Dc,uint32:Rc,"depth stencil":Mc})),G.webgl_compressed_texture_s3tc&&Nt(ie,{"rgb s3tc dxt1":ks,"rgba s3tc dxt1":Oa,"rgba s3tc dxt3":eu,"rgba s3tc dxt5":nu}),G.webgl_compressed_texture_atc&&Nt(ie,{"rgb atc":sg,"rgba atc explicit alpha":ru,"rgba atc interpolated alpha":Pc}),G.webgl_compressed_texture_pvrtc&&Nt(ie,{"rgb pvrtc 4bppv1":iu,"rgb pvrtc 2bppv1":_i,"rgba pvrtc 4bppv1":ag,"rgba pvrtc 2bppv1":ou}),G.webgl_compressed_texture_etc1&&(ie["rgb etc1"]=Nh);var ft=Array.prototype.slice.call(M.getParameter(og));Object.keys(ie).forEach(function(q){var Et=ie[q];ft.indexOf(Et)>=0&&(Zt[q]=Et)});var St=Object.keys(Zt);tt.textureFormats=St;var ee=[];Object.keys(Zt).forEach(function(q){var Et=Zt[q];ee[Et]=q});var ue=[];Object.keys(ce).forEach(function(q){var Et=ce[q];ue[Et]=q});var Ft=[];Object.keys(Kt).forEach(function(q){var Et=Kt[q];Ft[Et]=q});var ge=[];Object.keys(Yt).forEach(function(q){var Et=Yt[q];ge[Et]=q});var Vt=[];Object.keys(Wt).forEach(function(q){var Et=Wt[q];Vt[Et]=q});var se=St.reduce(function(q,Et){var vt=Zt[Et];return vt===ti||vt===Ei||vt===ti||vt===Cc||vt===Ql||vt===_o||G.ext_srgb&&(vt===Nc||vt===tu)?q[vt]=vt:vt===Ic||Et.indexOf("rgba")>=0?q[vt]=Fi:q[vt]=Tc,q},{});function zt(){this.internalformat=Fi,this.format=Fi,this.type=Qi,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Fh,this.width=0,this.height=0,this.channels=0}function oe(q,Et){q.internalformat=Et.internalformat,q.format=Et.format,q.type=Et.type,q.compressed=Et.compressed,q.premultiplyAlpha=Et.premultiplyAlpha,q.flipY=Et.flipY,q.unpackAlignment=Et.unpackAlignment,q.colorSpace=Et.colorSpace,q.width=Et.width,q.height=Et.height,q.channels=Et.channels}function Pe(q,Et){if(!(typeof Et!="object"||!Et)){if("premultiplyAlpha"in Et&&($.type(Et.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),q.premultiplyAlpha=Et.premultiplyAlpha),"flipY"in Et&&($.type(Et.flipY,"boolean","invalid texture flip"),q.flipY=Et.flipY),"alignment"in Et&&($.oneOf(Et.alignment,[1,2,4,8],"invalid texture unpack alignment"),q.unpackAlignment=Et.alignment),"colorSpace"in Et&&($.parameter(Et.colorSpace,re,"invalid colorSpace"),q.colorSpace=re[Et.colorSpace]),"type"in Et){var vt=Et.type;$(G.oes_texture_float||!(vt==="float"||vt==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(G.oes_texture_half_float||!(vt==="half float"||vt==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(G.webgl_depth_texture||!(vt==="uint16"||vt==="uint32"||vt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(vt,ce,"invalid texture type"),q.type=ce[vt]}var me=q.width,an=q.height,X=q.channels,j=!1;"shape"in Et?($(Array.isArray(Et.shape)&&Et.shape.length>=2,"shape must be an array"),me=Et.shape[0],an=Et.shape[1],Et.shape.length===3&&(X=Et.shape[2],$(X>0&&X<=4,"invalid number of channels"),j=!0),$(me>=0&&me<=tt.maxTextureSize,"invalid width"),$(an>=0&&an<=tt.maxTextureSize,"invalid height")):("radius"in Et&&(me=an=Et.radius,$(me>=0&&me<=tt.maxTextureSize,"invalid radius")),"width"in Et&&(me=Et.width,$(me>=0&&me<=tt.maxTextureSize,"invalid width")),"height"in Et&&(an=Et.height,$(an>=0&&an<=tt.maxTextureSize,"invalid height")),"channels"in Et&&(X=Et.channels,$(X>0&&X<=4,"invalid number of channels"),j=!0)),q.width=me|0,q.height=an|0,q.channels=X|0;var nt=!1;if("format"in Et){var ht=Et.format;$(G.webgl_depth_texture||!(ht==="depth"||ht==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(ht,Zt,"invalid texture format");var gt=q.internalformat=Zt[ht];q.format=se[gt],ht in ce&&("type"in Et||(q.type=ce[ht])),ht in ie&&(q.compressed=!0),nt=!0}!j&&nt?q.channels=ci[q.format]:j&&!nt?q.channels!==Bc[q.format]&&(q.format=q.internalformat=Bc[q.channels]):nt&&j&&$(q.channels===ci[q.format],"number of channels inconsistent with specified format")}}function ze(q){M.pixelStorei(dm,q.flipY),M.pixelStorei(gg,q.premultiplyAlpha),M.pixelStorei(jh,q.colorSpace),M.pixelStorei(Bh,q.unpackAlignment)}function ae(){zt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ne(q,Et){var vt=null;if(Gc(Et)?vt=Et:Et&&($.type(Et,"object","invalid pixel data type"),Pe(q,Et),"x"in Et&&(q.xOffset=Et.x|0),"y"in Et&&(q.yOffset=Et.y|0),Gc(Et.data)&&(vt=Et.data)),$(!q.compressed||vt instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Et.copy){$(!vt,"can not specify copy and data field for the same texture");var me=Dt.viewportWidth,an=Dt.viewportHeight;q.width=q.width||me-q.xOffset,q.height=q.height||an-q.yOffset,q.needsCopy=!0,$(q.xOffset>=0&&q.xOffset<me&&q.yOffset>=0&&q.yOffset<an&&q.width>0&&q.width<=me&&q.height>0&&q.height<=an,"copy texture read out of bounds")}else if(!vt)q.width=q.width||1,q.height=q.height||1,q.channels=q.channels||4;else if(wn(vt))q.channels=q.channels||4,q.data=vt,!("type"in Et)&&q.type===Qi&&(q.type=xg(vt));else if(Ao(vt))q.channels=q.channels||4,gu(q,vt),q.alignment=1,q.needsFree=!0;else if(hi(vt)){var X=vt.data;!Array.isArray(X)&&q.type===Qi&&(q.type=xg(X));var j=vt.shape,nt=vt.stride,ht,gt,ot,rt,lt,W;j.length===3?(ot=j[2],W=nt[2]):($(j.length===2,"invalid ndarray pixel data, must be 2 or 3D"),ot=1,W=1),ht=j[0],gt=j[1],rt=nt[0],lt=nt[1],q.alignment=1,q.width=ht,q.height=gt,q.channels=ot,q.format=q.internalformat=Bc[ot],q.needsFree=!0,Hh(q,X,rt,lt,W,vt.offset)}else if(jc(vt)||Fc(vt)||yg(vt))jc(vt)||Fc(vt)?q.element=vt:q.element=vt.canvas,q.width=q.element.width,q.height=q.element.height,q.channels=4;else if(fu(vt))q.element=vt,q.width=vt.width,q.height=vt.height,q.channels=4;else if(bg(vt))q.element=vt,q.width=vt.naturalWidth,q.height=vt.naturalHeight,q.channels=4;else if(du(vt))q.element=vt,q.width=vt.videoWidth,q.height=vt.videoHeight,q.channels=4;else if(Jo(vt)){var et=q.width||vt[0].length,z=q.height||vt.length,ut=q.channels;qn(vt[0][0])?ut=ut||vt[0][0].length:ut=ut||1;for(var mt=Ms.shape(vt),Pt=1,Rt=0;Rt<mt.length;++Rt)Pt*=mt[Rt];var Mt=pu(q,Pt);Ms.flatten(vt,mt,"",Mt),Vh(q,Mt),q.alignment=1,q.width=et,q.height=z,q.channels=ut,q.format=q.internalformat=Bc[ut],q.needsFree=!0}q.type===Bs?$(tt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):q.type===Yo&&$(tt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Gt(q,Et,vt){var me=q.element,an=q.data,X=q.internalformat,j=q.format,nt=q.type,ht=q.width,gt=q.height;ze(q),me?M.texImage2D(Et,vt,j,j,nt,me):q.compressed?M.compressedTexImage2D(Et,vt,X,ht,gt,0,an):q.needsCopy?(wt(),M.copyTexImage2D(Et,vt,j,q.xOffset,q.yOffset,ht,gt,0)):M.texImage2D(Et,vt,j,ht,gt,0,j,nt,an||null)}function je(q,Et,vt,me,an){var X=q.element,j=q.data,nt=q.internalformat,ht=q.format,gt=q.type,ot=q.width,rt=q.height;ze(q),X?M.texSubImage2D(Et,an,vt,me,ht,gt,X):q.compressed?M.compressedTexSubImage2D(Et,an,vt,me,nt,ot,rt,j):q.needsCopy?(wt(),M.copyTexSubImage2D(Et,an,vt,me,q.xOffset,q.yOffset,ot,rt)):M.texSubImage2D(Et,an,vt,me,ot,rt,ht,gt,j)}var qe=[];function we(){return qe.pop()||new ae}function on(q){q.needsFree&&tr.freeType(q.data),ae.call(q),qe.push(q)}function He(){zt.call(this),this.genMipmaps=!1,this.mipmapHint=Ia,this.mipmask=0,this.images=Array(16)}function en(q,Et,vt){var me=q.images[0]=we();q.mipmask=1,me.width=q.width=Et,me.height=q.height=vt,me.channels=q.channels=4}function yn(q,Et){var vt=null;if(Gc(Et))vt=q.images[0]=we(),oe(vt,q),ne(vt,Et),q.mipmask=1;else if(Pe(q,Et),Array.isArray(Et.mipmap))for(var me=Et.mipmap,an=0;an<me.length;++an)vt=q.images[an]=we(),oe(vt,q),vt.width>>=an,vt.height>>=an,ne(vt,me[an]),q.mipmask|=1<<an;else vt=q.images[0]=we(),oe(vt,q),ne(vt,Et),q.mipmask=1;oe(q,q.images[0]),q.compressed&&(q.internalformat===ks||q.internalformat===Oa||q.internalformat===eu||q.internalformat===nu)&&$(q.width%4===0&&q.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function nr(q,Et){for(var vt=q.images,me=0;me<vt.length;++me){if(!vt[me])return;Gt(vt[me],Et,me)}}var cn=[];function ln(){var q=cn.pop()||new He;zt.call(q),q.mipmask=0;for(var Et=0;Et<16;++Et)q.images[Et]=null;return q}function lr(q){for(var Et=q.images,vt=0;vt<Et.length;++vt)Et[vt]&&on(Et[vt]),Et[vt]=null;cn.push(q)}function Pn(){this.minFilter=kc,this.magFilter=kc,this.wrapS=su,this.wrapT=su,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ia}function Vn(q,Et){if("min"in Et){var vt=Et.min;$.parameter(vt,Yt),q.minFilter=Yt[vt],pg.indexOf(q.minFilter)>=0&&!("faces"in Et)&&(q.genMipmaps=!0)}if("mag"in Et){var me=Et.mag;$.parameter(me,Kt),q.magFilter=Kt[me]}var an=q.wrapS,X=q.wrapT;if("wrap"in Et){var j=Et.wrap;typeof j=="string"?($.parameter(j,Wt),an=X=Wt[j]):Array.isArray(j)&&($.parameter(j[0],Wt),$.parameter(j[1],Wt),an=Wt[j[0]],X=Wt[j[1]])}else{if("wrapS"in Et){var nt=Et.wrapS;$.parameter(nt,Wt),an=Wt[nt]}if("wrapT"in Et){var ht=Et.wrapT;$.parameter(ht,Wt),X=Wt[ht]}}if(q.wrapS=an,q.wrapT=X,"anisotropic"in Et){var gt=Et.anisotropic;$(typeof gt=="number"&&gt>=1&&gt<=tt.maxAnisotropic,"aniso samples must be between 1 and "),q.anisotropic=Et.anisotropic}if("mipmap"in Et){var ot=!1;switch(typeof Et.mipmap){case"string":$.parameter(Et.mipmap,$t,"invalid mipmap hint"),q.mipmapHint=$t[Et.mipmap],q.genMipmaps=!0,ot=!0;break;case"boolean":ot=q.genMipmaps=Et.mipmap;break;case"object":$(Array.isArray(Et.mipmap),"invalid mipmap type"),q.genMipmaps=!1,ot=!0;break;default:$.raise("invalid mipmap type")}ot&&!("min"in Et)&&(q.minFilter=cu)}}function Jn(q,Et){M.texParameteri(Et,Rh,q.minFilter),M.texParameteri(Et,Dh,q.magFilter),M.texParameteri(Et,cg,q.wrapS),M.texParameteri(Et,Lc,q.wrapT),G.ext_texture_filter_anisotropic&&M.texParameteri(Et,dg,q.anisotropic),q.genMipmaps&&(M.hint(ug,q.mipmapHint),M.generateMipmap(Et))}var Hn=0,Gn={},xr=tt.maxTextureUnits,$n=Array(xr).map(function(){return null});function Ye(q){zt.call(this),this.mipmask=0,this.internalformat=Fi,this.id=Hn++,this.refCount=1,this.target=q,this.texture=M.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Pn,Tt.profile&&(this.stats={size:0})}function _r(q){M.activeTexture(lu),M.bindTexture(q.target,q.texture)}function _n(){var q=$n[0];q?M.bindTexture(q.target,q.texture):M.bindTexture(ai,null)}function Le(q){var Et=q.texture;$(Et,"must not double destroy texture");var vt=q.unit,me=q.target;vt>=0&&(M.activeTexture(lu+vt),M.bindTexture(me,null),$n[vt]=null),M.deleteTexture(Et),q.texture=null,q.params=null,q.pixels=null,q.refCount=0,delete Gn[q.id],xt.textureCount--}Nt(Ye.prototype,{bind:function(){var q=this;q.bindCount+=1;var Et=q.unit;if(Et<0){for(var vt=0;vt<xr;++vt){var me=$n[vt];if(me){if(me.bindCount>0)continue;me.unit=-1}$n[vt]=q,Et=vt;break}Et>=xr&&$.raise("insufficient number of texture units"),Tt.profile&&xt.maxTextureUnits<Et+1&&(xt.maxTextureUnits=Et+1),q.unit=Et,M.activeTexture(lu+Et),M.bindTexture(q.target,q.texture)}return Et},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Le(this)}});function nn(q,Et){var vt=new Ye(ai);Gn[vt.id]=vt,xt.textureCount++;function me(j,nt){var ht=vt.texInfo;Pn.call(ht);var gt=ln();return typeof j=="number"?typeof nt=="number"?en(gt,j|0,nt|0):en(gt,j|0,j|0):j?($.type(j,"object","invalid arguments to regl.texture"),Vn(ht,j),yn(gt,j)):en(gt,1,1),ht.genMipmaps&&(gt.mipmask=(gt.width<<1)-1),vt.mipmask=gt.mipmask,oe(vt,gt),$.texture2D(ht,gt,tt),vt.internalformat=gt.internalformat,me.width=gt.width,me.height=gt.height,_r(vt),nr(gt,ai),Jn(ht,ai),_n(),lr(gt),Tt.profile&&(vt.stats.size=mu(vt.internalformat,vt.type,gt.width,gt.height,ht.genMipmaps,!1)),me.format=ee[vt.internalformat],me.type=ue[vt.type],me.mag=Ft[ht.magFilter],me.min=ge[ht.minFilter],me.wrapS=Vt[ht.wrapS],me.wrapT=Vt[ht.wrapT],me}function an(j,nt,ht,gt){$(!!j,"must specify image data");var ot=nt|0,rt=ht|0,lt=gt|0,W=we();return oe(W,vt),W.width=0,W.height=0,ne(W,j),W.width=W.width||(vt.width>>lt)-ot,W.height=W.height||(vt.height>>lt)-rt,$(vt.type===W.type&&vt.format===W.format&&vt.internalformat===W.internalformat,"incompatible format for texture.subimage"),$(ot>=0&&rt>=0&&ot+W.width<=vt.width&&rt+W.height<=vt.height,"texture.subimage write out of bounds"),$(vt.mipmask&1<<lt,"missing mipmap data"),$(W.data||W.element||W.needsCopy,"missing image data"),_r(vt),je(W,ai,ot,rt,lt),_n(),on(W),me}function X(j,nt){var ht=j|0,gt=nt|0||ht;if(ht===vt.width&&gt===vt.height)return me;me.width=vt.width=ht,me.height=vt.height=gt,_r(vt);for(var ot=0;vt.mipmask>>ot;++ot){var rt=ht>>ot,lt=gt>>ot;if(!rt||!lt)break;M.texImage2D(ai,ot,vt.format,rt,lt,0,vt.format,vt.type,null)}return _n(),Tt.profile&&(vt.stats.size=mu(vt.internalformat,vt.type,ht,gt,!1,!1)),me}return me(q,Et),me.subimage=an,me.resize=X,me._reglType="texture2d",me._texture=vt,Tt.profile&&(me.stats=vt.stats),me.destroy=function(){vt.decRef()},me}function fn(q,Et,vt,me,an,X){var j=new Ye(Jl);Gn[j.id]=j,xt.cubeCount++;var nt=new Array(6);function ht(rt,lt,W,et,z,ut){var mt,Pt=j.texInfo;for(Pn.call(Pt),mt=0;mt<6;++mt)nt[mt]=ln();if(typeof rt=="number"||!rt){var Rt=rt|0||1;for(mt=0;mt<6;++mt)en(nt[mt],Rt,Rt)}else if(typeof rt=="object")if(lt)yn(nt[0],rt),yn(nt[1],lt),yn(nt[2],W),yn(nt[3],et),yn(nt[4],z),yn(nt[5],ut);else if(Vn(Pt,rt),Pe(j,rt),"faces"in rt){var Mt=rt.faces;for($(Array.isArray(Mt)&&Mt.length===6,"cube faces must be a length 6 array"),mt=0;mt<6;++mt)$(typeof Mt[mt]=="object"&&!!Mt[mt],"invalid input for cube map face"),oe(nt[mt],j),yn(nt[mt],Mt[mt])}else for(mt=0;mt<6;++mt)yn(nt[mt],rt);else $.raise("invalid arguments to cube map");for(oe(j,nt[0]),tt.npotTextureCube||$(Ac(j.width)&&Ac(j.height),"your browser does not support non power or two texture dimensions"),Pt.genMipmaps?j.mipmask=(nt[0].width<<1)-1:j.mipmask=nt[0].mipmask,$.textureCube(j,Pt,nt,tt),j.internalformat=nt[0].internalformat,ht.width=nt[0].width,ht.height=nt[0].height,_r(j),mt=0;mt<6;++mt)nr(nt[mt],Kl+mt);for(Jn(Pt,Jl),_n(),Tt.profile&&(j.stats.size=mu(j.internalformat,j.type,ht.width,ht.height,Pt.genMipmaps,!0)),ht.format=ee[j.internalformat],ht.type=ue[j.type],ht.mag=Ft[Pt.magFilter],ht.min=ge[Pt.minFilter],ht.wrapS=Vt[Pt.wrapS],ht.wrapT=Vt[Pt.wrapT],mt=0;mt<6;++mt)lr(nt[mt]);return ht}function gt(rt,lt,W,et,z){$(!!lt,"must specify image data"),$(typeof rt=="number"&&rt===(rt|0)&&rt>=0&&rt<6,"invalid face");var ut=W|0,mt=et|0,Pt=z|0,Rt=we();return oe(Rt,j),Rt.width=0,Rt.height=0,ne(Rt,lt),Rt.width=Rt.width||(j.width>>Pt)-ut,Rt.height=Rt.height||(j.height>>Pt)-mt,$(j.type===Rt.type&&j.format===Rt.format&&j.internalformat===Rt.internalformat,"incompatible format for texture.subimage"),$(ut>=0&&mt>=0&&ut+Rt.width<=j.width&&mt+Rt.height<=j.height,"texture.subimage write out of bounds"),$(j.mipmask&1<<Pt,"missing mipmap data"),$(Rt.data||Rt.element||Rt.needsCopy,"missing image data"),_r(j),je(Rt,Kl+rt,ut,mt,Pt),_n(),on(Rt),ht}function ot(rt){var lt=rt|0;if(lt!==j.width){ht.width=j.width=lt,ht.height=j.height=lt,_r(j);for(var W=0;W<6;++W)for(var et=0;j.mipmask>>et;++et)M.texImage2D(Kl+W,et,j.format,lt>>et,lt>>et,0,j.format,j.type,null);return _n(),Tt.profile&&(j.stats.size=mu(j.internalformat,j.type,ht.width,ht.height,!1,!0)),ht}}return ht(q,Et,vt,me,an,X),ht.subimage=gt,ht.resize=ot,ht._reglType="textureCube",ht._texture=j,Tt.profile&&(ht.stats=j.stats),ht.destroy=function(){j.decRef()},ht}function Kn(){for(var q=0;q<xr;++q)M.activeTexture(lu+q),M.bindTexture(ai,null),$n[q]=null;Kr(Gn).forEach(Le),xt.cubeCount=0,xt.textureCount=0}Tt.profile&&(xt.getTotalTextureSize=function(){var q=0;return Object.keys(Gn).forEach(function(Et){q+=Gn[Et].stats.size}),q});function Oi(){for(var q=0;q<xr;++q){var Et=$n[q];Et&&(Et.bindCount=0,Et.unit=-1,$n[q]=null)}Kr(Gn).forEach(function(vt){vt.texture=M.createTexture(),M.bindTexture(vt.target,vt.texture);for(var me=0;me<32;++me)if(vt.mipmask&1<<me)if(vt.target===ai)M.texImage2D(ai,me,vt.internalformat,vt.width>>me,vt.height>>me,0,vt.internalformat,vt.type,null);else for(var an=0;an<6;++an)M.texImage2D(Kl+an,me,vt.internalformat,vt.width>>me,vt.height>>me,0,vt.internalformat,vt.type,null);Jn(vt.texInfo,vt.target)})}function No(){for(var q=0;q<xr;++q){var Et=$n[q];Et&&(Et.bindCount=0,Et.unit=-1,$n[q]=null),M.activeTexture(lu+q),M.bindTexture(ai,null),M.bindTexture(Jl,null)}}return{create2D:nn,createCube:fn,clear:Kn,getTexture:function(q){return null},restore:Oi,refresh:No}}var Ko=36161,Gs=32854,$h=32855,vu=36194,Wh=33189,yu=36168,bu=34041,xu=35907,Xh=34836,wu=34842,Eu=34843,Si=[];Si[Gs]=2,Si[$h]=2,Si[vu]=2,Si[Wh]=2,Si[yu]=1,Si[bu]=4,Si[xu]=4,Si[Xh]=16,Si[wu]=8,Si[Eu]=6;function Ma(M,G,tt){return Si[M]*G*tt}var wg=function(M,G,tt,wt,Dt){var xt={rgba4:Gs,rgb565:vu,"rgb5 a1":$h,depth:Wh,stencil:yu,"depth stencil":bu};G.ext_srgb&&(xt.srgba=xu),G.ext_color_buffer_half_float&&(xt.rgba16f=wu,xt.rgb16f=Eu),G.webgl_color_buffer_float&&(xt.rgba32f=Xh);var Tt=[];Object.keys(xt).forEach(function(Zt){var ie=xt[Zt];Tt[ie]=Zt});var $t=0,Wt={};function Kt(Zt){this.id=$t++,this.refCount=1,this.renderbuffer=Zt,this.format=Gs,this.width=0,this.height=0,Dt.profile&&(this.stats={size:0})}Kt.prototype.decRef=function(){--this.refCount<=0&&Yt(this)};function Yt(Zt){var ie=Zt.renderbuffer;$(ie,"must not double destroy renderbuffer"),M.bindRenderbuffer(Ko,null),M.deleteRenderbuffer(ie),Zt.renderbuffer=null,Zt.refCount=0,delete Wt[Zt.id],wt.renderbufferCount--}function re(Zt,ie){var ft=new Kt(M.createRenderbuffer());Wt[ft.id]=ft,wt.renderbufferCount++;function St(ue,Ft){var ge=0,Vt=0,se=Gs;if(typeof ue=="object"&&ue){var zt=ue;if("shape"in zt){var oe=zt.shape;$(Array.isArray(oe)&&oe.length>=2,"invalid renderbuffer shape"),ge=oe[0]|0,Vt=oe[1]|0}else"radius"in zt&&(ge=Vt=zt.radius|0),"width"in zt&&(ge=zt.width|0),"height"in zt&&(Vt=zt.height|0);"format"in zt&&($.parameter(zt.format,xt,"invalid renderbuffer format"),se=xt[zt.format])}else typeof ue=="number"?(ge=ue|0,typeof Ft=="number"?Vt=Ft|0:Vt=ge):ue?$.raise("invalid arguments to renderbuffer constructor"):ge=Vt=1;if($(ge>0&&Vt>0&&ge<=tt.maxRenderbufferSize&&Vt<=tt.maxRenderbufferSize,"invalid renderbuffer size"),!(ge===ft.width&&Vt===ft.height&&se===ft.format))return St.width=ft.width=ge,St.height=ft.height=Vt,ft.format=se,M.bindRenderbuffer(Ko,ft.renderbuffer),M.renderbufferStorage(Ko,se,ge,Vt),$(M.getError()===0,"invalid render buffer format"),Dt.profile&&(ft.stats.size=Ma(ft.format,ft.width,ft.height)),St.format=Tt[ft.format],St}function ee(ue,Ft){var ge=ue|0,Vt=Ft|0||ge;return ge===ft.width&&Vt===ft.height||($(ge>0&&Vt>0&&ge<=tt.maxRenderbufferSize&&Vt<=tt.maxRenderbufferSize,"invalid renderbuffer size"),St.width=ft.width=ge,St.height=ft.height=Vt,M.bindRenderbuffer(Ko,ft.renderbuffer),M.renderbufferStorage(Ko,ft.format,ge,Vt),$(M.getError()===0,"invalid render buffer format"),Dt.profile&&(ft.stats.size=Ma(ft.format,ft.width,ft.height))),St}return St(Zt,ie),St.resize=ee,St._reglType="renderbuffer",St._renderbuffer=ft,Dt.profile&&(St.stats=ft.stats),St.destroy=function(){ft.decRef()},St}Dt.profile&&(wt.getTotalRenderbufferSize=function(){var Zt=0;return Object.keys(Wt).forEach(function(ie){Zt+=Wt[ie].stats.size}),Zt});function ce(){Kr(Wt).forEach(function(Zt){Zt.renderbuffer=M.createRenderbuffer(),M.bindRenderbuffer(Ko,Zt.renderbuffer),M.renderbufferStorage(Ko,Zt.format,Zt.width,Zt.height)}),M.bindRenderbuffer(Ko,null)}return{create:re,clear:function(){Kr(Wt).forEach(Yt)},restore:ce}},Gi=36160,Uc=36161,ei=3553,zs=34069,Na=36064,Zh=36096,_u=36128,Su=33306,Vc=36053,qh=36054,Yh=36055,Jh=36057,Eg=36061,Qo=36193,fi=5121,_g=5126,Au=6407,Tu=6408,Kh=6402,gm=[Au,Tu],Cu=[];Cu[Tu]=4,Cu[Au]=3;var Hc=[];Hc[fi]=1,Hc[_g]=4,Hc[Qo]=2;var Sg=32854,Ag=32855,pm=36194,Tg=33189,mm=36168,Qh=34041,Cg=35907,Og=34836,Ig=34842,Mg=34843,Ng=[Sg,Ag,pm,Cg,Ig,Mg,Og],Us={};Us[Vc]="complete",Us[qh]="incomplete attachment",Us[Jh]="incomplete dimensions",Us[Yh]="incomplete, missing attachment",Us[Eg]="unsupported";function Ou(M,G,tt,wt,Dt,xt){var Tt={cur:null,next:null,dirty:!1,setFBO:null},$t=["rgba"],Wt=["rgba4","rgb565","rgb5 a1"];G.ext_srgb&&Wt.push("srgba"),G.ext_color_buffer_half_float&&Wt.push("rgba16f","rgb16f"),G.webgl_color_buffer_float&&Wt.push("rgba32f");var Kt=["uint8"];G.oes_texture_half_float&&Kt.push("half float","float16"),G.oes_texture_float&&Kt.push("float","float32");function Yt(ae,ne,Gt){this.target=ae,this.texture=ne,this.renderbuffer=Gt;var je=0,qe=0;ne?(je=ne.width,qe=ne.height):Gt&&(je=Gt.width,qe=Gt.height),this.width=je,this.height=qe}function re(ae){ae&&(ae.texture&&ae.texture._texture.decRef(),ae.renderbuffer&&ae.renderbuffer._renderbuffer.decRef())}function ce(ae,ne,Gt){if(ae)if(ae.texture){var je=ae.texture._texture,qe=Math.max(1,je.width),we=Math.max(1,je.height);$(qe===ne&&we===Gt,"inconsistent width/height for supplied texture"),je.refCount+=1}else{var on=ae.renderbuffer._renderbuffer;$(on.width===ne&&on.height===Gt,"inconsistent width/height for renderbuffer"),on.refCount+=1}}function Zt(ae,ne){ne&&(ne.texture?M.framebufferTexture2D(Gi,ae,ne.target,ne.texture._texture.texture,0):M.framebufferRenderbuffer(Gi,ae,Uc,ne.renderbuffer._renderbuffer.renderbuffer))}function ie(ae){var ne=ei,Gt=null,je=null,qe=ae;typeof ae=="object"&&(qe=ae.data,"target"in ae&&(ne=ae.target|0)),$.type(qe,"function","invalid attachment data");var we=qe._reglType;return we==="texture2d"?(Gt=qe,$(ne===ei)):we==="textureCube"?(Gt=qe,$(ne>=zs&&ne<zs+6,"invalid cube map target")):we==="renderbuffer"?(je=qe,ne=Uc):$.raise("invalid regl object for attachment"),new Yt(ne,Gt,je)}function ft(ae,ne,Gt,je,qe){if(Gt){var we=wt.create2D({width:ae,height:ne,format:je,type:qe});return we._texture.refCount=0,new Yt(ei,we,null)}else{var on=Dt.create({width:ae,height:ne,format:je});return on._renderbuffer.refCount=0,new Yt(Uc,null,on)}}function St(ae){return ae&&(ae.texture||ae.renderbuffer)}function ee(ae,ne,Gt){ae&&(ae.texture?ae.texture.resize(ne,Gt):ae.renderbuffer&&ae.renderbuffer.resize(ne,Gt),ae.width=ne,ae.height=Gt)}var ue=0,Ft={};function ge(){this.id=ue++,Ft[this.id]=this,this.framebuffer=M.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Vt(ae){ae.colorAttachments.forEach(re),re(ae.depthAttachment),re(ae.stencilAttachment),re(ae.depthStencilAttachment)}function se(ae){var ne=ae.framebuffer;$(ne,"must not double destroy framebuffer"),M.deleteFramebuffer(ne),ae.framebuffer=null,xt.framebufferCount--,delete Ft[ae.id]}function zt(ae){var ne;M.bindFramebuffer(Gi,ae.framebuffer);var Gt=ae.colorAttachments;for(ne=0;ne<Gt.length;++ne)Zt(Na+ne,Gt[ne]);for(ne=Gt.length;ne<tt.maxColorAttachments;++ne)M.framebufferTexture2D(Gi,Na+ne,ei,null,0);M.framebufferTexture2D(Gi,Su,ei,null,0),M.framebufferTexture2D(Gi,Zh,ei,null,0),M.framebufferTexture2D(Gi,_u,ei,null,0),Zt(Zh,ae.depthAttachment),Zt(_u,ae.stencilAttachment),Zt(Su,ae.depthStencilAttachment);var je=M.checkFramebufferStatus(Gi);!M.isContextLost()&&je!==Vc&&$.raise("framebuffer configuration not supported, status = "+Us[je]),M.bindFramebuffer(Gi,Tt.next?Tt.next.framebuffer:null),Tt.cur=Tt.next,M.getError()}function oe(ae,ne){var Gt=new ge;xt.framebufferCount++;function je(we,on){var He;$(Tt.next!==Gt,"can not update framebuffer which is currently in use");var en=0,yn=0,nr=!0,cn=!0,ln=null,lr=!0,Pn="rgba",Vn="uint8",Jn=1,Hn=null,Gn=null,xr=null,$n=!1;if(typeof we=="number")en=we|0,yn=on|0||en;else if(!we)en=yn=1;else{$.type(we,"object","invalid arguments for framebuffer");var Ye=we;if("shape"in Ye){var _r=Ye.shape;$(Array.isArray(_r)&&_r.length>=2,"invalid shape for framebuffer"),en=_r[0],yn=_r[1]}else"radius"in Ye&&(en=yn=Ye.radius),"width"in Ye&&(en=Ye.width),"height"in Ye&&(yn=Ye.height);("color"in Ye||"colors"in Ye)&&(ln=Ye.color||Ye.colors,Array.isArray(ln)&&$(ln.length===1||G.webgl_draw_buffers,"multiple render targets not supported")),ln||("colorCount"in Ye&&(Jn=Ye.colorCount|0,$(Jn>0,"invalid color buffer count")),"colorTexture"in Ye&&(lr=!!Ye.colorTexture,Pn="rgba4"),"colorType"in Ye&&(Vn=Ye.colorType,lr?($(G.oes_texture_float||!(Vn==="float"||Vn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(G.oes_texture_half_float||!(Vn==="half float"||Vn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Vn==="half float"||Vn==="float16"?($(G.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Pn="rgba16f"):(Vn==="float"||Vn==="float32")&&($(G.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Pn="rgba32f"),$.oneOf(Vn,Kt,"invalid color type")),"colorFormat"in Ye&&(Pn=Ye.colorFormat,$t.indexOf(Pn)>=0?lr=!0:Wt.indexOf(Pn)>=0?lr=!1:lr?$.oneOf(Ye.colorFormat,$t,"invalid color format for texture"):$.oneOf(Ye.colorFormat,Wt,"invalid color format for renderbuffer"))),("depthTexture"in Ye||"depthStencilTexture"in Ye)&&($n=!!(Ye.depthTexture||Ye.depthStencilTexture),$(!$n||G.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ye&&(typeof Ye.depth=="boolean"?nr=Ye.depth:(Hn=Ye.depth,cn=!1)),"stencil"in Ye&&(typeof Ye.stencil=="boolean"?cn=Ye.stencil:(Gn=Ye.stencil,nr=!1)),"depthStencil"in Ye&&(typeof Ye.depthStencil=="boolean"?nr=cn=Ye.depthStencil:(xr=Ye.depthStencil,nr=!1,cn=!1))}var _n=null,Le=null,nn=null,fn=null;if(Array.isArray(ln))_n=ln.map(ie);else if(ln)_n=[ie(ln)];else for(_n=new Array(Jn),He=0;He<Jn;++He)_n[He]=ft(en,yn,lr,Pn,Vn);$(G.webgl_draw_buffers||_n.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(_n.length<=tt.maxColorAttachments,"too many color attachments, not supported"),en=en||_n[0].width,yn=yn||_n[0].height,Hn?Le=ie(Hn):nr&&!cn&&(Le=ft(en,yn,$n,"depth","uint32")),Gn?nn=ie(Gn):cn&&!nr&&(nn=ft(en,yn,!1,"stencil","uint8")),xr?fn=ie(xr):!Hn&&!Gn&&cn&&nr&&(fn=ft(en,yn,$n,"depth stencil","depth stencil")),$(!!Hn+!!Gn+!!xr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Kn=null;for(He=0;He<_n.length;++He)if(ce(_n[He],en,yn),$(!_n[He]||_n[He].texture&&gm.indexOf(_n[He].texture._texture.format)>=0||_n[He].renderbuffer&&Ng.indexOf(_n[He].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+He+" is invalid"),_n[He]&&_n[He].texture){var Oi=Cu[_n[He].texture._texture.format]*Hc[_n[He].texture._texture.type];Kn===null?Kn=Oi:$(Kn===Oi,"all color attachments much have the same number of bits per pixel.")}return ce(Le,en,yn),$(!Le||Le.texture&&Le.texture._texture.format===Kh||Le.renderbuffer&&Le.renderbuffer._renderbuffer.format===Tg,"invalid depth attachment for framebuffer object"),ce(nn,en,yn),$(!nn||nn.renderbuffer&&nn.renderbuffer._renderbuffer.format===mm,"invalid stencil attachment for framebuffer object"),ce(fn,en,yn),$(!fn||fn.texture&&fn.texture._texture.format===Qh||fn.renderbuffer&&fn.renderbuffer._renderbuffer.format===Qh,"invalid depth-stencil attachment for framebuffer object"),Vt(Gt),Gt.width=en,Gt.height=yn,Gt.colorAttachments=_n,Gt.depthAttachment=Le,Gt.stencilAttachment=nn,Gt.depthStencilAttachment=fn,je.color=_n.map(St),je.depth=St(Le),je.stencil=St(nn),je.depthStencil=St(fn),je.width=Gt.width,je.height=Gt.height,zt(Gt),je}function qe(we,on){$(Tt.next!==Gt,"can not resize a framebuffer which is currently in use");var He=Math.max(we|0,1),en=Math.max(on|0||He,1);if(He===Gt.width&&en===Gt.height)return je;for(var yn=Gt.colorAttachments,nr=0;nr<yn.length;++nr)ee(yn[nr],He,en);return ee(Gt.depthAttachment,He,en),ee(Gt.stencilAttachment,He,en),ee(Gt.depthStencilAttachment,He,en),Gt.width=je.width=He,Gt.height=je.height=en,zt(Gt),je}return je(ae,ne),Nt(je,{resize:qe,_reglType:"framebuffer",_framebuffer:Gt,destroy:function(){se(Gt),Vt(Gt)},use:function(we){Tt.setFBO({framebuffer:je},we)}})}function Pe(ae){var ne=Array(6);function Gt(qe){var we;$(ne.indexOf(Tt.next)<0,"can not update framebuffer which is currently in use");var on={color:null},He=0,en=null,yn="rgba",nr="uint8",cn=1;if(typeof qe=="number")He=qe|0;else if(!qe)He=1;else{$.type(qe,"object","invalid arguments for framebuffer");var ln=qe;if("shape"in ln){var lr=ln.shape;$(Array.isArray(lr)&&lr.length>=2,"invalid shape for framebuffer"),$(lr[0]===lr[1],"cube framebuffer must be square"),He=lr[0]}else"radius"in ln&&(He=ln.radius|0),"width"in ln?(He=ln.width|0,"height"in ln&&$(ln.height===He,"must be square")):"height"in ln&&(He=ln.height|0);("color"in ln||"colors"in ln)&&(en=ln.color||ln.colors,Array.isArray(en)&&$(en.length===1||G.webgl_draw_buffers,"multiple render targets not supported")),en||("colorCount"in ln&&(cn=ln.colorCount|0,$(cn>0,"invalid color buffer count")),"colorType"in ln&&($.oneOf(ln.colorType,Kt,"invalid color type"),nr=ln.colorType),"colorFormat"in ln&&(yn=ln.colorFormat,$.oneOf(ln.colorFormat,$t,"invalid color format for texture"))),"depth"in ln&&(on.depth=ln.depth),"stencil"in ln&&(on.stencil=ln.stencil),"depthStencil"in ln&&(on.depthStencil=ln.depthStencil)}var Pn;if(en)if(Array.isArray(en))for(Pn=[],we=0;we<en.length;++we)Pn[we]=en[we];else Pn=[en];else{Pn=Array(cn);var Vn={radius:He,format:yn,type:nr};for(we=0;we<cn;++we)Pn[we]=wt.createCube(Vn)}for(on.color=Array(Pn.length),we=0;we<Pn.length;++we){var Jn=Pn[we];$(typeof Jn=="function"&&Jn._reglType==="textureCube","invalid cube map"),He=He||Jn.width,$(Jn.width===He&&Jn.height===He,"invalid cube map shape"),on.color[we]={target:zs,data:Pn[we]}}for(we=0;we<6;++we){for(var Hn=0;Hn<Pn.length;++Hn)on.color[Hn].target=zs+we;we>0&&(on.depth=ne[0].depth,on.stencil=ne[0].stencil,on.depthStencil=ne[0].depthStencil),ne[we]?ne[we](on):ne[we]=oe(on)}return Nt(Gt,{width:He,height:He,color:Pn})}function je(qe){var we,on=qe|0;if($(on>0&&on<=tt.maxCubeMapSize,"invalid radius for cube fbo"),on===Gt.width)return Gt;var He=Gt.color;for(we=0;we<He.length;++we)He[we].resize(on);for(we=0;we<6;++we)ne[we].resize(on);return Gt.width=Gt.height=on,Gt}return Gt(ae),Nt(Gt,{faces:ne,resize:je,_reglType:"framebufferCube",destroy:function(){ne.forEach(function(qe){qe.destroy()})}})}function ze(){Tt.cur=null,Tt.next=null,Tt.dirty=!0,Kr(Ft).forEach(function(ae){ae.framebuffer=M.createFramebuffer(),zt(ae)})}return Nt(Tt,{getFramebuffer:function(ae){if(typeof ae=="function"&&ae._reglType==="framebuffer"){var ne=ae._framebuffer;if(ne instanceof ge)return ne}return null},create:oe,createCube:Pe,clear:function(){Kr(Ft).forEach(se)},restore:ze})}var Pg=5126,tf=34962;function Iu(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Pg,this.offset=0,this.stride=0,this.divisor=0}function Dg(M,G,tt,wt,Dt){for(var xt=tt.maxAttributes,Tt=new Array(xt),$t=0;$t<xt;++$t)Tt[$t]=new Iu;var Wt=0,Kt={},Yt={Record:Iu,scope:{},state:Tt,currentVAO:null,targetVAO:null,restore:ce()?Ft:function(){},createVAO:ge,getVAO:ie,destroyBuffer:re,setVAO:ce()?ft:St,clear:ce()?ee:function(){}};function re(Vt){for(var se=0;se<Tt.length;++se){var zt=Tt[se];zt.buffer===Vt&&(M.disableVertexAttribArray(se),zt.buffer=null)}}function ce(){return G.oes_vertex_array_object}function Zt(){return G.angle_instanced_arrays}function ie(Vt){return typeof Vt=="function"&&Vt._vao?Vt._vao:null}function ft(Vt){if(Vt!==Yt.currentVAO){var se=ce();Vt?se.bindVertexArrayOES(Vt.vao):se.bindVertexArrayOES(null),Yt.currentVAO=Vt}}function St(Vt){if(Vt!==Yt.currentVAO){if(Vt)Vt.bindAttrs();else for(var se=Zt(),zt=0;zt<Tt.length;++zt){var oe=Tt[zt];oe.buffer?(M.enableVertexAttribArray(zt),M.vertexAttribPointer(zt,oe.size,oe.type,oe.normalized,oe.stride,oe.offfset),se&&oe.divisor&&se.vertexAttribDivisorANGLE(zt,oe.divisor)):(M.disableVertexAttribArray(zt),M.vertexAttrib4f(zt,oe.x,oe.y,oe.z,oe.w))}Yt.currentVAO=Vt}}function ee(){Kr(Kt).forEach(function(Vt){Vt.destroy()})}function ue(){this.id=++Wt,this.attributes=[];var Vt=ce();Vt?this.vao=Vt.createVertexArrayOES():this.vao=null,Kt[this.id]=this,this.buffers=[]}ue.prototype.bindAttrs=function(){for(var Vt=Zt(),se=this.attributes,zt=0;zt<se.length;++zt){var oe=se[zt];oe.buffer?(M.enableVertexAttribArray(zt),M.bindBuffer(tf,oe.buffer.buffer),M.vertexAttribPointer(zt,oe.size,oe.type,oe.normalized,oe.stride,oe.offset),Vt&&oe.divisor&&Vt.vertexAttribDivisorANGLE(zt,oe.divisor)):(M.disableVertexAttribArray(zt),M.vertexAttrib4f(zt,oe.x,oe.y,oe.z,oe.w))}for(var Pe=se.length;Pe<xt;++Pe)M.disableVertexAttribArray(Pe)},ue.prototype.refresh=function(){var Vt=ce();Vt&&(Vt.bindVertexArrayOES(this.vao),this.bindAttrs(),Yt.currentVAO=this)},ue.prototype.destroy=function(){if(this.vao){var Vt=ce();this===Yt.currentVAO&&(Yt.currentVAO=null,Vt.bindVertexArrayOES(null)),Vt.deleteVertexArrayOES(this.vao),this.vao=null}Kt[this.id]&&(delete Kt[this.id],wt.vaoCount-=1)};function Ft(){var Vt=ce();Vt&&Kr(Kt).forEach(function(se){se.refresh()})}function ge(Vt){var se=new ue;wt.vaoCount+=1;function zt(oe){$(Array.isArray(oe),"arguments to vertex array constructor must be an array"),$(oe.length<xt,"too many attributes"),$(oe.length>0,"must specify at least one attribute");var Pe={},ze=se.attributes;ze.length=oe.length;for(var ae=0;ae<oe.length;++ae){var ne=oe[ae],Gt=ze[ae]=new Iu,je=ne.data||ne;if(Array.isArray(je)||wn(je)||hi(je)){var qe;se.buffers[ae]&&(qe=se.buffers[ae],wn(je)&&qe._buffer.byteLength>=je.byteLength?qe.subdata(je):(qe.destroy(),se.buffers[ae]=null)),se.buffers[ae]||(qe=se.buffers[ae]=Dt.create(ne,tf,!1,!0)),Gt.buffer=Dt.getBuffer(qe),Gt.size=Gt.buffer.dimension|0,Gt.normalized=!1,Gt.type=Gt.buffer.dtype,Gt.offset=0,Gt.stride=0,Gt.divisor=0,Gt.state=1,Pe[ae]=1}else Dt.getBuffer(ne)?(Gt.buffer=Dt.getBuffer(ne),Gt.size=Gt.buffer.dimension|0,Gt.normalized=!1,Gt.type=Gt.buffer.dtype,Gt.offset=0,Gt.stride=0,Gt.divisor=0,Gt.state=1):Dt.getBuffer(ne.buffer)?(Gt.buffer=Dt.getBuffer(ne.buffer),Gt.size=(+ne.size||Gt.buffer.dimension)|0,Gt.normalized=!!ne.normalized||!1,"type"in ne?($.parameter(ne.type,wo,"invalid buffer type"),Gt.type=wo[ne.type]):Gt.type=Gt.buffer.dtype,Gt.offset=(ne.offset||0)|0,Gt.stride=(ne.stride||0)|0,Gt.divisor=(ne.divisor||0)|0,Gt.state=1,$(Gt.size>=1&&Gt.size<=4,"size must be between 1 and 4"),$(Gt.offset>=0,"invalid offset"),$(Gt.stride>=0&&Gt.stride<=255,"stride must be between 0 and 255"),$(Gt.divisor>=0,"divisor must be positive"),$(!Gt.divisor||!!G.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ne?($(ae>0,"first attribute must not be a constant"),Gt.x=+ne.x||0,Gt.y=+ne.y||0,Gt.z=+ne.z||0,Gt.w=+ne.w||0,Gt.state=2):$(!1,"invalid attribute spec for location "+ae)}for(var we=0;we<se.buffers.length;++we)!Pe[we]&&se.buffers[we]&&(se.buffers[we].destroy(),se.buffers[we]=null);return se.refresh(),zt}return zt.destroy=function(){for(var oe=0;oe<se.buffers.length;++oe)se.buffers[oe]&&se.buffers[oe].destroy();se.buffers.length=0,se.destroy()},zt._vao=se,zt._reglType="vao",zt(Vt)}return Yt}var Rn=35632,Rg=35633,Lg=35718,kg=35721;function Pa(M,G,tt,wt){var Dt={},xt={};function Tt(ft,St,ee,ue){this.name=ft,this.id=St,this.location=ee,this.info=ue}function $t(ft,St){for(var ee=0;ee<ft.length;++ee)if(ft[ee].id===St.id){ft[ee].location=St.location;return}ft.push(St)}function Wt(ft,St,ee){var ue=ft===Rn?Dt:xt,Ft=ue[St];if(!Ft){var ge=G.str(St);Ft=M.createShader(ft),M.shaderSource(Ft,ge),M.compileShader(Ft),$.shaderError(M,Ft,ge,ft,ee),ue[St]=Ft}return Ft}var Kt={},Yt=[],re=0;function ce(ft,St){this.id=re++,this.fragId=ft,this.vertId=St,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,wt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Zt(ft,St,ee){var ue,Ft,ge=Wt(Rn,ft.fragId),Vt=Wt(Rg,ft.vertId),se=ft.program=M.createProgram();if(M.attachShader(se,ge),M.attachShader(se,Vt),ee)for(ue=0;ue<ee.length;++ue){var zt=ee[ue];M.bindAttribLocation(se,zt[0],zt[1])}M.linkProgram(se),$.linkError(M,se,G.str(ft.fragId),G.str(ft.vertId),St);var oe=M.getProgramParameter(se,Lg);wt.profile&&(ft.stats.uniformsCount=oe);var Pe=ft.uniforms;for(ue=0;ue<oe;++ue)if(Ft=M.getActiveUniform(se,ue),Ft)if(Ft.size>1)for(var ze=0;ze<Ft.size;++ze){var ae=Ft.name.replace("[0]","["+ze+"]");$t(Pe,new Tt(ae,G.id(ae),M.getUniformLocation(se,ae),Ft))}else $t(Pe,new Tt(Ft.name,G.id(Ft.name),M.getUniformLocation(se,Ft.name),Ft));var ne=M.getProgramParameter(se,kg);wt.profile&&(ft.stats.attributesCount=ne);var Gt=ft.attributes;for(ue=0;ue<ne;++ue)Ft=M.getActiveAttrib(se,ue),Ft&&$t(Gt,new Tt(Ft.name,G.id(Ft.name),M.getAttribLocation(se,Ft.name),Ft))}wt.profile&&(tt.getMaxUniformsCount=function(){var ft=0;return Yt.forEach(function(St){St.stats.uniformsCount>ft&&(ft=St.stats.uniformsCount)}),ft},tt.getMaxAttributesCount=function(){var ft=0;return Yt.forEach(function(St){St.stats.attributesCount>ft&&(ft=St.stats.attributesCount)}),ft});function ie(){Dt={},xt={};for(var ft=0;ft<Yt.length;++ft)Zt(Yt[ft],null,Yt[ft].attributes.map(function(St){return[St.location,St.name]}))}return{clear:function(){var ft=M.deleteShader.bind(M);Kr(Dt).forEach(ft),Dt={},Kr(xt).forEach(ft),xt={},Yt.forEach(function(St){M.deleteProgram(St.program)}),Yt.length=0,Kt={},tt.shaderCount=0},program:function(ft,St,ee,ue){$.command(ft>=0,"missing vertex shader",ee),$.command(St>=0,"missing fragment shader",ee);var Ft=Kt[St];Ft||(Ft=Kt[St]={});var ge=Ft[ft];if(ge&&(ge.refCount++,!ue))return ge;var Vt=new ce(St,ft);return tt.shaderCount++,Zt(Vt,ee,ue),ge||(Ft[ft]=Vt),Yt.push(Vt),Nt(Vt,{destroy:function(){if(Vt.refCount--,Vt.refCount<=0){M.deleteProgram(Vt.program);var se=Yt.indexOf(Vt);Yt.splice(se,1),tt.shaderCount--}Ft[Vt.vertId].refCount<=0&&(M.deleteShader(xt[Vt.vertId]),delete xt[Vt.vertId],delete Kt[Vt.fragId][Vt.vertId]),Object.keys(Kt[Vt.fragId]).length||(M.deleteShader(Dt[Vt.fragId]),delete Dt[Vt.fragId],delete Kt[Vt.fragId])}})},restore:ie,shader:Wt,frag:-1,vert:-1}}var Bg=6408,Vs=5121,Da=3333,$c=5126;function Mu(M,G,tt,wt,Dt,xt,Tt){function $t(Yt){var re;G.next===null?($(Dt.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),re=Vs):($(G.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),re=G.next.colorAttachments[0].texture._texture.type,xt.oes_texture_float?($(re===Vs||re===$c,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),re===$c&&$(Tt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(re===Vs,"Reading from a framebuffer is only allowed for the type 'uint8'"));var ce=0,Zt=0,ie=wt.framebufferWidth,ft=wt.framebufferHeight,St=null;wn(Yt)?St=Yt:Yt&&($.type(Yt,"object","invalid arguments to regl.read()"),ce=Yt.x|0,Zt=Yt.y|0,$(ce>=0&&ce<wt.framebufferWidth,"invalid x offset for regl.read"),$(Zt>=0&&Zt<wt.framebufferHeight,"invalid y offset for regl.read"),ie=(Yt.width||wt.framebufferWidth-ce)|0,ft=(Yt.height||wt.framebufferHeight-Zt)|0,St=Yt.data||null),St&&(re===Vs?$(St instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):re===$c&&$(St instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(ie>0&&ie+ce<=wt.framebufferWidth,"invalid width for read pixels"),$(ft>0&&ft+Zt<=wt.framebufferHeight,"invalid height for read pixels"),tt();var ee=ie*ft*4;return St||(re===Vs?St=new Uint8Array(ee):re===$c&&(St=St||new Float32Array(ee))),$.isTypedArray(St,"data buffer for regl.read() must be a typedarray"),$(St.byteLength>=ee,"data buffer for regl.read() too small"),M.pixelStorei(Da,4),M.readPixels(ce,Zt,ie,ft,Bg,re,St),St}function Wt(Yt){var re;return G.setFBO({framebuffer:Yt.framebuffer},function(){re=$t(Yt)}),re}function Kt(Yt){return!Yt||!("framebuffer"in Yt)?$t(Yt):Wt(Yt)}return Kt}function Hs(M){return Array.prototype.slice.call(M)}function Ai(M){return Hs(M).join("")}function ef(){var M=0,G=[],tt=[];function wt(re){for(var ce=0;ce<tt.length;++ce)if(tt[ce]===re)return G[ce];var Zt="g"+M++;return G.push(Zt),tt.push(re),Zt}function Dt(){var re=[];function ce(){re.push.apply(re,Hs(arguments))}var Zt=[];function ie(){var ft="v"+M++;return Zt.push(ft),arguments.length>0&&(re.push(ft,"="),re.push.apply(re,Hs(arguments)),re.push(";")),ft}return Nt(ce,{def:ie,toString:function(){return Ai([Zt.length>0?"var "+Zt.join(",")+";":"",Ai(re)])}})}function xt(){var re=Dt(),ce=Dt(),Zt=re.toString,ie=ce.toString;function ft(St,ee){ce(St,ee,"=",re.def(St,ee),";")}return Nt(function(){re.apply(re,Hs(arguments))},{def:re.def,entry:re,exit:ce,save:ft,set:function(St,ee,ue){ft(St,ee),re(St,ee,"=",ue,";")},toString:function(){return Zt()+ie()}})}function Tt(){var re=Ai(arguments),ce=xt(),Zt=xt(),ie=ce.toString,ft=Zt.toString;return Nt(ce,{then:function(){return ce.apply(ce,Hs(arguments)),this},else:function(){return Zt.apply(Zt,Hs(arguments)),this},toString:function(){var St=ft();return St&&(St="else{"+St+"}"),Ai(["if(",re,"){",ie(),"}",St])}})}var $t=Dt(),Wt={};function Kt(re,ce){var Zt=[];function ie(){var Ft="a"+Zt.length;return Zt.push(Ft),Ft}ce=ce||0;for(var ft=0;ft<ce;++ft)ie();var St=xt(),ee=St.toString,ue=Wt[re]=Nt(St,{arg:ie,toString:function(){return Ai(["function(",Zt.join(),"){",ee(),"}"])}});return ue}function Yt(){var re=['"use strict";',$t,"return {"];Object.keys(Wt).forEach(function(ie){re.push('"',ie,'":',Wt[ie].toString(),",")}),re.push("}");var ce=Ai(re).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Zt=Function.apply(null,G.concat(ce));return Zt.apply(null,tt)}return{global:$t,link:wt,block:Dt,proc:Kt,scope:xt,cond:Tt,compile:Yt}}var $s="xyzw".split(""),ts=5121,To=1,Wc=2,Nu=0,eo=1,Pu=2,Ws=3,es=4,Du=5,ns=6,Ru="dither",Fr="blend.enable",rs="blend.color",is="blend.equation",Xs="blend.func",Ra="depth.enable",Xc="depth.func",nf="depth.range",di="depth.mask",Zs="colorMask",rf="cull.enable",of="cull.face",Lu="frontFace",Zc="lineWidth",qc="polygonOffset.enable",Co="polygonOffset.offset",zi="sample.alpha",sf="sample.enable",qs="sample.coverage",af="stencil.enable",ku="stencil.mask",Yc="stencil.func",Yn="stencil.opFront",$r="stencil.opBack",li="scissor.enable",La="scissor.box",no="viewport",ka="profile",ni="framebuffer",os="vert",Ba="frag",ss="elements",Oo="primitive",Gr="count",Nr="offset",ja="instances",ro="vao",Ys="Width",Jc="Height",Js=ni+Ys,Ks=ni+Jc,io=no+Ys,jg=no+Jc,cf="drawingBuffer",lf=cf+Ys,uf=cf+Jc,Fg=[Xs,is,Yc,Yn,$r,qs,no,La,Co],Qs=34962,Gg=34963,zg=35632,as=35633,ta=3553,Fa=34067,Ug=2884,Vg=3042,hf=3024,Bu=2960,Hg=2929,$g=3089,Wg=32823,cs=32926,ff=32928,ju=5126,Kc=35664,Io=35665,Qc=35666,Fu=5124,Ga=35667,tl=35668,Ti=35669,ea=35670,el=35671,oo=35672,so=35673,ls=35674,Mo=35675,ao=35676,za=35678,gi=35680,na=4,us=1028,Pr=1029,Gu=2304,nl=2305,Xg=32775,Zg=32776,ra=519,In=7680,df=0,Ui=1,gf=32774,co=513,rl=36160,jn=36064,Ci={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ua=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],pi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Vi={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},hs={frag:zg,vert:as},il={cw:Gu,ccw:nl};function Va(M){return Array.isArray(M)||wn(M)||hi(M)}function pf(M){return M.sort(function(G,tt){return G===no?-1:tt===no?1:G<tt?-1:1})}function Er(M,G,tt,wt){this.thisDep=M,this.contextDep=G,this.propDep=tt,this.append=wt}function lo(M){return M&&!(M.thisDep||M.contextDep||M.propDep)}function er(M){return new Er(!1,!1,!1,M)}function pr(M,G){var tt=M.type;if(tt===Nu){var wt=M.data.length;return new Er(!0,wt>=1,wt>=2,G)}else if(tt===es){var Dt=M.data;return new Er(Dt.thisDep,Dt.contextDep,Dt.propDep,G)}else{if(tt===Du)return new Er(!1,!1,!1,G);if(tt===ns){for(var xt=!1,Tt=!1,$t=!1,Wt=0;Wt<M.data.length;++Wt){var Kt=M.data[Wt];if(Kt.type===eo)$t=!0;else if(Kt.type===Pu)Tt=!0;else if(Kt.type===Ws)xt=!0;else if(Kt.type===Nu){xt=!0;var Yt=Kt.data;Yt>=1&&(Tt=!0),Yt>=2&&($t=!0)}else Kt.type===es&&(xt=xt||Kt.data.thisDep,Tt=Tt||Kt.data.contextDep,$t=$t||Kt.data.propDep)}return new Er(xt,Tt,$t,G)}else return new Er(tt===Ws,tt===Pu,tt===eo,G)}}var uo=new Er(!1,!1,!1,function(){});function ho(M,G,tt,wt,Dt,xt,Tt,$t,Wt,Kt,Yt,re,ce,Zt,ie){var ft=Kt.Record,St={add:32774,subtract:32778,"reverse subtract":32779};tt.ext_blend_minmax&&(St.min=Xg,St.max=Zg);var ee=tt.angle_instanced_arrays,ue=tt.webgl_draw_buffers,Ft={dirty:!0,profile:ie.profile},ge={},Vt=[],se={},zt={};function oe(X){return X.replace(".","_")}function Pe(X,j,nt){var ht=oe(X);Vt.push(X),ge[ht]=Ft[ht]=!!nt,se[ht]=j}function ze(X,j,nt){var ht=oe(X);Vt.push(X),Array.isArray(nt)?(Ft[ht]=nt.slice(),ge[ht]=nt.slice()):Ft[ht]=ge[ht]=nt,zt[ht]=j}Pe(Ru,hf),Pe(Fr,Vg),ze(rs,"blendColor",[0,0,0,0]),ze(is,"blendEquationSeparate",[gf,gf]),ze(Xs,"blendFuncSeparate",[Ui,df,Ui,df]),Pe(Ra,Hg,!0),ze(Xc,"depthFunc",co),ze(nf,"depthRange",[0,1]),ze(di,"depthMask",!0),ze(Zs,Zs,[!0,!0,!0,!0]),Pe(rf,Ug),ze(of,"cullFace",Pr),ze(Lu,Lu,nl),ze(Zc,Zc,1),Pe(qc,Wg),ze(Co,"polygonOffset",[0,0]),Pe(zi,cs),Pe(sf,ff),ze(qs,"sampleCoverage",[1,!1]),Pe(af,Bu),ze(ku,"stencilMask",-1),ze(Yc,"stencilFunc",[ra,0,-1]),ze(Yn,"stencilOpSeparate",[us,In,In,In]),ze($r,"stencilOpSeparate",[Pr,In,In,In]),Pe(li,$g),ze(La,"scissor",[0,0,M.drawingBufferWidth,M.drawingBufferHeight]),ze(no,no,[0,0,M.drawingBufferWidth,M.drawingBufferHeight]);var ae={gl:M,context:ce,strings:G,next:ge,current:Ft,draw:re,elements:xt,buffer:Dt,shader:Yt,attributes:Kt.state,vao:Kt,uniforms:Wt,framebuffer:$t,extensions:tt,timer:Zt,isBufferArgs:Va},ne={primTypes:Bi,compareFuncs:pi,blendFuncs:Ci,blendEquations:St,stencilOps:Vi,glTypes:wo,orientationType:il};$.optional(function(){ae.isArrayLike=qn}),ue&&(ne.backBuffer=[Pr],ne.drawBuffer=Mr(wt.maxDrawbuffers,function(X){return X===0?[0]:Mr(X,function(j){return jn+j})}));var Gt=0;function je(){var X=ef(),j=X.link,nt=X.global;X.id=Gt++,X.batchId="0";var ht=j(ae),gt=X.shared={props:"a0"};Object.keys(ae).forEach(function(et){gt[et]=nt.def(ht,".",et)}),$.optional(function(){X.CHECK=j($),X.commandStr=$.guessCommand(),X.command=j(X.commandStr),X.assert=function(et,z,ut){et("if(!(",z,"))",this.CHECK,".commandRaise(",j(ut),",",this.command,");")},ne.invalidBlendCombinations=Ua});var ot=X.next={},rt=X.current={};Object.keys(zt).forEach(function(et){Array.isArray(Ft[et])&&(ot[et]=nt.def(gt.next,".",et),rt[et]=nt.def(gt.current,".",et))});var lt=X.constants={};Object.keys(ne).forEach(function(et){lt[et]=nt.def(JSON.stringify(ne[et]))}),X.invoke=function(et,z){switch(z.type){case Nu:var ut=["this",gt.context,gt.props,X.batchId];return et.def(j(z.data),".call(",ut.slice(0,Math.max(z.data.length+1,4)),")");case eo:return et.def(gt.props,z.data);case Pu:return et.def(gt.context,z.data);case Ws:return et.def("this",z.data);case es:return z.data.append(X,et),z.data.ref;case Du:return z.data.toString();case ns:return z.data.map(function(mt){return X.invoke(et,mt)})}},X.attribCache={};var W={};return X.scopeAttrib=function(et){var z=G.id(et);if(z in W)return W[z];var ut=Kt.scope[z];ut||(ut=Kt.scope[z]=new ft);var mt=W[z]=j(ut);return mt},X}function qe(X){var j=X.static,nt=X.dynamic,ht;if(ka in j){var gt=!!j[ka];ht=er(function(rt,lt){return gt}),ht.enable=gt}else if(ka in nt){var ot=nt[ka];ht=pr(ot,function(rt,lt){return rt.invoke(lt,ot)})}return ht}function we(X,j){var nt=X.static,ht=X.dynamic;if(ni in nt){var gt=nt[ni];return gt?(gt=$t.getFramebuffer(gt),$.command(gt,"invalid framebuffer object"),er(function(rt,lt){var W=rt.link(gt),et=rt.shared;lt.set(et.framebuffer,".next",W);var z=et.context;return lt.set(z,"."+Js,W+".width"),lt.set(z,"."+Ks,W+".height"),W})):er(function(rt,lt){var W=rt.shared;lt.set(W.framebuffer,".next","null");var et=W.context;return lt.set(et,"."+Js,et+"."+lf),lt.set(et,"."+Ks,et+"."+uf),"null"})}else if(ni in ht){var ot=ht[ni];return pr(ot,function(rt,lt){var W=rt.invoke(lt,ot),et=rt.shared,z=et.framebuffer,ut=lt.def(z,".getFramebuffer(",W,")");$.optional(function(){rt.assert(lt,"!"+W+"||"+ut,"invalid framebuffer object")}),lt.set(z,".next",ut);var mt=et.context;return lt.set(mt,"."+Js,ut+"?"+ut+".width:"+mt+"."+lf),lt.set(mt,"."+Ks,ut+"?"+ut+".height:"+mt+"."+uf),ut})}else return null}function on(X,j,nt){var ht=X.static,gt=X.dynamic;function ot(W){if(W in ht){var et=ht[W];$.commandType(et,"object","invalid "+W,nt.commandStr);var z=!0,ut=et.x|0,mt=et.y|0,Pt,Rt;return"width"in et?(Pt=et.width|0,$.command(Pt>=0,"invalid "+W,nt.commandStr)):z=!1,"height"in et?(Rt=et.height|0,$.command(Rt>=0,"invalid "+W,nt.commandStr)):z=!1,new Er(!z&&j&&j.thisDep,!z&&j&&j.contextDep,!z&&j&&j.propDep,function(Oe,Je){var ve=Oe.shared.context,ke=Pt;"width"in et||(ke=Je.def(ve,".",Js,"-",ut));var $e=Rt;return"height"in et||($e=Je.def(ve,".",Ks,"-",mt)),[ut,mt,ke,$e]})}else if(W in gt){var Mt=gt[W],Qt=pr(Mt,function(Oe,Je){var ve=Oe.invoke(Je,Mt);$.optional(function(){Oe.assert(Je,ve+"&&typeof "+ve+'==="object"',"invalid "+W)});var ke=Oe.shared.context,$e=Je.def(ve,".x|0"),bn=Je.def(ve,".y|0"),zn=Je.def('"width" in ',ve,"?",ve,".width|0:","(",ke,".",Js,"-",$e,")"),Sr=Je.def('"height" in ',ve,"?",ve,".height|0:","(",ke,".",Ks,"-",bn,")");return $.optional(function(){Oe.assert(Je,zn+">=0&&"+Sr+">=0","invalid "+W)}),[$e,bn,zn,Sr]});return j&&(Qt.thisDep=Qt.thisDep||j.thisDep,Qt.contextDep=Qt.contextDep||j.contextDep,Qt.propDep=Qt.propDep||j.propDep),Qt}else return j?new Er(j.thisDep,j.contextDep,j.propDep,function(Oe,Je){var ve=Oe.shared.context;return[0,0,Je.def(ve,".",Js),Je.def(ve,".",Ks)]}):null}var rt=ot(no);if(rt){var lt=rt;rt=new Er(rt.thisDep,rt.contextDep,rt.propDep,function(W,et){var z=lt.append(W,et),ut=W.shared.context;return et.set(ut,"."+io,z[2]),et.set(ut,"."+jg,z[3]),z})}return{viewport:rt,scissor_box:ot(La)}}function He(X,j){var nt=X.static,ht=typeof nt[Ba]=="string"&&typeof nt[os]=="string";if(ht){if(Object.keys(j.dynamic).length>0)return null;var gt=j.static,ot=Object.keys(gt);if(ot.length>0&&typeof gt[ot[0]]=="number"){for(var rt=[],lt=0;lt<ot.length;++lt)$(typeof gt[ot[lt]]=="number","must specify all vertex attribute locations when using vaos"),rt.push([gt[ot[lt]]|0,ot[lt]]);return rt}}return null}function en(X,j,nt){var ht=X.static,gt=X.dynamic;function ot(z){if(z in ht){var ut=G.id(ht[z]);$.optional(function(){Yt.shader(hs[z],ut,$.guessCommand())});var mt=er(function(){return ut});return mt.id=ut,mt}else if(z in gt){var Pt=gt[z];return pr(Pt,function(Rt,Mt){var Qt=Rt.invoke(Mt,Pt),Oe=Mt.def(Rt.shared.strings,".id(",Qt,")");return $.optional(function(){Mt(Rt.shared.shader,".shader(",hs[z],",",Oe,",",Rt.command,");")}),Oe})}return null}var rt=ot(Ba),lt=ot(os),W=null,et;return lo(rt)&&lo(lt)?(W=Yt.program(lt.id,rt.id,null,nt),et=er(function(z,ut){return z.link(W)})):et=new Er(rt&&rt.thisDep||lt&&lt.thisDep,rt&&rt.contextDep||lt&&lt.contextDep,rt&&rt.propDep||lt&&lt.propDep,function(z,ut){var mt=z.shared.shader,Pt;rt?Pt=rt.append(z,ut):Pt=ut.def(mt,".",Ba);var Rt;lt?Rt=lt.append(z,ut):Rt=ut.def(mt,".",os);var Mt=mt+".program("+Rt+","+Pt;return $.optional(function(){Mt+=","+z.command}),ut.def(Mt+")")}),{frag:rt,vert:lt,progVar:et,program:W}}function yn(X,j){var nt=X.static,ht=X.dynamic;function gt(){if(ss in nt){var z=nt[ss];Va(z)?z=xt.getElements(xt.create(z,!0)):z&&(z=xt.getElements(z),$.command(z,"invalid elements",j.commandStr));var ut=er(function(Pt,Rt){if(z){var Mt=Pt.link(z);return Pt.ELEMENTS=Mt,Mt}return Pt.ELEMENTS=null,null});return ut.value=z,ut}else if(ss in ht){var mt=ht[ss];return pr(mt,function(Pt,Rt){var Mt=Pt.shared,Qt=Mt.isBufferArgs,Oe=Mt.elements,Je=Pt.invoke(Rt,mt),ve=Rt.def("null"),ke=Rt.def(Qt,"(",Je,")"),$e=Pt.cond(ke).then(ve,"=",Oe,".createStream(",Je,");").else(ve,"=",Oe,".getElements(",Je,");");return $.optional(function(){Pt.assert($e.else,"!"+Je+"||"+ve,"invalid elements")}),Rt.entry($e),Rt.exit(Pt.cond(ke).then(Oe,".destroyStream(",ve,");")),Pt.ELEMENTS=ve,ve})}return null}var ot=gt();function rt(){if(Oo in nt){var z=nt[Oo];return $.commandParameter(z,Bi,"invalid primitve",j.commandStr),er(function(mt,Pt){return Bi[z]})}else if(Oo in ht){var ut=ht[Oo];return pr(ut,function(mt,Pt){var Rt=mt.constants.primTypes,Mt=mt.invoke(Pt,ut);return $.optional(function(){mt.assert(Pt,Mt+" in "+Rt,"invalid primitive, must be one of "+Object.keys(Bi))}),Pt.def(Rt,"[",Mt,"]")})}else if(ot)return lo(ot)?ot.value?er(function(mt,Pt){return Pt.def(mt.ELEMENTS,".primType")}):er(function(){return na}):new Er(ot.thisDep,ot.contextDep,ot.propDep,function(mt,Pt){var Rt=mt.ELEMENTS;return Pt.def(Rt,"?",Rt,".primType:",na)});return null}function lt(z,ut){if(z in nt){var mt=nt[z]|0;return $.command(!ut||mt>=0,"invalid "+z,j.commandStr),er(function(Rt,Mt){return ut&&(Rt.OFFSET=mt),mt})}else if(z in ht){var Pt=ht[z];return pr(Pt,function(Rt,Mt){var Qt=Rt.invoke(Mt,Pt);return ut&&(Rt.OFFSET=Qt,$.optional(function(){Rt.assert(Mt,Qt+">=0","invalid "+z)})),Qt})}else if(ut&&ot)return er(function(Rt,Mt){return Rt.OFFSET="0",0});return null}var W=lt(Nr,!0);function et(){if(Gr in nt){var z=nt[Gr]|0;return $.command(typeof z=="number"&&z>=0,"invalid vertex count",j.commandStr),er(function(){return z})}else if(Gr in ht){var ut=ht[Gr];return pr(ut,function(Rt,Mt){var Qt=Rt.invoke(Mt,ut);return $.optional(function(){Rt.assert(Mt,"typeof "+Qt+'==="number"&&'+Qt+">=0&&"+Qt+"===("+Qt+"|0)","invalid vertex count")}),Qt})}else if(ot)if(lo(ot)){if(ot)return W?new Er(W.thisDep,W.contextDep,W.propDep,function(Rt,Mt){var Qt=Mt.def(Rt.ELEMENTS,".vertCount-",Rt.OFFSET);return $.optional(function(){Rt.assert(Mt,Qt+">=0","invalid vertex offset/element buffer too small")}),Qt}):er(function(Rt,Mt){return Mt.def(Rt.ELEMENTS,".vertCount")});var mt=er(function(){return-1});return $.optional(function(){mt.MISSING=!0}),mt}else{var Pt=new Er(ot.thisDep||W.thisDep,ot.contextDep||W.contextDep,ot.propDep||W.propDep,function(Rt,Mt){var Qt=Rt.ELEMENTS;return Rt.OFFSET?Mt.def(Qt,"?",Qt,".vertCount-",Rt.OFFSET,":-1"):Mt.def(Qt,"?",Qt,".vertCount:-1")});return $.optional(function(){Pt.DYNAMIC=!0}),Pt}return null}return{elements:ot,primitive:rt(),count:et(),instances:lt(ja,!1),offset:W}}function nr(X,j){var nt=X.static,ht=X.dynamic,gt={};return Vt.forEach(function(ot){var rt=oe(ot);function lt(W,et){if(ot in nt){var z=W(nt[ot]);gt[rt]=er(function(){return z})}else if(ot in ht){var ut=ht[ot];gt[rt]=pr(ut,function(mt,Pt){return et(mt,Pt,mt.invoke(Pt,ut))})}}switch(ot){case rf:case Fr:case Ru:case af:case Ra:case li:case qc:case zi:case sf:case di:return lt(function(W){return $.commandType(W,"boolean",ot,j.commandStr),W},function(W,et,z){return $.optional(function(){W.assert(et,"typeof "+z+'==="boolean"',"invalid flag "+ot,W.commandStr)}),z});case Xc:return lt(function(W){return $.commandParameter(W,pi,"invalid "+ot,j.commandStr),pi[W]},function(W,et,z){var ut=W.constants.compareFuncs;return $.optional(function(){W.assert(et,z+" in "+ut,"invalid "+ot+", must be one of "+Object.keys(pi))}),et.def(ut,"[",z,"]")});case nf:return lt(function(W){return $.command(qn(W)&&W.length===2&&typeof W[0]=="number"&&typeof W[1]=="number"&&W[0]<=W[1],"depth range is 2d array",j.commandStr),W},function(W,et,z){$.optional(function(){W.assert(et,W.shared.isArrayLike+"("+z+")&&"+z+".length===2&&typeof "+z+'[0]==="number"&&typeof '+z+'[1]==="number"&&'+z+"[0]<="+z+"[1]","depth range must be a 2d array")});var ut=et.def("+",z,"[0]"),mt=et.def("+",z,"[1]");return[ut,mt]});case Xs:return lt(function(W){$.commandType(W,"object","blend.func",j.commandStr);var et="srcRGB"in W?W.srcRGB:W.src,z="srcAlpha"in W?W.srcAlpha:W.src,ut="dstRGB"in W?W.dstRGB:W.dst,mt="dstAlpha"in W?W.dstAlpha:W.dst;return $.commandParameter(et,Ci,rt+".srcRGB",j.commandStr),$.commandParameter(z,Ci,rt+".srcAlpha",j.commandStr),$.commandParameter(ut,Ci,rt+".dstRGB",j.commandStr),$.commandParameter(mt,Ci,rt+".dstAlpha",j.commandStr),$.command(Ua.indexOf(et+", "+ut)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+et+", "+ut+")",j.commandStr),[Ci[et],Ci[ut],Ci[z],Ci[mt]]},function(W,et,z){var ut=W.constants.blendFuncs;$.optional(function(){W.assert(et,z+"&&typeof "+z+'==="object"',"invalid blend func, must be an object")});function mt(ve,ke){var $e=et.def('"',ve,ke,'" in ',z,"?",z,".",ve,ke,":",z,".",ve);return $.optional(function(){W.assert(et,$e+" in "+ut,"invalid "+ot+"."+ve+ke+", must be one of "+Object.keys(Ci))}),$e}var Pt=mt("src","RGB"),Rt=mt("dst","RGB");$.optional(function(){var ve=W.constants.invalidBlendCombinations;W.assert(et,ve+".indexOf("+Pt+'+", "+'+Rt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Mt=et.def(ut,"[",Pt,"]"),Qt=et.def(ut,"[",mt("src","Alpha"),"]"),Oe=et.def(ut,"[",Rt,"]"),Je=et.def(ut,"[",mt("dst","Alpha"),"]");return[Mt,Oe,Qt,Je]});case is:return lt(function(W){if(typeof W=="string")return $.commandParameter(W,St,"invalid "+ot,j.commandStr),[St[W],St[W]];if(typeof W=="object")return $.commandParameter(W.rgb,St,ot+".rgb",j.commandStr),$.commandParameter(W.alpha,St,ot+".alpha",j.commandStr),[St[W.rgb],St[W.alpha]];$.commandRaise("invalid blend.equation",j.commandStr)},function(W,et,z){var ut=W.constants.blendEquations,mt=et.def(),Pt=et.def(),Rt=W.cond("typeof ",z,'==="string"');return $.optional(function(){function Mt(Qt,Oe,Je){W.assert(Qt,Je+" in "+ut,"invalid "+Oe+", must be one of "+Object.keys(St))}Mt(Rt.then,ot,z),W.assert(Rt.else,z+"&&typeof "+z+'==="object"',"invalid "+ot),Mt(Rt.else,ot+".rgb",z+".rgb"),Mt(Rt.else,ot+".alpha",z+".alpha")}),Rt.then(mt,"=",Pt,"=",ut,"[",z,"];"),Rt.else(mt,"=",ut,"[",z,".rgb];",Pt,"=",ut,"[",z,".alpha];"),et(Rt),[mt,Pt]});case rs:return lt(function(W){return $.command(qn(W)&&W.length===4,"blend.color must be a 4d array",j.commandStr),Mr(4,function(et){return+W[et]})},function(W,et,z){return $.optional(function(){W.assert(et,W.shared.isArrayLike+"("+z+")&&"+z+".length===4","blend.color must be a 4d array")}),Mr(4,function(ut){return et.def("+",z,"[",ut,"]")})});case ku:return lt(function(W){return $.commandType(W,"number",rt,j.commandStr),W|0},function(W,et,z){return $.optional(function(){W.assert(et,"typeof "+z+'==="number"',"invalid stencil.mask")}),et.def(z,"|0")});case Yc:return lt(function(W){$.commandType(W,"object",rt,j.commandStr);var et=W.cmp||"keep",z=W.ref||0,ut="mask"in W?W.mask:-1;return $.commandParameter(et,pi,ot+".cmp",j.commandStr),$.commandType(z,"number",ot+".ref",j.commandStr),$.commandType(ut,"number",ot+".mask",j.commandStr),[pi[et],z,ut]},function(W,et,z){var ut=W.constants.compareFuncs;$.optional(function(){function Mt(){W.assert(et,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Mt(z+"&&typeof ",z,'==="object"'),Mt('!("cmp" in ',z,")||(",z,".cmp in ",ut,")")});var mt=et.def('"cmp" in ',z,"?",ut,"[",z,".cmp]",":",In),Pt=et.def(z,".ref|0"),Rt=et.def('"mask" in ',z,"?",z,".mask|0:-1");return[mt,Pt,Rt]});case Yn:case $r:return lt(function(W){$.commandType(W,"object",rt,j.commandStr);var et=W.fail||"keep",z=W.zfail||"keep",ut=W.zpass||"keep";return $.commandParameter(et,Vi,ot+".fail",j.commandStr),$.commandParameter(z,Vi,ot+".zfail",j.commandStr),$.commandParameter(ut,Vi,ot+".zpass",j.commandStr),[ot===$r?Pr:us,Vi[et],Vi[z],Vi[ut]]},function(W,et,z){var ut=W.constants.stencilOps;$.optional(function(){W.assert(et,z+"&&typeof "+z+'==="object"',"invalid "+ot)});function mt(Pt){return $.optional(function(){W.assert(et,'!("'+Pt+'" in '+z+")||("+z+"."+Pt+" in "+ut+")","invalid "+ot+"."+Pt+", must be one of "+Object.keys(Vi))}),et.def('"',Pt,'" in ',z,"?",ut,"[",z,".",Pt,"]:",In)}return[ot===$r?Pr:us,mt("fail"),mt("zfail"),mt("zpass")]});case Co:return lt(function(W){$.commandType(W,"object",rt,j.commandStr);var et=W.factor|0,z=W.units|0;return $.commandType(et,"number",rt+".factor",j.commandStr),$.commandType(z,"number",rt+".units",j.commandStr),[et,z]},function(W,et,z){$.optional(function(){W.assert(et,z+"&&typeof "+z+'==="object"',"invalid "+ot)});var ut=et.def(z,".factor|0"),mt=et.def(z,".units|0");return[ut,mt]});case of:return lt(function(W){var et=0;return W==="front"?et=us:W==="back"&&(et=Pr),$.command(!!et,rt,j.commandStr),et},function(W,et,z){return $.optional(function(){W.assert(et,z+'==="front"||'+z+'==="back"',"invalid cull.face")}),et.def(z,'==="front"?',us,":",Pr)});case Zc:return lt(function(W){return $.command(typeof W=="number"&&W>=wt.lineWidthDims[0]&&W<=wt.lineWidthDims[1],"invalid line width, must be a positive number between "+wt.lineWidthDims[0]+" and "+wt.lineWidthDims[1],j.commandStr),W},function(W,et,z){return $.optional(function(){W.assert(et,"typeof "+z+'==="number"&&'+z+">="+wt.lineWidthDims[0]+"&&"+z+"<="+wt.lineWidthDims[1],"invalid line width")}),z});case Lu:return lt(function(W){return $.commandParameter(W,il,rt,j.commandStr),il[W]},function(W,et,z){return $.optional(function(){W.assert(et,z+'==="cw"||'+z+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),et.def(z+'==="cw"?'+Gu+":"+nl)});case Zs:return lt(function(W){return $.command(qn(W)&&W.length===4,"color.mask must be length 4 array",j.commandStr),W.map(function(et){return!!et})},function(W,et,z){return $.optional(function(){W.assert(et,W.shared.isArrayLike+"("+z+")&&"+z+".length===4","invalid color.mask")}),Mr(4,function(ut){return"!!"+z+"["+ut+"]"})});case qs:return lt(function(W){$.command(typeof W=="object"&&W,rt,j.commandStr);var et="value"in W?W.value:1,z=!!W.invert;return $.command(typeof et=="number"&&et>=0&&et<=1,"sample.coverage.value must be a number between 0 and 1",j.commandStr),[et,z]},function(W,et,z){$.optional(function(){W.assert(et,z+"&&typeof "+z+'==="object"',"invalid sample.coverage")});var ut=et.def('"value" in ',z,"?+",z,".value:1"),mt=et.def("!!",z,".invert");return[ut,mt]})}}),gt}function cn(X,j){var nt=X.static,ht=X.dynamic,gt={};return Object.keys(nt).forEach(function(ot){var rt=nt[ot],lt;if(typeof rt=="number"||typeof rt=="boolean")lt=er(function(){return rt});else if(typeof rt=="function"){var W=rt._reglType;W==="texture2d"||W==="textureCube"?lt=er(function(et){return et.link(rt)}):W==="framebuffer"||W==="framebufferCube"?($.command(rt.color.length>0,'missing color attachment for framebuffer sent to uniform "'+ot+'"',j.commandStr),lt=er(function(et){return et.link(rt.color[0])})):$.commandRaise('invalid data for uniform "'+ot+'"',j.commandStr)}else qn(rt)?lt=er(function(et){var z=et.global.def("[",Mr(rt.length,function(ut){return $.command(typeof rt[ut]=="number"||typeof rt[ut]=="boolean","invalid uniform "+ot,et.commandStr),rt[ut]}),"]");return z}):$.commandRaise('invalid or missing data for uniform "'+ot+'"',j.commandStr);lt.value=rt,gt[ot]=lt}),Object.keys(ht).forEach(function(ot){var rt=ht[ot];gt[ot]=pr(rt,function(lt,W){return lt.invoke(W,rt)})}),gt}function ln(X,j){var nt=X.static,ht=X.dynamic,gt={};return Object.keys(nt).forEach(function(ot){var rt=nt[ot],lt=G.id(ot),W=new ft;if(Va(rt))W.state=To,W.buffer=Dt.getBuffer(Dt.create(rt,Qs,!1,!0)),W.type=0;else{var et=Dt.getBuffer(rt);if(et)W.state=To,W.buffer=et,W.type=0;else if($.command(typeof rt=="object"&&rt,"invalid data for attribute "+ot,j.commandStr),"constant"in rt){var z=rt.constant;W.buffer="null",W.state=Wc,typeof z=="number"?W.x=z:($.command(qn(z)&&z.length>0&&z.length<=4,"invalid constant for attribute "+ot,j.commandStr),$s.forEach(function(Oe,Je){Je<z.length&&(W[Oe]=z[Je])}))}else{Va(rt.buffer)?et=Dt.getBuffer(Dt.create(rt.buffer,Qs,!1,!0)):et=Dt.getBuffer(rt.buffer),$.command(!!et,'missing buffer for attribute "'+ot+'"',j.commandStr);var ut=rt.offset|0;$.command(ut>=0,'invalid offset for attribute "'+ot+'"',j.commandStr);var mt=rt.stride|0;$.command(mt>=0&&mt<256,'invalid stride for attribute "'+ot+'", must be integer betweeen [0, 255]',j.commandStr);var Pt=rt.size|0;$.command(!("size"in rt)||Pt>0&&Pt<=4,'invalid size for attribute "'+ot+'", must be 1,2,3,4',j.commandStr);var Rt=!!rt.normalized,Mt=0;"type"in rt&&($.commandParameter(rt.type,wo,"invalid type for attribute "+ot,j.commandStr),Mt=wo[rt.type]);var Qt=rt.divisor|0;"divisor"in rt&&($.command(Qt===0||ee,'cannot specify divisor for attribute "'+ot+'", instancing not supported',j.commandStr),$.command(Qt>=0,'invalid divisor for attribute "'+ot+'"',j.commandStr)),$.optional(function(){var Oe=j.commandStr,Je=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(rt).forEach(function(ve){$.command(Je.indexOf(ve)>=0,'unknown parameter "'+ve+'" for attribute pointer "'+ot+'" (valid parameters are '+Je+")",Oe)})}),W.buffer=et,W.state=To,W.size=Pt,W.normalized=Rt,W.type=Mt||et.dtype,W.offset=ut,W.stride=mt,W.divisor=Qt}}gt[ot]=er(function(Oe,Je){var ve=Oe.attribCache;if(lt in ve)return ve[lt];var ke={isStream:!1};return Object.keys(W).forEach(function($e){ke[$e]=W[$e]}),W.buffer&&(ke.buffer=Oe.link(W.buffer),ke.type=ke.type||ke.buffer+".dtype"),ve[lt]=ke,ke})}),Object.keys(ht).forEach(function(ot){var rt=ht[ot];function lt(W,et){var z=W.invoke(et,rt),ut=W.shared,mt=W.constants,Pt=ut.isBufferArgs,Rt=ut.buffer;$.optional(function(){W.assert(et,z+"&&(typeof "+z+'==="object"||typeof '+z+'==="function")&&('+Pt+"("+z+")||"+Rt+".getBuffer("+z+")||"+Rt+".getBuffer("+z+".buffer)||"+Pt+"("+z+'.buffer)||("constant" in '+z+"&&(typeof "+z+'.constant==="number"||'+ut.isArrayLike+"("+z+".constant))))",'invalid dynamic attribute "'+ot+'"')});var Mt={isStream:et.def(!1)},Qt=new ft;Qt.state=To,Object.keys(Qt).forEach(function(ke){Mt[ke]=et.def(""+Qt[ke])});var Oe=Mt.buffer,Je=Mt.type;et("if(",Pt,"(",z,")){",Mt.isStream,"=true;",Oe,"=",Rt,".createStream(",Qs,",",z,");",Je,"=",Oe,".dtype;","}else{",Oe,"=",Rt,".getBuffer(",z,");","if(",Oe,"){",Je,"=",Oe,".dtype;",'}else if("constant" in ',z,"){",Mt.state,"=",Wc,";","if(typeof "+z+'.constant === "number"){',Mt[$s[0]],"=",z,".constant;",$s.slice(1).map(function(ke){return Mt[ke]}).join("="),"=0;","}else{",$s.map(function(ke,$e){return Mt[ke]+"="+z+".constant.length>"+$e+"?"+z+".constant["+$e+"]:0;"}).join(""),"}}else{","if(",Pt,"(",z,".buffer)){",Oe,"=",Rt,".createStream(",Qs,",",z,".buffer);","}else{",Oe,"=",Rt,".getBuffer(",z,".buffer);","}",Je,'="type" in ',z,"?",mt.glTypes,"[",z,".type]:",Oe,".dtype;",Mt.normalized,"=!!",z,".normalized;");function ve(ke){et(Mt[ke],"=",z,".",ke,"|0;")}return ve("size"),ve("offset"),ve("stride"),ve("divisor"),et("}}"),et.exit("if(",Mt.isStream,"){",Rt,".destroyStream(",Oe,");","}"),Mt}gt[ot]=pr(rt,lt)}),gt}function lr(X,j){var nt=X.static,ht=X.dynamic;if(ro in nt){var gt=nt[ro];return gt!==null&&Kt.getVAO(gt)===null&&(gt=Kt.createVAO(gt)),er(function(rt){return rt.link(Kt.getVAO(gt))})}else if(ro in ht){var ot=ht[ro];return pr(ot,function(rt,lt){var W=rt.invoke(lt,ot);return lt.def(rt.shared.vao+".getVAO("+W+")")})}return null}function Pn(X){var j=X.static,nt=X.dynamic,ht={};return Object.keys(j).forEach(function(gt){var ot=j[gt];ht[gt]=er(function(rt,lt){return typeof ot=="number"||typeof ot=="boolean"?""+ot:rt.link(ot)})}),Object.keys(nt).forEach(function(gt){var ot=nt[gt];ht[gt]=pr(ot,function(rt,lt){return rt.invoke(lt,ot)})}),ht}function Vn(X,j,nt,ht,gt){var ot=X.static,rt=X.dynamic;$.optional(function(){var ve=[ni,os,Ba,ss,Oo,Nr,Gr,ja,ka,ro].concat(Vt);function ke($e){Object.keys($e).forEach(function(bn){$.command(ve.indexOf(bn)>=0,'unknown parameter "'+bn+'"',gt.commandStr)})}ke(ot),ke(rt)});var lt=He(X,j),W=we(X,gt),et=on(X,W,gt),z=yn(X,gt),ut=nr(X,gt),mt=en(X,gt,lt);function Pt(ve){var ke=et[ve];ke&&(ut[ve]=ke)}Pt(no),Pt(oe(La));var Rt=Object.keys(ut).length>0,Mt={framebuffer:W,draw:z,shader:mt,state:ut,dirty:Rt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Mt.profile=qe(X,gt),Mt.uniforms=cn(nt,gt),Mt.drawVAO=Mt.scopeVAO=lr(X,gt),!Mt.drawVAO&&mt.program&&!lt&&tt.angle_instanced_arrays){var Qt=!0,Oe=mt.program.attributes.map(function(ve){var ke=j.static[ve];return Qt=Qt&&!!ke,ke});if(Qt&&Oe.length>0){var Je=Kt.getVAO(Kt.createVAO(Oe));Mt.drawVAO=new Er(null,null,null,function(ve,ke){return ve.link(Je)}),Mt.useVAO=!0}}return lt?Mt.useVAO=!0:Mt.attributes=ln(j,gt),Mt.context=Pn(ht,gt),Mt}function Jn(X,j,nt){var ht=X.shared,gt=ht.context,ot=X.scope();Object.keys(nt).forEach(function(rt){j.save(gt,"."+rt);var lt=nt[rt],W=lt.append(X,j);Array.isArray(W)?ot(gt,".",rt,"=[",W.join(),"];"):ot(gt,".",rt,"=",W,";")}),j(ot)}function Hn(X,j,nt,ht){var gt=X.shared,ot=gt.gl,rt=gt.framebuffer,lt;ue&&(lt=j.def(gt.extensions,".webgl_draw_buffers"));var W=X.constants,et=W.drawBuffer,z=W.backBuffer,ut;nt?ut=nt.append(X,j):ut=j.def(rt,".next"),ht||j("if(",ut,"!==",rt,".cur){"),j("if(",ut,"){",ot,".bindFramebuffer(",rl,",",ut,".framebuffer);"),ue&&j(lt,".drawBuffersWEBGL(",et,"[",ut,".colorAttachments.length]);"),j("}else{",ot,".bindFramebuffer(",rl,",null);"),ue&&j(lt,".drawBuffersWEBGL(",z,");"),j("}",rt,".cur=",ut,";"),ht||j("}")}function Gn(X,j,nt){var ht=X.shared,gt=ht.gl,ot=X.current,rt=X.next,lt=ht.current,W=ht.next,et=X.cond(lt,".dirty");Vt.forEach(function(z){var ut=oe(z);if(!(ut in nt.state)){var mt,Pt;if(ut in rt){mt=rt[ut],Pt=ot[ut];var Rt=Mr(Ft[ut].length,function(Qt){return et.def(mt,"[",Qt,"]")});et(X.cond(Rt.map(function(Qt,Oe){return Qt+"!=="+Pt+"["+Oe+"]"}).join("||")).then(gt,".",zt[ut],"(",Rt,");",Rt.map(function(Qt,Oe){return Pt+"["+Oe+"]="+Qt}).join(";"),";"))}else{mt=et.def(W,".",ut);var Mt=X.cond(mt,"!==",lt,".",ut);et(Mt),ut in se?Mt(X.cond(mt).then(gt,".enable(",se[ut],");").else(gt,".disable(",se[ut],");"),lt,".",ut,"=",mt,";"):Mt(gt,".",zt[ut],"(",mt,");",lt,".",ut,"=",mt,";")}}}),Object.keys(nt.state).length===0&&et(lt,".dirty=false;"),j(et)}function xr(X,j,nt,ht){var gt=X.shared,ot=X.current,rt=gt.current,lt=gt.gl;pf(Object.keys(nt)).forEach(function(W){var et=nt[W];if(!(ht&&!ht(et))){var z=et.append(X,j);if(se[W]){var ut=se[W];lo(et)?z?j(lt,".enable(",ut,");"):j(lt,".disable(",ut,");"):j(X.cond(z).then(lt,".enable(",ut,");").else(lt,".disable(",ut,");")),j(rt,".",W,"=",z,";")}else if(qn(z)){var mt=ot[W];j(lt,".",zt[W],"(",z,");",z.map(function(Pt,Rt){return mt+"["+Rt+"]="+Pt}).join(";"),";")}else j(lt,".",zt[W],"(",z,");",rt,".",W,"=",z,";")}})}function $n(X,j){ee&&(X.instancing=j.def(X.shared.extensions,".angle_instanced_arrays"))}function Ye(X,j,nt,ht,gt){var ot=X.shared,rt=X.stats,lt=ot.current,W=ot.timer,et=nt.profile;function z(){return typeof performance>"u"?"Date.now()":"performance.now()"}var ut,mt;function Pt(ve){ut=j.def(),ve(ut,"=",z(),";"),typeof gt=="string"?ve(rt,".count+=",gt,";"):ve(rt,".count++;"),Zt&&(ht?(mt=j.def(),ve(mt,"=",W,".getNumPendingQueries();")):ve(W,".beginQuery(",rt,");"))}function Rt(ve){ve(rt,".cpuTime+=",z(),"-",ut,";"),Zt&&(ht?ve(W,".pushScopeStats(",mt,",",W,".getNumPendingQueries(),",rt,");"):ve(W,".endQuery();"))}function Mt(ve){var ke=j.def(lt,".profile");j(lt,".profile=",ve,";"),j.exit(lt,".profile=",ke,";")}var Qt;if(et){if(lo(et)){et.enable?(Pt(j),Rt(j.exit),Mt("true")):Mt("false");return}Qt=et.append(X,j),Mt(Qt)}else Qt=j.def(lt,".profile");var Oe=X.block();Pt(Oe),j("if(",Qt,"){",Oe,"}");var Je=X.block();Rt(Je),j.exit("if(",Qt,"){",Je,"}")}function _r(X,j,nt,ht,gt){var ot=X.shared;function rt(W){switch(W){case Kc:case Ga:case el:return 2;case Io:case tl:case oo:return 3;case Qc:case Ti:case so:return 4;default:return 1}}function lt(W,et,z){var ut=ot.gl,mt=j.def(W,".location"),Pt=j.def(ot.attributes,"[",mt,"]"),Rt=z.state,Mt=z.buffer,Qt=[z.x,z.y,z.z,z.w],Oe=["buffer","normalized","offset","stride"];function Je(){j("if(!",Pt,".buffer){",ut,".enableVertexAttribArray(",mt,");}");var ke=z.type,$e;if(z.size?$e=j.def(z.size,"||",et):$e=et,j("if(",Pt,".type!==",ke,"||",Pt,".size!==",$e,"||",Oe.map(function(zn){return Pt+"."+zn+"!=="+z[zn]}).join("||"),"){",ut,".bindBuffer(",Qs,",",Mt,".buffer);",ut,".vertexAttribPointer(",[mt,$e,ke,z.normalized,z.stride,z.offset],");",Pt,".type=",ke,";",Pt,".size=",$e,";",Oe.map(function(zn){return Pt+"."+zn+"="+z[zn]+";"}).join(""),"}"),ee){var bn=z.divisor;j("if(",Pt,".divisor!==",bn,"){",X.instancing,".vertexAttribDivisorANGLE(",[mt,bn],");",Pt,".divisor=",bn,";}")}}function ve(){j("if(",Pt,".buffer){",ut,".disableVertexAttribArray(",mt,");",Pt,".buffer=null;","}if(",$s.map(function(ke,$e){return Pt+"."+ke+"!=="+Qt[$e]}).join("||"),"){",ut,".vertexAttrib4f(",mt,",",Qt,");",$s.map(function(ke,$e){return Pt+"."+ke+"="+Qt[$e]+";"}).join(""),"}")}Rt===To?Je():Rt===Wc?ve():(j("if(",Rt,"===",To,"){"),Je(),j("}else{"),ve(),j("}"))}ht.forEach(function(W){var et=W.name,z=nt.attributes[et],ut;if(z){if(!gt(z))return;ut=z.append(X,j)}else{if(!gt(uo))return;var mt=X.scopeAttrib(et);$.optional(function(){X.assert(j,mt+".state","missing attribute "+et)}),ut={},Object.keys(new ft).forEach(function(Pt){ut[Pt]=j.def(mt,".",Pt)})}lt(X.link(W),rt(W.info.type),ut)})}function _n(X,j,nt,ht,gt){for(var ot=X.shared,rt=ot.gl,lt,W=0;W<ht.length;++W){var et=ht[W],z=et.name,ut=et.info.type,mt=nt.uniforms[z],Pt=X.link(et),Rt=Pt+".location",Mt;if(mt){if(!gt(mt))continue;if(lo(mt)){var Qt=mt.value;if($.command(Qt!==null&&typeof Qt<"u",'missing uniform "'+z+'"',X.commandStr),ut===za||ut===gi){$.command(typeof Qt=="function"&&(ut===za&&(Qt._reglType==="texture2d"||Qt._reglType==="framebuffer")||ut===gi&&(Qt._reglType==="textureCube"||Qt._reglType==="framebufferCube")),"invalid texture for uniform "+z,X.commandStr);var Oe=X.link(Qt._texture||Qt.color[0]._texture);j(rt,".uniform1i(",Rt,",",Oe+".bind());"),j.exit(Oe,".unbind();")}else if(ut===ls||ut===Mo||ut===ao){$.optional(function(){$.command(qn(Qt),"invalid matrix for uniform "+z,X.commandStr),$.command(ut===ls&&Qt.length===4||ut===Mo&&Qt.length===9||ut===ao&&Qt.length===16,"invalid length for matrix uniform "+z,X.commandStr)});var Je=X.global.def("new Float32Array(["+Array.prototype.slice.call(Qt)+"])"),ve=2;ut===Mo?ve=3:ut===ao&&(ve=4),j(rt,".uniformMatrix",ve,"fv(",Rt,",false,",Je,");")}else{switch(ut){case ju:$.commandType(Qt,"number","uniform "+z,X.commandStr),lt="1f";break;case Kc:$.command(qn(Qt)&&Qt.length===2,"uniform "+z,X.commandStr),lt="2f";break;case Io:$.command(qn(Qt)&&Qt.length===3,"uniform "+z,X.commandStr),lt="3f";break;case Qc:$.command(qn(Qt)&&Qt.length===4,"uniform "+z,X.commandStr),lt="4f";break;case ea:$.commandType(Qt,"boolean","uniform "+z,X.commandStr),lt="1i";break;case Fu:$.commandType(Qt,"number","uniform "+z,X.commandStr),lt="1i";break;case el:$.command(qn(Qt)&&Qt.length===2,"uniform "+z,X.commandStr),lt="2i";break;case Ga:$.command(qn(Qt)&&Qt.length===2,"uniform "+z,X.commandStr),lt="2i";break;case oo:$.command(qn(Qt)&&Qt.length===3,"uniform "+z,X.commandStr),lt="3i";break;case tl:$.command(qn(Qt)&&Qt.length===3,"uniform "+z,X.commandStr),lt="3i";break;case so:$.command(qn(Qt)&&Qt.length===4,"uniform "+z,X.commandStr),lt="4i";break;case Ti:$.command(qn(Qt)&&Qt.length===4,"uniform "+z,X.commandStr),lt="4i";break}j(rt,".uniform",lt,"(",Rt,",",qn(Qt)?Array.prototype.slice.call(Qt):Qt,");")}continue}else Mt=mt.append(X,j)}else{if(!gt(uo))continue;Mt=j.def(ot.uniforms,"[",G.id(z),"]")}ut===za?($(!Array.isArray(Mt),"must specify a scalar prop for textures"),j("if(",Mt,"&&",Mt,'._reglType==="framebuffer"){',Mt,"=",Mt,".color[0];","}")):ut===gi&&($(!Array.isArray(Mt),"must specify a scalar prop for cube maps"),j("if(",Mt,"&&",Mt,'._reglType==="framebufferCube"){',Mt,"=",Mt,".color[0];","}")),$.optional(function(){function Sr(Ii,Ln){X.assert(j,Ii,'bad data or missing for uniform "'+z+'".  '+Ln)}function ds(Ii){$(!Array.isArray(Mt),"must not specify an array type for uniform"),Sr("typeof "+Mt+'==="'+Ii+'"',"invalid type, expected "+Ii)}function Wr(Ii,Ln){Array.isArray(Mt)?$(Mt.length===Ii,"must have length "+Ii):Sr(ot.isArrayLike+"("+Mt+")&&"+Mt+".length==="+Ii,"invalid vector, should have length "+Ii,X.commandStr)}function Ef(Ii){$(!Array.isArray(Mt),"must not specify a value type"),Sr("typeof "+Mt+'==="function"&&'+Mt+'._reglType==="texture'+(Ii===ta?"2d":"Cube")+'"',"invalid texture type",X.commandStr)}switch(ut){case Fu:ds("number");break;case Ga:Wr(2,"number");break;case tl:Wr(3,"number");break;case Ti:Wr(4,"number");break;case ju:ds("number");break;case Kc:Wr(2,"number");break;case Io:Wr(3,"number");break;case Qc:Wr(4,"number");break;case ea:ds("boolean");break;case el:Wr(2,"boolean");break;case oo:Wr(3,"boolean");break;case so:Wr(4,"boolean");break;case ls:Wr(4,"number");break;case Mo:Wr(9,"number");break;case ao:Wr(16,"number");break;case za:Ef(ta);break;case gi:Ef(Fa);break}});var ke=1;switch(ut){case za:case gi:var $e=j.def(Mt,"._texture");j(rt,".uniform1i(",Rt,",",$e,".bind());"),j.exit($e,".unbind();");continue;case Fu:case ea:lt="1i";break;case Ga:case el:lt="2i",ke=2;break;case tl:case oo:lt="3i",ke=3;break;case Ti:case so:lt="4i",ke=4;break;case ju:lt="1f";break;case Kc:lt="2f",ke=2;break;case Io:lt="3f",ke=3;break;case Qc:lt="4f",ke=4;break;case ls:lt="Matrix2fv";break;case Mo:lt="Matrix3fv";break;case ao:lt="Matrix4fv";break}if(j(rt,".uniform",lt,"(",Rt,","),lt.charAt(0)==="M"){var bn=Math.pow(ut-ls+2,2),zn=X.global.def("new Float32Array(",bn,")");Array.isArray(Mt)?j("false,(",Mr(bn,function(Sr){return zn+"["+Sr+"]="+Mt[Sr]}),",",zn,")"):j("false,(Array.isArray(",Mt,")||",Mt," instanceof Float32Array)?",Mt,":(",Mr(bn,function(Sr){return zn+"["+Sr+"]="+Mt+"["+Sr+"]"}),",",zn,")")}else ke>1?j(Mr(ke,function(Sr){return Array.isArray(Mt)?Mt[Sr]:Mt+"["+Sr+"]"})):($(!Array.isArray(Mt),"uniform value must not be an array"),j(Mt));j(");")}}function Le(X,j,nt,ht){var gt=X.shared,ot=gt.gl,rt=gt.draw,lt=ht.draw;function W(){var $e=lt.elements,bn,zn=j;return $e?(($e.contextDep&&ht.contextDynamic||$e.propDep)&&(zn=nt),bn=$e.append(X,zn)):bn=zn.def(rt,".",ss),bn&&zn("if("+bn+")"+ot+".bindBuffer("+Gg+","+bn+".buffer.buffer);"),bn}function et(){var $e=lt.count,bn,zn=j;return $e?(($e.contextDep&&ht.contextDynamic||$e.propDep)&&(zn=nt),bn=$e.append(X,zn),$.optional(function(){$e.MISSING&&X.assert(j,"false","missing vertex count"),$e.DYNAMIC&&X.assert(zn,bn+">=0","missing vertex count")})):(bn=zn.def(rt,".",Gr),$.optional(function(){X.assert(zn,bn+">=0","missing vertex count")})),bn}var z=W();function ut($e){var bn=lt[$e];return bn?bn.contextDep&&ht.contextDynamic||bn.propDep?bn.append(X,nt):bn.append(X,j):j.def(rt,".",$e)}var mt=ut(Oo),Pt=ut(Nr),Rt=et();if(typeof Rt=="number"){if(Rt===0)return}else nt("if(",Rt,"){"),nt.exit("}");var Mt,Qt;ee&&(Mt=ut(ja),Qt=X.instancing);var Oe=z+".type",Je=lt.elements&&lo(lt.elements);function ve(){function $e(){nt(Qt,".drawElementsInstancedANGLE(",[mt,Rt,Oe,Pt+"<<(("+Oe+"-"+ts+")>>1)",Mt],");")}function bn(){nt(Qt,".drawArraysInstancedANGLE(",[mt,Pt,Rt,Mt],");")}z?Je?$e():(nt("if(",z,"){"),$e(),nt("}else{"),bn(),nt("}")):bn()}function ke(){function $e(){nt(ot+".drawElements("+[mt,Rt,Oe,Pt+"<<(("+Oe+"-"+ts+")>>1)"]+");")}function bn(){nt(ot+".drawArrays("+[mt,Pt,Rt]+");")}z?Je?$e():(nt("if(",z,"){"),$e(),nt("}else{"),bn(),nt("}")):bn()}ee&&(typeof Mt!="number"||Mt>=0)?typeof Mt=="string"?(nt("if(",Mt,">0){"),ve(),nt("}else if(",Mt,"<0){"),ke(),nt("}")):ve():ke()}function nn(X,j,nt,ht,gt){var ot=je(),rt=ot.proc("body",gt);return $.optional(function(){ot.commandStr=j.commandStr,ot.command=ot.link(j.commandStr)}),ee&&(ot.instancing=rt.def(ot.shared.extensions,".angle_instanced_arrays")),X(ot,rt,nt,ht),ot.compile().body}function fn(X,j,nt,ht){$n(X,j),nt.useVAO?nt.drawVAO?j(X.shared.vao,".setVAO(",nt.drawVAO.append(X,j),");"):j(X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"):(j(X.shared.vao,".setVAO(null);"),_r(X,j,nt,ht.attributes,function(){return!0})),_n(X,j,nt,ht.uniforms,function(){return!0}),Le(X,j,j,nt)}function Kn(X,j){var nt=X.proc("draw",1);$n(X,nt),Jn(X,nt,j.context),Hn(X,nt,j.framebuffer),Gn(X,nt,j),xr(X,nt,j.state),Ye(X,nt,j,!1,!0);var ht=j.shader.progVar.append(X,nt);if(nt(X.shared.gl,".useProgram(",ht,".program);"),j.shader.program)fn(X,nt,j,j.shader.program);else{nt(X.shared.vao,".setVAO(null);");var gt=X.global.def("{}"),ot=nt.def(ht,".id"),rt=nt.def(gt,"[",ot,"]");nt(X.cond(rt).then(rt,".call(this,a0);").else(rt,"=",gt,"[",ot,"]=",X.link(function(lt){return nn(fn,X,j,lt,1)}),"(",ht,");",rt,".call(this,a0);"))}Object.keys(j.state).length>0&&nt(X.shared.current,".dirty=true;")}function Oi(X,j,nt,ht){X.batchId="a1",$n(X,j);function gt(){return!0}_r(X,j,nt,ht.attributes,gt),_n(X,j,nt,ht.uniforms,gt),Le(X,j,j,nt)}function No(X,j,nt,ht){$n(X,j);var gt=nt.contextDep,ot=j.def(),rt="a0",lt="a1",W=j.def();X.shared.props=W,X.batchId=ot;var et=X.scope(),z=X.scope();j(et.entry,"for(",ot,"=0;",ot,"<",lt,";++",ot,"){",W,"=",rt,"[",ot,"];",z,"}",et.exit);function ut(Oe){return Oe.contextDep&&gt||Oe.propDep}function mt(Oe){return!ut(Oe)}if(nt.needsContext&&Jn(X,z,nt.context),nt.needsFramebuffer&&Hn(X,z,nt.framebuffer),xr(X,z,nt.state,ut),nt.profile&&ut(nt.profile)&&Ye(X,z,nt,!1,!0),ht)nt.useVAO?nt.drawVAO?ut(nt.drawVAO)?z(X.shared.vao,".setVAO(",nt.drawVAO.append(X,z),");"):et(X.shared.vao,".setVAO(",nt.drawVAO.append(X,et),");"):et(X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"):(et(X.shared.vao,".setVAO(null);"),_r(X,et,nt,ht.attributes,mt),_r(X,z,nt,ht.attributes,ut)),_n(X,et,nt,ht.uniforms,mt),_n(X,z,nt,ht.uniforms,ut),Le(X,et,z,nt);else{var Pt=X.global.def("{}"),Rt=nt.shader.progVar.append(X,z),Mt=z.def(Rt,".id"),Qt=z.def(Pt,"[",Mt,"]");z(X.shared.gl,".useProgram(",Rt,".program);","if(!",Qt,"){",Qt,"=",Pt,"[",Mt,"]=",X.link(function(Oe){return nn(Oi,X,nt,Oe,2)}),"(",Rt,");}",Qt,".call(this,a0[",ot,"],",ot,");")}}function q(X,j){var nt=X.proc("batch",2);X.batchId="0",$n(X,nt);var ht=!1,gt=!0;Object.keys(j.context).forEach(function(Pt){ht=ht||j.context[Pt].propDep}),ht||(Jn(X,nt,j.context),gt=!1);var ot=j.framebuffer,rt=!1;ot?(ot.propDep?ht=rt=!0:ot.contextDep&&ht&&(rt=!0),rt||Hn(X,nt,ot)):Hn(X,nt,null),j.state.viewport&&j.state.viewport.propDep&&(ht=!0);function lt(Pt){return Pt.contextDep&&ht||Pt.propDep}Gn(X,nt,j),xr(X,nt,j.state,function(Pt){return!lt(Pt)}),(!j.profile||!lt(j.profile))&&Ye(X,nt,j,!1,"a1"),j.contextDep=ht,j.needsContext=gt,j.needsFramebuffer=rt;var W=j.shader.progVar;if(W.contextDep&&ht||W.propDep)No(X,nt,j,null);else{var et=W.append(X,nt);if(nt(X.shared.gl,".useProgram(",et,".program);"),j.shader.program)No(X,nt,j,j.shader.program);else{nt(X.shared.vao,".setVAO(null);");var z=X.global.def("{}"),ut=nt.def(et,".id"),mt=nt.def(z,"[",ut,"]");nt(X.cond(mt).then(mt,".call(this,a0,a1);").else(mt,"=",z,"[",ut,"]=",X.link(function(Pt){return nn(No,X,j,Pt,2)}),"(",et,");",mt,".call(this,a0,a1);"))}}Object.keys(j.state).length>0&&nt(X.shared.current,".dirty=true;")}function Et(X,j){var nt=X.proc("scope",3);X.batchId="a2";var ht=X.shared,gt=ht.current;Jn(X,nt,j.context),j.framebuffer&&j.framebuffer.append(X,nt),pf(Object.keys(j.state)).forEach(function(rt){var lt=j.state[rt],W=lt.append(X,nt);qn(W)?W.forEach(function(et,z){nt.set(X.next[rt],"["+z+"]",et)}):nt.set(ht.next,"."+rt,W)}),Ye(X,nt,j,!0,!0),[ss,Nr,Gr,ja,Oo].forEach(function(rt){var lt=j.draw[rt];lt&&nt.set(ht.draw,"."+rt,""+lt.append(X,nt))}),Object.keys(j.uniforms).forEach(function(rt){var lt=j.uniforms[rt].append(X,nt);Array.isArray(lt)&&(lt="["+lt.join()+"]"),nt.set(ht.uniforms,"["+G.id(rt)+"]",lt)}),Object.keys(j.attributes).forEach(function(rt){var lt=j.attributes[rt].append(X,nt),W=X.scopeAttrib(rt);Object.keys(new ft).forEach(function(et){nt.set(W,"."+et,lt[et])})}),j.scopeVAO&&nt.set(ht.vao,".targetVAO",j.scopeVAO.append(X,nt));function ot(rt){var lt=j.shader[rt];lt&&nt.set(ht.shader,"."+rt,lt.append(X,nt))}ot(os),ot(Ba),Object.keys(j.state).length>0&&(nt(gt,".dirty=true;"),nt.exit(gt,".dirty=true;")),nt("a1(",X.shared.context,",a0,",X.batchId,");")}function vt(X){if(!(typeof X!="object"||qn(X))){for(var j=Object.keys(X),nt=0;nt<j.length;++nt)if(gr.isDynamic(X[j[nt]]))return!0;return!1}}function me(X,j,nt){var ht=j.static[nt];if(!ht||!vt(ht))return;var gt=X.global,ot=Object.keys(ht),rt=!1,lt=!1,W=!1,et=X.global.def("{}");ot.forEach(function(ut){var mt=ht[ut];if(gr.isDynamic(mt)){typeof mt=="function"&&(mt=ht[ut]=gr.unbox(mt));var Pt=pr(mt,null);rt=rt||Pt.thisDep,W=W||Pt.propDep,lt=lt||Pt.contextDep}else{switch(gt(et,".",ut,"="),typeof mt){case"number":gt(mt);break;case"string":gt('"',mt,'"');break;case"object":Array.isArray(mt)&&gt("[",mt.join(),"]");break;default:gt(X.link(mt));break}gt(";")}});function z(ut,mt){ot.forEach(function(Pt){var Rt=ht[Pt];if(gr.isDynamic(Rt)){var Mt=ut.invoke(mt,Rt);mt(et,".",Pt,"=",Mt,";")}})}j.dynamic[nt]=new gr.DynamicVariable(es,{thisDep:rt,contextDep:lt,propDep:W,ref:et,append:z}),delete j.static[nt]}function an(X,j,nt,ht,gt){var ot=je();ot.stats=ot.link(gt),Object.keys(j.static).forEach(function(lt){me(ot,j,lt)}),Fg.forEach(function(lt){me(ot,X,lt)});var rt=Vn(X,j,nt,ht,ot);return Kn(ot,rt),Et(ot,rt),q(ot,rt),Nt(ot.compile(),{destroy:function(){rt.shader.program.destroy()}})}return{next:ge,current:Ft,procs:function(){var X=je(),j=X.proc("poll"),nt=X.proc("refresh"),ht=X.block();j(ht),nt(ht);var gt=X.shared,ot=gt.gl,rt=gt.next,lt=gt.current;ht(lt,".dirty=false;"),Hn(X,j),Hn(X,nt,null,!0);var W;ee&&(W=X.link(ee)),tt.oes_vertex_array_object&&nt(X.link(tt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var et=0;et<wt.maxAttributes;++et){var z=nt.def(gt.attributes,"[",et,"]"),ut=X.cond(z,".buffer");ut.then(ot,".enableVertexAttribArray(",et,");",ot,".bindBuffer(",Qs,",",z,".buffer.buffer);",ot,".vertexAttribPointer(",et,",",z,".size,",z,".type,",z,".normalized,",z,".stride,",z,".offset);").else(ot,".disableVertexAttribArray(",et,");",ot,".vertexAttrib4f(",et,",",z,".x,",z,".y,",z,".z,",z,".w);",z,".buffer=null;"),nt(ut),ee&&nt(W,".vertexAttribDivisorANGLE(",et,",",z,".divisor);")}return nt(X.shared.vao,".currentVAO=null;",X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"),Object.keys(se).forEach(function(mt){var Pt=se[mt],Rt=ht.def(rt,".",mt),Mt=X.block();Mt("if(",Rt,"){",ot,".enable(",Pt,")}else{",ot,".disable(",Pt,")}",lt,".",mt,"=",Rt,";"),nt(Mt),j("if(",Rt,"!==",lt,".",mt,"){",Mt,"}")}),Object.keys(zt).forEach(function(mt){var Pt=zt[mt],Rt=Ft[mt],Mt,Qt,Oe=X.block();if(Oe(ot,".",Pt,"("),qn(Rt)){var Je=Rt.length;Mt=X.global.def(rt,".",mt),Qt=X.global.def(lt,".",mt),Oe(Mr(Je,function(ve){return Mt+"["+ve+"]"}),");",Mr(Je,function(ve){return Qt+"["+ve+"]="+Mt+"["+ve+"];"}).join("")),j("if(",Mr(Je,function(ve){return Mt+"["+ve+"]!=="+Qt+"["+ve+"]"}).join("||"),"){",Oe,"}")}else Mt=ht.def(rt,".",mt),Qt=ht.def(lt,".",mt),Oe(Mt,");",lt,".",mt,"=",Mt,";"),j("if(",Mt,"!==",Qt,"){",Oe,"}");nt(Oe)}),X.compile()}(),compile:an}}function fo(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var mf=34918,ol=34919,vf=35007,yf=function(M,G){if(!G.ext_disjoint_timer_query)return null;var tt=[];function wt(){return tt.pop()||G.ext_disjoint_timer_query.createQueryEXT()}function Dt(ee){tt.push(ee)}var xt=[];function Tt(ee){var ue=wt();G.ext_disjoint_timer_query.beginQueryEXT(vf,ue),xt.push(ue),Zt(xt.length-1,xt.length,ee)}function $t(){G.ext_disjoint_timer_query.endQueryEXT(vf)}function Wt(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Kt=[];function Yt(){return Kt.pop()||new Wt}function re(ee){Kt.push(ee)}var ce=[];function Zt(ee,ue,Ft){var ge=Yt();ge.startQueryIndex=ee,ge.endQueryIndex=ue,ge.sum=0,ge.stats=Ft,ce.push(ge)}var ie=[],ft=[];function St(){var ee,ue,Ft=xt.length;if(Ft!==0){ft.length=Math.max(ft.length,Ft+1),ie.length=Math.max(ie.length,Ft+1),ie[0]=0,ft[0]=0;var ge=0;for(ee=0,ue=0;ue<xt.length;++ue){var Vt=xt[ue];G.ext_disjoint_timer_query.getQueryObjectEXT(Vt,ol)?(ge+=G.ext_disjoint_timer_query.getQueryObjectEXT(Vt,mf),Dt(Vt)):xt[ee++]=Vt,ie[ue+1]=ge,ft[ue+1]=ee}for(xt.length=ee,ee=0,ue=0;ue<ce.length;++ue){var se=ce[ue],zt=se.startQueryIndex,oe=se.endQueryIndex;se.sum+=ie[oe]-ie[zt];var Pe=ft[zt],ze=ft[oe];ze===Pe?(se.stats.gpuTime+=se.sum/1e6,re(se)):(se.startQueryIndex=Pe,se.endQueryIndex=ze,ce[ee++]=se)}ce.length=ee}}return{beginQuery:Tt,endQuery:$t,pushScopeStats:Zt,update:St,getNumPendingQueries:function(){return xt.length},clear:function(){tt.push.apply(tt,xt);for(var ee=0;ee<tt.length;ee++)G.ext_disjoint_timer_query.deleteQueryEXT(tt[ee]);xt.length=0,tt.length=0},restore:function(){xt.length=0,tt.length=0}}},fs=16384,qg=256,zu=1024,sl=34962,Uu="webglcontextlost",mi="webglcontextrestored",bf=1,xf=2,Vu=3;function wf(M,G){for(var tt=0;tt<M.length;++tt)if(M[tt]===G)return tt;return-1}function Hu(M){var G=va(M);if(!G)return null;var tt=G.gl,wt=tt.getContextAttributes(),Dt=tt.isContextLost(),xt=pc(tt,G);if(!xt)return null;var Tt=gc(),$t=fo(),Wt=xt.extensions,Kt=yf(tt,Wt),Yt=Gl(),re=tt.drawingBufferWidth,ce=tt.drawingBufferHeight,Zt={tick:0,time:0,viewportWidth:re,viewportHeight:ce,framebufferWidth:re,framebufferHeight:ce,drawingBufferWidth:re,drawingBufferHeight:ce,pixelRatio:G.pixelRatio},ie={},ft={elements:null,primitive:4,count:-1,offset:0,instances:-1},St=yh(tt,Wt),ee=qd(tt,$t,G,Ft),ue=Dg(tt,Wt,St,$t,ee);function Ft(Le){return ue.destroyBuffer(Le)}var ge=Ih(tt,Wt,ee,$t),Vt=Pa(tt,Tt,$t,G),se=zc(tt,Wt,St,function(){Pe.procs.poll()},Zt,$t,G),zt=wg(tt,Wt,St,$t,G),oe=Ou(tt,Wt,St,se,zt,$t),Pe=ho(tt,Tt,Wt,St,ee,ge,se,oe,ie,ue,Vt,ft,Zt,Kt,G),ze=Mu(tt,oe,Pe.procs.poll,Zt,wt,Wt,St),ae=Pe.next,ne=tt.canvas,Gt=[],je=[],qe=[],we=[G.onDestroy],on=null;function He(){if(Gt.length===0){Kt&&Kt.update(),on=null;return}on=wr.next(He),xr();for(var Le=Gt.length-1;Le>=0;--Le){var nn=Gt[Le];nn&&nn(Zt,null,0)}tt.flush(),Kt&&Kt.update()}function en(){!on&&Gt.length>0&&(on=wr.next(He))}function yn(){on&&(wr.cancel(He),on=null)}function nr(Le){Le.preventDefault(),Dt=!0,yn(),je.forEach(function(nn){nn()})}function cn(Le){tt.getError(),Dt=!1,xt.restore(),Vt.restore(),ee.restore(),se.restore(),zt.restore(),oe.restore(),ue.restore(),Kt&&Kt.restore(),Pe.procs.refresh(),en(),qe.forEach(function(nn){nn()})}ne&&(ne.addEventListener(Uu,nr,!1),ne.addEventListener(mi,cn,!1));function ln(){Gt.length=0,yn(),ne&&(ne.removeEventListener(Uu,nr),ne.removeEventListener(mi,cn)),Vt.clear(),oe.clear(),zt.clear(),se.clear(),ge.clear(),ee.clear(),ue.clear(),Kt&&Kt.clear(),we.forEach(function(Le){Le()})}function lr(Le){$(!!Le,"invalid args to regl({...})"),$.type(Le,"object","invalid args to regl({...})");function nn(gt){var ot=Nt({},gt);delete ot.uniforms,delete ot.attributes,delete ot.context,delete ot.vao,"stencil"in ot&&ot.stencil.op&&(ot.stencil.opBack=ot.stencil.opFront=ot.stencil.op,delete ot.stencil.op);function rt(lt){if(lt in ot){var W=ot[lt];delete ot[lt],Object.keys(W).forEach(function(et){ot[lt+"."+et]=W[et]})}}return rt("blend"),rt("depth"),rt("cull"),rt("stencil"),rt("polygonOffset"),rt("scissor"),rt("sample"),"vao"in gt&&(ot.vao=gt.vao),ot}function fn(gt,ot){var rt={},lt={};return Object.keys(gt).forEach(function(W){var et=gt[W];if(gr.isDynamic(et)){lt[W]=gr.unbox(et,W);return}else if(ot&&Array.isArray(et)){for(var z=0;z<et.length;++z)if(gr.isDynamic(et[z])){lt[W]=gr.unbox(et,W);return}}rt[W]=et}),{dynamic:lt,static:rt}}var Kn=fn(Le.context||{},!0),Oi=fn(Le.uniforms||{},!0),No=fn(Le.attributes||{},!1),q=fn(nn(Le),!1),Et={gpuTime:0,cpuTime:0,count:0},vt=Pe.compile(q,No,Oi,Kn,Et),me=vt.draw,an=vt.batch,X=vt.scope,j=[];function nt(gt){for(;j.length<gt;)j.push(null);return j}function ht(gt,ot){var rt;if(Dt&&$.raise("context lost"),typeof gt=="function")return X.call(this,null,gt,0);if(typeof ot=="function")if(typeof gt=="number")for(rt=0;rt<gt;++rt)X.call(this,null,ot,rt);else if(Array.isArray(gt))for(rt=0;rt<gt.length;++rt)X.call(this,gt[rt],ot,rt);else return X.call(this,gt,ot,0);else if(typeof gt=="number"){if(gt>0)return an.call(this,nt(gt|0),gt|0)}else if(Array.isArray(gt)){if(gt.length)return an.call(this,gt,gt.length)}else return me.call(this,gt)}return Nt(ht,{stats:Et,destroy:function(){vt.destroy()}})}var Pn=oe.setFBO=lr({framebuffer:gr.define.call(null,bf,"framebuffer")});function Vn(Le,nn){var fn=0;Pe.procs.poll();var Kn=nn.color;Kn&&(tt.clearColor(+Kn[0]||0,+Kn[1]||0,+Kn[2]||0,+Kn[3]||0),fn|=fs),"depth"in nn&&(tt.clearDepth(+nn.depth),fn|=qg),"stencil"in nn&&(tt.clearStencil(nn.stencil|0),fn|=zu),$(!!fn,"called regl.clear with no buffer specified"),tt.clear(fn)}function Jn(Le){if($(typeof Le=="object"&&Le,"regl.clear() takes an object as input"),"framebuffer"in Le)if(Le.framebuffer&&Le.framebuffer_reglType==="framebufferCube")for(var nn=0;nn<6;++nn)Pn(Nt({framebuffer:Le.framebuffer.faces[nn]},Le),Vn);else Pn(Le,Vn);else Vn(null,Le)}function Hn(Le){$.type(Le,"function","regl.frame() callback must be a function"),Gt.push(Le);function nn(){var fn=wf(Gt,Le);$(fn>=0,"cannot cancel a frame twice");function Kn(){var Oi=wf(Gt,Kn);Gt[Oi]=Gt[Gt.length-1],Gt.length-=1,Gt.length<=0&&yn()}Gt[fn]=Kn}return en(),{cancel:nn}}function Gn(){var Le=ae.viewport,nn=ae.scissor_box;Le[0]=Le[1]=nn[0]=nn[1]=0,Zt.viewportWidth=Zt.framebufferWidth=Zt.drawingBufferWidth=Le[2]=nn[2]=tt.drawingBufferWidth,Zt.viewportHeight=Zt.framebufferHeight=Zt.drawingBufferHeight=Le[3]=nn[3]=tt.drawingBufferHeight}function xr(){Zt.tick+=1,Zt.time=Ye(),Gn(),Pe.procs.poll()}function $n(){se.refresh(),Gn(),Pe.procs.refresh(),Kt&&Kt.update()}function Ye(){return(Gl()-Yt)/1e3}$n();function _r(Le,nn){$.type(nn,"function","listener callback must be a function");var fn;switch(Le){case"frame":return Hn(nn);case"lost":fn=je;break;case"restore":fn=qe;break;case"destroy":fn=we;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return fn.push(nn),{cancel:function(){for(var Kn=0;Kn<fn.length;++Kn)if(fn[Kn]===nn){fn[Kn]=fn[fn.length-1],fn.pop();return}}}}var _n=Nt(lr,{clear:Jn,prop:gr.define.bind(null,bf),context:gr.define.bind(null,xf),this:gr.define.bind(null,Vu),draw:lr({}),buffer:function(Le){return ee.create(Le,sl,!1,!1)},elements:function(Le){return ge.create(Le,!1)},texture:se.create2D,cube:se.createCube,renderbuffer:zt.create,framebuffer:oe.create,framebufferCube:oe.createCube,vao:ue.createVAO,attributes:wt,frame:Hn,on:_r,limits:St,hasExtension:function(Le){return St.extensions.indexOf(Le.toLowerCase())>=0},read:ze,destroy:ln,_gl:tt,_refresh:$n,poll:function(){xr(),Kt&&Kt.update()},now:Ye,stats:$t});return G.onDone(null,_n),_n}return Hu})},2443:(yo,wn,Nt)=>{"use strict";Nt.d(wn,{Vq:()=>eo});var Lt={};Nt.r(Lt),Nt.d(Lt,{postorder:()=>Kd,preorder:()=>Qd});const mn=i=>typeof i=="string",An=i=>{const r=Object.create(null);return o=>r[o]||(r[o]=i(o))},Te=/-(\w)/g,Be=An(i=>i.replace(Te,(r,o)=>o?o.toUpperCase():"")),Jt=Array.isArray,kt=i=>typeof i=="number",te=i=>Number.isNaN(Number(i)),Y=i=>{const r=parseFloat(i);return te(r)?i:r},Q=i=>i!==null&&typeof i=="object",st=i=>{if(i===null)return i;if(i instanceof Date)return new Date(i.getTime());if(i instanceof Array){const r=[];return i.forEach(o=>{r.push(o)}),r.map(o=>st(o))}if(typeof i=="object"&&Object.keys(i).length){const r=Object.assign({},i);return Object.keys(r).forEach(o=>{r[o]=st(r[o])}),r}return i},at=(i,r)=>{const o=i[r];return Q(o)?o.cell:o},jt=(i,r,o)=>{const s=[];for(let l=0;l<i;l++)s[l]={in:0,out:0,all:0};return o&&o.forEach(l=>{const h=at(l,"source"),g=at(l,"target");h&&s[r[h]]&&(s[r[h]].out+=1,s[r[h]].all+=1),g&&s[r[g]]&&(s[r[g]].in+=1,s[r[g]].all+=1)}),s},Ht=(i,r)=>{const o={};return i.forEach(s=>{o[s.id]={in:0,out:0,all:0}}),r&&r.forEach(s=>{const l=at(s,"source"),h=at(s,"target");l&&(o[l].out+=1,o[l].all+=1),h&&(o[h].in+=1,o[h].all+=1)}),o},Xt=i=>{const r=[],o=i.length;for(let s=0;s<o;s+=1){r[s]=[];for(let l=0;l<o;l+=1)s===l?r[s][l]=0:i[s][l]===0||!i[s][l]?r[s][l]=1/0:r[s][l]=i[s][l]}for(let s=0;s<o;s+=1)for(let l=0;l<o;l+=1)for(let h=0;h<o;h+=1)r[l][h]>r[l][s]+r[s][h]&&(r[l][h]=r[l][s]+r[s][h]);return r},De=(i,r)=>{const{nodes:o,edges:s}=i,l=[],h={};if(!o)throw new Error("invalid nodes data!");return o&&o.forEach((g,p)=>{h[g.id]=p;const m=[];l.push(m)}),s==null||s.forEach(g=>{const p=at(g,"source"),m=at(g,"target"),y=h[p],x=h[m];y===void 0||x===void 0||(l[y][x]=1,r||(l[x][y]=1))}),l},Ze=(i,r)=>{const o=[];return i.forEach(s=>{const l=[];s.forEach(h=>{l.push(h*r)}),o.push(l)}),o},hn=(i,r)=>{if(i&&i.children){for(let o=i.children.length-1;o>=0;o--)if(!hn(i.children[o],r))return}return!!r(i)},Ce=(i,r)=>{typeof r=="function"&&hn(i,r)},Me=i=>{let r=1/0,o=1/0,s=-1/0,l=-1/0;return i.forEach(h=>{let g=h.size;Jt(g)?g.length===1&&(g=[g[0],g[0]]):kt(g)?g=[g,g]:(g===void 0||isNaN(g))&&(g=[30,30]);const p=[g[0]/2,g[1]/2],m=h.x-p[0],y=h.x+p[0],x=h.y-p[1],w=h.y+p[1];r>m&&(r=m),o>x&&(o=x),s<y&&(s=y),l<w&&(l=w)}),{minX:r,minY:o,maxX:s,maxY:l}},tn=i=>{const r={x:0,y:0};i.forEach(s=>{r.x+=s.x||0,r.y+=s.y||0});const o=i.length||1;return{x:r.x/o,y:r.y/o}},fe=(i,r,o)=>{var s,l;return i==="source"?((s=o==null?void 0:o.find(h=>h.target===r.id))===null||s===void 0?void 0:s.source)||{}:((l=o==null?void 0:o.find(h=>h.source===r.id))===null||l===void 0?void 0:l.target)||{}},Se=(i,r,o)=>{let s=[];switch(i){case"source":s=o==null?void 0:o.filter(h=>h.source===r.id).map(h=>h.target);break;case"target":s=o==null?void 0:o.filter(h=>h.target===r.id).map(h=>h.source);break;case"both":s=o==null?void 0:o.filter(h=>h.source===r.id).map(h=>h.target).concat(o==null?void 0:o.filter(h=>h.target===r.id).map(h=>h.source));break;default:break}const l=new Set(s);return Array.from(l)},Ve=(i,r,o,s,l)=>{const h=o[r]||"";let g=(s==null?void 0:s.filter(p=>p[r]===h))||[];return i==="leaf"&&(g=g.filter(p=>{var m,y;return((m=l[p.id])===null||m===void 0?void 0:m.in)===0||((y=l[p.id])===null||y===void 0?void 0:y.out)===0})),g},rn=(i,r,o,s,l,h)=>{const{in:g,out:p}=l[r.id];let m=r,y=[];g===0?(m=fe("source",r,o),y=Se("both",m,o).map(w=>h[w])):p===0&&(m=fe("target",r,o),y=Se("both",m,o).map(w=>h[w])),y=y.filter(w=>l[w.id]&&(l[w.id].in===0||l[w.id].out===0));const x=Ve(i,s,r,y,l);return{coreNode:m,relativeLeafNodes:y,sameTypeLeafNodes:x}},Ue=i=>typeof i=="function",Tn=(i,r,o)=>{let s;return o?s=o:kt(i)?s=()=>i:s=()=>r,s},Qn=(i,r,o=!0)=>!r&&r!==0?s=>s.size?Jt(s.size)?s.size[0]>s.size[1]?s.size[0]:s.size[1]:Q(s.size)?s.size.width>s.size.height?s.size.width:s.size.height:s.size:i:Ue(r)?r:kt(r)?()=>r:Jt(r)?()=>{if(o){const s=Math.max(...r);return isNaN(s)?i:s}return r}:Q(r)?()=>{if(o){const s=Math.max(r.width,r.height);return isNaN(s)?i:s}return[r.width,r.height]}:()=>i,Zn=new Map,xi=(i,r)=>{if(Zn.get(i)&&console.warn(`The layout with the name ${i} exists already, it will be overridden`),isObject(r)){class o extends Base{constructor(l){var h;super();const g=this,p={},m=Object.assign({},g.getDefaultCfg(),((h=r.getDefaultCfg)===null||h===void 0?void 0:h.call(r))||{});Object.assign(p,m,r,l),Object.keys(p).forEach(y=>{const x=p[y];g[y]=x})}}Zn.set(i,o)}else Zn.set(i,r);return Zn.get(i)},Or=i=>{Zn.has(i)&&Zn.delete(i)},ki=i=>Zn.has(i)?Zn.get(i):null;class vn{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(r){return this.init(r),this.execute(!0)}init(r){this.nodes=r.nodes||[],this.edges=r.edges||[],this.combos=r.combos||[],this.comboEdges=r.comboEdges||[],this.hiddenNodes=r.hiddenNodes||[],this.hiddenEdges=r.hiddenEdges||[],this.hiddenCombos=r.hiddenCombos||[],this.vedges=r.vedges||[]}execute(r){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(r){r&&Object.assign(this,r)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}class Bn extends vn{constructor(r){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const r=this,{nodes:o,edges:s,begin:l}=r,h=o.length;if(h===0)return r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s};if(h===1)return o[0].x=l[0],o[0].y=l[1],r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s};let{sortBy:g,width:p,height:m}=r;const{condense:y,preventOverlapPadding:x,preventOverlap:w,nodeSpacing:A,nodeSize:T}=r,O=[];o.forEach(R=>{O.push(R)});const I={};if(O.forEach((R,k)=>{I[R.id]=k}),(g==="degree"||!mn(g)||O[0][g]===void 0)&&(g="degree",te(o[0].degree))){const R=jt(O.length,I,s);O.forEach((k,U)=>{k.degree=R[U].all})}O.sort((R,k)=>k[g]-R[g]),!p&&typeof window<"u"&&(p=window.innerWidth),!m&&typeof window<"u"&&(m=window.innerHeight);const N=r.rows,P=r.cols!=null?r.cols:r.columns;if(r.cells=h,N!=null&&P!=null?(r.rows=N,r.cols=P):N!=null&&P==null?(r.rows=N,r.cols=Math.ceil(r.cells/r.rows)):N==null&&P!=null?(r.cols=P,r.rows=Math.ceil(r.cells/r.cols)):(r.splits=Math.sqrt(r.cells*r.height/r.width),r.rows=Math.round(r.splits),r.cols=Math.round(r.width/r.height*r.splits)),r.rows=Math.max(r.rows,1),r.cols=Math.max(r.cols,1),r.cols*r.rows>r.cells){const R=r.small(),k=r.large();(R-1)*k>=r.cells?r.small(R-1):(k-1)*R>=r.cells&&r.large(k-1)}else for(;r.cols*r.rows<r.cells;){const R=r.small(),k=r.large();(k+1)*R>=r.cells?r.large(k+1):r.small(R+1)}if(r.cellWidth=p/r.cols,r.cellHeight=m/r.rows,y&&(r.cellWidth=0,r.cellHeight=0),w||A){const R=Qn(10,A),k=Qn(30,T,!1);O.forEach(U=>{(!U.x||!U.y)&&(U.x=0,U.y=0);const K=k(U)||30;let pt,Ot;Jt(K)?(pt=K[0],Ot=K[1]):(pt=K,Ot=K);const It=R!==void 0?R(U):x,Ct=pt+It,_t=Ot+It;r.cellWidth=Math.max(r.cellWidth,Ct),r.cellHeight=Math.max(r.cellHeight,_t)})}r.cellUsed={},r.row=0,r.col=0,r.id2manPos={};for(let R=0;R<O.length;R++){const k=O[R];let U;if(r.position&&(U=r.position(k)),U&&(U.row!==void 0||U.col!==void 0)){const K={row:U.row,col:U.col};if(K.col===void 0)for(K.col=0;r.used(K.row,K.col);)K.col++;else if(K.row===void 0)for(K.row=0;r.used(K.row,K.col);)K.row++;r.id2manPos[k.id]=K,r.use(K.row,K.col)}r.getPos(k)}return r.onLayoutEnd&&r.onLayoutEnd(),{edges:s,nodes:O}}small(r){const o=this;let s;const l=o.rows||5,h=o.cols||5;return r==null?s=Math.min(l,h):Math.min(l,h)===o.rows?o.rows=r:o.cols=r,s}large(r){const o=this;let s;const l=o.rows||5,h=o.cols||5;return r==null?s=Math.max(l,h):Math.max(l,h)===o.rows?o.rows=r:o.cols=r,s}used(r,o){return this.cellUsed[`c-${r}-${o}`]||!1}use(r,o){const s=this;s.cellUsed[`c-${r}-${o}`]=!0}moveToNextCell(){const r=this,o=r.cols||5;r.col++,r.col>=o&&(r.col=0,r.row++)}getPos(r){const o=this,{begin:s,cellWidth:l,cellHeight:h}=o;let g,p;const m=o.id2manPos[r.id];if(m)g=m.col*l+l/2+s[0],p=m.row*h+h/2+s[1];else{for(;o.used(o.row,o.col);)o.moveToNextCell();g=o.col*l+l/2+s[0],p=o.row*h+h/2+s[1],o.use(o.row,o.col),o.moveToNextCell()}r.x=g,r.y=p}getType(){return"grid"}}const oi=(i,r)=>{let o;return i?kt(i)?o=s=>i:o=i:o=s=>r||1,o};class dr extends vn{constructor(r){super(),this.maxIteration=500,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.collideStrength=1,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.animate=!0,this.updateCfg(r)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){var r,o;const s=this,l=s.nodes;if(s.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(s.timeInterval),!l||l.length===0){(r=s.onLayoutEnd)===null||r===void 0||r.call(s);return}!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight),s.center||(s.center=[s.width/2,s.height/2]);const h=s.center;if(l.length===1){l[0].x=h[0],l[0].y=h[1],(o=s.onLayoutEnd)===null||o===void 0||o.call(s);return}const g={},p={};l.forEach((w,A)=>{kt(w.x)||(w.x=Math.random()*s.width),kt(w.y)||(w.y=Math.random()*s.height),g[w.id]=w,p[w.id]=A}),s.nodeMap=g,s.nodeIdxMap=p,s.linkDistance=oi(s.linkDistance,1),s.nodeStrength=oi(s.nodeStrength,1),s.edgeStrength=oi(s.edgeStrength,1);const m=s.nodeSize;let y;if(s.preventOverlap){const w=s.nodeSpacing;let A;kt(w)?A=()=>w:Ue(w)?A=w:A=()=>0,m?Jt(m)?y=T=>Math.max(m[0],m[1])+A(T):y=T=>m+A(T):y=T=>T.size?Jt(T.size)?Math.max(T.size[0],T.size[1])+A(T):Q(T.size)?Math.max(T.size.width,T.size.height)+A(T):T.size+A(T):10+A(T)}s.nodeSize=y;const x=s.edges;s.degrees=jt(l.length,s.nodeIdxMap,x),s.getMass||(s.getMass=w=>w.mass||s.degrees[s.nodeIdxMap[w.id]].all||1),s.run()}run(){var r;const o=this,{maxIteration:s,nodes:l,workerEnabled:h,minMovement:g,animate:p}=o;if(l)if(h||!p){for(let m=0;m<s;m++){const y=o.runOneStep(m);if(o.reachMoveThreshold(l,y,g))break}(r=o.onLayoutEnd)===null||r===void 0||r.call(o)}else{if(typeof window>"u")return;let m=0;this.timeInterval=window.setInterval(()=>{var y,x;if(!l)return;const w=o.runOneStep(m)||[];o.reachMoveThreshold(l,w,g)&&((y=o.onLayoutEnd)===null||y===void 0||y.call(o),window.clearInterval(o.timeInterval)),m++,m>=s&&((x=o.onLayoutEnd)===null||x===void 0||x.call(o),window.clearInterval(o.timeInterval))},0)}}reachMoveThreshold(r,o,s){let l=0;return r.forEach((h,g)=>{const p=h.x-o[g].x,m=h.y-o[g].y;l+=Math.sqrt(p*p+m*m)}),l/=r.length,l<s}runOneStep(r){var o;const s=this,{nodes:l,edges:h}=s,g=[],p=[];if(!l)return;l.forEach((x,w)=>{g[2*w]=0,g[2*w+1]=0,p[2*w]=0,p[2*w+1]=0}),s.calRepulsive(g,l),h&&s.calAttractive(g,h),s.calGravity(g,l);const m=Math.max(.02,s.interval-r*.002);s.updateVelocity(g,p,m,l);const y=[];return l.forEach(x=>{y.push({x:x.x,y:x.y})}),s.updatePosition(p,m,l),(o=s.tick)===null||o===void 0||o.call(s),y}calRepulsive(r,o){const s=this,{getMass:l,factor:h,coulombDisScale:g,preventOverlap:p,collideStrength:m=1}=s,y=s.nodeStrength,x=s.nodeSize;o.forEach((w,A)=>{const T=l?l(w):1;o.forEach((O,I)=>{if(A>=I)return;let N=w.x-O.x,P=w.y-O.y;N===0&&P===0&&(N=Math.random()*.01,P=Math.random()*.01);const R=N*N+P*P,k=Math.sqrt(R),U=(k+.1)*g,K=N/k,pt=P/k,Ot=(y(w)+y(O))*.5*h/(U*U),It=l?l(O):1;if(r[2*A]+=K*Ot,r[2*A+1]+=pt*Ot,r[2*I]-=K*Ot,r[2*I+1]-=pt*Ot,p&&(x(w)+x(O))/2>k){const Ct=m*(y(w)+y(O))*.5/R;r[2*A]+=K*Ct/T,r[2*A+1]+=pt*Ct/T,r[2*I]-=K*Ct/It,r[2*I+1]-=pt*Ct/It}})})}calAttractive(r,o){const s=this,{nodeMap:l,nodeIdxMap:h,linkDistance:g,edgeStrength:p}=s,m=s.nodeSize,y=s.getMass;o.forEach((x,w)=>{const A=at(x,"source"),T=at(x,"target"),O=l[A],I=l[T];let N=I.x-O.x,P=I.y-O.y;N===0&&P===0&&(N=Math.random()*.01,P=Math.random()*.01);const R=Math.sqrt(N*N+P*P),k=N/R,U=P/R,Ot=((g(x,O,I)||1+(m(O)+m(I)||0)/2)-R)*p(x),It=h[A],Ct=h[T],_t=y?y(O):1,F=y?y(I):1;r[2*It]-=k*Ot/_t,r[2*It+1]-=U*Ot/_t,r[2*Ct]+=k*Ot/F,r[2*Ct+1]+=U*Ot/F})}calGravity(r,o){const s=this,l=s.center,h=s.gravity,g=s.degrees,p=o.length;for(let m=0;m<p;m++){const y=o[m];let x=y.x-l[0],w=y.y-l[1],A=h;if(s.getCenter){const T=s.getCenter(y,g[m].all);T&&kt(T[0])&&kt(T[1])&&kt(T[2])&&(x=y.x-T[0],w=y.y-T[1],A=T[2])}A&&(r[2*m]-=A*x,r[2*m+1]-=A*w)}}updateVelocity(r,o,s,l){const h=this,g=s*h.damping;l.forEach((p,m)=>{let y=r[2*m]*g||.01,x=r[2*m+1]*g||.01;const w=Math.sqrt(y*y+x*x);if(w>h.maxSpeed){const A=h.maxSpeed/w;y=A*y,x=A*x}o[2*m]=y,o[2*m+1]=x})}updatePosition(r,o,s){s.forEach((l,h)=>{if(kt(l.fx)&&kt(l.fy)){l.x=l.fx,l.y=l.fy;return}const g=r[2*h]*o,p=r[2*h+1]*o;l.x+=g,l.y+=p})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const r=this;r.stop(),r.tick=null,r.nodes=null,r.edges=null,r.destroyed=!0}getType(){return"gForce"}}function ar(i){const r=+this._x.call(null,i),o=+this._y.call(null,i);return jo(this.cover(r,o),r,o,i)}function jo(i,r,o,s){if(isNaN(r)||isNaN(o))return i;var l,h=i._root,g={data:s},p=i._x0,m=i._y0,y=i._x1,x=i._y1,w,A,T,O,I,N,P,R;if(!h)return i._root=g,i;for(;h.length;)if((I=r>=(w=(p+y)/2))?p=w:y=w,(N=o>=(A=(m+x)/2))?m=A:x=A,l=h,!(h=h[P=N<<1|I]))return l[P]=g,i;if(T=+i._x.call(null,h.data),O=+i._y.call(null,h.data),r===T&&o===O)return g.next=h,l?l[P]=g:i._root=g,i;do l=l?l[P]=new Array(4):i._root=new Array(4),(I=r>=(w=(p+y)/2))?p=w:y=w,(N=o>=(A=(m+x)/2))?m=A:x=A;while((P=N<<1|I)===(R=(O>=A)<<1|T>=w));return l[R]=h,l[P]=g,i}function da(i){var r,o,s=i.length,l,h,g=new Array(s),p=new Array(s),m=1/0,y=1/0,x=-1/0,w=-1/0;for(o=0;o<s;++o)isNaN(l=+this._x.call(null,r=i[o]))||isNaN(h=+this._y.call(null,r))||(g[o]=l,p[o]=h,l<m&&(m=l),l>x&&(x=l),h<y&&(y=h),h>w&&(w=h));if(m>x||y>w)return this;for(this.cover(m,y).cover(x,w),o=0;o<s;++o)jo(this,g[o],p[o],i[o]);return this}function Ir(i,r){if(isNaN(i=+i)||isNaN(r=+r))return this;var o=this._x0,s=this._y0,l=this._x1,h=this._y1;if(isNaN(o))l=(o=Math.floor(i))+1,h=(s=Math.floor(r))+1;else{for(var g=l-o||1,p=this._root,m,y;o>i||i>=l||s>r||r>=h;)switch(y=(r<s)<<1|i<o,m=new Array(4),m[y]=p,p=m,g*=2,y){case 0:l=o+g,h=s+g;break;case 1:o=l-g,h=s+g;break;case 2:l=o+g,s=h-g;break;case 3:o=l-g,s=h-g;break}this._root&&this._root.length&&(this._root=p)}return this._x0=o,this._y0=s,this._x1=l,this._y1=h,this}function bo(){var i=[];return this.visit(function(r){if(!r.length)do i.push(r.data);while(r=r.next)}),i}function Cs(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function cr(i,r,o,s,l){this.node=i,this.x0=r,this.y0=o,this.x1=s,this.y1=l}function Fo(i,r,o){var s,l=this._x0,h=this._y0,g,p,m,y,x=this._x1,w=this._y1,A=[],T=this._root,O,I;for(T&&A.push(new cr(T,l,h,x,w)),o==null?o=1/0:(l=i-o,h=r-o,x=i+o,w=r+o,o*=o);O=A.pop();)if(!(!(T=O.node)||(g=O.x0)>x||(p=O.y0)>w||(m=O.x1)<l||(y=O.y1)<h))if(T.length){var N=(g+m)/2,P=(p+y)/2;A.push(new cr(T[3],N,P,m,y),new cr(T[2],g,P,N,y),new cr(T[1],N,p,m,P),new cr(T[0],g,p,N,P)),(I=(r>=P)<<1|i>=N)&&(O=A[A.length-1],A[A.length-1]=A[A.length-1-I],A[A.length-1-I]=O)}else{var R=i-+this._x.call(null,T.data),k=r-+this._y.call(null,T.data),U=R*R+k*k;if(U<o){var K=Math.sqrt(o=U);l=i-K,h=r-K,x=i+K,w=r+K,s=T.data}}return s}function Go(i){if(isNaN(x=+this._x.call(null,i))||isNaN(w=+this._y.call(null,i)))return this;var r,o=this._root,s,l,h,g=this._x0,p=this._y0,m=this._x1,y=this._y1,x,w,A,T,O,I,N,P;if(!o)return this;if(o.length)for(;;){if((O=x>=(A=(g+m)/2))?g=A:m=A,(I=w>=(T=(p+y)/2))?p=T:y=T,r=o,!(o=o[N=I<<1|O]))return this;if(!o.length)break;(r[N+1&3]||r[N+2&3]||r[N+3&3])&&(s=r,P=N)}for(;o.data!==i;)if(l=o,!(o=o.next))return this;return(h=o.next)&&delete o.next,l?(h?l.next=h:delete l.next,this):r?(h?r[N]=h:delete r[N],(o=r[0]||r[1]||r[2]||r[3])&&o===(r[3]||r[2]||r[1]||r[0])&&!o.length&&(s?s[P]=o:this._root=o),this):(this._root=h,this)}function xo(i){for(var r=0,o=i.length;r<o;++r)this.remove(i[r]);return this}function wi(){return this._root}function Jr(){var i=0;return this.visit(function(r){if(!r.length)do++i;while(r=r.next)}),i}function Yi(i){var r=[],o,s=this._root,l,h,g,p,m;for(s&&r.push(new cr(s,this._x0,this._y0,this._x1,this._y1));o=r.pop();)if(!i(s=o.node,h=o.x0,g=o.y0,p=o.x1,m=o.y1)&&s.length){var y=(h+p)/2,x=(g+m)/2;(l=s[3])&&r.push(new cr(l,y,x,p,m)),(l=s[2])&&r.push(new cr(l,h,x,y,m)),(l=s[1])&&r.push(new cr(l,y,g,p,x)),(l=s[0])&&r.push(new cr(l,h,g,y,x))}return this}function _d(i){var r=[],o=[],s;for(this._root&&r.push(new cr(this._root,this._x0,this._y0,this._x1,this._y1));s=r.pop();){var l=s.node;if(l.length){var h,g=s.x0,p=s.y0,m=s.x1,y=s.y1,x=(g+m)/2,w=(p+y)/2;(h=l[0])&&r.push(new cr(h,g,p,x,w)),(h=l[1])&&r.push(new cr(h,x,p,m,w)),(h=l[2])&&r.push(new cr(h,g,w,x,y)),(h=l[3])&&r.push(new cr(h,x,w,m,y))}o.push(s)}for(;s=o.pop();)i(s.node,s.x0,s.y0,s.x1,s.y1);return this}function si(i){return i[0]}function Bl(i){return arguments.length?(this._x=i,this):this._x}function fc(i){return i[1]}function Sd(i){return arguments.length?(this._y=i,this):this._y}function ga(i,r,o){var s=new $(r==null?si:r,o==null?fc:o,NaN,NaN,NaN,NaN);return i==null?s:s.addAll(i)}function $(i,r,o,s,l,h){this._x=i,this._y=r,this._x0=o,this._y0=s,this._x1=l,this._y1=h,this._root=void 0}function Ke(i){for(var r={data:i.data},o=r;i=i.next;)o=o.next={data:i.data};return r}var Br=ga.prototype=$.prototype;Br.copy=function(){var i=new $(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root,o,s;if(!r)return i;if(!r.length)return i._root=Ke(r),i;for(o=[{source:r,target:i._root=new Array(4)}];r=o.pop();)for(var l=0;l<4;++l)(s=r.source[l])&&(s.length?o.push({source:s,target:r.target[l]=new Array(4)}):r.target[l]=Ke(s));return i},Br.add=ar,Br.addAll=da,Br.cover=Ir,Br.data=bo,Br.extent=Cs,Br.find=Fo,Br.remove=Go,Br.removeAll=xo,Br.root=wi,Br.size=Jr,Br.visit=Yi,Br.visitAfter=_d,Br.x=Bl,Br.y=Sd;const jl=.81,pa=.1;function zo(i,r,o,s,l){const h=o/s,g=i.map((m,y)=>{const x=r[m.id],{data:w,x:A,y:T,size:O}=x,{nodeStrength:I}=w.layout.force;return{x:A,y:T,size:O,index:y,vx:0,vy:0,weight:h*I}}),p=ga(g,m=>m.x,m=>m.y).visitAfter(dc);return g.forEach(m=>{oh(m,p)}),g.map((m,y)=>{const x=r[i[y].id],{mass:w=1}=x.data.layout.force;l[2*y]=m.vx/w,l[2*y+1]=m.vy/w}),l}function dc(i){let r=0,o=0,s=0;if(i.length){for(let l=0;l<4;l++){const h=i[l];h&&h.weight&&(r+=h.weight,o+=h.x*h.weight,s+=h.y*h.weight)}i.x=o/r,i.y=s/r,i.weight=r}else{const l=i;i.x=l.data.x,i.y=l.data.y,i.weight=l.data.weight}}const ma=(i,r,o,s,l,h)=>{const g=h.x-i.x||pa,p=h.y-i.y||pa,m=s-r,y=g*g+p*p,x=Math.sqrt(y)*y;if(m*m*jl<y){const w=i.weight/x;return h.vx+=g*w,h.vy+=p*w,!0}if(i.length)return!1;if(i.data!==h){const w=i.data.weight/x;h.vx+=g*w,h.vy+=p*w}};function oh(i,r){r.visit((o,s,l,h,g)=>ma(o,s,l,h,g,i))}const Fl=(i,r)=>{let o;return i?kt(i)?o=s=>i:o=i:o=s=>r||1,o};class Ad extends vn{constructor(r){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=500,this.minMovement=.4,this.interval=.02,this.factor=1,this.linkDistance=200,this.gravity=0,this.clusterNodeStrength=20,this.preventOverlap=!0,this.distanceThresholdMode="mean",this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.judgingDistance=0,this.centripetalOptions={leaf:2,single:2,others:1,center:s=>({x:this.width/2,y:this.height/2})};const{getMass:o}=r;this.propsGetMass=o,this.updateCfg(r)}getCentripetalOptions(){const{leafCluster:r,clustering:o,nodeClusterBy:s,nodes:l,nodeMap:h,clusterNodeStrength:g}=this,p=T=>typeof g=="function"?g(T):g;let m={},y;if(r){y=this.getSameTypeLeafMap()||{};const T=Array.from(new Set(l==null?void 0:l.map(O=>O[s])))||[];m={single:100,leaf:(O,I,N)=>{const{relativeLeafNodes:P,sameTypeLeafNodes:R}=y[O.id]||{};return(R==null?void 0:R.length)===(P==null?void 0:P.length)||(T==null?void 0:T.length)===1?1:p(O)},others:1,center:(O,I,N)=>{var P;const{degree:R}=((P=O.data)===null||P===void 0?void 0:P.layout)||{};if(!R)return{x:100,y:100};let k;if(R===1){const{sameTypeLeafNodes:U=[]}=y[O.id]||{};U.length===1?k=void 0:U.length>1&&(k=tn(U))}else k=void 0;return{x:k==null?void 0:k.x,y:k==null?void 0:k.y}}}}if(o){y||(y=this.getSameTypeLeafMap());const T=Array.from(new Set(l.map((I,N)=>I[s]))).filter(I=>I!==void 0),O={};T.forEach(I=>{const N=l.filter(P=>P[s]===I).map(P=>h[P.id]);O[I]=tn(N)}),m={single:I=>p(I),leaf:I=>p(I),others:I=>p(I),center:(I,N,P)=>{const R=O[I[s]];return{x:R==null?void 0:R.x,y:R==null?void 0:R.y}}}}this.centripetalOptions=Object.assign(Object.assign({},this.centripetalOptions),m);const{leaf:x,single:w,others:A}=this.centripetalOptions;x&&typeof x!="function"&&(this.centripetalOptions.leaf=()=>x),w&&typeof w!="function"&&(this.centripetalOptions.single=()=>w),A&&typeof A!="function"&&(this.centripetalOptions.others=()=>A)}updateCfg(r){r&&Object.assign(this,r)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){const r=this;r.stop();const{nodes:o,edges:s,defSpringLen:l}=r;if(r.judgingDistance=0,!o||o.length===0){r.onLayoutEnd([]);return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const h=r.center;if(o.length===1){o[0].x=h[0],o[0].y=h[1],r.onLayoutEnd([Object.assign({},o[0])]);return}r.degreesMap=Ht(o,s),r.propsGetMass?r.getMass=r.propsGetMass:r.getMass=x=>{let w=1;kt(x.mass)&&(w=x.mass);const A=r.degreesMap[x.id].all;return!A||A<5?w:A*5*w};const g=r.nodeSize;let p;if(r.preventOverlap){const x=r.nodeSpacing;let w;kt(x)?w=()=>x:Ue(x)?w=x:w=()=>0,g?Jt(g)?p=A=>Math.max(g[0],g[1])+w(A):p=A=>g+w(A):p=A=>A.size?Jt(A.size)?Math.max(A.size[0],A.size[1])+w(A):Q(A.size)?Math.max(A.size.width,A.size.height)+w(A):A.size+w(A):10+w(A)}r.nodeSize=p,r.linkDistance=Fl(r.linkDistance,1),r.nodeStrength=Fl(r.nodeStrength,1),r.edgeStrength=Fl(r.edgeStrength,1);const m={},y={};o.forEach((x,w)=>{kt(x.x)||(x.x=Math.random()*r.width),kt(x.y)||(x.y=Math.random()*r.height);const A=r.degreesMap[x.id];m[x.id]=Object.assign(Object.assign({},x),{data:Object.assign(Object.assign({},x.data),{size:r.nodeSize(x)||30,layout:{inDegree:A.in,outDegree:A.out,degree:A.all,tDegree:A.in,sDegree:A.out,force:{mass:r.getMass(x),nodeStrength:r.nodeStrength(x,s)}}})}),y[x.id]=w}),r.nodeMap=m,r.nodeIdxMap=y,r.edgeInfos=[],s==null||s.forEach(x=>{const w=m[x.source],A=m[x.target];!w||!A?elf.edgeInfos.push({}):r.edgeInfos.push({edgeStrength:r.edgeStrength(x),linkDistance:l?l(Object.assign(Object.assign({},x),{source:w,target:A}),w,A):r.linkDistance(x,w,A)||1+(g(w)+g(w)||0)/2})}),this.getCentripetalOptions(),r.onLayoutEnd=r.onLayoutEnd||(()=>{}),r.run()}run(){const r=this,{maxIteration:o,nodes:s,edges:l,workerEnabled:h,minMovement:g,animate:p,nodeMap:m,height:y}=r;if(r.currentMinY=0,r.currentMaxY=y,!s)return;const x=[];if(s.forEach((T,O)=>{x[2*O]=0,x[2*O+1]=0}),this.defSideCoe&&typeof this.defSideCoe=="function"){const T={};l.forEach(O=>{const{source:I,target:N}=O;T[I]=T[I]||[],T[I].push(O),T[N]=T[N]||[],T[N].push(O)}),this.relatedEdges=T}const w=o;if(h||!p){let T=0;for(let O=0;(r.judgingDistance>g||O<1)&&O<w;O++)T=O,r.runOneStep(O,x);r.onLayoutEnd(Object.values(m))}else{if(typeof window>"u")return;let T=0;this.timeInterval=window.setInterval(()=>{s&&(r.runOneStep(T,x),T++,(T>=w||r.judgingDistance<g)&&(r.onLayoutEnd(Object.values(m)),window.clearInterval(r.timeInterval)))},0)}}runOneStep(r,o){var s;const l=this,{nodes:h,edges:g,nodeMap:p,monitor:m}=l,y=[];if(!(h!=null&&h.length))return;l.calRepulsive(y),g&&l.calAttractive(y),l.calGravity(y),l.attractToSide(y);const x=l.interval;if(l.updateVelocity(y,o,x),l.updatePosition(o,x),(s=l.tick)===null||s===void 0||s.call(l),m){const w=this.calTotalEnergy(y);m({energy:w,nodes:h,edges:g,iterations:r})}}calTotalEnergy(r){const{nodes:o,nodeMap:s}=this;if(!(o!=null&&o.length))return 0;let l=0;return o.forEach((h,g)=>{const p=r[2*g],m=r[2*g+1],y=p*p+m*m,{mass:x=1}=s[h.id].data.layout.force;l+=x*y*.5}),l}calRepulsive(r){const o=this,{nodes:s,nodeMap:l,factor:h,coulombDisScale:g}=o,p=o.nodeSize;zo(s,l,h,g*g,r)}calAttractive(r){const o=this,{edges:s,nodeMap:l,nodeIdxMap:h,edgeInfos:g}=o,p=o.nodeSize;s.forEach((m,y)=>{const x=at(m,"source"),w=at(m,"target"),A=l[x],T=l[w];if(!A||!T)return;let O=T.x-A.x,I=T.y-A.y;!O&&!I&&(O=Math.random()*.01,I=Math.random()*.01);const N=Math.sqrt(O*O+I*I),P=O/N,R=I/N,{linkDistance:k=200,edgeStrength:U=200}=g[y]||{},pt=(k-N)*U,Ot=A.data.layout.force.mass||1,It=T.data.layout.force.mass||1,Ct=1/Ot,_t=1/It,F=P*pt,Z=R*pt,yt=2*h[x],bt=2*h[w];r[yt]-=F*Ct,r[yt+1]-=Z*Ct,r[bt]+=F*_t,r[bt+1]+=Z*_t})}calGravity(r){var o;const s=this,{nodes:l,edges:h=[],nodeMap:g,width:p,height:m,center:y,gravity:x,degreesMap:w,centripetalOptions:A}=s;if(!l)return;const T=l.length;for(let O=0;O<T;O++){const I=2*O,N=g[l[O].id],{mass:P=1}=N.data.layout.force;let R=0,k=0,U=x;const{in:K,out:pt,all:Ot}=w[N.id],It=(o=s.getCenter)===null||o===void 0?void 0:o.call(s,N,Ot);if(It){const[Ct,_t,F]=It;R=N.x-Ct,k=N.y-_t,U=F}else R=N.x-y[0],k=N.y-y[1];if(U&&(r[I]-=U*R/P,r[I+1]-=U*k/P),A){const{leaf:Ct,single:_t,others:F,center:Z}=A,{x:yt,y:bt,centerStrength:de}=(Z==null?void 0:Z(N,l,h,p,m))||{x:0,y:0,centerStrength:0};if(!kt(yt)||!kt(bt))continue;const Ne=(N.x-yt)/P,Ee=(N.y-bt)/P;if(de&&(r[I]-=de*Ne,r[I+1]-=de*Ee),Ot===0){const Ge=_t(N);if(!Ge)continue;r[I]-=Ge*Ne,r[I+1]-=Ge*Ee;continue}if(K===0||pt===0){const Ge=Ct(N,l,h);if(!Ge)continue;r[I]-=Ge*Ne,r[I+1]-=Ge*Ee;continue}const Ie=F(N);if(!Ie)continue;r[I]-=Ie*Ne,r[I+1]-=Ie*Ee}}}attractToSide(r){const{defSideCoe:o,height:s,nodes:l,relatedEdges:h,currentMinY:g=0,currentMaxY:p=this.height}=this;!o||typeof o!="function"||!(l!=null&&l.length)||l.forEach((m,y)=>{const x=o(m,h[m.id]||[]);if(x===0)return;const w=x<0?g:p,A=Math.abs(x);r[2*y+1]-=A*(m.y-w)})}updateVelocity(r,o,s){const l=this,{nodes:h,damping:g,maxSpeed:p}=l;h!=null&&h.length&&h.forEach((m,y)=>{let x=(o[2*y]+r[2*y]*s)*g||.01,w=(o[2*y+1]+r[2*y+1]*s)*g||.01;const A=Math.sqrt(x*x+w*w);if(A>p){const T=p/A;x=T*x,w=T*w}o[2*y]=x,o[2*y+1]=w})}updatePosition(r,o){const s=this,{nodes:l,distanceThresholdMode:h,nodeMap:g}=s;if(!(l!=null&&l.length)){this.judgingDistance=0;return}let p=0;h==="max"?s.judgingDistance=-1/0:h==="min"&&(s.judgingDistance=1/0);let m=1/0,y=-1/0;l.forEach((x,w)=>{const A=g[x.id];if(kt(x.fx)&&kt(x.fy)){x.x=x.fx,x.y=x.fy,A.x=x.x,A.y=x.y;return}const T=r[2*w]*o,O=r[2*w+1]*o;x.x+=T,x.y+=O,A.x=x.x,A.y=x.y,x.y<m&&(m=x.y),x.y>y&&(y=x.y);const I=Math.sqrt(T*T+O*O);switch(h){case"max":s.judgingDistance<I&&(s.judgingDistance=I);break;case"min":s.judgingDistance>I&&(s.judgingDistance=I);break;default:p=p+I;break}}),this.currentMinY=m,this.currentMaxY=y,(!h||h==="mean")&&(s.judgingDistance=p/l.length)}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const r=this;r.stop(),r.tick=null,r.nodes=null,r.edges=null,r.destroyed=!0}getType(){return"force2"}getSameTypeLeafMap(){const{nodeClusterBy:r,nodes:o,edges:s,nodeMap:l,degreesMap:h}=this;if(!(o!=null&&o.length))return;const g={};return o.forEach((p,m)=>{h[p.id].all===1&&(g[p.id]=rn("leaf",p,s,r,h,l))}),g}}function jr(i){return function(){return i}}function gr(i){return(i()-.5)*1e-6}var wr={value:()=>{}};function Gl(){for(var i=0,r=arguments.length,o={},s;i<r;++i){if(!(s=arguments[i]+"")||s in o||/[\s.]/.test(s))throw new Error("illegal type: "+s);o[s]=[]}return new gc(o)}function gc(i){this._=i}function Td(i,r){return i.trim().split(/^|\s+/).map(function(o){var s="",l=o.indexOf(".");if(l>=0&&(s=o.slice(l+1),o=o.slice(0,l)),o&&!r.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:s}})}gc.prototype=Gl.prototype={constructor:gc,on:function(i,r){var o=this._,s=Td(i+"",o),l,h=-1,g=s.length;if(arguments.length<2){for(;++h<g;)if((l=(i=s[h]).type)&&(l=zl(o[l],i.name)))return l;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++h<g;)if(l=(i=s[h]).type)o[l]=sh(o[l],i.name,r);else if(r==null)for(l in o)o[l]=sh(o[l],i.name,null);return this},copy:function(){var i={},r=this._;for(var o in r)i[o]=r[o].slice();return new gc(i)},call:function(i,r){if((l=arguments.length-2)>0)for(var o=new Array(l),s=0,l,h;s<l;++s)o[s]=arguments[s+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(h=this._[i],s=0,l=h.length;s<l;++s)h[s].value.apply(r,o)},apply:function(i,r,o){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var s=this._[i],l=0,h=s.length;l<h;++l)s[l].value.apply(r,o)}};function zl(i,r){for(var o=0,s=i.length,l;o<s;++o)if((l=i[o]).name===r)return l.value}function sh(i,r,o){for(var s=0,l=i.length;s<l;++s)if(i[s].name===r){i[s]=wr,i=i.slice(0,s).concat(i.slice(s+1));break}return o!=null&&i.push({name:r,value:o}),i}const Cd=Gl;var Uo=0,Os=0,va=0,pc=1e3,Mr,Vo,ya=0,Ho=0,mc=0,ba=typeof performance=="object"&&performance.now?performance:Date,ah=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function ch(){return Ho||(ah($o),Ho=ba.now()+mc)}function $o(){Ho=0}function vc(){this._call=this._time=this._next=null}vc.prototype=Ul.prototype={constructor:vc,restart:function(i,r,o){if(typeof i!="function")throw new TypeError("callback is not a function");o=(o==null?ch():+o)+(r==null?0:+r),!this._next&&Vo!==this&&(Vo?Vo._next=this:Mr=this,Vo=this),this._call=i,this._time=o,Vl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vl())}};function Ul(i,r,o){var s=new vc;return s.restart(i,r,o),s}function tr(){ch(),++Uo;for(var i=Mr,r;i;)(r=Ho-i._time)>=0&&i._call.call(null,r),i=i._next;--Uo}function lh(){Ho=(ya=ba.now())+mc,Uo=Os=0;try{tr()}finally{Uo=0,Id(),Ho=0}}function Od(){var i=ba.now(),r=i-ya;r>pc&&(mc-=r,ya=i)}function Id(){for(var i,r=Mr,o,s=1/0;r;)r._call?(s>r._time&&(s=r._time),i=r,r=r._next):(o=r._next,r._next=null,r=i?i._next=o:Mr=o);Vo=i,Vl(s)}function Vl(i){if(!Uo){Os&&(Os=clearTimeout(Os));var r=i-Ho;r>24?(i<1/0&&(Os=setTimeout(lh,i-ba.now()-mc)),va&&(va=clearInterval(va))):(va||(ya=ba.now(),va=setInterval(Od,pc)),Uo=1,ah(lh))}}const Md=1664525,Nd=1013904223,uh=4294967296;function Pd(){let i=1;return()=>(i=(Md*i+Nd)%uh)/uh}function Dd(i){return i.x}function Wo(i){return i.y}var Rd=10,xa=Math.PI*(3-Math.sqrt(5));function Hl(i){var r,o=1,s=.001,l=1-Math.pow(s,1/300),h=0,g=.6,p=new Map,m=Ul(w),y=Cd("tick","end"),x=Pd();i==null&&(i=[]);function w(){A(),y.call("tick",r),o<s&&(m.stop(),y.call("end",r))}function A(I){var N,P=i.length,R;I===void 0&&(I=1);for(var k=0;k<I;++k)for(o+=(h-o)*l,p.forEach(function(U){U(o)}),N=0;N<P;++N)R=i[N],R.fx==null?R.x+=R.vx*=g:(R.x=R.fx,R.vx=0),R.fy==null?R.y+=R.vy*=g:(R.y=R.fy,R.vy=0);return r}function T(){for(var I=0,N=i.length,P;I<N;++I){if(P=i[I],P.index=I,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var R=Rd*Math.sqrt(.5+I),k=I*xa;P.x=R*Math.cos(k),P.y=R*Math.sin(k)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function O(I){return I.initialize&&I.initialize(i,x),I}return T(),r={tick:A,restart:function(){return m.restart(w),r},stop:function(){return m.stop(),r},nodes:function(I){return arguments.length?(i=I,T(),p.forEach(O),r):i},alpha:function(I){return arguments.length?(o=+I,r):o},alphaMin:function(I){return arguments.length?(s=+I,r):s},alphaDecay:function(I){return arguments.length?(l=+I,r):+l},alphaTarget:function(I){return arguments.length?(h=+I,r):h},velocityDecay:function(I){return arguments.length?(g=1-I,r):1-g},randomSource:function(I){return arguments.length?(x=I,p.forEach(O),r):x},force:function(I,N){return arguments.length>1?(N==null?p.delete(I):p.set(I,O(N)),r):p.get(I)},find:function(I,N,P){var R=0,k=i.length,U,K,pt,Ot,It;for(P==null?P=1/0:P*=P,R=0;R<k;++R)Ot=i[R],U=I-Ot.x,K=N-Ot.y,pt=U*U+K*K,pt<P&&(It=Ot,P=pt);return It},on:function(I,N){return arguments.length>1?(y.on(I,N),r):y.on(I)}}}function $l(){var i,r,o,s,l=jr(-30),h,g=1,p=1/0,m=.81;function y(T){var O,I=i.length,N=ga(i,Dd,Wo).visitAfter(w);for(s=T,O=0;O<I;++O)r=i[O],N.visit(A)}function x(){if(i){var T,O=i.length,I;for(h=new Array(O),T=0;T<O;++T)I=i[T],h[I.index]=+l(I,T,i)}}function w(T){var O=0,I,N,P=0,R,k,U;if(T.length){for(R=k=U=0;U<4;++U)(I=T[U])&&(N=Math.abs(I.value))&&(O+=I.value,P+=N,R+=N*I.x,k+=N*I.y);T.x=R/P,T.y=k/P}else{I=T,I.x=I.data.x,I.y=I.data.y;do O+=h[I.data.index];while(I=I.next)}T.value=O}function A(T,O,I,N){if(!T.value)return!0;var P=T.x-r.x,R=T.y-r.y,k=N-O,U=P*P+R*R;if(k*k/m<U)return U<p&&(P===0&&(P=gr(o),U+=P*P),R===0&&(R=gr(o),U+=R*R),U<g&&(U=Math.sqrt(g*U)),r.vx+=P*T.value*s/U,r.vy+=R*T.value*s/U),!0;if(T.length||U>=p)return;(T.data!==r||T.next)&&(P===0&&(P=gr(o),U+=P*P),R===0&&(R=gr(o),U+=R*R),U<g&&(U=Math.sqrt(g*U)));do T.data!==r&&(k=h[T.data.index]*s/U,r.vx+=P*k,r.vy+=R*k);while(T=T.next)}return y.initialize=function(T,O){i=T,o=O,x()},y.strength=function(T){return arguments.length?(l=typeof T=="function"?T:jr(+T),x(),y):l},y.distanceMin=function(T){return arguments.length?(g=T*T,y):Math.sqrt(g)},y.distanceMax=function(T){return arguments.length?(p=T*T,y):Math.sqrt(p)},y.theta=function(T){return arguments.length?(m=T*T,y):Math.sqrt(m)},y}function hh(i,r){var o,s=1;i==null&&(i=0),r==null&&(r=0);function l(){var h,g=o.length,p,m=0,y=0;for(h=0;h<g;++h)p=o[h],m+=p.x,y+=p.y;for(m=(m/g-i)*s,y=(y/g-r)*s,h=0;h<g;++h)p=o[h],p.x-=m,p.y-=y}return l.initialize=function(h){o=h},l.x=function(h){return arguments.length?(i=+h,l):i},l.y=function(h){return arguments.length?(r=+h,l):r},l.strength=function(h){return arguments.length?(s=+h,l):s},l}function Ld(i){return i.index}function fh(i,r){var o=i.get(r);if(!o)throw new Error("node not found: "+r);return o}function yc(i){var r=Ld,o=w,s,l=jr(30),h,g,p,m,y,x=1;i==null&&(i=[]);function w(N){return 1/Math.min(p[N.source.index],p[N.target.index])}function A(N){for(var P=0,R=i.length;P<x;++P)for(var k=0,U,K,pt,Ot,It,Ct,_t;k<R;++k)U=i[k],K=U.source,pt=U.target,Ot=pt.x+pt.vx-K.x-K.vx||gr(y),It=pt.y+pt.vy-K.y-K.vy||gr(y),Ct=Math.sqrt(Ot*Ot+It*It),Ct=(Ct-h[k])/Ct*N*s[k],Ot*=Ct,It*=Ct,pt.vx-=Ot*(_t=m[k]),pt.vy-=It*_t,K.vx+=Ot*(_t=1-_t),K.vy+=It*_t}function T(){if(g){var N,P=g.length,R=i.length,k=new Map(g.map((K,pt)=>[r(K,pt,g),K])),U;for(N=0,p=new Array(P);N<R;++N)U=i[N],U.index=N,typeof U.source!="object"&&(U.source=fh(k,U.source)),typeof U.target!="object"&&(U.target=fh(k,U.target)),p[U.source.index]=(p[U.source.index]||0)+1,p[U.target.index]=(p[U.target.index]||0)+1;for(N=0,m=new Array(R);N<R;++N)U=i[N],m[N]=p[U.source.index]/(p[U.source.index]+p[U.target.index]);s=new Array(R),O(),h=new Array(R),I()}}function O(){if(g)for(var N=0,P=i.length;N<P;++N)s[N]=+o(i[N],N,i)}function I(){if(g)for(var N=0,P=i.length;N<P;++N)h[N]=+l(i[N],N,i)}return A.initialize=function(N,P){g=N,y=P,T()},A.links=function(N){return arguments.length?(i=N,T(),A):i},A.id=function(N){return arguments.length?(r=N,A):r},A.iterations=function(N){return arguments.length?(x=+N,A):x},A.strength=function(N){return arguments.length?(o=typeof N=="function"?N:jr(+N),O(),A):o},A.distance=function(N){return arguments.length?(l=typeof N=="function"?N:jr(+N),I(),A):l},A}function kd(i){return i.x+i.vx}function Bd(i){return i.y+i.vy}function dh(i){var r,o,s,l=1,h=1;typeof i!="function"&&(i=jr(i==null?1:+i));function g(){for(var y,x=r.length,w,A,T,O,I,N,P=0;P<h;++P)for(w=ga(r,kd,Bd).visitAfter(p),y=0;y<x;++y)A=r[y],I=o[A.index],N=I*I,T=A.x+A.vx,O=A.y+A.vy,w.visit(R);function R(k,U,K,pt,Ot){var It=k.data,Ct=k.r,_t=I+Ct;if(It){if(It.index>A.index){var F=T-It.x-It.vx,Z=O-It.y-It.vy,yt=F*F+Z*Z;yt<_t*_t&&(F===0&&(F=gr(s),yt+=F*F),Z===0&&(Z=gr(s),yt+=Z*Z),yt=(_t-(yt=Math.sqrt(yt)))/yt*l,A.vx+=(F*=yt)*(_t=(Ct*=Ct)/(N+Ct)),A.vy+=(Z*=yt)*_t,It.vx-=F*(_t=1-_t),It.vy-=Z*_t)}return}return U>T+_t||pt<T-_t||K>O+_t||Ot<O-_t}}function p(y){if(y.data)return y.r=o[y.data.index];for(var x=y.r=0;x<4;++x)y[x]&&y[x].r>y.r&&(y.r=y[x].r)}function m(){if(r){var y,x=r.length,w;for(o=new Array(x),y=0;y<x;++y)w=r[y],o[w.index]=+i(w,y,r)}}return g.initialize=function(y,x){r=y,s=x,m()},g.iterations=function(y){return arguments.length?(h=+y,g):h},g.strength=function(y){return arguments.length?(l=+y,g):l},g.radius=function(y){return arguments.length?(i=typeof y=="function"?y:jr(+y),m(),g):i},g}function gh(i){var r=jr(.1),o,s,l;typeof i!="function"&&(i=jr(i==null?0:+i));function h(p){for(var m=0,y=o.length,x;m<y;++m)x=o[m],x.vx+=(l[m]-x.x)*s[m]*p}function g(){if(o){var p,m=o.length;for(s=new Array(m),l=new Array(m),p=0;p<m;++p)s[p]=isNaN(l[p]=+i(o[p],p,o))?0:+r(o[p],p,o)}}return h.initialize=function(p){o=p,g()},h.strength=function(p){return arguments.length?(r=typeof p=="function"?p:jr(+p),g(),h):r},h.x=function(p){return arguments.length?(i=typeof p=="function"?p:jr(+p),g(),h):i},h}function ph(i){var r=jr(.1),o,s,l;typeof i!="function"&&(i=jr(i==null?0:+i));function h(p){for(var m=0,y=o.length,x;m<y;++m)x=o[m],x.vy+=(l[m]-x.y)*s[m]*p}function g(){if(o){var p,m=o.length;for(s=new Array(m),l=new Array(m),p=0;p<m;++p)s[p]=isNaN(l[p]=+i(o[p],p,o))?0:+r(o[p],p,o)}}return h.initialize=function(p){o=p,g()},h.strength=function(p){return arguments.length?(r=typeof p=="function"?p:jr(+p),g(),h):r},h.y=function(p){return arguments.length?(i=typeof p=="function"?p:jr(+p),g(),h):i},h}function jd(){function i(Ut){return()=>Ut}let r=Ut=>Ut.cluster,o=i(1),s=i(-1),l=i(100),h=i(.1),g=[0,0],p=[],m={},y=[],x=100,w=100,A={none:{x:0,y:0}},T=[],O,I="force",N=!0,P=.1;function R(Ut){if(!N)return R;O.tick(),It();for(let un=0,Nn=p.length,En,xn=Ut*P;un<Nn;++un)En=p[un],En.vx+=(A[r(En)].x-En.x)*xn,En.vy+=(A[r(En)].y-En.y)*xn}function k(){p&&U()}function U(){if(!p||!p.length)return;if(r(p[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const Ut=K();O=Hl(Ut.nodes).force("x",gh(x).strength(.1)).force("y",ph(w).strength(.1)).force("collide",dh(un=>un.r).iterations(4)).force("charge",$l().strength(s)).force("links",yc(Ut.nodes.length?Ut.links:[]).distance(l).strength(h)),T=O.nodes(),It()}function K(){const Ut=[],un=[],Nn={};let En=[],xn={},We=[];return xn=pt(p),We=Ot(y),En=Object.keys(xn),En.forEach((Xe,rr)=>{const Lr=xn[Xe];Ut.push({id:Xe,size:Lr.count,r:Math.sqrt(Lr.sumforceNodeSize/Math.PI)}),Nn[Xe]=rr}),We.forEach(Xe=>{const rr=at(Xe,"source"),Lr=at(Xe,"target"),Tr=Nn[rr],kn=Nn[Lr];Tr!==void 0&&kn!==void 0&&un.push({source:Tr,target:kn,count:Xe.count})}),{nodes:Ut,links:un}}function pt(Ut){const un={};return Ut.forEach(Nn=>{const En=r(Nn);un[En]||(un[En]={count:0,sumforceNodeSize:0})}),Ut.forEach(Nn=>{const En=r(Nn),xn=o(Nn),We=un[En];We.count=We.count+1,We.sumforceNodeSize=We.sumforceNodeSize+Math.PI*(xn*xn)*1.3,un[En]=We}),un}function Ot(Ut){const un={},Nn=[];return Ut.forEach(xn=>{const We=Ct(xn);let Xe=0;un[We]!==void 0&&(Xe=un[We]),Xe+=1,un[We]=Xe}),Object.entries(un).forEach(([xn,We])=>{const Xe=xn.split("~")[0],rr=xn.split("~")[1];Xe!==void 0&&rr!==void 0&&Nn.push({source:Xe,target:rr,count:We})}),Nn}function It(){return A={none:{x:0,y:0}},T.forEach(Ut=>{A[Ut.id]={x:Ut.x-g[0],y:Ut.y-g[1]}}),A}function Ct(Ut){const un=at(Ut,"source"),Nn=at(Ut,"target"),En=r(m[un]),xn=r(m[Nn]);return En<=xn?`${En}~${xn}`:`${xn}~${En}`}function _t(Ut){m={},Ut.forEach(un=>{m[un.id]=un})}function F(Ut){return arguments.length?(I=Ut,k(),R):I}function Z(Ut){return arguments.length?typeof Ut=="string"?(r=un=>un[Ut],R):(r=Ut,R):r}function yt(Ut){return arguments.length?(N=Ut,R):N}function bt(Ut){return arguments.length?(P=Ut,R):P}function de(Ut){return arguments.length?(x=Ut,R):x}function Ne(Ut){return arguments.length?(w=Ut,R):w}function Ee(Ut){return arguments.length?(_t(Ut||[]),p=Ut||[],R):p}function Ie(Ut){return arguments.length?(y=Ut||[],k(),R):y}function Ge(Ut){return arguments.length?(typeof Ut=="function"?o=Ut:o=i(+Ut),k(),R):o}function Qe(Ut){return arguments.length?(typeof Ut=="function"?s=Ut:s=i(+Ut),k(),R):s}function Xn(Ut){return arguments.length?(typeof Ut=="function"?l=Ut:l=i(+Ut),k(),R):l}function Mn(Ut){return arguments.length?(typeof Ut=="function"?h=Ut:h=i(+Ut),k(),R):h}function Un(Ut){return arguments.length?(g=Ut,R):g}return R.initialize=Ut=>{p=Ut,k()},R.template=F,R.groupBy=Z,R.enableGrouping=yt,R.strength=bt,R.centerX=de,R.centerY=Ne,R.nodes=Ee,R.links=Ie,R.forceNodeSize=Ge,R.nodeSize=R.forceNodeSize,R.forceCharge=Qe,R.forceLinkDistance=Xn,R.forceLinkStrength=Mn,R.offset=Un,R.getFocis=It,R}const Wl={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},Fd={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};class Gd extends vn{constructor(r){super(),this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,r&&this.updateCfg(r)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(r){const o=this;o.nodes=r.nodes||[];const s=r.edges||[];o.edges=s.map(l=>{const h={},g=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(l).forEach(p=>{g.indexOf(p)>-1||(h[p]=l[p])}),h}),o.ticking=!1}execute(r){const o=this,s=o.nodes,l=o.edges;if(o.ticking)return;let h=o.forceSimulation;const g=o.alphaMin,p=o.alphaDecay,m=o.alpha;if(h){if(r){if(o.clustering&&o.clusterForce&&(o.clusterForce.nodes(s),o.clusterForce.links(l)),h.nodes(s),l&&o.edgeForce)o.edgeForce.links(l);else if(l&&!o.edgeForce){const y=yc().id(x=>x.id).links(l);o.edgeStrength&&y.strength(o.edgeStrength),o.linkDistance&&y.distance(o.linkDistance),o.edgeForce=y,h.force("link",y)}}o.preventOverlap&&o.overlapProcess(h),h.alpha(m).restart(),this.ticking=!0}else try{const y=$l();if(o.nodeStrength&&y.strength(o.nodeStrength),h=Hl().nodes(s),o.clustering){const x=jd();x.centerX(o.center[0]).centerY(o.center[1]).template("force").strength(o.clusterFociStrength),l&&x.links(l),s&&x.nodes(s),x.forceLinkDistance(o.clusterEdgeDistance).forceLinkStrength(o.clusterEdgeStrength).forceCharge(o.clusterNodeStrength).forceNodeSize(o.clusterNodeSize),o.clusterForce=x,h.force("group",x)}if(h.force("center",hh(o.center[0],o.center[1])).force("charge",y).alpha(m).alphaDecay(p).alphaMin(g),o.preventOverlap&&o.overlapProcess(h),l){const x=yc().id(w=>w.id).links(l);o.edgeStrength&&x.strength(o.edgeStrength),o.linkDistance&&x.distance(o.linkDistance),o.edgeForce=x,h.force("link",x)}if(o.workerEnabled&&!Xo()&&(o.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!o.workerEnabled)h.on("tick",()=>{o.tick()}).on("end",()=>{o.ticking=!1,o.onLayoutEnd&&o.onLayoutEnd()}),o.ticking=!0;else{h.stop();const x=bc(h);for(let w=1;w<=x;w++)h.tick(),postMessage({nodes:s,currentTick:w,totalTicks:x,type:Wl.TICK},void 0);o.ticking=!1}o.forceSimulation=h,o.ticking=!0}catch(y){o.ticking=!1,console.warn(y)}}overlapProcess(r){const o=this,s=o.nodeSize,l=o.nodeSpacing;let h,g;const p=o.collideStrength;if(kt(l)?g=()=>l:Ue(l)?g=l:g=()=>0,!s)h=m=>m.size?Jt(m.size)?(m.size[0]>m.size[1]?m.size[0]:m.size[1])/2+g(m):Q(m.size)?(m.size.width>m.size.height?m.size.width:m.size.height)/2+g(m):m.size/2+g(m):10+g(m);else if(Ue(s))h=m=>s(m)+g(m);else if(Jt(s)){const y=(s[0]>s[1]?s[0]:s[1])/2;h=x=>y+g(x)}else if(kt(s)){const m=s/2;h=y=>m+g(y)}else h=()=>10;r.force("collisionForce",dh(h).strength(p))}updateCfg(r){const o=this;o.ticking&&(o.forceSimulation.stop(),o.ticking=!1),o.forceSimulation=null,Object.assign(o,r)}destroy(){const r=this;r.ticking&&(r.forceSimulation.stop(),r.ticking=!1),r.nodes=null,r.edges=null,r.destroyed=!0}}function bc(i){const r=i.alphaMin(),o=i.alphaTarget(),s=i.alpha(),l=Math.log((r-o)/(s-o))/Math.log(1-i.alphaDecay());return Math.ceil(l)}function Xo(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function mh(i,r,o,s){i.forEach((l,h)=>{i[h].children=[],i[h].parent=[]}),s?r.forEach(l=>{const h=at(l,"source"),g=at(l,"target");let p=0;h&&(p=o[h]);let m=0;g&&(m=o[g]);const y=i[p].children,x=i[m].parent;y.push(i[m].id),x.push(i[p].id)}):r.forEach(l=>{const h=at(l,"source"),g=at(l,"target");let p=0;h&&(p=o[h]);let m=0;g&&(m=o[g]);const y=i[p].children,x=i[m].children;y.push(i[m].id),x.push(i[p].id)})}function zd(i,r,o){const s=o.length;for(let l=0;l<s;l++){const h=at(o[l],"source"),g=at(o[l],"target");if(i.id===h&&r.id===g||r.id===h&&i.id===g)return!0}return!1}function wa(i,r){const o=i.degree,s=r.degree;return o<s?-1:o>s?1:0}class Xl extends vn{constructor(r){super(),this.radius=null,this.nodeSize=void 0,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(r)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){var r;const o=this,s=o.nodes,l=o.edges,h=s.length;if(h===0){o.onLayoutEnd&&o.onLayoutEnd();return}!o.width&&typeof window<"u"&&(o.width=window.innerWidth),!o.height&&typeof window<"u"&&(o.height=window.innerHeight),o.center||(o.center=[o.width/2,o.height/2]);const g=o.center;if(h===1){s[0].x=g[0],s[0].y=g[1],o.onLayoutEnd&&o.onLayoutEnd();return}let{radius:p,startRadius:m,endRadius:y}=o;const{divisions:x,startAngle:w,endAngle:A,angleRatio:T,ordering:O,clockwise:I,nodeSpacing:N,nodeSize:P}=o,R=(A-w)/h,k={};s.forEach((It,Ct)=>{k[It.id]=Ct}),o.nodeMap=k;const U=jt(s.length,k,l);if(o.degrees=U,N){const It=Qn(10,N),Ct=Qn(10,P);let _t=-1/0;s.forEach(Z=>{const yt=Ct(Z);_t<yt&&(_t=yt)});let F=0;s.forEach((Z,yt)=>{yt===0?F+=_t||10:F+=(It(Z)||0)+(_t||10)}),p=F/(2*Math.PI)}else!p&&!m&&!y?p=o.height>o.width?o.width/2:o.height/2:!m&&y?m=y:m&&!y&&(y=m);const K=R*T;let pt=[];O==="topology"?pt=o.topologyOrdering():O==="topology-directed"?pt=o.topologyOrdering(!0):O==="degree"?pt=o.degreeOrdering():pt=s;const Ot=Math.ceil(h/x);for(let It=0;It<h;++It){let Ct=p;!Ct&&m!==null&&y!==null&&(Ct=m+It*(y-m)/(h-1)),Ct||(Ct=10+It*100/(h-1));let _t=w+It%Ot*K+2*Math.PI/x*Math.floor(It/Ot);I||(_t=A-It%Ot*K-2*Math.PI/x*Math.floor(It/Ot)),pt[It].x=g[0]+Math.cos(_t)*Ct,pt[It].y=g[1]+Math.sin(_t)*Ct,pt[It].weight=U[It].all}return(r=o.onLayoutEnd)===null||r===void 0||r.call(o),{nodes:pt,edges:this.edges}}topologyOrdering(r=!1){const o=this,s=o.degrees,l=o.edges,h=o.nodes,g=st(h),p=o.nodeMap,m=[g[0]],y=[h[0]],x=[],w=h.length;x[0]=!0,mh(g,l,p,r);let A=0;return g.forEach((T,O)=>{if(O!==0)if((O===w-1||s[O].all!==s[O+1].all||zd(m[A],T,l))&&!x[O])m.push(T),y.push(h[p[T.id]]),x[O]=!0,A++;else{const I=m[A].children;let N=!1;for(let R=0;R<I.length;R++){const k=p[I[R]];if(s[k].all===s[O].all&&!x[k]){m.push(g[k]),y.push(h[p[g[k].id]]),x[k]=!0,N=!0;break}}let P=0;for(;!N&&(x[P]||(m.push(g[P]),y.push(h[p[g[P].id]]),x[P]=!0,N=!0),P++,P!==w););}}),y}degreeOrdering(){const r=this,o=r.nodes,s=[],l=r.degrees;return o.forEach((h,g)=>{h.degree=l[g].all,s.push(h)}),s.sort(wa),s}getType(){return"circular"}}const Zo=(i,r)=>{if(i!=="next"&&i!=="prev")return r},xc=i=>{i.prev.next=i.next,i.next.prev=i.prev,delete i.next,delete i.prev};class wc{constructor(){const r={};r.prev=r,r.next=r.prev,this.shortcut=r}dequeue(){const r=this.shortcut,o=r.prev;if(o&&o!==r)return xc(o),o}enqueue(r){const o=this.shortcut;r.prev&&r.next&&xc(r),r.next=o.next,o.next.prev=r,o.next=r,r.prev=o}toString(){const r=[],o=this.shortcut;let s=o.prev;for(;s!==o;)r.push(JSON.stringify(s,Zo)),s=s==null?void 0:s.prev;return`[${r.join(", ")}]`}}var Is;(function(i){i.DEFAULT_EDGE_NAME="\0",i.GRAPH_NODE="\0",i.EDGE_KEY_DELIM=""})(Is||(Is={}));function vh(i,r){var o=i.get(r)||0;i.set(r,o+1)}function yh(i,r){var o=i.get(r);o!==void 0&&(o=o-1,o>0?i.set(r,o):i.delete(r))}function hi(i,r,o,s){var l=String(r),h=String(o);if(!i&&l>h){var g=l;l=h,h=g}return l+Is.EDGE_KEY_DELIM+h+Is.EDGE_KEY_DELIM+(s===void 0?Is.DEFAULT_EDGE_NAME:s)}function Kr(i,r,o,s){var l=String(r),h=String(o),g={v:r,w:o};if(!i&&l>h){var p=g.v;g.v=g.w,g.w=p}return s!==void 0&&(g.name=s),g}function Ms(i,r){return hi(i,r.v,r.w,r.name)}function bh(i){return typeof i=="function"}var Ud=function(r){return r.nodes().map(function(o){var s=r.node(o),l=r.parent(o),h={id:o,value:s,parent:l};return h.value===void 0&&delete h.value,h.parent===void 0&&delete h.parent,h})},xh=function(r){return r.edges().map(function(o){var s=r.edge(o),l={v:o.v,w:o.w,value:s,name:o.name};return l.name===void 0&&delete l.name,l.value===void 0&&delete l.value,l})},wh=function(r){var o={options:{directed:r.isDirected(),multigraph:r.isMultigraph(),compound:r.isCompound()},nodes:Ud(r),edges:xh(r),value:r.graph()};return o.value===void 0&&delete o.value,o},Ns=function(r){var o=new Sa(r.options);return r.value!==void 0&&o.setGraph(r.value),r.nodes.forEach(function(s){o.setNode(s.id,s.value),s.parent&&o.setParent(s.id,s.parent)}),r.edges.forEach(function(s){o.setEdge(s.v,s.w,s.value,s.name)}),o};function Ea(i,r){var o=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),o.push.apply(o,s)}return o}function Ec(i){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?Ea(Object(o),!0).forEach(function(s){_a(i,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):Ea(Object(o)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(o,s))})}return i}function _a(i,r,o){return r in i?Object.defineProperty(i,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[r]=o,i}function Vd(i,r){if(!(i instanceof r))throw new TypeError("Cannot call a class as a function")}function Eh(i,r){for(var o=0;o<r.length;o++){var s=r[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function Hd(i,r,o){return r&&Eh(i.prototype,r),o&&Eh(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i}var $d={compound:!1,multigraph:!1,directed:!0},Sa=function(){function i(){var r=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Vd(this,i),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Is.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return r.directed},this.isMultigraph=function(){return r.multigraph},this.isCompound=function(){return r.compound},this.setGraph=function(l){return r.label=l,r},this.graph=function(){return r.label},this.setDefaultNodeLabel=function(l){return bh(l)?r.defaultNodeLabelFn=l:r.defaultNodeLabelFn=function(){return l},r},this.nodeCount=function(){return r.nodeCountNum},this.node=function(l){return r.nodesLabelMap.get(l)},this.nodes=function(){return Array.from(r.nodesLabelMap.keys())},this.sources=function(){return r.nodes().filter(function(l){var h;return!(!((h=r.inEdgesMap.get(l))===null||h===void 0)&&h.size)})},this.sinks=function(){return r.nodes().filter(function(l){var h;return!(!((h=r.outEdgesMap.get(l))===null||h===void 0)&&h.size)})},this.setNodes=function(l,h){return l.map(function(g){return r.setNode(g,h)}),r},this.hasNode=function(l){return r.nodesLabelMap.has(l)},this.checkCompound=function(){if(!r.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(l){if(r.isCompound()){var h,g=(h=r.parentMap)===null||h===void 0?void 0:h.get(l);if(g!==r.GRAPH_NODE)return g}},this.removeFromParentsChildList=function(l){var h=r.parentMap.get(l);r.childrenMap.get(h).delete(l)},this.setParent=function(l,h){var g,p;r.checkCompound();for(var m=h===void 0?r.GRAPH_NODE:h,y=r.parent(m);y;){if(l===y)throw new Error("Setting "+h+" as parent of "+l+" would create a cycle");y=r.parent(y)}h&&r.setNode(h),r.setNode(l),r.removeFromParentsChildList(l),(g=r.parentMap)===null||g===void 0||g.set(l,m);var x=r.childrenMap.get(m);return x.set(l,!0),(p=r.childrenMap)===null||p===void 0||p.set(m,x),r},this.children=function(l){var h=l===void 0?r.GRAPH_NODE:l;if(r.isCompound()){var g,p=(g=r.childrenMap)===null||g===void 0?void 0:g.get(h);return p?Array.from(p.keys()):void 0}if(h===r.GRAPH_NODE)return r.nodes();if(l&&r.hasNode(l))return[]},this.predecessors=function(l){var h=r.predecessorsMap.get(l);return h?Array.from(h.keys()):void 0},this.successors=function(l){var h=r.successorsMap.get(l);return h?Array.from(h.keys()):void 0},this.neighbors=function(l){var h;if(r.hasNode(l))return Array.from(new Set((h=r.predecessors(l))===null||h===void 0?void 0:h.concat(r.successors(l))))},this.isLeaf=function(l){var h;if(r.isDirected()){var g;return!(!((g=r.successors(l))===null||g===void 0)&&g.length)}return!(!((h=r.neighbors(l))===null||h===void 0)&&h.length)},this.filterNodes=function(l){var h=r.directed,g=r.multigraph,p=r.compound,m=new i({directed:h,multigraph:g,compound:p});if(m.setGraph(r.graph()),r.nodes().forEach(function(x){l(x)&&m.setNode(x,r.node(x))}),r.edges().forEach(function(x){m.hasNode(x.v)&&m.hasNode(x.w)&&m.setEdgeObj(x,r.edge(x))}),p){var y=function(w){for(var A=r.parent(w);A!==void 0&&!m.hasNode(A);)A=r.parent(A);return A};m.nodes().forEach(function(x){m.setParent(x,y(x))})}return m},this.setDefaultEdgeLabel=function(l){return bh(l)?r.defaultEdgeLabelFn=l:r.defaultEdgeLabelFn=function(){return l},r},this.edgeCount=function(){return r.edgeCountNum},this.setEdgeObj=function(l,h){return r.setEdge(l.v,l.w,h,l.name)},this.setPath=function(l,h){return l.reduce(function(g,p){return r.setEdge(g,p,h),p}),r},this.edgeFromArgs=function(l,h,g){return r.edge({v:l,w:h,name:g})},this.edge=function(l){return r.edgesLabelsMap.get(Ms(r.isDirected(),l))},this.hasEdge=function(l,h,g){return r.edgesLabelsMap.has(Ms(r.isDirected(),{v:l,w:h,name:g}))},this.removeEdgeObj=function(l){var h=l.v,g=l.w,p=l.name;return r.removeEdge(h,g,p)},this.edges=function(){return Array.from(r.edgesMap.values())},this.inEdges=function(l,h){var g=r.inEdgesMap.get(l);if(g)return Array.from(g.values()).filter(function(p){return!h||p.v===h})},this.outEdges=function(l,h){var g=r.outEdgesMap.get(l);if(g)return Array.from(g.values()).filter(function(p){return!h||p.w===h})},this.nodeEdges=function(l,h){var g;if(r.hasNode(l))return(g=r.inEdges(l,h))===null||g===void 0?void 0:g.concat(r.outEdges(l,h))},this.toJSON=function(){return wh(r)},this.nodeInDegree=function(l){var h=r.inEdgesMap.get(l);return h?h.size:0},this.nodeOutDegree=function(l){var h=r.outEdgesMap.get(l);return h?h.size:0},this.nodeDegree=function(l){return r.nodeInDegree(l)+r.nodeOutDegree(l)},this.source=function(l){return l.v},this.target=function(l){return l.w};var s=Ec(Ec({},$d),o);this.compound=s.compound,this.directed=s.directed,this.multigraph=s.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return Hd(i,[{key:"setNode",value:function(o,s){var l=this.nodesLabelMap,h=this.defaultNodeLabelFn,g=this.isCompound,p=this.parentMap,m=this.childrenMap,y=this.inEdgesMap,x=this.outEdgesMap,w=this.predecessorsMap,A=this.successorsMap;if(l.has(o))return s!==void 0&&l.set(o,s),this;if(l.set(o,s||h(o)),g()){var T;p==null||p.set(o,this.GRAPH_NODE),m==null||m.set(o,new Map),m!=null&&m.has(this.GRAPH_NODE)||m==null||m.set(this.GRAPH_NODE,new Map),m==null||(T=m.get(this.GRAPH_NODE))===null||T===void 0||T.set(o,!0)}return[y,x,w,A].forEach(function(O){return O.set(o,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(o){var s=this;if(this.hasNode(o)){var l=function(N){s.removeEdge(N.v,N.w,N.name)},h=this.inEdgesMap,g=this.outEdgesMap,p=this.predecessorsMap,m=this.successorsMap,y=this.nodesLabelMap;if(this.isCompound()){var x,w,A;this.removeFromParentsChildList(o),(x=this.parentMap)===null||x===void 0||x.delete(o),(w=this.children(o))===null||w===void 0||w.forEach(function(I){return s.setParent(I)}),(A=this.childrenMap)===null||A===void 0||A.delete(o)}var T=h.get(o),O=g.get(o);Array.from(T.values()).forEach(function(I){return l(I)}),Array.from(O.values()).forEach(function(I){return l(I)}),y.delete(o),h.delete(o),g.delete(o),p.delete(o),m.delete(o),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(o,s,l,h){var g,p,m=Kr(this.isDirected(),o,s,h),y=Ms(this.isDirected(),m),x=m.v,w=m.w;if(this.edgesLabelsMap.has(y))return this.edgesLabelsMap.set(y,l),this;if(h!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(x),this.setNode(w),this.edgesLabelsMap.set(y,l||this.defaultEdgeLabelFn(x,w,h)),Object.freeze(m),this.edgesMap.set(y,m);var A=this.predecessorsMap.get(w),T=this.successorsMap.get(x);return vh(A,x),vh(T,w),(g=this.inEdgesMap.get(w))===null||g===void 0||g.set(y,m),(p=this.outEdgesMap.get(x))===null||p===void 0||p.set(y,m),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(o,s,l){var h=hi(this.isDirected(),o,s,l),g=this.edgesMap.get(h);if(g){var p=Kr(this.isDirected(),o,s,l),m=p.v,y=p.w;this.edgesLabelsMap.delete(h),this.edgesMap.delete(h);var x=this.predecessorsMap.get(y),w=this.successorsMap.get(m);yh(x,m),yh(w,y),this.inEdgesMap.get(y).delete(h),this.outEdgesMap.get(m).delete(h),this.edgeCountNum-=1}return this}}]),i}();Sa.fromJSON=Ns;function Ps(i){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ps(i)}function lm(i,r){if(!(i instanceof r))throw new TypeError("Cannot call a class as a function")}function wo(i,r){for(var o=0;o<r.length;o++){var s=r[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function um(i,r,o){return r&&wo(i.prototype,r),o&&wo(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i}function Zl(){return typeof Reflect<"u"&&Reflect.get?Zl=Reflect.get:Zl=function(r,o,s){var l=_c(r,o);if(l){var h=Object.getOwnPropertyDescriptor(l,o);return h.get?h.get.call(arguments.length<3?r:s):h.value}},Zl.apply(this,arguments)}function _c(i,r){for(;!Object.prototype.hasOwnProperty.call(i,r)&&(i=Qr(i),i!==null););return i}function _h(i,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(r&&r.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),r&&Sc(i,r)}function Sc(i,r){return Sc=Object.setPrototypeOf||function(s,l){return s.__proto__=l,s},Sc(i,r)}function Wd(i){var r=ql();return function(){var s=Qr(i),l;if(r){var h=Qr(this).constructor;l=Reflect.construct(s,arguments,h)}else l=s.apply(this,arguments);return Ds(this,l)}}function Ds(i,r){if(r&&(Ps(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rs(i)}function Rs(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function ql(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(i){return!1}}function Qr(i){return Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},Qr(i)}var Yl=null,Xd=function(r,o){var s=new Graph,l=new Map,h=new PriorityQueue,g;function p(x){var w=x.v===g?x.w:x.v,A=h.priority(w);if(A!==void 0){var T=o(x);T<A&&(l.set(w,g),h.decrease(w,T))}}if(r.nodeCount()===0)return s;r.nodes().forEach(function(x){h.add(x,Number.POSITIVE_INFINITY),s.setNode(x)}),h.decrease(r.nodes()[0],0);for(var m=!1;h.size()>0;){var y;if(g=h.removeMin(),l.has(g))s.setEdge(g,l.get(g));else{if(m)throw new Error("Input graph is not connected: "+r.graph());m=!0}(y=r.nodeEdges(g))===null||y===void 0||y.forEach(p)}return s};const Zd=null;var qd=function i(r,o,s,l,h,g){l.includes(o)||(l.push(o),s||g.push(o),h(o).forEach(function(p){return i(r,p,s,l,h,g)}),s&&g.push(o))},Yd=function(r,o,s){var l=Array.isArray(o)?o:[o],h=function(y){return r.isDirected()?r.successors(y):r.neighbors(y)},g=[],p=[];return l.forEach(function(m){if(r.hasNode(m))qd(r,m,s==="post",p,h,g);else throw new Error("Graph does not have node: "+m)}),g};const Sh=Yd;var Jd=function(r,o){return Sh(r,o,"post")};const Kd=Jd;var Eo=function(r,o){return Sh(r,o,"pre")};const Qd=Eo;function Bi(i,r){return Ls(i)||Th(i,r)||Ah(i,r)||tg()}function tg(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ah(i,r){if(i){if(typeof i=="string")return qo(i,r);var o=Object.prototype.toString.call(i).slice(8,-1);if(o==="Object"&&i.constructor&&(o=i.constructor.name),o==="Map"||o==="Set")return Array.from(i);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return qo(i,r)}}function qo(i,r){(r==null||r>i.length)&&(r=i.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=i[o];return s}function Th(i,r){var o=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(o!=null){var s=[],l=!0,h=!1,g,p;try{for(o=o.call(i);!(l=(g=o.next()).done)&&(s.push(g.value),!(r&&s.length===r));l=!0);}catch(m){h=!0,p=m}finally{try{!l&&o.return!=null&&o.return()}finally{if(h)throw p}}return s}}function Ls(i){if(Array.isArray(i))return i}function eg(i){return i instanceof Graph}function ji(i){if(i.isMultigraph())return!1;for(var r=i.edges(),o=new Map,s=0;s<r.length;s++){var l=r[s];if(l.v===l.w)return!1;var h=[l.v,l.w].sort(),g=Bi(h,2),p=g[0],m=g[1],y="".concat(p,"-").concat(m);if(o.has(y))return!1;o.set(y,!0)}return!0}function ng(i){return i.nodes().length===0}function Ji(i){for(var r=i.edges(),o=0;o<r.length;o++){var s=r[o];if(s.v===s.w)return!0}return!1}var Ch=function(r,o){if(!isSimpleGraph(r)||!isSimpleGraph(o)||!containAllSameNodes(r,o)||containSameEdges(r,o))return!1;var s=r.nodeCount();return r.edgeCount()+o.edgeCount()===s*(s-1)/2},hm=function(r){if(!isSimpleGraph(r))return null;for(var o=r.nodeCount(),s=new Graph({compound:r.isCompound(),directed:r.isDirected(),multigraph:r.isMultigraph()}),l=r.nodes(),h=0;h<o;h++){var g=l[h];s.setNode(g,r.node(g));for(var p=h+1;p<o;p++){var m=l[p];r.hasEdge(g,m)||s.setEdge(g,m)}}return s};class Oh extends wc{}class Ih extends Sa{}const Mh=()=>1,rg=(i,r)=>{var o;if(i.nodeCount()<=1)return[];const s=qn(i,r||Mh);return(o=ig(s.graph,s.buckets,s.zeroIdx).map(h=>i.outEdges(h.v,h.w)))===null||o===void 0?void 0:o.flat()},ig=(i,r,o)=>{let s=[];const l=r[r.length-1],h=r[0];let g;for(;i.nodeCount();){for(;g=h.dequeue();)Ki(i,r,o,g);for(;g=l.dequeue();)Ki(i,r,o,g);if(i.nodeCount()){for(let p=r.length-2;p>0;--p)if(g=r[p].dequeue(),g){s=s.concat(Ki(i,r,o,g,!0));break}}}return s},Ki=(i,r,o,s,l)=>{var h,g;const p=[];return(h=i.inEdges(s.v))===null||h===void 0||h.forEach(m=>{const y=i.edge(m),x=i.node(m.v);l&&p.push({v:m.v,w:m.w,in:0,out:0}),x.out===void 0&&(x.out=0),x.out-=y,Ac(r,o,x)}),(g=i.outEdges(s.v))===null||g===void 0||g.forEach(m=>{const y=i.edge(m),x=m.w,w=i.node(x);w.in===void 0&&(w.in=0),w.in-=y,Ac(r,o,w)}),i.removeNode(s.v),l?p:void 0},qn=(i,r)=>{const o=new Ih;let s=0,l=0;i.nodes().forEach(m=>{o.setNode(m,{v:m,in:0,out:0})}),i.edges().forEach(m=>{const y=o.edge(m)||0,x=(r==null?void 0:r(m))||1,w=y+x;o.setEdge(m.v,m.w,w),l=Math.max(l,o.node(m.v).out+=x),s=Math.max(s,o.node(m.w).in+=x)});const h=[],g=l+s+3;for(let m=0;m<g;m++)h.push(new Oh);const p=s+1;return o.nodes().forEach(m=>{Ac(h,p,o.node(m))}),{buckets:h,zeroIdx:p,graph:o}},Ac=(i,r,o)=>{o.out?o.in?i[o.out-o.in+r].enqueue(o):i[i.length-1].enqueue(o):i[0].enqueue(o)},og=rg,ai=i=>{const r=s=>l=>{var h;return((h=s.edge(l))===null||h===void 0?void 0:h.weight)||1},o=i.graph().acyclicer==="greedy"?og(i,r(i)):Jl(i);o==null||o.forEach(s=>{const l=i.edge(s);i.removeEdgeObj(s),l.forwardName=s.name,l.reversed=!0,i.setEdge(s.w,s.v,l,`rev-${Math.random()}`)})},Jl=i=>{const r=[],o={},s={},l=h=>{var g;s[h]||(s[h]=!0,o[h]=!0,(g=i.outEdges(h))===null||g===void 0||g.forEach(p=>{o[p.w]?r.push(p):l(p.w)}),delete o[h])};return i.nodes().forEach(l),r},Fi={run:ai,undo:i=>{i.edges().forEach(r=>{const o=i.edge(r);if(o.reversed){i.removeEdgeObj(r);const s=o.forwardName;delete o.reversed,delete o.forwardName,i.setEdge(r.w,r.v,o,s)}})}};class Ei extends Sa{}const Tc=(i,r)=>Number(i)-Number(r),ti=(i,r,o,s)=>{let l;do l=`${s}${Math.random()}`;while(i.hasNode(l));return o.dummy=r,i.setNode(l,o),l},Cc=i=>{const r=new Ei().setGraph(i.graph());return i.nodes().forEach(o=>{r.setNode(o,i.node(o))}),i.edges().forEach(o=>{const s=r.edgeFromArgs(o.v,o.w)||{weight:0,minlen:1},l=i.edge(o);r.setEdge(o.v,o.w,{weight:s.weight+l.weight,minlen:Math.max(s.minlen,l.minlen)})}),r},Oc=i=>{const r=new Ei({multigraph:i.isMultigraph()}).setGraph(i.graph());return i.nodes().forEach(o=>{var s;!((s=i.children(o))===null||s===void 0)&&s.length||r.setNode(o,i.node(o))}),i.edges().forEach(o=>{r.setEdgeObj(o,i.edge(o))}),r},Ic=(i,r)=>i==null?void 0:i.reduce((o,s,l)=>(o[s]=r[l],o),{}),Aa=i=>{const r={};return i.nodes().forEach(o=>{var s;const l={};(s=i.outEdges(o))===null||s===void 0||s.forEach(h=>{var g;l[h.w]=(l[h.w]||0)+(((g=i.edge(h))===null||g===void 0?void 0:g.weight)||0)}),r[o]=l}),r},fm=i=>{const r=i.nodes(),o=r.map(s=>{var l;const h={};return(l=i.inEdges(s))===null||l===void 0||l.forEach(g=>{h[g.v]=(h[g.v]||0)+i.edge(g).weight}),h});return Ic(r,o)},Ta=(i,r)=>{const o=Number(i.x),s=Number(i.y),l=Number(r.x)-o,h=Number(r.y)-s;let g=Number(i.width)/2,p=Number(i.height)/2;if(!l&&!h)return{x:0,y:0};let m,y;return Math.abs(h)*g>Math.abs(l)*p?(h<0&&(p=-p),m=p*l/h,y=p):(l<0&&(g=-g),m=g,y=g*h/l),{x:o+m,y:s+y}},Ca=i=>{const r=[],o=Nc(i)+1;for(let s=0;s<o;s++)r.push([]);i.nodes().forEach(s=>{const l=i.node(s);if(!l)return;const h=l.rank;h!==void 0&&r[h]&&r[h].push(s)});for(let s=0;s<o;s++)r[s]=r[s].sort((l,h)=>{var g,p;return Tc((g=i.node(l))===null||g===void 0?void 0:g.order,(p=i.node(h))===null||p===void 0?void 0:p.order)});return r},Mc=i=>{const r=i.nodes().filter(s=>{var l;return((l=i.node(s))===null||l===void 0?void 0:l.rank)!==void 0}).map(s=>i.node(s).rank),o=Math.min(...r);i.nodes().forEach(s=>{const l=i.node(s);l.hasOwnProperty("rank")&&o!==1/0&&(l.rank-=o)})},Ql=i=>{const r=i.nodes(),o=r.filter(p=>{var m;return((m=i.node(p))===null||m===void 0?void 0:m.rank)!==void 0}).map(p=>i.node(p).rank),s=Math.min(...o),l=[];r.forEach(p=>{var m;const y=(((m=i.node(p))===null||m===void 0?void 0:m.rank)||0)-s;l[y]||(l[y]=[]),l[y].push(p)});let h=0;const g=i.graph().nodeRankFactor||0;for(let p=0;p<l.length;p++){const m=l[p];m===void 0?p%g!==0&&(h-=1):h&&(m==null||m.forEach(y=>{const x=i.node(y);x&&(x.rank=x.rank||0,x.rank+=h)}))}},_o=(i,r,o,s)=>{const l={width:0,height:0};return kt(o)&&kt(s)&&(l.rank=o,l.order=s),ti(i,"border",l,r)},Nc=i=>{let r;return i.nodes().forEach(o=>{var s;const l=(s=i.node(o))===null||s===void 0?void 0:s.rank;l!==void 0&&(r===void 0||l>r)&&(r=l)}),r||(r=0),r},tu=(i,r)=>{const o={lhs:[],rhs:[]};return i==null||i.forEach(s=>{r(s)?o.lhs.push(s):o.rhs.push(s)}),o},Yo=(i,r)=>{const o=Date.now();try{return r()}finally{console.log(`${i} time: ${Date.now()-o}ms`)}},ks=(i,r)=>r(),Oa=(i,r)=>i.reduce((o,s)=>{const l=r(o),h=r(s);return l>h?s:o}),eu=i=>{i.graph().dummyChains=[],i.edges().forEach(r=>nu(i,r))},nu=(i,r)=>{let o=r.v,s=i.node(o).rank;const l=r.w,h=i.node(l).rank,g=r.name,p=i.edge(r),m=p.labelRank;if(h===s+1)return;i.removeEdgeObj(r);const y=i.graph();let x,w,A;for(A=0,++s;s<h;++A,++s)p.points=[],w={edgeLabel:p,width:0,height:0,edgeObj:r,rank:s},x=ti(i,"edge",w,"_d"),s===m&&(w.width=p.width,w.height=p.height,w.dummy="edge-label",w.labelpos=p.labelpos),i.setEdge(o,x,{weight:p.weight},g),A===0&&(y.dummyChains||(y.dummyChains=[]),y.dummyChains.push(x)),o=x;i.setEdge(o,l,{weight:p.weight},g)},ru={run:eu,undo:i=>{var r;(r=i.graph().dummyChains)===null||r===void 0||r.forEach(o=>{let s=i.node(o);const l=s.edgeLabel;let h;s.edgeObj&&i.setEdgeObj(s.edgeObj,l);let g=o;for(;s.dummy;)h=i.successors(g)[0],i.removeNode(g),l.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(l.x=s.x,l.y=s.y,l.width=s.width,l.height=s.height),g=h,s=i.node(g)})}},Pc=i=>{var r;const o={},s=l=>{var h;const g=i.node(l);if(!g)return 0;if(o[l])return g.rank;o[l]=!0;let p;return(h=i.outEdges(l))===null||h===void 0||h.forEach(m=>{const y=s(m.w),x=i.edge(m).minlen,w=y-x;w&&(p===void 0||w<p)&&(p=w)}),p||(p=0),g.rank=p,p};(r=i.sources())===null||r===void 0||r.forEach(l=>s(l))},iu=i=>{var r;const o={};let s;const l=p=>{var m;const y=i.node(p);if(!y)return 0;if(o[p])return y.rank;o[p]=!0;let x;return(m=i.outEdges(p))===null||m===void 0||m.forEach(w=>{const A=l(w.w),T=i.edge(w).minlen,O=A-T;O&&(x===void 0||O<x)&&(x=O)}),x||(x=0),(s===void 0||x<s)&&(s=x),y.rank=x,x};(r=i.sources())===null||r===void 0||r.forEach(p=>{i.node(p)&&l(p)}),s===void 0&&(s=0);const h={},g=(p,m)=>{var y;const x=i.node(p),w=isNaN(x.layer)?m:x.layer;(x.rank===void 0||x.rank<w)&&(x.rank=w),!h[p]&&(h[p]=!0,(y=i.outEdges(p))===null||y===void 0||y.map(A=>{g(A.w,w+i.edge(A).minlen)}))};i.nodes().forEach(p=>{const m=i.node(p);m&&(isNaN(m.layer)?m.rank-=s:g(p,m.layer))})},_i=(i,r)=>i.node(r.w).rank-i.node(r.v).rank-i.edge(r).minlen,ag={longestPath:Pc,longestPathWithLayer:iu,slack:_i},ou=i=>{const r=new Ei({directed:!1}),o=i.nodes()[0],s=i.nodeCount();r.setNode(o,{});let l,h;for(;Nh(r,i)<s;)l=Rc(r,i),h=r.hasNode(l.v)?_i(i,l):-_i(i,l),Bs(r,i,h);return r},Nh=(i,r)=>{const o=s=>{r.nodeEdges(s).forEach(l=>{const h=l.v,g=s===h?l.w:h;!i.hasNode(g)&&!_i(r,l)&&(i.setNode(g,{}),i.setEdge(s,g,{}),o(g))})};return i.nodes().forEach(o),i.nodeCount()},Qi=i=>{const r=new Ei({directed:!1}),o=i.nodes()[0],s=i.nodes().filter(g=>!!i.node(g)).length;r.setNode(o,{});let l,h;for(;Dc(r,i)<s;)l=Rc(r,i),h=r.hasNode(l.v)?_i(i,l):-_i(i,l),Bs(r,i,h);return r},Dc=(i,r)=>{const o=s=>{var l;(l=r.nodeEdges(s))===null||l===void 0||l.forEach(h=>{const g=h.v,p=s===g?h.w:g;!i.hasNode(p)&&(r.node(p).layer!==void 0||!_i(r,h))&&(i.setNode(p,{}),i.setEdge(s,p,{}),o(p))})};return i.nodes().forEach(o),i.nodeCount()},Rc=(i,r)=>Oa(r.edges(),o=>i.hasNode(o.v)!==i.hasNode(o.w)?_i(r,o):1/0),Bs=(i,r,o)=>{i.nodes().forEach(s=>{r.node(s).rank||(r.node(s).rank=0),r.node(s).rank+=o})},cg={feasibleTree:ou,feasibleTreeWithLayer:Qi},{preorder:Lc,postorder:lg}=Lt,su=i=>{const r=Cc(i);Pc(r);const o=ou(r);kc(o),Ph(o,r);let s,l;for(;s=cu(o);)l=Lh(o,r,s),kh(o,r,s,l)},Ph=(i,r)=>{let o=lg(i,i.nodes());o=o==null?void 0:o.slice(0,(o==null?void 0:o.length)-1),o==null||o.forEach(s=>{Dh(i,r,s)})},Dh=(i,r,o)=>{const l=i.node(o).parent;i.edgeFromArgs(o,l).cutvalue=Rh(i,r,o)},Rh=(i,r,o)=>{var s;const h=i.node(o).parent;let g=!0,p=r.edgeFromArgs(o,h),m=0;return p||(g=!1,p=r.edgeFromArgs(h,o)),m=p.weight,(s=r.nodeEdges(o))===null||s===void 0||s.forEach(y=>{const x=y.v===o,w=x?y.w:y.v;if(w!==h){const A=x===g,T=r.edge(y).weight;if(m+=A?T:-T,ug(i,o,w)){const O=i.edgeFromArgs(o,w).cutvalue;m+=A?-O:O}}}),m},kc=(i,r=i.nodes()[0])=>{au(i,{},1,r)},au=(i,r,o,s,l)=>{var h;const g=o;let p=o;const m=i.node(s);return r[s]=!0,(h=i.neighbors(s))===null||h===void 0||h.forEach(y=>{r[y]||(p=au(i,r,p,y,s))}),m.low=g,m.lim=p++,l?m.parent=l:delete m.parent,p},cu=i=>i.edges().find(r=>i.edge(r).cutvalue<0),Lh=(i,r,o)=>{let s=o.v,l=o.w;r.hasEdge(s,l)||(s=o.w,l=o.v);const h=i.node(s),g=i.node(l);let p=h,m=!1;h.lim>g.lim&&(p=g,m=!0);const y=r.edges().filter(x=>m===Ia(i,i.node(x.v),p)&&m!==Ia(i,i.node(x.w),p));return Oa(y,x=>_i(r,x))},kh=(i,r,o,s)=>{const l=o.v,h=o.w;i.removeEdge(l,h),i.setEdge(s.v,s.w,{}),kc(i),Ph(i,r),So(i,r)},So=(i,r)=>{const o=i.nodes().find(l=>{var h;return!(!((h=r.node(l))===null||h===void 0)&&h.parent)});let s=Lc(i,o);s=s==null?void 0:s.slice(1),s==null||s.forEach(l=>{const h=i.node(l).parent;let g=r.edgeFromArgs(l,h),p=!1;g||(g=r.edgeFromArgs(h,l),p=!0),r.node(l).rank=r.node(h).rank+(p?g.minlen:-g.minlen)})},ug=(i,r,o)=>i.hasEdge(r,o),Ia=(i,r,o)=>o.low<=r.lim&&r.lim<=o.lim,hg=su,fg=i=>{switch(i.graph().ranker){case"network-simplex":dm(i);break;case"tight-tree":Bh(i);break;case"longest-path":dg(i);break;default:Bh(i)}},dg=Pc,Bh=i=>{iu(i),Qi(i)},dm=i=>{hg(i)},gg=fg,jh=i=>{var r;const o={};let s=0;const l=h=>{var g;const p=s;(g=i.children(h))===null||g===void 0||g.forEach(l),o[h]={low:p,lim:s++}};return(r=i.children())===null||r===void 0||r.forEach(l),o},Fh=(i,r,o,s)=>{const l=[],h=[],g=Math.min(r[o].low,r[s].low),p=Math.max(r[o].lim,r[s].lim);let m,y;m=o;do m=i.parent(m),l.push(m);while(m&&(r[m].low>g||p>r[m].lim));for(y=m,m=s;m&&m!==y;)h.push(m),m=i.parent(m);return{lca:y,path:l.concat(h.reverse())}},pg=i=>{var r;const o=jh(i);(r=i.graph().dummyChains)===null||r===void 0||r.forEach(s=>{var l,h;let g=s,p=i.node(g);const m=p.edgeObj;if(!m)return;const y=Fh(i,o,m.v,m.w),x=y.path,w=y.lca;let A=0,T=x[A],O=!0;for(;g!==m.w;){if(p=i.node(g),O){for(;T!==w&&((l=i.node(T))===null||l===void 0?void 0:l.maxRank)<p.rank;)A++,T=x[A];T===w&&(O=!1)}if(!O){for(;A<x.length-1&&((h=i.node(x[A+1]))===null||h===void 0?void 0:h.minRank)<=p.rank;)A++;T=x[A]}i.setParent(g,T),g=i.successors(g)[0]}})},Bc=i=>{var r;const o=ti(i,"root",{},"_root"),s=js(i);let l=Math.max(...Object.values(s));Math.abs(l)===1/0&&(l=1);const h=l-1,g=2*h+1;i.graph().nestingRoot=o,i.edges().forEach(m=>{i.edge(m).minlen*=g});const p=Gh(i)+1;(r=i.children())===null||r===void 0||r.forEach(m=>{ci(i,o,g,p,h,s,m)}),i.graph().nodeRankFactor=g},ci=(i,r,o,s,l,h,g)=>{const p=i.children(g);if(!(p!=null&&p.length)){g!==r&&i.setEdge(r,g,{weight:0,minlen:o});return}const m=_o(i,"_bt"),y=_o(i,"_bb"),x=i.node(g);i.setParent(m,g),x.borderTop=m,i.setParent(y,g),x.borderBottom=y,p==null||p.forEach(w=>{ci(i,r,o,s,l,h,w);const A=i.node(w),T=A.borderTop?A.borderTop:w,O=A.borderBottom?A.borderBottom:w,I=A.borderTop?s:2*s,N=T!==O?1:l-h[g]+1;i.setEdge(m,T,{minlen:N,weight:I,nestingEdge:!0}),i.setEdge(O,y,{minlen:N,weight:I,nestingEdge:!0})}),i.parent(g)||i.setEdge(r,m,{weight:0,minlen:l+h[g]})},js=i=>{var r;const o={},s=(l,h)=>{const g=i.children(l);g==null||g.forEach(p=>s(p,h+1)),o[l]=h};return(r=i.children())===null||r===void 0||r.forEach(l=>s(l,1)),o},Gh=i=>{let r=0;return i.edges().forEach(o=>{r+=i.edge(o).weight}),r},uu={run:Bc,cleanup:i=>{const r=i.graph();r.nestingRoot&&i.removeNode(r.nestingRoot),delete r.nestingRoot,i.edges().forEach(o=>{i.edge(o).nestingEdge&&i.removeEdgeObj(o)})}},zh=i=>{var r;const o=s=>{const l=i.children(s),h=i.node(s);if(l!=null&&l.length&&l.forEach(g=>o(g)),h.hasOwnProperty("minRank")){h.borderLeft=[],h.borderRight=[];for(let g=h.minRank,p=h.maxRank+1;g<p;g+=1)hu(i,"borderLeft","_bl",s,h,g),hu(i,"borderRight","_br",s,h,g)}};(r=i.children())===null||r===void 0||r.forEach(s=>o(s))},hu=(i,r,o,s,l,h)=>{const g={rank:h,borderType:r,width:0,height:0},p=l[r][h-1],m=ti(i,"border",g,o);l[r][h]=m,i.setParent(m,s),p&&i.setEdge(p,m,{weight:1})},Uh=zh,vg=i=>{var r;const o=(r=i.graph().rankdir)===null||r===void 0?void 0:r.toLowerCase();(o==="lr"||o==="rl")&&br(i)},Fs=i=>{var r;const o=(r=i.graph().rankdir)===null||r===void 0?void 0:r.toLowerCase();(o==="bt"||o==="rl")&&Jo(i),(o==="lr"||o==="rl")&&(jc(i),br(i))},br=i=>{i.nodes().forEach(r=>{Ao(i.node(r))}),i.edges().forEach(r=>{Ao(i.edge(r))})},Ao=i=>{const r=i.width;i.width=i.height,i.height=r},Jo=i=>{i.nodes().forEach(r=>{to(i.node(r))}),i.edges().forEach(r=>{var o;const s=i.edge(r);(o=s.points)===null||o===void 0||o.forEach(l=>to(l)),s.hasOwnProperty("y")&&to(s)})},to=i=>{i!=null&&i.y&&(i.y=-i.y)},jc=i=>{i.nodes().forEach(r=>{Fc(i.node(r))}),i.edges().forEach(r=>{var o;const s=i.edge(r);(o=s.points)===null||o===void 0||o.forEach(l=>Fc(l)),s.hasOwnProperty("x")&&Fc(s)})},Fc=i=>{const r=i.x;i.x=i.y,i.y=r},yg={adjust:vg,undo:Fs};function fu(i){if(!Array.isArray(i))return-1/0;var r=i.length;if(!r)return-1/0;for(var o=i[0],s=1;s<r;s++)o=Math.max(o,i[s]);return o}const du=i=>{const r={},o=i.nodes().filter(x=>{var w;return!(!((w=i.children(x))===null||w===void 0)&&w.length)}),s=o.map(x=>i.node(x).rank),l=fu(s),h=[];for(let x=0;x<l+1;x++)h.push([]);const g=x=>{var w;if(r.hasOwnProperty(x))return;r[x]=!0;const A=i.node(x);isNaN(A.rank)||h[A.rank].push(x),(w=i.successors(x))===null||w===void 0||w.forEach(T=>g(T))},p=o.sort((x,w)=>i.node(x).rank-i.node(w).rank),y=p.filter(x=>i.node(x).fixorder!==void 0).sort((x,w)=>i.node(x).fixorder-i.node(w).fixorder);return y==null||y.forEach(x=>{isNaN(i.node(x).rank)||h[i.node(x).rank].push(x),r[x]=!0}),p==null||p.forEach(g),h},Gc=(i,r,o)=>{const s=Ic(o,o.map((x,w)=>w)),h=r.map(x=>{var w;const A=(w=i.outEdges(x))===null||w===void 0?void 0:w.map(T=>({pos:s[T.w]||0,weight:i.edge(T).weight}));return A==null?void 0:A.sort((T,O)=>T.pos-O.pos)}).flat().filter(x=>x!==void 0);let g=1;for(;g<o.length;)g<<=1;const p=2*g-1;g-=1;const m=Array(p).fill(0,0,p);let y=0;return h==null||h.forEach(x=>{if(x){let w=x.pos+g;m[w]+=x.weight;let A=0;for(;w>0;)w%2&&(A+=m[w+1]),w=w-1>>1,m[w]+=x.weight;y+=x.weight*A}}),y},gu=(i,r)=>{let o=0;for(let s=1;s<(r==null?void 0:r.length);s+=1)o+=Gc(i,r[s-1],r[s]);return o},pu=(i,r,o)=>{const s=Vh(i),l=new Ei({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(h=>i.node(h));return i.nodes().forEach(h=>{var g;const p=i.node(h),m=i.parent(h);(p.rank===r||p.minRank<=r&&r<=p.maxRank)&&(l.setNode(h),l.setParent(h,m||s),(g=i[o](h))===null||g===void 0||g.forEach(y=>{const x=y.v===h?y.w:y.v,w=l.edgeFromArgs(x,h),A=w!==void 0?w.weight:0;l.setEdge(x,h,{weight:i.edge(y).weight+A})}),p.hasOwnProperty("minRank")&&l.setNode(h,{borderLeft:p.borderLeft[r],borderRight:p.borderRight[r]}))}),l},Vh=i=>{let r;for(;i.hasNode(r=`_root${Math.random()}`););return r},Hh=pu,zc=(i,r,o)=>{const s={};let l;o==null||o.forEach(h=>{let g=i.parent(h),p,m;for(;g;){if(p=i.parent(g),p?(m=s[p],s[p]=g):(m=l,l=g),m&&m!==g){r.setEdge(m,g);return}g=p}})},Gs=(i,r)=>r.map(o=>{const s=i.inEdges(o);if(!(s!=null&&s.length))return{v:o};{const l={sum:0,weight:0};return s==null||s.forEach(h=>{const g=i.edge(h),p=i.node(h.v);l.sum+=g.weight*p.order,l.weight+=g.weight}),{v:o,barycenter:l.sum/l.weight,weight:l.weight}}}),$h=(i,r)=>{var o,s,l;const h={};i==null||i.forEach((p,m)=>{h[p.v]={i:m,indegree:0,in:[],out:[],vs:[p.v]};const y=h[p.v];p.barycenter!==void 0&&(y.barycenter=p.barycenter,y.weight=p.weight)}),(o=r.edges())===null||o===void 0||o.forEach(p=>{const m=h[p.v],y=h[p.w];m!==void 0&&y!==void 0&&(y.indegree++,m.out.push(h[p.w]))});const g=(l=(s=Object.values(h)).filter)===null||l===void 0?void 0:l.call(s,p=>!p.indegree);return vu(g)},vu=i=>{var r,o;const s=[],l=m=>y=>{y.merged||(y.barycenter===void 0||m.barycenter===void 0||y.barycenter>=m.barycenter)&&Wh(m,y)},h=m=>y=>{y.in.push(m),--y.indegree===0&&i.push(y)};for(;i!=null&&i.length;){const m=i.pop();s.push(m),(r=m.in.reverse())===null||r===void 0||r.forEach(y=>l(m)(y)),(o=m.out)===null||o===void 0||o.forEach(y=>h(m)(y))}const g=s.filter(m=>!m.merged),p=["vs","i","barycenter","weight"];return g.map(m=>{const y={};return p==null||p.forEach(x=>{m[x]!==void 0&&(y[x]=m[x])}),y})},Wh=(i,r)=>{var o;let s=0,l=0;i.weight&&(s+=i.barycenter*i.weight,l+=i.weight),r.weight&&(s+=r.barycenter*r.weight,l+=r.weight),i.vs=(o=r.vs)===null||o===void 0?void 0:o.concat(i.vs),i.barycenter=s/l,i.weight=l,i.i=Math.min(r.i,i.i),r.merged=!0},yu=$h,bu=(i,r,o,s)=>{const l=tu(i,A=>{const T=A.hasOwnProperty("fixorder")&&!isNaN(A.fixorder);return s?!T&&A.hasOwnProperty("barycenter"):T||A.hasOwnProperty("barycenter")}),h=l.lhs,g=l.rhs.sort((A,T)=>-A.i- -T.i),p=[];let m=0,y=0,x=0;h==null||h.sort(Xh(!!r,!!o)),x=xu(p,g,x),h==null||h.forEach(A=>{var T;x+=(T=A.vs)===null||T===void 0?void 0:T.length,p.push(A.vs),m+=A.barycenter*A.weight,y+=A.weight,x=xu(p,g,x)});const w={vs:p.flat()};return y&&(w.barycenter=m/y,w.weight=y),w},xu=(i,r,o)=>{let s=o,l;for(;r.length&&(l=r[r.length-1]).i<=s;)r.pop(),i==null||i.push(l.vs),s++;return s},Xh=(i,r)=>(o,s)=>{if(o.fixorder!==void 0&&s.fixorder!==void 0)return o.fixorder-s.fixorder;if(o.barycenter<s.barycenter)return-1;if(o.barycenter>s.barycenter)return 1;if(r&&o.order!==void 0&&s.order!==void 0){if(o.order<s.order)return-1;if(o.order>s.order)return 1}return i?s.i-o.i:o.i-s.i},wu=bu,Eu=(i,r,o,s,l,h)=>{var g,p,m,y;let x=i.children(r);const w=i.node(r),A=w?w.borderLeft:void 0,T=w?w.borderRight:void 0,O={};A&&(x=x==null?void 0:x.filter(R=>R!==A&&R!==T));const I=Gs(i,x||[]);I==null||I.forEach(R=>{var k;if(!((k=i.children(R.v))===null||k===void 0)&&k.length){const U=Eu(i,R.v,o,s,h);O[R.v]=U,U.hasOwnProperty("barycenter")&&Ma(R,U)}});const N=yu(I,o);Si(N,O),(g=N.filter(R=>R.vs.length>0))===null||g===void 0||g.forEach(R=>{const k=i.node(R.vs[0]);k&&(R.fixorder=k.fixorder,R.order=k.order)});const P=wu(N,s,l,h);if(A&&(P.vs=[A,P.vs,T].flat(),!((p=i.predecessors(A))===null||p===void 0)&&p.length)){const R=i.node(((m=i.predecessors(A))===null||m===void 0?void 0:m[0])||""),k=i.node(((y=i.predecessors(T))===null||y===void 0?void 0:y[0])||"");P.hasOwnProperty("barycenter")||(P.barycenter=0,P.weight=0),P.barycenter=(P.barycenter*P.weight+R.order+k.order)/(P.weight+2),P.weight+=2}return P},Si=(i,r)=>{i==null||i.forEach(o=>{var s;const l=(s=o.vs)===null||s===void 0?void 0:s.map(h=>r[h]?r[h].vs:h);o.vs=l.flat()})},Ma=(i,r)=>{i.barycenter!==void 0?(i.barycenter=(i.barycenter*i.weight+r.barycenter*r.weight)/(i.weight+r.weight),i.weight+=r.weight):(i.barycenter=r.barycenter,i.weight=r.weight)},wg=Eu,Gi=(i,r)=>{const o=Nc(i),s=[],l=[];for(let x=1;x<o+1;x++)s.push(x);for(let x=o-1;x>-1;x--)l.push(x);const h=Uc(i,s,"inEdges"),g=Uc(i,l,"outEdges");let p=du(i);zs(i,p);let m=Number.POSITIVE_INFINITY,y;for(let x=0,w=0;w<4;++x,++w){ei(x%2?h:g,x%4>=2,!1,r),p=Ca(i);const A=gu(i,p);A<m&&(w=0,y=st(p),m=A)}p=du(i),zs(i,p);for(let x=0,w=0;w<4;++x,++w){ei(x%2?h:g,x%4>=2,!0,r),p=Ca(i);const A=gu(i,p);A<m&&(w=0,y=st(p),m=A)}zs(i,y)},Uc=(i,r,o)=>r.map(s=>Hh(i,s,o)),ei=(i,r,o,s)=>{const l=new Ei;i==null||i.forEach(h=>{var g;const p=h.graph().root,m=wg(h,p,l,r,o,s);for(let y=0;y<((g=m.vs)===null||g===void 0?void 0:g.length);y++){const x=h.node(m.vs[y]);x&&(x.order=y)}zc(h,l,m.vs)})},zs=(i,r)=>{r==null||r.forEach(o=>{o==null||o.forEach((s,l)=>{i.node(s).order=l})})},Na=Gi;function Zh(i){return Array.isArray(i)}const _u=function(i){if(Zh(i))return i.reduce(function(r,o){return Math.min(r,o)},i[0])};class Su extends Sa{}const Vc=(i,r)=>{const o={},s=(l,h)=>{let g=0,p=0;const m=l.length,y=h==null?void 0:h[(h==null?void 0:h.length)-1];return h==null||h.forEach((x,w)=>{var A;const T=Yh(i,x),O=T?i.node(T).order:m;(T||x===y)&&((A=h.slice(p,w+1))===null||A===void 0||A.forEach(I=>{var N;(N=i.predecessors(I))===null||N===void 0||N.forEach(P=>{var R;const k=i.node(P),U=k.order;(U<g||O<U)&&!(k.dummy&&(!((R=i.node(I))===null||R===void 0)&&R.dummy))&&Jh(o,P,I)})}),p=w+1,g=O)}),h};return r!=null&&r.length&&r.reduce(s),o},qh=(i,r)=>{const o={};function s(p,m,y,x,w){var A,T;let O;for(let I=m;I<y;I++)O=p[I],!((A=i.node(O))===null||A===void 0)&&A.dummy&&((T=i.predecessors(O))===null||T===void 0||T.forEach(N=>{const P=i.node(N);P.dummy&&(P.order<x||P.order>w)&&Jh(o,N,O)}))}function l(p){return JSON.stringify(p.slice(1))}function h(p,m){const y=l(p);m.get(y)||(s(...p),m.set(y,!0))}const g=(p,m)=>{let y=-1,x,w=0;const A=new Map;return m==null||m.forEach((T,O)=>{var I;if(((I=i.node(T))===null||I===void 0?void 0:I.dummy)==="border"){const N=i.predecessors(T)||[];N.length&&(x=i.node(N[0]).order,h([m,w,O,y,x],A),w=O,y=x)}h([m,w,m.length,x,p.length],A)}),m};return r!=null&&r.length&&r.reduce(g),o},Yh=(i,r)=>{var o,s;if(!((o=i.node(r))===null||o===void 0)&&o.dummy)return(s=i.predecessors(r))===null||s===void 0?void 0:s.find(l=>i.node(l).dummy)},Jh=(i,r,o)=>{let s=r,l=o;if(s>l){const g=s;s=l,l=g}let h=i[s];h||(i[s]=h={}),h[l]=!0},Eg=(i,r,o)=>{let s=r,l=o;if(s>l){const h=r;s=l,l=h}return!!i[s]},Qo=(i,r,o,s)=>{const l={},h={},g={};return r==null||r.forEach(p=>{p==null||p.forEach((m,y)=>{l[m]=m,h[m]=m,g[m]=y})}),r==null||r.forEach(p=>{let m=-1;p==null||p.forEach(y=>{let x=s(y);if(x.length){x=x.sort((A,T)=>g[A]-g[T]);const w=(x.length-1)/2;for(let A=Math.floor(w),T=Math.ceil(w);A<=T;++A){const O=x[A];h[y]===y&&m<g[O]&&!Eg(o,y,O)&&(h[O]=y,h[y]=l[y]=l[O],m=g[O])}}})}),{root:l,align:h}},fi=(i,r,o,s,l)=>{var h;const g={},p=_g(i,r,o,l),m=l?"borderLeft":"borderRight",y=(A,T)=>{let O=p.nodes(),I=O.pop();const N={};for(;I;)N[I]?A(I):(N[I]=!0,O.push(I),O=O.concat(T(I))),I=O.pop()},x=A=>{g[A]=(p.inEdges(A)||[]).reduce((T,O)=>Math.max(T,(g[O.v]||0)+p.edge(O)),0)},w=A=>{const T=(p.outEdges(A)||[]).reduce((I,N)=>Math.min(I,(g[N.w]||0)-p.edge(N)),Number.POSITIVE_INFINITY),O=i.node(A);T!==Number.POSITIVE_INFINITY&&O.borderType!==m&&(g[A]=Math.max(g[A],T))};return y(x,p.predecessors.bind(p)),y(w,p.successors.bind(p)),(h=Object.values(s))===null||h===void 0||h.forEach(A=>{g[A]=g[o[A]]}),g},_g=(i,r,o,s)=>{const l=new Su,h=i.graph(),g=Cu(h.nodesep,h.edgesep,s);return r==null||r.forEach(p=>{let m;p==null||p.forEach(y=>{const x=o[y];if(l.setNode(x),m){const w=o[m],A=l.edgeFromArgs(w,x);l.setEdge(w,x,Math.max(g(i,y,m),A||0))}m=y})}),l},Au=(i,r)=>Oa(Object.values(r),o=>{var s;let l=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;return(s=Object.keys(o))===null||s===void 0||s.forEach(g=>{const p=o[g],m=Hc(i,g)/2;l=Math.max(p+m,l),h=Math.min(p-m,h)}),l-h});function Tu(i,r){const o=Object.values(r),s=_u(o),l=fu(o);["u","d"].forEach(h=>{["l","r"].forEach(g=>{const p=h+g,m=i[p];let y;if(m===r)return;const x=Object.values(m);y=g==="l"?s-_u(x):l-fu(x),y&&(i[p]={},Object.keys(m).forEach(w=>{i[p][w]=m[w]+y}))})})}const Kh=(i,r)=>{const o={};return Object.keys(i.ul).forEach(s=>{if(r)o[s]=i[r.toLowerCase()][s];else{const l=Object.values(i).map(h=>h[s]);o[s]=(l[0]+l[1])/2}}),o},gm=i=>{const r=buildLayerMatrix(i),o=Object.assign(Vc(i,r),qh(i,r)),s={};let l;["u","d"].forEach(g=>{l=g==="u"?r:Object.values(r).reverse(),["l","r"].forEach(p=>{p==="r"&&(l=l.map(w=>Object.values(w).reverse()));const m=(g==="u"?i.predecessors:i.successors).bind(i),y=Qo(i,l,o,m),x=fi(i,l,y.root,y.align,p==="r");p==="r"&&Object.keys(x).forEach(w=>{x[w]=-x[w]}),s[g+p]=x})});const h=Au(i,s);return Tu(s,h),Kh(s,i.graph().align)},Cu=(i,r,o)=>(s,l,h)=>{const g=s.node(l),p=s.node(h);let m=0,y;if(m+=g.width/2,g.hasOwnProperty("labelpos"))switch((g.labelpos||"").toLowerCase()){case"l":y=-g.width/2;break;case"r":y=g.width/2;break}if(y&&(m+=o?y:-y),y=0,m+=(g.dummy?r:i)/2,m+=(p.dummy?r:i)/2,m+=p.width/2,p.labelpos)switch((p.labelpos||"").toLowerCase()){case"l":y=p.width/2;break;case"r":y=-p.width/2;break}return y&&(m+=o?y:-y),y=0,m},Hc=(i,r)=>i.node(r).width||0,Sg=i=>{const r=Ca(i),o=i.graph().ranksep;let s=0;r==null||r.forEach(l=>{const h=l.map(p=>i.node(p).height),g=Math.max(...h,0);l==null||l.forEach(p=>{i.node(p).y=s+g/2}),s+=g+o})},Ag=i=>{const r=Ca(i),o=Object.assign(Vc(i,r),qh(i,r)),s={};let l=[];["u","d"].forEach(g=>{l=g==="u"?r:Object.values(r).reverse(),["l","r"].forEach(p=>{p==="r"&&(l=l.map(w=>Object.values(w).reverse()));const m=(g==="u"?i.predecessors:i.successors).bind(i),y=Qo(i,l,o,m),x=fi(i,l,y.root,y.align,p==="r");p==="r"&&Object.keys(x).forEach(w=>x[w]=-x[w]),s[g+p]=x})});const h=Au(i,s);return h&&Tu(s,h),Kh(s,i.graph().align)},Tg=i=>{var r;const o=Oc(i);Sg(o);const s=Ag(o);(r=Object.keys(s))===null||r===void 0||r.forEach(l=>{o.node(l).x=s[l]})},Qh=(i,r)=>{const s=i.nodes().filter(g=>{var p;return!(!((p=i.children(g))===null||p===void 0)&&p.length)}).map(g=>i.node(g).rank),l=Math.max(...s),h=[];for(let g=0;g<l+1;g++)h[g]=[];r==null||r.forEach(g=>{const p=i.node(g);!p||p!=null&&p.dummy||isNaN(p.rank)||(p.fixorder=h[p.rank].length,h[p.rank].push(g))})},Cg=(i,r)=>{const o=r&&r.debugTiming?Yo:ks;o("layout",()=>{r&&!r.keepNodeOrder&&r.prevGraph&&o("  inheritOrder",()=>{Ig(i,r.prevGraph)});const s=o("  buildLayoutGraph",()=>Rg(i));r&&r.edgeLabelSpace===!1||o("  makeSpaceForEdgeLabels",()=>{Lg(s)});try{o("  runLayout",()=>{Og(s,o,r)})}catch(l){if(l.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,l);return}throw l}o("  updateInputGraph",()=>{Mg(i,s)})})},Og=(i,r,o)=>{r("    removeSelfEdges",()=>{Ai(i)}),r("    acyclic",()=>{Fi.run(i)}),r("    nestingGraph.run",()=>{uu.run(i)}),r("    rank",()=>{gg(Oc(i))}),r("    injectEdgeLabelProxies",()=>{kg(i)}),r("    removeEmptyRanks",()=>{Ql(i)}),r("    nestingGraph.cleanup",()=>{uu.cleanup(i)}),r("    normalizeRanks",()=>{Mc(i)}),r("    assignRankMinMax",()=>{Pa(i)}),r("    removeEdgeLabelProxies",()=>{Bg(i)}),r("    normalize.run",()=>{ru.run(i)}),r("    parentDummyChains",()=>{pg(i)}),r("    addBorderSegments",()=>{Uh(i)}),o&&o.keepNodeOrder&&r("    initDataOrder",()=>{Qh(i,o.nodeOrder)}),r("    order",()=>{Na(i,o==null?void 0:o.keepNodeOrder)}),r("    insertSelfEdges",()=>{ef(i)}),r("    adjustCoordinateSystem",()=>{yg.adjust(i)}),r("    position",()=>{Tg(i)}),r("    positionSelfEdges",()=>{$s(i)}),r("    removeBorderNodes",()=>{Hs(i)}),r("    normalize.undo",()=>{ru.undo(i)}),r("    fixupEdgeLabelCoords",()=>{$c(i)}),r("    undoCoordinateSystem",()=>{yg.undo(i)}),r("    translateGraph",()=>{Vs(i)}),r("    assignNodeIntersects",()=>{Da(i)}),r("    reversePoints",()=>{Mu(i)}),r("    acyclic.undo",()=>{Fi.undo(i)})},Ig=(i,r)=>{i.nodes().forEach(o=>{const s=i.node(o),l=r.node(o);l!==void 0?(s.fixorder=l._order,delete l._order):delete s.fixorder})},Mg=(i,r)=>{i.nodes().forEach(o=>{var s;const l=i.node(o);if(l){const h=r.node(o);l.x=h.x,l.y=h.y,l._order=h.order,l._rank=h.rank,!((s=r.children(o))===null||s===void 0)&&s.length&&(l.width=h.width,l.height=h.height)}}),i.edges().forEach(o=>{const s=i.edge(o),l=r.edge(o);s.points=l?l.points:[],l&&l.hasOwnProperty("x")&&(s.x=l.x,s.y=l.y)}),i.graph().width=r.graph().width,i.graph().height=r.graph().height},Ng=["nodesep","edgesep","ranksep","marginx","marginy"],Us={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Ou=["acyclicer","ranker","rankdir","align"],Pg=["width","height","layer","fixorder"],tf={width:0,height:0},Iu=["minlen","weight","width","height","labeloffset"],Dg={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Rn=["labelpos"],Rg=i=>{const r=new Ei({multigraph:!0,compound:!0}),o=To(i.graph()),s={};return Ou==null||Ou.forEach(l=>{o[l]!==void 0&&(s[l]=o[l])}),r.setGraph(Object.assign({},Us,ts(o,Ng),s)),i.nodes().forEach(l=>{const h=To(i.node(l)),g=Object.assign(Object.assign({},tf),h),p=ts(g,Pg);r.setNode(l,p),r.setParent(l,i.parent(l))}),i.edges().forEach(l=>{const h=To(i.edge(l)),g={};Rn==null||Rn.forEach(p=>{h[p]!==void 0&&(g[p]=h[p])}),r.setEdgeObj(l,Object.assign({},Dg,ts(h,Iu),g))}),r},Lg=i=>{const r=i.graph();r.ranksep||(r.ranksep=0),r.ranksep/=2,i.nodes().forEach(o=>{const s=i.node(o);isNaN(s.layer)||s.layer||(s.layer=0)}),i.edges().forEach(o=>{var s;const l=i.edge(o);l.minlen*=2,((s=l.labelpos)===null||s===void 0?void 0:s.toLowerCase())!=="c"&&(r.rankdir==="TB"||r.rankdir==="BT"?l.width+=l.labeloffset:l.height+=l.labeloffset)})},kg=i=>{i.edges().forEach(r=>{const o=i.edge(r);if(o.width&&o.height){const s=i.node(r.v),l=i.node(r.w),h={e:r,rank:(l.rank-s.rank)/2+s.rank};ti(i,"edge-proxy",h,"_ep")}})},Pa=i=>{let r=0;i.nodes().forEach(o=>{var s,l;const h=i.node(o);h.borderTop&&(h.minRank=(s=i.node(h.borderTop))===null||s===void 0?void 0:s.rank,h.maxRank=(l=i.node(h.borderBottom))===null||l===void 0?void 0:l.rank,r=Math.max(r,h.maxRank||-1/0))}),i.graph().maxRank=r},Bg=i=>{i.nodes().forEach(r=>{const o=i.node(r);o.dummy==="edge-proxy"&&(i.edge(o.e).labelRank=o.rank,i.removeNode(r))})},Vs=i=>{let r,o=0,s,l=0;const h=i.graph(),g=h.marginx||0,p=h.marginy||0,m=y=>{if(!y)return;const x=y.x,w=y.y,A=y.width,T=y.height;!isNaN(x)&&!isNaN(A)&&(r===void 0&&(r=x-A/2),r=Math.min(r,x-A/2),o=Math.max(o,x+A/2)),!isNaN(w)&&!isNaN(T)&&(s===void 0&&(s=w-T/2),s=Math.min(s,w-T/2),l=Math.max(l,w+T/2))};i.nodes().forEach(y=>{m(i.node(y))}),i.edges().forEach(y=>{const x=i.edge(y);x!=null&&x.hasOwnProperty("x")&&m(x)}),r-=g,s-=p,i.nodes().forEach(y=>{const x=i.node(y);x&&(x.x-=r,x.y-=s)}),i.edges().forEach(y=>{var x;const w=i.edge(y);(x=w.points)===null||x===void 0||x.forEach(A=>{A.x-=r,A.y-=s}),w.hasOwnProperty("x")&&(w.x-=r),w.hasOwnProperty("y")&&(w.y-=s)}),h.width=o-r+g,h.height=l-s+p},Da=i=>{i.edges().forEach(r=>{const o=i.edge(r),s=i.node(r.v),l=i.node(r.w);let h,g;o.points?(h=o.points[0],g=o.points[o.points.length-1]):(o.points=[],h=l,g=s),o.points.unshift(Ta(s,h)),o.points.push(Ta(l,g))})},$c=i=>{i.edges().forEach(r=>{const o=i.edge(r);if(o!=null&&o.hasOwnProperty("x"))switch((o.labelpos==="l"||o.labelpos==="r")&&(o.width-=o.labeloffset),o.labelpos){case"l":o.x-=o.width/2+o.labeloffset;break;case"r":o.x+=o.width/2+o.labeloffset;break}})},Mu=i=>{i.edges().forEach(r=>{var o;const s=i.edge(r);s.reversed&&((o=s.points)===null||o===void 0||o.reverse())})},Hs=i=>{i.nodes().forEach(r=>{var o,s,l;if(!((o=i.children(r))===null||o===void 0)&&o.length){const h=i.node(r),g=i.node(h.borderTop),p=i.node(h.borderBottom),m=i.node(h.borderLeft[((s=h.borderLeft)===null||s===void 0?void 0:s.length)-1]),y=i.node(h.borderRight[((l=h.borderRight)===null||l===void 0?void 0:l.length)-1]);h.width=Math.abs((y==null?void 0:y.x)-(m==null?void 0:m.x))||10,h.height=Math.abs((p==null?void 0:p.y)-(g==null?void 0:g.y))||10,h.x=((m==null?void 0:m.x)||0)+h.width/2,h.y=((g==null?void 0:g.y)||0)+h.height/2}}),i.nodes().forEach(r=>{var o;((o=i.node(r))===null||o===void 0?void 0:o.dummy)==="border"&&i.removeNode(r)})},Ai=i=>{i.edges().forEach(r=>{if(r.v===r.w){const o=i.node(r.v);o.selfEdges||(o.selfEdges=[]),o.selfEdges.push({e:r,label:i.edge(r)}),i.removeEdgeObj(r)}})},ef=i=>{const r=Ca(i);r==null||r.forEach(o=>{let s=0;o==null||o.forEach((l,h)=>{var g;const p=i.node(l);p.order=h+s,(g=p.selfEdges)===null||g===void 0||g.forEach(m=>{ti(i,"selfedge",{width:m.label.width,height:m.label.height,rank:p.rank,order:h+ ++s,e:m.e,label:m.label},"_se")}),delete p.selfEdges})})},$s=i=>{i.nodes().forEach(r=>{const o=i.node(r);if(o.dummy==="selfedge"){const s=i.node(o.e.v),l=s.x+s.width/2,h=s.y,g=o.x-l,p=s.height/2;i.setEdgeObj(o.e,o.label),i.removeNode(r),o.label.points=[{x:l+2*g/3,y:h-p},{x:l+5*g/6,y:h-p},{y:h,x:l+g},{x:l+5*g/6,y:h+p},{x:l+2*g/3,y:h+p}],o.label.x=o.x,o.label.y=o.y}})},ts=(i,r)=>{const o={};return r==null||r.forEach(s=>{i[s]!==void 0&&(o[s]=+i[s])}),o},To=(i={})=>{const r={};return Object.keys(i).forEach(o=>{r[o.toLowerCase()]=i[o]}),r},Nu={layout:Cg,util:{time:Yo,notime:ks}};class eo extends vn{constructor(r){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=o=>{const s=this,{nodes:l}=s,h=l.find(g=>g.id===o);return h?h.layout!==!1:!0},this.updateCfg(r)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var r,o,s,l;const h=this,{nodes:g,nodeSize:p,rankdir:m,combos:y,begin:x,radial:w,comboEdges:A=[],vedges:T=[]}=h;if(!g)return;const O=h.edges||[],I=new Ei({multigraph:!0,compound:!0});h.nodeMap={};const N={};g.forEach(Z=>{h.nodeMap[Z.id]=Z,Z.comboId&&(N[Z.comboId]=N[Z.comboId]||[],N[Z.comboId].push(Z.id))});let P=[];const R={};!((r=h.nodeOrder)===null||r===void 0)&&r.length?(h.nodeOrder.forEach(Z=>{R[Z]=!0,P.push(h.nodeMap[Z])}),g.forEach(Z=>{R[Z.id]||P.push(Z)})):P=g;let k;p?Jt(p)?k=()=>p:k=()=>[p,p]:k=Z=>Z.size?Jt(Z.size)?Z.size:Q(Z.size)?[Z.size.width||40,Z.size.height||40]:[Z.size,Z.size]:[40,40];const U=Tn(h.ranksep,50,h.ranksepFunc),K=Tn(h.nodesep,50,h.nodesepFunc);let pt=K,Ot=U;(m==="LR"||m==="RL")&&(pt=U,Ot=K),I.setDefaultEdgeLabel(()=>({})),I.setGraph(h);const It={};this.sortByCombo&&y&&y.forEach(Z=>{if(It[Z.id]=Z,Z.collapsed){const yt=k(Z),bt=Ot(Z),de=pt(Z),Ne=yt[0]+2*de,Ee=yt[1]+2*bt;I.setNode(Z.id,{width:Ne,height:Ee})}Z.parentId&&(It[Z.parentId]||I.setNode(Z.parentId,{}),I.setParent(Z.id,Z.parentId))}),P.filter(Z=>Z.layout!==!1).forEach(Z=>{const yt=k(Z),bt=Ot(Z),de=pt(Z),Ne=yt[0]+2*de,Ee=yt[1]+2*bt,Ie=Z.layer;kt(Ie)?I.setNode(Z.id,{width:Ne,height:Ee,layer:Ie}):I.setNode(Z.id,{width:Ne,height:Ee}),this.sortByCombo&&Z.comboId&&(It[Z.comboId]||(It[Z.comboId]={id:Z.comboId},I.setNode(Z.comboId,{})),I.setParent(Z.id,Z.comboId))}),O.forEach(Z=>{const yt=at(Z,"source"),bt=at(Z,"target");this.layoutNode(yt)&&this.layoutNode(bt)&&I.setEdge(yt,bt,{weight:Z.weight||1})}),(o=A==null?void 0:A.concat(T||[]))===null||o===void 0||o.forEach(Z=>{var yt,bt;const{source:de,target:Ne}=Z,Ee=!((yt=It[de])===null||yt===void 0)&&yt.collapsed?[de]:N[de]||[de],Ie=!((bt=It[Ne])===null||bt===void 0)&&bt.collapsed?[Ne]:N[Ne]||[Ne];Ee.forEach(Ge=>{Ie.forEach(Qe=>{I.setEdge(Ge,Qe,{weight:Z.weight||1})})})});let Ct;!((s=h.preset)===null||s===void 0)&&s.nodes&&(Ct=new Ei({multigraph:!0,compound:!0}),h.preset.nodes.forEach(Z=>{Ct==null||Ct.setNode(Z.id,Z)})),Nu.layout(I,{prevGraph:Ct,edgeLabelSpace:h.edgeLabelSpace,keepNodeOrder:!!h.nodeOrder,nodeOrder:h.nodeOrder});const _t=[0,0];if(x){let Z=1/0,yt=1/0;I.nodes().forEach(bt=>{const de=I.node(bt);Z>de.x&&(Z=de.x),yt>de.y&&(yt=de.y)}),I.edges().forEach(bt=>{var de;(de=I.edge(bt).points)===null||de===void 0||de.forEach(Ee=>{Z>Ee.x&&(Z=Ee.x),yt>Ee.y&&(yt=Ee.y)})}),_t[0]=x[0]-Z,_t[1]=x[1]-yt}const F=m==="LR"||m==="RL";if(w){const{focusNode:Z,ranksep:yt,getRadialPos:bt}=this,de=mn(Z)?Z:Z==null?void 0:Z.id,Ne=de?(l=I.node(de))===null||l===void 0?void 0:l._rank:0,Ee=[],Ie=F?"y":"x",Ge=F?"height":"width";let Qe=1/0,Xn=-1/0;I.nodes().forEach(We=>{const Xe=I.node(We);if(!h.nodeMap[We])return;const rr=K(h.nodeMap[We]);if(Ne===0)Ee[Xe._rank]||(Ee[Xe._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),Ee[Xe._rank].nodes.push(We),Ee[Xe._rank].totalWidth+=rr*2+Xe[Ge],Ee[Xe._rank].maxSize<Math.max(Xe.width,Xe.height)&&(Ee[Xe._rank].maxSize=Math.max(Xe.width,Xe.height));else{const kn=Xe._rank-Ne;if(kn===0)Ee[kn]||(Ee[kn]={nodes:[],totalWidth:0,maxSize:-1/0}),Ee[kn].nodes.push(We),Ee[kn].totalWidth+=rr*2+Xe[Ge],Ee[kn].maxSize<Math.max(Xe.width,Xe.height)&&(Ee[kn].maxSize=Math.max(Xe.width,Xe.height));else{const fr=Math.abs(kn);Ee[fr]||(Ee[fr]={left:[],right:[],totalWidth:0,maxSize:-1/0}),Ee[fr].totalWidth+=rr*2+Xe[Ge],Ee[fr].maxSize<Math.max(Xe.width,Xe.height)&&(Ee[fr].maxSize=Math.max(Xe.width,Xe.height)),kn<0?Ee[fr].left.push(We):Ee[fr].right.push(We)}}const Lr=Xe[Ie]-Xe[Ge]/2-rr,Tr=Xe[Ie]+Xe[Ge]/2+rr;Lr<Qe&&(Qe=Lr),Tr>Xn&&(Xn=Tr)});let Mn=yt||50;const Un={},Ut=(Xn-Qe)/.9,un=[(Qe+Xn-Ut)*.5,(Qe+Xn+Ut)*.5],Nn=(We,Xe,rr=-1/0,Lr=[0,1])=>{let Tr=rr;return We.forEach(kn=>{const fr=I.node(kn);Un[kn]=Xe;const{x:Vr,y:yi}=bt(fr[Ie],un,Ut,Xe,Lr);if(!h.nodeMap[kn])return;h.nodeMap[kn].x=Vr+_t[0],h.nodeMap[kn].y=yi+_t[1],h.nodeMap[kn]._order=fr._order;const Ri=U(h.nodeMap[kn]);Tr<Ri&&(Tr=Ri)}),Tr};let En=!0;const xn=0;Ee.forEach(We=>{var Xe,rr,Lr,Tr,kn,fr,Vr;if(!(!((Xe=We==null?void 0:We.nodes)===null||Xe===void 0)&&Xe.length)&&!(!((rr=We==null?void 0:We.left)===null||rr===void 0)&&rr.length)&&!(!((Lr=We==null?void 0:We.right)===null||Lr===void 0)&&Lr.length))return;if(En&&We.nodes.length===1){const Ri=We.nodes[0];if(!h.nodeMap[Ri])return;h.nodeMap[Ri].x=_t[0],h.nodeMap[Ri].y=_t[1],Un[We.nodes[0]]=0,Mn=U(h.nodeMap[Ri]),En=!1;return}Mn=Math.max(Mn,We.totalWidth/(2*Math.PI));let yi=-1/0;if(Ne===0||!((Tr=We.nodes)===null||Tr===void 0)&&Tr.length)yi=Nn(We.nodes,Mn,yi,[0,1]);else{const Ri=((kn=We.left)===null||kn===void 0?void 0:kn.length)/(((fr=We.left)===null||fr===void 0?void 0:fr.length)+((Vr=We.right)===null||Vr===void 0?void 0:Vr.length));yi=Nn(We.left,Mn,yi,[0,Ri]),yi=Nn(We.right,Mn,yi,[Ri+.05,1])}Mn+=yi,En=!1,xn-We.maxSize}),I.edges().forEach(We=>{var Xe,rr,Lr;const Tr=I.edge(We),kn=O.findIndex(fr=>{const Vr=at(fr,"source"),yi=at(fr,"target");return Vr===We.v&&yi===We.w});if(!(kn<=-1)&&h.edgeLabelSpace&&h.controlPoints&&O[kn].type!=="loop"){const fr=Ie==="x"?"y":"x",Vr=(Xe=Tr==null?void 0:Tr.points)===null||Xe===void 0?void 0:Xe.slice(1,Tr.points.length-1),yi=[],Ri=(rr=I.node(We.v))===null||rr===void 0?void 0:rr[fr],gv=Ri-((Lr=I.node(We.w))===null||Lr===void 0?void 0:Lr[fr]),Jp=Un[We.v],Ax=Jp-Un[We.w];Vr==null||Vr.forEach(pv=>{const mv=(pv[fr]-Ri)/gv*Ax+Jp,Kp=bt(pv[Ie],un,Ut,mv);yi.push({x:Kp.x+_t[0],y:Kp.y+_t[1]})}),O[kn].controlPoints=yi}})}else{const Z=new Set,bt=m==="BT"||m==="RL"?(Ie,Ge)=>Ge-Ie:(Ie,Ge)=>Ie-Ge;I.nodes().forEach(Ie=>{const Ge=I.node(Ie);if(!Ge)return;let Qe=this.nodeMap[Ie];Qe||(Qe=y==null?void 0:y.find(Xn=>Xn.id===Ie)),Qe&&(Qe.x=Ge.x+_t[0],Qe.y=Ge.y+_t[1],Qe._order=Ge._order,Z.add(F?Qe.x:Qe.y))});const de=Array.from(Z).sort(bt),Ne=F?(Ie,Ge)=>Ie.x!==Ge.x:(Ie,Ge)=>Ie.y!==Ge.y,Ee=F?(Ie,Ge,Qe)=>{const Xn=Math.max(Ge.y,Qe.y),Mn=Math.min(Ge.y,Qe.y);return Ie.filter(Un=>Un.y<=Xn&&Un.y>=Mn)}:(Ie,Ge,Qe)=>{const Xn=Math.max(Ge.x,Qe.x),Mn=Math.min(Ge.x,Qe.x);return Ie.filter(Un=>Un.x<=Xn&&Un.x>=Mn)};I.edges().forEach(Ie=>{var Ge;const Qe=I.edge(Ie),Xn=O.findIndex(Mn=>{const Un=at(Mn,"source"),Ut=at(Mn,"target");return Un===Ie.v&&Ut===Ie.w});if(!(Xn<=-1)&&h.edgeLabelSpace&&h.controlPoints&&O[Xn].type!=="loop"){(Ge=Qe==null?void 0:Qe.points)===null||Ge===void 0||Ge.forEach(Ut=>{Ut.x+=_t[0],Ut.y+=_t[1]});const Mn=h.nodeMap[Ie.v],Un=h.nodeMap[Ie.w];O[Xn].controlPoints=Pu(Qe==null?void 0:Qe.points,Mn,Un,de,F,Ne,Ee)}})}return h.onLayoutEnd&&h.onLayoutEnd(),{nodes:g,edges:O}}getRadialPos(r,o,s,l,h=[0,1]){let g=(r-o[0])/s;g=g*(h[1]-h[0])+h[0];const p=g*2*Math.PI;return{x:Math.cos(p)*l,y:Math.sin(p)*l}}getType(){return"dagre"}}const Pu=(i,r,o,s,l,h,g)=>{let p=(i==null?void 0:i.slice(1,i.length-1))||[];if(r&&o){let{x:m,y}=r,{x,y:w}=o;if(l&&(m=r.y,y=r.x,x=o.y,w=o.x),w!==y&&m!==x){const A=s.indexOf(y),T=s[A+1];if(T){const N=p[0],P=l?{x:(y+T)/2,y:(N==null?void 0:N.y)||x}:{x:(N==null?void 0:N.x)||x,y:(y+T)/2};(!N||h(N,P))&&p.unshift(P)}const O=s.indexOf(w),I=Math.abs(O-A);if(I===1)p=g(p,r,o),p.length||p.push(l?{x:(y+w)/2,y:m}:{x:m,y:(y+w)/2});else if(I>1){const N=s[O-1];if(N){const P=p[p.length-1],R=l?{x:(w+N)/2,y:(P==null?void 0:P.y)||x}:{x:(P==null?void 0:P.x)||m,y:(w+N)/2};(!P||h(P,R))&&p.push(R)}}}}return p},Ws={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function es(i={},r=Ws){var o,s,l,h;const g=JSON.parse(JSON.stringify(r)),p=((o=i==null?void 0:i.graph)===null||o===void 0?void 0:o.meta)||{},m=((s=i==null?void 0:i.subScene)===null||s===void 0?void 0:s.meta)||{},y=((l=i==null?void 0:i.nodeSize)===null||l===void 0?void 0:l.meta)||{},x=((h=i==null?void 0:i.nodeSize)===null||h===void 0?void 0:h.node)||{},w=g.nodeSize.bridge;return{graph:{meta:Object.assign(g.graph.meta,p)},subScene:{meta:Object.assign(g.subScene.meta,m)},nodeSize:{meta:Object.assign(g.nodeSize.meta,y),node:Object.assign(g.nodeSize.node,x),bridge:w}}}function Du(i){return`\u25EC${i}\u25EC`}const ns=Du("ROOT"),Ru=Du("BRIDGE_GRAPH");var Fr,rs,is,Xs;(function(i){i[i.META=0]="META",i[i.NODE=1]="NODE",i[i.BRIDGE=2]="BRIDGE"})(Fr||(Fr={})),function(i){i[i.INCLUDE=0]="INCLUDE",i[i.EXCLUDE=1]="EXCLUDE",i[i.UNSPECIFIED=2]="UNSPECIFIED"}(rs||(rs={})),function(i){i[i.META=0]="META",i[i.CORE=1]="CORE",i[i.BRIDGE=2]="BRIDGE"}(is||(is={})),function(i){i[i.META=0]="META",i[i.OP=1]="OP",i[i.SERIES=2]="SERIES"}(Xs||(Xs={}));var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Nt.g<"u"?Nt.g:typeof self<"u"?self:{};function Xc(i,r){return i(r={exports:{}},r.exports),r.exports}var nf=function(){this.__data__=[],this.size=0},di=function(i,r){return i===r||i!=i&&r!=r},Zs=function(i,r){for(var o=i.length;o--;)if(di(i[o][0],r))return o;return-1},rf=Array.prototype.splice,of=function(i){var r=this.__data__,o=Zs(r,i);return!(o<0)&&(o==r.length-1?r.pop():rf.call(r,o,1),--this.size,!0)},Lu=function(i){var r=this.__data__,o=Zs(r,i);return o<0?void 0:r[o][1]},Zc=function(i){return Zs(this.__data__,i)>-1},qc=function(i,r){var o=this.__data__,s=Zs(o,i);return s<0?(++this.size,o.push([i,r])):o[s][1]=r,this};function Co(i){var r=-1,o=i==null?0:i.length;for(this.clear();++r<o;){var s=i[r];this.set(s[0],s[1])}}Co.prototype.clear=nf,Co.prototype.delete=of,Co.prototype.get=Lu,Co.prototype.has=Zc,Co.prototype.set=qc;var zi=Co,sf=function(){this.__data__=new zi,this.size=0},qs=function(i){var r=this.__data__,o=r.delete(i);return this.size=r.size,o},af=function(i){return this.__data__.get(i)},ku=function(i){return this.__data__.has(i)},Yc=typeof Ra=="object"&&Ra&&Ra.Object===Object&&Ra,Yn=typeof self=="object"&&self&&self.Object===Object&&self,$r=Yc||Yn||Function("return this")(),li=$r.Symbol,La=Object.prototype,no=La.hasOwnProperty,ka=La.toString,ni=li?li.toStringTag:void 0,os=function(i){var r=no.call(i,ni),o=i[ni];try{i[ni]=void 0;var s=!0}catch(h){}var l=ka.call(i);return s&&(r?i[ni]=o:delete i[ni]),l},Ba=Object.prototype.toString,ss=function(i){return Ba.call(i)},Oo=li?li.toStringTag:void 0,Gr=function(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Oo&&Oo in Object(i)?os(i):ss(i)},Nr=function(i){var r=typeof i;return i!=null&&(r=="object"||r=="function")},ja,ro=function(i){if(!Nr(i))return!1;var r=Gr(i);return r=="[object Function]"||r=="[object GeneratorFunction]"||r=="[object AsyncFunction]"||r=="[object Proxy]"},Ys=$r["__core-js_shared__"],Jc=(ja=/[^.]+$/.exec(Ys&&Ys.keys&&Ys.keys.IE_PROTO||""))?"Symbol(src)_1."+ja:"",Js=function(i){return!!Jc&&Jc in i},Ks=Function.prototype.toString,io=function(i){if(i!=null){try{return Ks.call(i)}catch(r){}try{return i+""}catch(r){}}return""},jg=/^\[object .+?Constructor\]$/,cf=Function.prototype,lf=Object.prototype,uf=cf.toString,Fg=lf.hasOwnProperty,Qs=RegExp("^"+uf.call(Fg).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gg=function(i){return!(!Nr(i)||Js(i))&&(ro(i)?Qs:jg).test(io(i))},zg=function(i,r){return i==null?void 0:i[r]},as=function(i,r){var o=zg(i,r);return Gg(o)?o:void 0},ta=as($r,"Map"),Fa=as(Object,"create"),Ug=function(){this.__data__=Fa?Fa(null):{},this.size=0},Vg=function(i){var r=this.has(i)&&delete this.__data__[i];return this.size-=r?1:0,r},hf=Object.prototype.hasOwnProperty,Bu=function(i){var r=this.__data__;if(Fa){var o=r[i];return o==="__lodash_hash_undefined__"?void 0:o}return hf.call(r,i)?r[i]:void 0},Hg=Object.prototype.hasOwnProperty,$g=function(i){var r=this.__data__;return Fa?r[i]!==void 0:Hg.call(r,i)},Wg=function(i,r){var o=this.__data__;return this.size+=this.has(i)?0:1,o[i]=Fa&&r===void 0?"__lodash_hash_undefined__":r,this};function cs(i){var r=-1,o=i==null?0:i.length;for(this.clear();++r<o;){var s=i[r];this.set(s[0],s[1])}}cs.prototype.clear=Ug,cs.prototype.delete=Vg,cs.prototype.get=Bu,cs.prototype.has=$g,cs.prototype.set=Wg;var ff=cs,ju=function(){this.size=0,this.__data__={hash:new ff,map:new(ta||zi),string:new ff}},Kc=function(i){var r=typeof i;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?i!=="__proto__":i===null},Io=function(i,r){var o=i.__data__;return Kc(r)?o[typeof r=="string"?"string":"hash"]:o.map},Qc=function(i){var r=Io(this,i).delete(i);return this.size-=r?1:0,r},Fu=function(i){return Io(this,i).get(i)},Ga=function(i){return Io(this,i).has(i)},tl=function(i,r){var o=Io(this,i),s=o.size;return o.set(i,r),this.size+=o.size==s?0:1,this};function Ti(i){var r=-1,o=i==null?0:i.length;for(this.clear();++r<o;){var s=i[r];this.set(s[0],s[1])}}Ti.prototype.clear=ju,Ti.prototype.delete=Qc,Ti.prototype.get=Fu,Ti.prototype.has=Ga,Ti.prototype.set=tl;var ea=Ti,el=function(i,r){var o=this.__data__;if(o instanceof zi){var s=o.__data__;if(!ta||s.length<199)return s.push([i,r]),this.size=++o.size,this;o=this.__data__=new ea(s)}return o.set(i,r),this.size=o.size,this};function oo(i){var r=this.__data__=new zi(i);this.size=r.size}oo.prototype.clear=sf,oo.prototype.delete=qs,oo.prototype.get=af,oo.prototype.has=ku,oo.prototype.set=el;var so=oo,ls=function(i,r){for(var o=-1,s=i==null?0:i.length;++o<s&&r(i[o],o,i)!==!1;);return i},Mo=function(){try{var i=as(Object,"defineProperty");return i({},"",{}),i}catch(r){}}(),ao=function(i,r,o){r=="__proto__"&&Mo?Mo(i,r,{configurable:!0,enumerable:!0,value:o,writable:!0}):i[r]=o},za=Object.prototype.hasOwnProperty,gi=function(i,r,o){var s=i[r];za.call(i,r)&&di(s,o)&&(o!==void 0||r in i)||ao(i,r,o)},na=function(i,r,o,s){var l=!o;o||(o={});for(var h=-1,g=r.length;++h<g;){var p=r[h],m=s?s(o[p],i[p],p,o,i):void 0;m===void 0&&(m=i[p]),l?ao(o,p,m):gi(o,p,m)}return o},us=function(i,r){for(var o=-1,s=Array(i);++o<i;)s[o]=r(o);return s},Pr=function(i){return i!=null&&typeof i=="object"},Gu=function(i){return Pr(i)&&Gr(i)=="[object Arguments]"},nl=Object.prototype,Xg=nl.hasOwnProperty,Zg=nl.propertyIsEnumerable,ra=Gu(function(){return arguments}())?Gu:function(i){return Pr(i)&&Xg.call(i,"callee")&&!Zg.call(i,"callee")},In=Array.isArray,df=function(){return!1},Ui=Xc(function(i,r){var o=r&&!r.nodeType&&r,s=o&&i&&!i.nodeType&&i,l=s&&s.exports===o?$r.Buffer:void 0,h=(l?l.isBuffer:void 0)||df;i.exports=h}),gf=/^(?:0|[1-9]\d*)$/,co=function(i,r){var o=typeof i;return!!(r=r==null?9007199254740991:r)&&(o=="number"||o!="symbol"&&gf.test(i))&&i>-1&&i%1==0&&i<r},rl=function(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=9007199254740991},jn={};jn["[object Float32Array]"]=jn["[object Float64Array]"]=jn["[object Int8Array]"]=jn["[object Int16Array]"]=jn["[object Int32Array]"]=jn["[object Uint8Array]"]=jn["[object Uint8ClampedArray]"]=jn["[object Uint16Array]"]=jn["[object Uint32Array]"]=!0,jn["[object Arguments]"]=jn["[object Array]"]=jn["[object ArrayBuffer]"]=jn["[object Boolean]"]=jn["[object DataView]"]=jn["[object Date]"]=jn["[object Error]"]=jn["[object Function]"]=jn["[object Map]"]=jn["[object Number]"]=jn["[object Object]"]=jn["[object RegExp]"]=jn["[object Set]"]=jn["[object String]"]=jn["[object WeakMap]"]=!1;var Ci=function(i){return Pr(i)&&rl(i.length)&&!!jn[Gr(i)]},Ua=function(i){return function(r){return i(r)}},pi=Xc(function(i,r){var o=r&&!r.nodeType&&r,s=o&&i&&!i.nodeType&&i,l=s&&s.exports===o&&Yc.process,h=function(){try{var g=s&&s.require&&s.require("util").types;return g||l&&l.binding&&l.binding("util")}catch(p){}}();i.exports=h}),Vi=pi&&pi.isTypedArray,hs=Vi?Ua(Vi):Ci,il=Object.prototype.hasOwnProperty,Va=function(i,r){var o=In(i),s=!o&&ra(i),l=!o&&!s&&Ui(i),h=!o&&!s&&!l&&hs(i),g=o||s||l||h,p=g?us(i.length,String):[],m=p.length;for(var y in i)!r&&!il.call(i,y)||g&&(y=="length"||l&&(y=="offset"||y=="parent")||h&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||co(y,m))||p.push(y);return p},pf=Object.prototype,Er=function(i){var r=i&&i.constructor;return i===(typeof r=="function"&&r.prototype||pf)},lo=function(i,r){return function(o){return i(r(o))}},er=lo(Object.keys,Object),pr=Object.prototype.hasOwnProperty,uo=function(i){if(!Er(i))return er(i);var r=[];for(var o in Object(i))pr.call(i,o)&&o!="constructor"&&r.push(o);return r},ho=function(i){return i!=null&&rl(i.length)&&!ro(i)},fo=function(i){return ho(i)?Va(i):uo(i)},mf=function(i,r){return i&&na(r,fo(r),i)},ol=function(i){var r=[];if(i!=null)for(var o in Object(i))r.push(o);return r},vf=Object.prototype.hasOwnProperty,yf=function(i){if(!Nr(i))return ol(i);var r=Er(i),o=[];for(var s in i)(s!="constructor"||!r&&vf.call(i,s))&&o.push(s);return o},fs=function(i){return ho(i)?Va(i,!0):yf(i)},qg=function(i,r){return i&&na(r,fs(r),i)},zu=Xc(function(i,r){var o=r&&!r.nodeType&&r,s=o&&i&&!i.nodeType&&i,l=s&&s.exports===o?$r.Buffer:void 0,h=l?l.allocUnsafe:void 0;i.exports=function(g,p){if(p)return g.slice();var m=g.length,y=h?h(m):new g.constructor(m);return g.copy(y),y}}),sl=function(i,r){var o=-1,s=i.length;for(r||(r=Array(s));++o<s;)r[o]=i[o];return r},Uu=function(i,r){for(var o=-1,s=i==null?0:i.length,l=0,h=[];++o<s;){var g=i[o];r(g,o,i)&&(h[l++]=g)}return h},mi=function(){return[]},bf=Object.prototype.propertyIsEnumerable,xf=Object.getOwnPropertySymbols,Vu=xf?function(i){return i==null?[]:(i=Object(i),Uu(xf(i),function(r){return bf.call(i,r)}))}:mi,wf=function(i,r){return na(i,Vu(i),r)},Hu=function(i,r){for(var o=-1,s=r.length,l=i.length;++o<s;)i[l+o]=r[o];return i},M=lo(Object.getPrototypeOf,Object),G=Object.getOwnPropertySymbols?function(i){for(var r=[];i;)Hu(r,Vu(i)),i=M(i);return r}:mi,tt=function(i,r){return na(i,G(i),r)},wt=function(i,r,o){var s=r(i);return In(i)?s:Hu(s,o(i))},Dt=function(i){return wt(i,fo,Vu)},xt=function(i){return wt(i,fs,G)},Tt=as($r,"DataView"),$t=as($r,"Promise"),Wt=as($r,"Set"),Kt=as($r,"WeakMap"),Yt=io(Tt),re=io(ta),ce=io($t),Zt=io(Wt),ie=io(Kt),ft=Gr;(Tt&&ft(new Tt(new ArrayBuffer(1)))!="[object DataView]"||ta&&ft(new ta)!="[object Map]"||$t&&ft($t.resolve())!="[object Promise]"||Wt&&ft(new Wt)!="[object Set]"||Kt&&ft(new Kt)!="[object WeakMap]")&&(ft=function(i){var r=Gr(i),o=r=="[object Object]"?i.constructor:void 0,s=o?io(o):"";if(s)switch(s){case Yt:return"[object DataView]";case re:return"[object Map]";case ce:return"[object Promise]";case Zt:return"[object Set]";case ie:return"[object WeakMap]"}return r});var St=ft,ee=Object.prototype.hasOwnProperty,ue=function(i){var r=i.length,o=new i.constructor(r);return r&&typeof i[0]=="string"&&ee.call(i,"index")&&(o.index=i.index,o.input=i.input),o},Ft=$r.Uint8Array,ge=function(i){var r=new i.constructor(i.byteLength);return new Ft(r).set(new Ft(i)),r},Vt=function(i,r){var o=r?ge(i.buffer):i.buffer;return new i.constructor(o,i.byteOffset,i.byteLength)},se=/\w*$/,zt=function(i){var r=new i.constructor(i.source,se.exec(i));return r.lastIndex=i.lastIndex,r},oe=li?li.prototype:void 0,Pe=oe?oe.valueOf:void 0,ze=function(i){return Pe?Object(Pe.call(i)):{}},ae=function(i,r){var o=r?ge(i.buffer):i.buffer;return new i.constructor(o,i.byteOffset,i.length)},ne=function(i,r,o){var s=i.constructor;switch(r){case"[object ArrayBuffer]":return ge(i);case"[object Boolean]":case"[object Date]":return new s(+i);case"[object DataView]":return Vt(i,o);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ae(i,o);case"[object Map]":return new s;case"[object Number]":case"[object String]":return new s(i);case"[object RegExp]":return zt(i);case"[object Set]":return new s;case"[object Symbol]":return ze(i)}},Gt=Object.create,je=function(){function i(){}return function(r){if(!Nr(r))return{};if(Gt)return Gt(r);i.prototype=r;var o=new i;return i.prototype=void 0,o}}(),qe=function(i){return typeof i.constructor!="function"||Er(i)?{}:je(M(i))},we=function(i){return Pr(i)&&St(i)=="[object Map]"},on=pi&&pi.isMap,He=on?Ua(on):we,en=function(i){return Pr(i)&&St(i)=="[object Set]"},yn=pi&&pi.isSet,nr=yn?Ua(yn):en,cn={};cn["[object Arguments]"]=cn["[object Array]"]=cn["[object ArrayBuffer]"]=cn["[object DataView]"]=cn["[object Boolean]"]=cn["[object Date]"]=cn["[object Float32Array]"]=cn["[object Float64Array]"]=cn["[object Int8Array]"]=cn["[object Int16Array]"]=cn["[object Int32Array]"]=cn["[object Map]"]=cn["[object Number]"]=cn["[object Object]"]=cn["[object RegExp]"]=cn["[object Set]"]=cn["[object String]"]=cn["[object Symbol]"]=cn["[object Uint8Array]"]=cn["[object Uint8ClampedArray]"]=cn["[object Uint16Array]"]=cn["[object Uint32Array]"]=!0,cn["[object Error]"]=cn["[object Function]"]=cn["[object WeakMap]"]=!1;var ln=function i(r,o,s,l,h,g){var p,m=1&o,y=2&o,x=4&o;if(s&&(p=h?s(r,l,h,g):s(r)),p!==void 0)return p;if(!Nr(r))return r;var w=In(r);if(w){if(p=ue(r),!m)return sl(r,p)}else{var A=St(r),T=A=="[object Function]"||A=="[object GeneratorFunction]";if(Ui(r))return zu(r,m);if(A=="[object Object]"||A=="[object Arguments]"||T&&!h){if(p=y||T?{}:qe(r),!m)return y?tt(r,qg(p,r)):wf(r,mf(p,r))}else{if(!cn[A])return h?r:{};p=ne(r,A,m)}}g||(g=new so);var O=g.get(r);if(O)return O;g.set(r,p),nr(r)?r.forEach(function(N){p.add(i(N,o,s,N,r,g))}):He(r)&&r.forEach(function(N,P){p.set(P,i(N,o,s,P,r,g))});var I=w?void 0:(x?y?xt:Dt:y?fs:fo)(r);return ls(I||r,function(N,P){I&&(N=r[P=N]),gi(p,P,i(N,o,s,P,r,g))}),p},lr=function(i){return ln(i,4)},Pn=function(i){return function(){return i}},Vn=function(i){return function(r,o,s){for(var l=-1,h=Object(r),g=s(r),p=g.length;p--;){var m=g[i?p:++l];if(o(h[m],m,h)===!1)break}return r}}(),Jn=function(i,r){return i&&Vn(i,r,fo)},Hn=function(i,r){return function(o,s){if(o==null)return o;if(!ho(o))return i(o,s);for(var l=o.length,h=r?l:-1,g=Object(o);(r?h--:++h<l)&&s(g[h],h,g)!==!1;);return o}}(Jn),Gn=function(i){return i},xr=function(i){return typeof i=="function"?i:Gn},$n=function(i,r){return(In(i)?ls:Hn)(i,xr(r))},Ye=$n,_r=function(i,r){var o=[];return Hn(i,function(s,l,h){r(s,l,h)&&o.push(s)}),o},_n=function(i){return this.__data__.set(i,"__lodash_hash_undefined__"),this},Le=function(i){return this.__data__.has(i)};function nn(i){var r=-1,o=i==null?0:i.length;for(this.__data__=new ea;++r<o;)this.add(i[r])}nn.prototype.add=nn.prototype.push=_n,nn.prototype.has=Le;var fn=nn,Kn=function(i,r){for(var o=-1,s=i==null?0:i.length;++o<s;)if(r(i[o],o,i))return!0;return!1},Oi=function(i,r){return i.has(r)},No=function(i,r,o,s,l,h){var g=1&o,p=i.length,m=r.length;if(p!=m&&!(g&&m>p))return!1;var y=h.get(i),x=h.get(r);if(y&&x)return y==r&&x==i;var w=-1,A=!0,T=2&o?new fn:void 0;for(h.set(i,r),h.set(r,i);++w<p;){var O=i[w],I=r[w];if(s)var N=g?s(I,O,w,r,i,h):s(O,I,w,i,r,h);if(N!==void 0){if(N)continue;A=!1;break}if(T){if(!Kn(r,function(P,R){if(!Oi(T,R)&&(O===P||l(O,P,o,s,h)))return T.push(R)})){A=!1;break}}else if(O!==I&&!l(O,I,o,s,h)){A=!1;break}}return h.delete(i),h.delete(r),A},q=function(i){var r=-1,o=Array(i.size);return i.forEach(function(s,l){o[++r]=[l,s]}),o},Et=function(i){var r=-1,o=Array(i.size);return i.forEach(function(s){o[++r]=s}),o},vt=li?li.prototype:void 0,me=vt?vt.valueOf:void 0,an=function(i,r,o,s,l,h,g){switch(o){case"[object DataView]":if(i.byteLength!=r.byteLength||i.byteOffset!=r.byteOffset)return!1;i=i.buffer,r=r.buffer;case"[object ArrayBuffer]":return!(i.byteLength!=r.byteLength||!h(new Ft(i),new Ft(r)));case"[object Boolean]":case"[object Date]":case"[object Number]":return di(+i,+r);case"[object Error]":return i.name==r.name&&i.message==r.message;case"[object RegExp]":case"[object String]":return i==r+"";case"[object Map]":var p=q;case"[object Set]":var m=1&s;if(p||(p=Et),i.size!=r.size&&!m)return!1;var y=g.get(i);if(y)return y==r;s|=2,g.set(i,r);var x=No(p(i),p(r),s,l,h,g);return g.delete(i),x;case"[object Symbol]":if(me)return me.call(i)==me.call(r)}return!1},X=Object.prototype.hasOwnProperty,j=function(i,r,o,s,l,h){var g=1&o,p=Dt(i),m=p.length;if(m!=Dt(r).length&&!g)return!1;for(var y=m;y--;){var x=p[y];if(!(g?x in r:X.call(r,x)))return!1}var w=h.get(i),A=h.get(r);if(w&&A)return w==r&&A==i;var T=!0;h.set(i,r),h.set(r,i);for(var O=g;++y<m;){var I=i[x=p[y]],N=r[x];if(s)var P=g?s(N,I,x,r,i,h):s(I,N,x,i,r,h);if(!(P===void 0?I===N||l(I,N,o,s,h):P)){T=!1;break}O||(O=x=="constructor")}if(T&&!O){var R=i.constructor,k=r.constructor;R==k||!("constructor"in i)||!("constructor"in r)||typeof R=="function"&&R instanceof R&&typeof k=="function"&&k instanceof k||(T=!1)}return h.delete(i),h.delete(r),T},nt=Object.prototype.hasOwnProperty,ht=function(i,r,o,s,l,h){var g=In(i),p=In(r),m=g?"[object Array]":St(i),y=p?"[object Array]":St(r),x=(m=m=="[object Arguments]"?"[object Object]":m)=="[object Object]",w=(y=y=="[object Arguments]"?"[object Object]":y)=="[object Object]",A=m==y;if(A&&Ui(i)){if(!Ui(r))return!1;g=!0,x=!1}if(A&&!x)return h||(h=new so),g||hs(i)?No(i,r,o,s,l,h):an(i,r,m,o,s,l,h);if(!(1&o)){var T=x&&nt.call(i,"__wrapped__"),O=w&&nt.call(r,"__wrapped__");if(T||O){var I=T?i.value():i,N=O?r.value():r;return h||(h=new so),l(I,N,o,s,h)}}return!!A&&(h||(h=new so),j(i,r,o,s,l,h))},gt=function i(r,o,s,l,h){return r===o||(r==null||o==null||!Pr(r)&&!Pr(o)?r!=r&&o!=o:ht(r,o,s,l,i,h))},ot=function(i,r,o,s){var l=o.length,h=l,g=!s;if(i==null)return!h;for(i=Object(i);l--;){var p=o[l];if(g&&p[2]?p[1]!==i[p[0]]:!(p[0]in i))return!1}for(;++l<h;){var m=(p=o[l])[0],y=i[m],x=p[1];if(g&&p[2]){if(y===void 0&&!(m in i))return!1}else{var w=new so;if(s)var A=s(y,x,m,i,r,w);if(!(A===void 0?gt(x,y,3,s,w):A))return!1}}return!0},rt=function(i){return i==i&&!Nr(i)},lt=function(i){for(var r=fo(i),o=r.length;o--;){var s=r[o],l=i[s];r[o]=[s,l,rt(l)]}return r},W=function(i,r){return function(o){return o!=null&&o[i]===r&&(r!==void 0||i in Object(o))}},et=function(i){var r=lt(i);return r.length==1&&r[0][2]?W(r[0][0],r[0][1]):function(o){return o===i||ot(o,i,r)}},z=function(i){return typeof i=="symbol"||Pr(i)&&Gr(i)=="[object Symbol]"},ut=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mt=/^\w*$/,Pt=function(i,r){if(In(i))return!1;var o=typeof i;return!(o!="number"&&o!="symbol"&&o!="boolean"&&i!=null&&!z(i))||mt.test(i)||!ut.test(i)||r!=null&&i in Object(r)};function Rt(i,r){if(typeof i!="function"||r!=null&&typeof r!="function")throw new TypeError("Expected a function");var o=function(){var s=arguments,l=r?r.apply(this,s):s[0],h=o.cache;if(h.has(l))return h.get(l);var g=i.apply(this,s);return o.cache=h.set(l,g)||h,g};return o.cache=new(Rt.Cache||ea),o}Rt.Cache=ea;var Mt=Rt,Qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Oe=/\\(\\)?/g,Je=function(i){var r=Mt(i,function(s){return o.size===500&&o.clear(),s}),o=r.cache;return r}(function(i){var r=[];return i.charCodeAt(0)===46&&r.push(""),i.replace(Qt,function(o,s,l,h){r.push(l?h.replace(Oe,"$1"):s||o)}),r}),ve=function(i,r){for(var o=-1,s=i==null?0:i.length,l=Array(s);++o<s;)l[o]=r(i[o],o,i);return l},ke=li?li.prototype:void 0,$e=ke?ke.toString:void 0,bn=function i(r){if(typeof r=="string")return r;if(In(r))return ve(r,i)+"";if(z(r))return $e?$e.call(r):"";var o=r+"";return o=="0"&&1/r==-1/0?"-0":o},zn=function(i){return i==null?"":bn(i)},Sr=function(i,r){return In(i)?i:Pt(i,r)?[i]:Je(zn(i))},ds=function(i){if(typeof i=="string"||z(i))return i;var r=i+"";return r=="0"&&1/i==-1/0?"-0":r},Wr=function(i,r){for(var o=0,s=(r=Sr(r,i)).length;i!=null&&o<s;)i=i[ds(r[o++])];return o&&o==s?i:void 0},Ef=function(i,r,o){var s=i==null?void 0:Wr(i,r);return s===void 0?o:s},Ii=function(i,r){return i!=null&&r in Object(i)},Ln=function(i,r,o){for(var s=-1,l=(r=Sr(r,i)).length,h=!1;++s<l;){var g=ds(r[s]);if(!(h=i!=null&&o(i,g)))break;i=i[g]}return h||++s!=l?h:!!(l=i==null?0:i.length)&&rl(l)&&co(g,l)&&(In(i)||ra(i))},$u=function(i,r){return i!=null&&Ln(i,r,Ii)},vm=function(i,r){return Pt(i)&&rt(r)?W(ds(i),r):function(o){var s=Ef(o,i);return s===void 0&&s===r?$u(o,i):gt(r,s,3)}},ym=function(i){return function(r){return r==null?void 0:r[i]}},Bv=function(i){return function(r){return Wr(r,i)}},_f=function(i){return Pt(i)?ym(ds(i)):Bv(i)},gs=function(i){return typeof i=="function"?i:i==null?Gn:typeof i=="object"?In(i)?vm(i[0],i[1]):et(i):_f(i)},bm=function(i,r){return(In(i)?Uu:_r)(i,gs(r))},jv=Object.prototype.hasOwnProperty,ur=function(i,r){return i!=null&&jv.call(i,r)},Yg=function(i,r){return i!=null&&Ln(i,r,ur)},Fv=Object.prototype.hasOwnProperty,Gv=function(i){if(i==null)return!0;if(ho(i)&&(In(i)||typeof i=="string"||typeof i.splice=="function"||Ui(i)||hs(i)||ra(i)))return!i.length;var r=St(i);if(r=="[object Map]"||r=="[object Set]")return!i.size;if(Er(i))return!uo(i).length;for(var o in i)if(Fv.call(i,o))return!1;return!0},Jg=function(i){return i===void 0},Kg=function(i,r){var o=-1,s=ho(i)?Array(i.length):[];return Hn(i,function(l,h,g){s[++o]=r(l,h,g)}),s},xm=function(i,r){return(In(i)?ve:Kg)(i,gs(r))},zv=function(i,r,o,s){var l=-1,h=i==null?0:i.length;for(s&&h&&(o=i[++l]);++l<h;)o=r(o,i[l],l,i);return o},Uv=function(i,r,o,s,l){return l(i,function(h,g,p){o=s?(s=!1,h):r(o,h,g,p)}),o},wm=function(i,r,o){var s=In(i)?zv:Uv,l=arguments.length<3;return s(i,gs(r),o,l,Hn)},Qg=function(i){return typeof i=="string"||!In(i)&&Pr(i)&&Gr(i)=="[object String]"},Em=ym("length"),Vv=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),_m=function(i){return Vv.test(i)},Hv="[\\ud800-\\udfff]",tp="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",al="\\ud83c[\\udffb-\\udfff]",ep="[^\\ud800-\\udfff]",Sm="(?:\\ud83c[\\udde6-\\uddff]){2}",Am="[\\ud800-\\udbff][\\udc00-\\udfff]",Tm="(?:"+tp+"|"+al+")?",np="[\\ufe0e\\ufe0f]?"+Tm+("(?:\\u200d(?:"+[ep,Sm,Am].join("|")+")[\\ufe0e\\ufe0f]?"+Tm+")*"),Sf="(?:"+[ep+tp+"?",tp,Sm,Am,Hv].join("|")+")",ia=RegExp(al+"(?="+al+")|"+Sf+np,"g"),rp=function(i){for(var r=ia.lastIndex=0;ia.test(i);)++r;return r},Cm=function(i){return _m(i)?rp(i):Em(i)},$v=function(i){if(i==null)return 0;if(ho(i))return Qg(i)?Cm(i):i.length;var r=St(i);return r=="[object Map]"||r=="[object Set]"?i.size:uo(i).length},vi=function(i,r,o){var s=In(i),l=s||Ui(i)||hs(i);if(r=gs(r),o==null){var h=i&&i.constructor;o=l?s?new h:[]:Nr(i)&&ro(h)?je(M(i)):{}}return(l?ls:Jn)(i,function(g,p,m){return r(o,g,p,m)}),o},Wv=li?li.isConcatSpreadable:void 0,Xv=function(i){return In(i)||ra(i)||!!(Wv&&i&&i[Wv])},ip=function i(r,o,s,l,h){var g=-1,p=r.length;for(s||(s=Xv),h||(h=[]);++g<p;){var m=r[g];o>0&&s(m)?o>1?i(m,o-1,s,l,h):Hu(h,m):l||(h[h.length]=m)}return h},Zv=function(i,r,o){switch(o.length){case 0:return i.call(r);case 1:return i.call(r,o[0]);case 2:return i.call(r,o[0],o[1]);case 3:return i.call(r,o[0],o[1],o[2])}return i.apply(r,o)},Om=Math.max,Im=function(i,r,o){return r=Om(r===void 0?i.length-1:r,0),function(){for(var s=arguments,l=-1,h=Om(s.length-r,0),g=Array(h);++l<h;)g[l]=s[r+l];l=-1;for(var p=Array(r+1);++l<r;)p[l]=s[l];return p[r]=o(g),Zv(i,this,p)}},qv=Mo?function(i,r){return Mo(i,"toString",{configurable:!0,enumerable:!1,value:Pn(r),writable:!0})}:Gn,Yv=Date.now,Mm=function(i){var r=0,o=0;return function(){var s=Yv(),l=16-(s-o);if(o=s,l>0){if(++r>=800)return arguments[0]}else r=0;return i.apply(void 0,arguments)}}(qv),Af=function(i,r){return Mm(Im(i,r,Gn),i+"")},op=function(i,r,o,s){for(var l=i.length,h=o+(s?1:-1);s?h--:++h<l;)if(r(i[h],h,i))return h;return-1},Jv=function(i){return i!=i},Nm=function(i,r,o){for(var s=o-1,l=i.length;++s<l;)if(i[s]===r)return s;return-1},Kv=function(i,r,o){return r==r?Nm(i,r,o):op(i,Jv,o)},Qv=function(i,r){return!!(i!=null&&i.length)&&Kv(i,r,0)>-1},ty=function(i,r,o){for(var s=-1,l=i==null?0:i.length;++s<l;)if(o(r,i[s]))return!0;return!1},ey=function(){},ny=Wt&&1/Et(new Wt([,-0]))[1]==1/0?function(i){return new Wt(i)}:ey,ry=function(i,r,o){var s=-1,l=Qv,h=i.length,g=!0,p=[],m=p;if(o)g=!1,l=ty;else if(h>=200){var y=r?null:ny(i);if(y)return Et(y);g=!1,l=Oi,m=new fn}else m=r?[]:p;t:for(;++s<h;){var x=i[s],w=r?r(x):x;if(x=o||x!==0?x:0,g&&w==w){for(var A=m.length;A--;)if(m[A]===w)continue t;r&&m.push(w),p.push(x)}else l(m,w,o)||(m!==p&&m.push(w),p.push(x))}return p},Pm=function(i){return Pr(i)&&ho(i)},Dm=Af(function(i){return ry(ip(i,1,Pm,!0))}),iy=function(i,r){return ve(r,function(o){return i[o]})},Wu,Rm=function(i){return i==null?[]:iy(i,fo(i))};try{Wu={clone:lr,constant:Pn,each:Ye,filter:bm,has:Yg,isArray:In,isEmpty:Gv,isFunction:ro,isUndefined:Jg,keys:fo,map:xm,reduce:wm,size:$v,transform:vi,union:Dm,values:Rm}}catch(i){}Wu||(Wu=window._);var _e=Wu,sp=Sn;function Sn(i){this._isDirected=!_e.has(i,"directed")||i.directed,this._isMultigraph=!!_e.has(i,"multigraph")&&i.multigraph,this._isCompound=!!_e.has(i,"compound")&&i.compound,this._label=void 0,this._defaultNodeLabelFn=_e.constant(void 0),this._defaultEdgeLabelFn=_e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Lm(i,r){i[r]?i[r]++:i[r]=1}function km(i,r){--i[r]||delete i[r]}function Xu(i,r,o,s){var l=""+r,h=""+o;if(!i&&l>h){var g=l;l=h,h=g}return l+""+h+""+(_e.isUndefined(s)?"\0":s)}function Bm(i,r,o,s){var l=""+r,h=""+o;if(!i&&l>h){var g=l;l=h,h=g}var p={v:l,w:h};return s&&(p.name=s),p}function ap(i,r){return Xu(i,r.v,r.w,r.name)}Sn.prototype._nodeCount=0,Sn.prototype._edgeCount=0,Sn.prototype.isDirected=function(){return this._isDirected},Sn.prototype.isMultigraph=function(){return this._isMultigraph},Sn.prototype.isCompound=function(){return this._isCompound},Sn.prototype.setGraph=function(i){return this._label=i,this},Sn.prototype.graph=function(){return this._label},Sn.prototype.setDefaultNodeLabel=function(i){return _e.isFunction(i)||(i=_e.constant(i)),this._defaultNodeLabelFn=i,this},Sn.prototype.nodeCount=function(){return this._nodeCount},Sn.prototype.nodes=function(){return _e.keys(this._nodes)},Sn.prototype.sources=function(){var i=this;return _e.filter(this.nodes(),function(r){return _e.isEmpty(i._in[r])})},Sn.prototype.sinks=function(){var i=this;return _e.filter(this.nodes(),function(r){return _e.isEmpty(i._out[r])})},Sn.prototype.setNodes=function(i,r){var o=arguments,s=this;return _e.each(i,function(l){o.length>1?s.setNode(l,r):s.setNode(l)}),this},Sn.prototype.setNode=function(i,r){return _e.has(this._nodes,i)?(arguments.length>1&&(this._nodes[i]=r),this):(this._nodes[i]=arguments.length>1?r:this._defaultNodeLabelFn(i),this._isCompound&&(this._parent[i]="\0",this._children[i]={},this._children["\0"][i]=!0),this._in[i]={},this._preds[i]={},this._out[i]={},this._sucs[i]={},++this._nodeCount,this)},Sn.prototype.node=function(i){return this._nodes[i]},Sn.prototype.hasNode=function(i){return _e.has(this._nodes,i)},Sn.prototype.removeNode=function(i){var r=this;if(_e.has(this._nodes,i)){var o=function(s){r.removeEdge(r._edgeObjs[s])};delete this._nodes[i],this._isCompound&&(this._removeFromParentsChildList(i),delete this._parent[i],_e.each(this.children(i),function(s){r.setParent(s)}),delete this._children[i]),_e.each(_e.keys(this._in[i]),o),delete this._in[i],delete this._preds[i],_e.each(_e.keys(this._out[i]),o),delete this._out[i],delete this._sucs[i],--this._nodeCount}return this},Sn.prototype.setParent=function(i,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(_e.isUndefined(r))r="\0";else{for(var o=r+="";!_e.isUndefined(o);o=this.parent(o))if(o===i)throw new Error("Setting "+r+" as parent of "+i+" would create a cycle");this.setNode(r)}return this.setNode(i),this._removeFromParentsChildList(i),this._parent[i]=r,this._children[r][i]=!0,this},Sn.prototype._removeFromParentsChildList=function(i){delete this._children[this._parent[i]][i]},Sn.prototype.parent=function(i){if(this._isCompound){var r=this._parent[i];if(r!=="\0")return r}},Sn.prototype.children=function(i){if(_e.isUndefined(i)&&(i="\0"),this._isCompound){var r=this._children[i];if(r)return _e.keys(r)}else{if(i==="\0")return this.nodes();if(this.hasNode(i))return[]}},Sn.prototype.predecessors=function(i){var r=this._preds[i];if(r)return _e.keys(r)},Sn.prototype.successors=function(i){var r=this._sucs[i];if(r)return _e.keys(r)},Sn.prototype.neighbors=function(i){var r=this.predecessors(i);if(r)return _e.union(r,this.successors(i))},Sn.prototype.isLeaf=function(i){return(this.isDirected()?this.successors(i):this.neighbors(i)).length===0},Sn.prototype.filterNodes=function(i){var r=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});r.setGraph(this.graph());var o=this;_e.each(this._nodes,function(h,g){i(g)&&r.setNode(g,h)}),_e.each(this._edgeObjs,function(h){r.hasNode(h.v)&&r.hasNode(h.w)&&r.setEdge(h,o.edge(h))});var s={};function l(h){var g=o.parent(h);return g===void 0||r.hasNode(g)?(s[h]=g,g):g in s?s[g]:l(g)}return this._isCompound&&_e.each(r.nodes(),function(h){r.setParent(h,l(h))}),r},Sn.prototype.setDefaultEdgeLabel=function(i){return _e.isFunction(i)||(i=_e.constant(i)),this._defaultEdgeLabelFn=i,this},Sn.prototype.edgeCount=function(){return this._edgeCount},Sn.prototype.edges=function(){return _e.values(this._edgeObjs)},Sn.prototype.setPath=function(i,r){var o=this,s=arguments;return _e.reduce(i,function(l,h){return s.length>1?o.setEdge(l,h,r):o.setEdge(l,h),h}),this},Sn.prototype.setEdge=function(){var i,r,o,s,l=!1,h=arguments[0];typeof h=="object"&&h!==null&&"v"in h?(i=h.v,r=h.w,o=h.name,arguments.length===2&&(s=arguments[1],l=!0)):(i=h,r=arguments[1],o=arguments[3],arguments.length>2&&(s=arguments[2],l=!0)),i=""+i,r=""+r,_e.isUndefined(o)||(o=""+o);var g=Xu(this._isDirected,i,r,o);if(_e.has(this._edgeLabels,g))return l&&(this._edgeLabels[g]=s),this;if(!_e.isUndefined(o)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(i),this.setNode(r),this._edgeLabels[g]=l?s:this._defaultEdgeLabelFn(i,r,o);var p=Bm(this._isDirected,i,r,o);return i=p.v,r=p.w,Object.freeze(p),this._edgeObjs[g]=p,Lm(this._preds[r],i),Lm(this._sucs[i],r),this._in[r][g]=p,this._out[i][g]=p,this._edgeCount++,this},Sn.prototype.edge=function(i,r,o){var s=arguments.length===1?ap(this._isDirected,arguments[0]):Xu(this._isDirected,i,r,o);return this._edgeLabels[s]},Sn.prototype.hasEdge=function(i,r,o){var s=arguments.length===1?ap(this._isDirected,arguments[0]):Xu(this._isDirected,i,r,o);return _e.has(this._edgeLabels,s)},Sn.prototype.removeEdge=function(i,r,o){var s=arguments.length===1?ap(this._isDirected,arguments[0]):Xu(this._isDirected,i,r,o),l=this._edgeObjs[s];return l&&(i=l.v,r=l.w,delete this._edgeLabels[s],delete this._edgeObjs[s],km(this._preds[r],i),km(this._sucs[i],r),delete this._in[r][s],delete this._out[i][s],this._edgeCount--),this},Sn.prototype.inEdges=function(i,r){var o=this._in[i];if(o){var s=_e.values(o);return r?_e.filter(s,function(l){return l.v===r}):s}},Sn.prototype.outEdges=function(i,r){var o=this._out[i];if(o){var s=_e.values(o);return r?_e.filter(s,function(l){return l.w===r}):s}},Sn.prototype.nodeEdges=function(i,r){var o=this.inEdges(i,r);if(o)return o.concat(this.outEdges(i,r))};var jm={Graph:sp,version:"2.1.8"},oy={write:function(i){var r={options:{directed:i.isDirected(),multigraph:i.isMultigraph(),compound:i.isCompound()},nodes:sy(i),edges:ay(i)};return _e.isUndefined(i.graph())||(r.value=_e.clone(i.graph())),r},read:function(i){var r=new sp(i.options).setGraph(i.value);return _e.each(i.nodes,function(o){r.setNode(o.v,o.value),o.parent&&r.setParent(o.v,o.parent)}),_e.each(i.edges,function(o){r.setEdge({v:o.v,w:o.w,name:o.name},o.value)}),r}};function sy(i){return _e.map(i.nodes(),function(r){var o=i.node(r),s=i.parent(r),l={v:r};return _e.isUndefined(o)||(l.value=o),_e.isUndefined(s)||(l.parent=s),l})}function ay(i){return _e.map(i.edges(),function(r){var o=i.edge(r),s={v:r.v,w:r.w};return _e.isUndefined(r.name)||(s.name=r.name),_e.isUndefined(o)||(s.value=o),s})}var cy=function(i){var r,o={},s=[];function l(h){_e.has(o,h)||(o[h]=!0,r.push(h),_e.each(i.successors(h),l),_e.each(i.predecessors(h),l))}return _e.each(i.nodes(),function(h){r=[],l(h),r.length&&s.push(r)}),s},Fm=Hi;function Hi(){this._arr=[],this._keyIndices={}}Hi.prototype.size=function(){return this._arr.length},Hi.prototype.keys=function(){return this._arr.map(function(i){return i.key})},Hi.prototype.has=function(i){return _e.has(this._keyIndices,i)},Hi.prototype.priority=function(i){var r=this._keyIndices[i];if(r!==void 0)return this._arr[r].priority},Hi.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},Hi.prototype.add=function(i,r){var o=this._keyIndices;if(i=String(i),!_e.has(o,i)){var s=this._arr,l=s.length;return o[i]=l,s.push({key:i,priority:r}),this._decrease(l),!0}return!1},Hi.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var i=this._arr.pop();return delete this._keyIndices[i.key],this._heapify(0),i.key},Hi.prototype.decrease=function(i,r){var o=this._keyIndices[i];if(r>this._arr[o].priority)throw new Error("New priority is greater than current priority. Key: "+i+" Old: "+this._arr[o].priority+" New: "+r);this._arr[o].priority=r,this._decrease(o)},Hi.prototype._heapify=function(i){var r=this._arr,o=2*i,s=o+1,l=i;o<r.length&&(l=r[o].priority<r[l].priority?o:l,s<r.length&&(l=r[s].priority<r[l].priority?s:l),l!==i&&(this._swap(i,l),this._heapify(l)))},Hi.prototype._decrease=function(i){for(var r,o=this._arr,s=o[i].priority;i!==0&&!(o[r=i>>1].priority<s);)this._swap(i,r),i=r},Hi.prototype._swap=function(i,r){var o=this._arr,s=this._keyIndices,l=o[i],h=o[r];o[i]=h,o[r]=l,s[h.key]=i,s[l.key]=r};var Gm=function(i,r,o,s){return function(l,h,g,p){var m,y,x={},w=new Fm,A=function(T){var O=T.v!==m?T.v:T.w,I=x[O],N=g(T),P=y.distance+N;if(N<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+T+" Weight: "+N);P<I.distance&&(I.distance=P,I.predecessor=m,w.decrease(O,P))};for(l.nodes().forEach(function(T){var O=T===h?0:Number.POSITIVE_INFINITY;x[T]={distance:O},w.add(T,O)});w.size()>0&&(m=w.removeMin(),(y=x[m]).distance!==Number.POSITIVE_INFINITY);)p(m).forEach(A);return x}(i,String(r),o||ly,s||function(l){return i.outEdges(l)})},ly=_e.constant(1),uy=function(i,r,o){return _e.transform(i.nodes(),function(s,l){s[l]=Gm(i,l,r,o)},{})},cp=function(i){var r=0,o=[],s={},l=[];function h(g){var p=s[g]={onStack:!0,lowlink:r,index:r++};if(o.push(g),i.successors(g).forEach(function(x){_e.has(s,x)?s[x].onStack&&(p.lowlink=Math.min(p.lowlink,s[x].index)):(h(x),p.lowlink=Math.min(p.lowlink,s[x].lowlink))}),p.lowlink===p.index){var m,y=[];do m=o.pop(),s[m].onStack=!1,y.push(m);while(g!==m);l.push(y)}}return i.nodes().forEach(function(g){_e.has(s,g)||h(g)}),l},hy=function(i){return _e.filter(cp(i),function(r){return r.length>1||r.length===1&&i.hasEdge(r[0],r[0])})},fy=function(i,r,o){return function(s,l,h){var g={},p=s.nodes();return p.forEach(function(m){g[m]={},g[m][m]={distance:0},p.forEach(function(y){m!==y&&(g[m][y]={distance:Number.POSITIVE_INFINITY})}),h(m).forEach(function(y){var x=y.v===m?y.w:y.v,w=l(y);g[m][x]={distance:w,predecessor:m}})}),p.forEach(function(m){var y=g[m];p.forEach(function(x){var w=g[x];p.forEach(function(A){var T=w[m],O=y[A],I=w[A],N=T.distance+O.distance;N<I.distance&&(I.distance=N,I.predecessor=O.predecessor)})})}),g}(i,r||dy,o||function(s){return i.outEdges(s)})},dy=_e.constant(1),Tf=zm;function zm(i){var r={},o={},s=[];if(_e.each(i.sinks(),function l(h){if(_e.has(o,h))throw new Cf;_e.has(r,h)||(o[h]=!0,r[h]=!0,_e.each(i.predecessors(h),l),delete o[h],s.push(h))}),_e.size(r)!==i.nodeCount())throw new Cf;return s}function Cf(){}zm.CycleException=Cf,Cf.prototype=new Error;var Um=function(i,r,o){_e.isArray(r)||(r=[r]);var s=(i.isDirected()?i.successors:i.neighbors).bind(i),l=[],h={};return _e.each(r,function(g){if(!i.hasNode(g))throw new Error("Graph does not have node: "+g);Vm(i,g,o==="post",h,s,l)}),l};function Vm(i,r,o,s,l,h){_e.has(s,r)||(s[r]=!0,o||h.push(r),_e.each(l(r),function(g){Vm(i,g,o,s,l,h)}),o&&h.push(r))}var Of,gy={Graph:jm.Graph,json:oy,alg:{components:cy,dijkstra:Gm,dijkstraAll:uy,findCycles:hy,floydWarshall:fy,isAcyclic:function(i){try{Tf(i)}catch(r){if(r instanceof Tf.CycleException)return!1;throw r}return!0},postorder:function(i,r){return Um(i,r,"post")},preorder:function(i,r){return Um(i,r,"pre")},prim:function(i,r){var o,s=new sp,l={},h=new Fm;function g(m){var y=m.v===o?m.w:m.v,x=h.priority(y);if(x!==void 0){var w=r(m);w<x&&(l[y]=o,h.decrease(y,w))}}if(i.nodeCount()===0)return s;_e.each(i.nodes(),function(m){h.add(m,Number.POSITIVE_INFINITY),s.setNode(m)}),h.decrease(i.nodes()[0],0);for(var p=!1;h.size()>0;){if(o=h.removeMin(),_e.has(l,o))s.setEdge(o,l[o]);else{if(p)throw new Error("Input graph is not connected: "+i);p=!0}i.nodeEdges(o).forEach(g)}return s},tarjan:cp,topsort:Tf},version:jm.version};try{Of=gy}catch(i){}Of||(Of=window.graphlib);var go=Of,py=function(i){return ln(i,5)},Zu=function(i,r,o){if(!Nr(o))return!1;var s=typeof r;return!!(s=="number"?ho(o)&&co(r,o.length):s=="string"&&r in o)&&di(o[r],i)},Hm=Object.prototype,my=Hm.hasOwnProperty,vy=Af(function(i,r){i=Object(i);var o=-1,s=r.length,l=s>2?r[2]:void 0;for(l&&Zu(r[0],r[1],l)&&(s=1);++o<s;)for(var h=r[o],g=fs(h),p=-1,m=g.length;++p<m;){var y=g[p],x=i[y];(x===void 0||di(x,Hm[y])&&!my.call(i,y))&&(i[y]=h[y])}return i}),yy=function(i){return function(r,o,s){var l=Object(r);if(!ho(r)){var h=gs(o);r=fo(r),o=function(p){return h(l[p],p,l)}}var g=i(r,o,s);return g>-1?l[h?r[g]:g]:void 0}},by=/^\s+|\s+$/g,xy=/^[-+]0x[0-9a-f]+$/i,lp=/^0b[01]+$/i,wy=/^0o[0-7]+$/i,Ey=parseInt,_y=function(i){if(typeof i=="number")return i;if(z(i))return NaN;if(Nr(i)){var r=typeof i.valueOf=="function"?i.valueOf():i;i=Nr(r)?r+"":r}if(typeof i!="string")return i===0?i:+i;i=i.replace(by,"");var o=lp.test(i);return o||wy.test(i)?Ey(i.slice(2),o?2:8):xy.test(i)?NaN:+i},If=function(i){return i?(i=_y(i))===1/0||i===-1/0?17976931348623157e292*(i<0?-1:1):i==i?i:0:i===0?i:0},Sy=function(i){var r=If(i),o=r%1;return r==r?o?r-o:r:0},zx=Math.max,Ay=yy(function(i,r,o){var s=i==null?0:i.length;if(!s)return-1;var l=o==null?0:Sy(o);return l<0&&(l=zx(s+l,0)),op(i,gs(r),l)}),up=function(i){return i!=null&&i.length?ip(i,1):[]},Ty=function(i,r){return i==null?i:Vn(i,xr(r),fs)},Cy=function(i){var r=i==null?0:i.length;return r?i[r-1]:void 0},Oy=function(i,r){var o={};return r=gs(r),Jn(i,function(s,l,h){ao(o,l,r(s,l,h))}),o},hp=function(i,r,o){for(var s=-1,l=i.length;++s<l;){var h=i[s],g=r(h);if(g!=null&&(p===void 0?g==g&&!z(g):o(g,p)))var p=g,m=h}return m},Iy=function(i,r){return i>r},My=function(i){return i&&i.length?hp(i,Gn,Iy):void 0},fp=function(i,r,o){(o!==void 0&&!di(i[r],o)||o===void 0&&!(r in i))&&ao(i,r,o)},Ny=Function.prototype,Py=Object.prototype,$m=Ny.toString,Dy=Py.hasOwnProperty,Ry=$m.call(Object),Ly=function(i){if(!Pr(i)||Gr(i)!="[object Object]")return!1;var r=M(i);if(r===null)return!0;var o=Dy.call(r,"constructor")&&r.constructor;return typeof o=="function"&&o instanceof o&&$m.call(o)==Ry},dp=function(i,r){if((r!=="constructor"||typeof i[r]!="function")&&r!="__proto__")return i[r]},ky=function(i){return na(i,fs(i))},By=function(i,r,o,s,l,h,g){var p=dp(i,o),m=dp(r,o),y=g.get(m);if(y)fp(i,o,y);else{var x=h?h(p,m,o+"",i,r,g):void 0,w=x===void 0;if(w){var A=In(m),T=!A&&Ui(m),O=!A&&!T&&hs(m);x=m,A||T||O?In(p)?x=p:Pm(p)?x=sl(p):T?(w=!1,x=zu(m,!0)):O?(w=!1,x=ae(m,!0)):x=[]:Ly(m)||ra(m)?(x=p,ra(p)?x=ky(p):Nr(p)&&!ro(p)||(x=qe(m))):w=!1}w&&(g.set(m,x),l(x,m,s,h,g),g.delete(m)),fp(i,o,x)}},jy=function i(r,o,s,l,h){r!==o&&Vn(o,function(g,p){if(h||(h=new so),Nr(g))By(r,o,p,s,i,l,h);else{var m=l?l(dp(r,p),g,p+"",r,o,h):void 0;m===void 0&&(m=g),fp(r,p,m)}},fs)},Fy=function(i){return Af(function(r,o){var s=-1,l=o.length,h=l>1?o[l-1]:void 0,g=l>2?o[2]:void 0;for(h=i.length>3&&typeof h=="function"?(l--,h):void 0,g&&Zu(o[0],o[1],g)&&(h=l<3?void 0:h,l=1),r=Object(r);++s<l;){var p=o[s];p&&i(r,p,s,h)}return r})}(function(i,r,o){jy(i,r,o)}),Wm=function(i,r){return i<r},Gy=function(i){return i&&i.length?hp(i,Gn,Wm):void 0},zy=function(i,r){return i&&i.length?hp(i,gs(r),Wm):void 0},Xm=function(){return $r.Date.now()},Uy=function(i,r,o,s){if(!Nr(i))return i;for(var l=-1,h=(r=Sr(r,i)).length,g=h-1,p=i;p!=null&&++l<h;){var m=ds(r[l]),y=o;if(m==="__proto__"||m==="constructor"||m==="prototype")return i;if(l!=g){var x=p[m];(y=s?s(x,m,p):void 0)===void 0&&(y=Nr(x)?x:co(r[l+1])?[]:{})}gi(p,m,y),p=p[m]}return i},Vy=function(i,r,o){for(var s=-1,l=r.length,h={};++s<l;){var g=r[s],p=Wr(i,g);o(p,g)&&Uy(h,Sr(g,i),p)}return h},Hy=function(i,r){return Vy(i,r,function(o,s){return $u(i,s)})},$y=function(i){return Mm(Im(i,void 0,up),i+"")}(function(i,r){return i==null?{}:Hy(i,r)}),Wy=Math.ceil,Xy=Math.max,Zy=function(i,r,o,s){for(var l=-1,h=Xy(Wy((r-i)/(o||1)),0),g=Array(h);h--;)g[s?h:++l]=i,i+=o;return g},qy=function(i){return function(r,o,s){return s&&typeof s!="number"&&Zu(r,o,s)&&(o=s=void 0),r=If(r),o===void 0?(o=r,r=0):o=If(o),s=s===void 0?r<o?1:-1:If(s),Zy(r,o,s,i)}}(),Yy=function(i,r){var o=i.length;for(i.sort(r);o--;)i[o]=i[o].value;return i},Jy=function(i,r){if(i!==r){var o=i!==void 0,s=i===null,l=i==i,h=z(i),g=r!==void 0,p=r===null,m=r==r,y=z(r);if(!p&&!y&&!h&&i>r||h&&g&&m&&!p&&!y||s&&g&&m||!o&&m||!l)return 1;if(!s&&!h&&!y&&i<r||y&&o&&l&&!s&&!h||p&&o&&l||!g&&l||!m)return-1}return 0},Ky=function(i,r,o){for(var s=-1,l=i.criteria,h=r.criteria,g=l.length,p=o.length;++s<g;){var m=Jy(l[s],h[s]);if(m)return s>=p?m:m*(o[s]=="desc"?-1:1)}return i.index-r.index},Qy=function(i,r,o){r=r.length?ve(r,function(h){return In(h)?function(g){return Wr(g,h.length===1?h[0]:h)}:h}):[Gn];var s=-1;r=ve(r,Ua(gs));var l=Kg(i,function(h,g,p){return{criteria:ve(r,function(m){return m(h)}),index:++s,value:h}});return Yy(l,function(h,g){return Ky(h,g,o)})},tb=Af(function(i,r){if(i==null)return[];var o=r.length;return o>1&&Zu(i,r[0],r[1])?r=[]:o>2&&Zu(r[0],r[1],r[2])&&(r=[r[0]]),Qy(i,ip(r,1),[])}),Ux=0,eb=function(i){var r=++Ux;return zn(i)+r},nb=function(i,r,o){for(var s=-1,l=i.length,h=r.length,g={};++s<l;){var p=s<h?r[s]:void 0;o(g,i[s],p)}return g},Mf,rb=function(i,r){return nb(i||[],r||[],gi)};try{Mf={cloneDeep:py,constant:Pn,defaults:vy,each:Ye,filter:bm,find:Ay,flatten:up,forEach:$n,forIn:Ty,has:Yg,isUndefined:Jg,last:Cy,map:xm,mapValues:Oy,max:My,merge:Fy,min:Gy,minBy:zy,now:Xm,pick:$y,range:qy,reduce:wm,sortBy:tb,uniqueId:eb,values:Rm,zipObject:rb}}catch(i){}Mf||(Mf=window._);var it=Mf,ib=Nf;function Nf(){var i={};i._next=i._prev=i,this._sentinel=i}function Zm(i){i._prev._next=i._next,i._next._prev=i._prev,delete i._next,delete i._prev}function ob(i,r){if(i!=="_next"&&i!=="_prev")return r}Nf.prototype.dequeue=function(){var i=this._sentinel,r=i._prev;if(r!==i)return Zm(r),r},Nf.prototype.enqueue=function(i){var r=this._sentinel;i._prev&&i._next&&Zm(i),i._next=r._next,r._next._prev=i,r._next=i,i._prev=r},Nf.prototype.toString=function(){for(var i=[],r=this._sentinel,o=r._prev;o!==r;)i.push(JSON.stringify(o,ob)),o=o._prev;return"["+i.join(", ")+"]"};var sb=go.Graph,ab=function(i,r){if(i.nodeCount()<=1)return[];var o=function(l,h){var g=new sb,p=0,m=0;it.forEach(l.nodes(),function(w){g.setNode(w,{v:w,in:0,out:0})}),it.forEach(l.edges(),function(w){var A=g.edge(w.v,w.w)||0,T=h(w),O=A+T;g.setEdge(w.v,w.w,O),m=Math.max(m,g.node(w.v).out+=T),p=Math.max(p,g.node(w.w).in+=T)});var y=it.range(m+p+3).map(function(){return new ib}),x=p+1;return it.forEach(g.nodes(),function(w){pp(y,x,g.node(w))}),{graph:g,buckets:y,zeroIdx:x}}(i,r||cb),s=function(l,h,g){for(var p,m=[],y=h[h.length-1],x=h[0];l.nodeCount();){for(;p=x.dequeue();)gp(l,h,g,p);for(;p=y.dequeue();)gp(l,h,g,p);if(l.nodeCount()){for(var w=h.length-2;w>0;--w)if(p=h[w].dequeue()){m=m.concat(gp(l,h,g,p,!0));break}}}return m}(o.graph,o.buckets,o.zeroIdx);return it.flatten(it.map(s,function(l){return i.outEdges(l.v,l.w)}),!0)},cb=it.constant(1);function gp(i,r,o,s,l){var h=l?[]:void 0;return it.forEach(i.inEdges(s.v),function(g){var p=i.edge(g),m=i.node(g.v);l&&h.push({v:g.v,w:g.w}),m.out-=p,pp(r,o,m)}),it.forEach(i.outEdges(s.v),function(g){var p=i.edge(g),m=g.w,y=i.node(m);y.in-=p,pp(r,o,y)}),i.removeNode(s.v),h}function pp(i,r,o){o.out?o.in?i[o.out-o.in+r].enqueue(o):i[i.length-1].enqueue(o):i[0].enqueue(o)}var qm={run:function(i){var r=i.graph().acyclicer==="greedy"?ab(i,function(o){return function(s){return o.edge(s).weight}}(i)):function(o){var s=[],l={},h={};function g(p){it.has(h,p)||(h[p]=!0,l[p]=!0,it.forEach(o.outEdges(p),function(m){it.has(l,m.w)?s.push(m):g(m.w)}),delete l[p])}return it.forEach(o.nodes(),g),s}(i);it.forEach(r,function(o){var s=i.edge(o);i.removeEdge(o),s.forwardName=o.name,s.reversed=!0,i.setEdge(o.w,o.v,s,it.uniqueId("rev"))})},undo:function(i){it.forEach(i.edges(),function(r){var o=i.edge(r);if(o.reversed){i.removeEdge(r);var s=o.forwardName;delete o.reversed,delete o.forwardName,i.setEdge(r.w,r.v,o,s)}})}},Ym=go.Graph,zr={addDummyNode:Jm,simplify:function(i){var r=new Ym().setGraph(i.graph());return it.forEach(i.nodes(),function(o){r.setNode(o,i.node(o))}),it.forEach(i.edges(),function(o){var s=r.edge(o.v,o.w)||{weight:0,minlen:1},l=i.edge(o);r.setEdge(o.v,o.w,{weight:s.weight+l.weight,minlen:Math.max(s.minlen,l.minlen)})}),r},asNonCompoundGraph:function(i){var r=new Ym({multigraph:i.isMultigraph()}).setGraph(i.graph());return it.forEach(i.nodes(),function(o){i.children(o).length||r.setNode(o,i.node(o))}),it.forEach(i.edges(),function(o){r.setEdge(o,i.edge(o))}),r},successorWeights:function(i){var r=it.map(i.nodes(),function(o){var s={};return it.forEach(i.outEdges(o),function(l){s[l.w]=(s[l.w]||0)+i.edge(l).weight}),s});return it.zipObject(i.nodes(),r)},predecessorWeights:function(i){var r=it.map(i.nodes(),function(o){var s={};return it.forEach(i.inEdges(o),function(l){s[l.v]=(s[l.v]||0)+i.edge(l).weight}),s});return it.zipObject(i.nodes(),r)},intersectRect:function(i,r){var o,s,l=i.x,h=i.y,g=r.x-l,p=r.y-h,m=i.width/2,y=i.height/2;if(!g&&!p)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(p)*m>Math.abs(g)*y?(p<0&&(y=-y),o=y*g/p,s=y):(g<0&&(m=-m),o=m,s=m*p/g),{x:l+o,y:h+s}},buildLayerMatrix:function(i){var r=it.map(it.range(Km(i)+1),function(){return[]});return it.forEach(i.nodes(),function(o){var s=i.node(o),l=s.rank;it.isUndefined(l)||(r[l][s.order]=o)}),r},normalizeRanks:function(i){var r=it.min(it.map(i.nodes(),function(o){return i.node(o).rank}));it.forEach(i.nodes(),function(o){var s=i.node(o);it.has(s,"rank")&&(s.rank-=r)})},removeEmptyRanks:function(i){var r=it.min(it.map(i.nodes(),function(h){return i.node(h).rank})),o=[];it.forEach(i.nodes(),function(h){var g=i.node(h).rank-r;o[g]||(o[g]=[]),o[g].push(h)});var s=0,l=i.graph().nodeRankFactor;it.forEach(o,function(h,g){it.isUndefined(h)&&g%l!=0?--s:s&&it.forEach(h,function(p){i.node(p).rank+=s})})},addBorderNode:function(i,r,o,s){var l={width:0,height:0};return arguments.length>=4&&(l.rank=o,l.order=s),Jm(i,"border",l,r)},maxRank:Km,partition:function(i,r){var o={lhs:[],rhs:[]};return it.forEach(i,function(s){r(s)?o.lhs.push(s):o.rhs.push(s)}),o},time:function(i,r){var o=it.now();try{return r()}finally{console.log(i+" time: "+(it.now()-o)+"ms")}},notime:function(i,r){return r()}};function Jm(i,r,o,s){var l;do l=it.uniqueId(s);while(i.hasNode(l));return o.dummy=r,i.setNode(l,o),l}function Km(i){return it.max(it.map(i.nodes(),function(r){var o=i.node(r).rank;if(!it.isUndefined(o))return o}))}var Qm={run:function(i){i.graph().dummyChains=[],it.forEach(i.edges(),function(r){(function(o,s){var l,h,g,p=s.v,m=o.node(p).rank,y=s.w,x=o.node(y).rank,w=s.name,A=o.edge(s),T=A.labelRank;if(x!==m+1){for(o.removeEdge(s),g=0,++m;m<x;++g,++m)A.points=[],h={width:0,height:0,edgeLabel:A,edgeObj:s,rank:m},l=zr.addDummyNode(o,"edge",h,"_d"),m===T&&(h.width=A.width,h.height=A.height,h.dummy="edge-label",h.labelpos=A.labelpos),o.setEdge(p,l,{weight:A.weight},w),g===0&&o.graph().dummyChains.push(l),p=l;o.setEdge(p,y,{weight:A.weight},w)}})(i,r)})},undo:function(i){it.forEach(i.graph().dummyChains,function(r){var o,s=i.node(r),l=s.edgeLabel;for(i.setEdge(s.edgeObj,l);s.dummy;)o=i.successors(r)[0],i.removeNode(r),l.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(l.x=s.x,l.y=s.y,l.width=s.width,l.height=s.height),r=o,s=i.node(r)})}},t0=function(i){var r={};it.forEach(i.sources(),function o(s){var l=i.node(s);if(it.has(r,s))return l.rank;r[s]=!0;var h=it.min(it.map(i.outEdges(s),function(g){return o(g.w)-i.edge(g).minlen}));return h!==Number.POSITIVE_INFINITY&&h!=null||(h=0),l.rank=h})},e0=function(i,r){return i.node(r.w).rank-i.node(r.v).rank-i.edge(r).minlen},n0=go.Graph,Pf=e0,r0=function(i){var r,o,s=new n0({directed:!1}),l=i.nodes()[0],h=i.nodeCount();for(s.setNode(l,{});lb(s,i)<h;)r=ub(s,i),o=s.hasNode(r.v)?Pf(i,r):-Pf(i,r),i0(s,i,o);return s};function lb(i,r){return it.forEach(i.nodes(),function o(s){it.forEach(r.nodeEdges(s),function(l){var h=l.v,g=s===h?l.w:h;i.hasNode(g)||Pf(r,l)||(i.setNode(g,{}),i.setEdge(s,g,{}),o(g))})}),i.nodeCount()}function ub(i,r){return it.minBy(r.edges(),function(o){if(i.hasNode(o.v)!==i.hasNode(o.w))return Pf(r,o)})}function i0(i,r,o){it.forEach(i.nodes(),function(s){r.node(s).rank+=o})}var o0=e0,hb=t0,fb=go.alg.preorder,db=go.alg.postorder,gb=zr.simplify,s0=Ha;function Ha(i){i=gb(i),hb(i);var r,o=r0(i);for(Rf(o),Df(o,i);r=vp(o);)yp(o,i,r,c0(o,i,r))}function Df(i,r){var o=db(i,i.nodes());o=o.slice(0,o.length-1),it.forEach(o,function(s){(function(l,h,g){var p=l.node(g).parent;l.edge(g,p).cutvalue=mp(l,h,g)})(i,r,s)})}function mp(i,r,o){var s=i.node(o).parent,l=!0,h=r.edge(o,s),g=0;return h||(l=!1,h=r.edge(s,o)),g=h.weight,it.forEach(r.nodeEdges(o),function(p){var m,y,x=p.v===o,w=x?p.w:p.v;if(w!==s){var A=x===l,T=r.edge(p).weight;if(g+=A?T:-T,m=o,y=w,i.hasEdge(m,y)){var O=i.edge(o,w).cutvalue;g+=A?-O:O}}}),g}function Rf(i,r){arguments.length<2&&(r=i.nodes()[0]),a0(i,{},1,r)}function a0(i,r,o,s,l){var h=o,g=i.node(s);return r[s]=!0,it.forEach(i.neighbors(s),function(p){it.has(r,p)||(o=a0(i,r,o,p,s))}),g.low=h,g.lim=o++,l?g.parent=l:delete g.parent,o}function vp(i){return it.find(i.edges(),function(r){return i.edge(r).cutvalue<0})}function c0(i,r,o){var s=o.v,l=o.w;r.hasEdge(s,l)||(s=o.w,l=o.v);var h=i.node(s),g=i.node(l),p=h,m=!1;h.lim>g.lim&&(p=g,m=!0);var y=it.filter(r.edges(),function(x){return m===bp(i,i.node(x.v),p)&&m!==bp(i,i.node(x.w),p)});return it.minBy(y,function(x){return o0(r,x)})}function yp(i,r,o,s){var l=o.v,h=o.w;i.removeEdge(l,h),i.setEdge(s.v,s.w,{}),Rf(i),Df(i,r),function(g,p){var m=it.find(g.nodes(),function(x){return!p.node(x).parent}),y=fb(g,m);y=y.slice(1),it.forEach(y,function(x){var w=g.node(x).parent,A=p.edge(x,w),T=!1;A||(A=p.edge(w,x),T=!0),p.node(x).rank=p.node(w).rank+(T?A.minlen:-A.minlen)})}(i,r)}function bp(i,r,o){return o.low<=r.lim&&r.lim<=o.lim}Ha.initLowLimValues=Rf,Ha.initCutValues=Df,Ha.calcCutValue=mp,Ha.leaveEdge=vp,Ha.enterEdge=c0,Ha.exchangeEdges=yp;var l0=t0,pb=function(i){switch(i.graph().ranker){case"network-simplex":xp(i);break;case"tight-tree":(function(r){l0(r),r0(r)})(i);break;case"longest-path":mb(i);break;default:xp(i)}},mb=l0;function xp(i){s0(i)}var u0=function(i){var r=function(o){var s={},l=0;function h(g){var p=l;it.forEach(o.children(g),h),s[g]={low:p,lim:l++}}return it.forEach(o.children(),h),s}(i);it.forEach(i.graph().dummyChains,function(o){for(var s=i.node(o),l=s.edgeObj,h=function(w,A,T,O){var I,N,P=[],R=[],k=Math.min(A[T].low,A[O].low),U=Math.max(A[T].lim,A[O].lim);I=T;do I=w.parent(I),P.push(I);while(I&&(A[I].low>k||U>A[I].lim));for(N=I,I=O;(I=w.parent(I))!==N;)R.push(I);return{path:P.concat(R.reverse()),lca:N}}(i,r,l.v,l.w),g=h.path,p=h.lca,m=0,y=g[m],x=!0;o!==l.w;){if(s=i.node(o),x){for(;(y=g[m])!==p&&i.node(y).maxRank<s.rank;)m++;y===p&&(x=!1)}if(!x){for(;m<g.length-1&&i.node(y=g[m+1]).minRank<=s.rank;)m++;y=g[m]}i.setParent(o,y),o=i.successors(o)[0]}})},$a={run:function(i){var r=zr.addDummyNode(i,"root",{},"_root"),o=function(g){var p={};function m(y,x){var w=g.children(y);w&&w.length&&it.forEach(w,function(A){m(A,x+1)}),p[y]=x}return it.forEach(g.children(),function(y){m(y,1)}),p}(i),s=it.max(it.values(o))-1,l=2*s+1;i.graph().nestingRoot=r,it.forEach(i.edges(),function(g){i.edge(g).minlen*=l});var h=function(g){return it.reduce(g.edges(),function(p,m){return p+g.edge(m).weight},0)}(i)+1;it.forEach(i.children(),function(g){h0(i,r,l,h,s,o,g)}),i.graph().nodeRankFactor=l},cleanup:function(i){var r=i.graph();i.removeNode(r.nestingRoot),delete r.nestingRoot,it.forEach(i.edges(),function(o){i.edge(o).nestingEdge&&i.removeEdge(o)})}};function h0(i,r,o,s,l,h,g){var p=i.children(g);if(p.length){var m=zr.addBorderNode(i,"_bt"),y=zr.addBorderNode(i,"_bb"),x=i.node(g);i.setParent(m,g),x.borderTop=m,i.setParent(y,g),x.borderBottom=y,it.forEach(p,function(w){h0(i,r,o,s,l,h,w);var A=i.node(w),T=A.borderTop?A.borderTop:w,O=A.borderBottom?A.borderBottom:w,I=A.borderTop?s:2*s,N=T!==O?1:l-h[g]+1;i.setEdge(m,T,{weight:I,minlen:N,nestingEdge:!0}),i.setEdge(O,y,{weight:I,minlen:N,nestingEdge:!0})}),i.parent(g)||i.setEdge(r,m,{weight:0,minlen:l+h[g]})}else g!==r&&i.setEdge(r,g,{weight:0,minlen:o})}var f0=function(i){it.forEach(i.children(),function r(o){var s=i.children(o),l=i.node(o);if(s.length&&it.forEach(s,r),it.has(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(var h=l.minRank,g=l.maxRank+1;h<g;++h)d0(i,"borderLeft","_bl",o,l,h),d0(i,"borderRight","_br",o,l,h)}})};function d0(i,r,o,s,l,h){var g={width:0,height:0,rank:h,borderType:r},p=l[r][h-1],m=zr.addDummyNode(i,"border",g,o);l[r][h]=m,i.setParent(m,s),p&&i.setEdge(p,m,{weight:1})}var wp={adjust:function(i){var r=i.graph().rankdir.toLowerCase();r!=="lr"&&r!=="rl"||Ep(i)},undo:function(i){var r=i.graph().rankdir.toLowerCase();r!=="bt"&&r!=="rl"||function(o){it.forEach(o.nodes(),function(s){Lf(o.node(s))}),it.forEach(o.edges(),function(s){var l=o.edge(s);it.forEach(l.points,Lf),it.has(l,"y")&&Lf(l)})}(i),r!=="lr"&&r!=="rl"||(function(o){it.forEach(o.nodes(),function(s){Sp(o.node(s))}),it.forEach(o.edges(),function(s){var l=o.edge(s);it.forEach(l.points,Sp),it.has(l,"x")&&Sp(l)})}(i),Ep(i))}};function Ep(i){it.forEach(i.nodes(),function(r){_p(i.node(r))}),it.forEach(i.edges(),function(r){_p(i.edge(r))})}function _p(i){var r=i.width;i.width=i.height,i.height=r}function Lf(i){i.y=-i.y}function Sp(i){var r=i.x;i.x=i.y,i.y=r}var vb=function(i){var r={},o=it.filter(i.nodes(),function(p){return!i.children(p).length}),s=it.max(it.map(o,function(p){return i.node(p).rank})),l=it.map(it.range(s+1),function(){return[]});function h(p){if(!it.has(r,p)){r[p]=!0;var m=i.node(p);l[m.rank].push(p),it.forEach(i.successors(p),h)}}var g=it.sortBy(o,function(p){return i.node(p).rank});return it.forEach(g,h),l},yb=function(i,r){for(var o=0,s=1;s<r.length;++s)o+=bb(i,r[s-1],r[s]);return o};function bb(i,r,o){for(var s=it.zipObject(o,it.map(o,function(y,x){return x})),l=it.flatten(it.map(r,function(y){return it.sortBy(it.map(i.outEdges(y),function(x){return{pos:s[x.w],weight:i.edge(x).weight}}),"pos")}),!0),h=1;h<o.length;)h<<=1;var g=2*h-1;h-=1;var p=it.map(new Array(g),function(){return 0}),m=0;return it.forEach(l.forEach(function(y){var x=y.pos+h;p[x]+=y.weight;for(var w=0;x>0;)x%2&&(w+=p[x+1]),p[x=x-1>>1]+=y.weight;m+=y.weight*w})),m}var xb=function(i,r){return it.map(r,function(o){var s=i.inEdges(o);if(s.length){var l=it.reduce(s,function(h,g){var p=i.edge(g),m=i.node(g.v);return{sum:h.sum+p.weight*m.order,weight:h.weight+p.weight}},{sum:0,weight:0});return{v:o,barycenter:l.sum/l.weight,weight:l.weight}}return{v:o}})},wb=function(i,r){var o={};return it.forEach(i,function(s,l){var h=o[s.v]={indegree:0,in:[],out:[],vs:[s.v],i:l};it.isUndefined(s.barycenter)||(h.barycenter=s.barycenter,h.weight=s.weight)}),it.forEach(r.edges(),function(s){var l=o[s.v],h=o[s.w];it.isUndefined(l)||it.isUndefined(h)||(h.indegree++,l.out.push(o[s.w]))}),function(s){var l=[];function h(m){return function(y){y.merged||(it.isUndefined(y.barycenter)||it.isUndefined(m.barycenter)||y.barycenter>=m.barycenter)&&function(x,w){var A=0,T=0;x.weight&&(A+=x.barycenter*x.weight,T+=x.weight),w.weight&&(A+=w.barycenter*w.weight,T+=w.weight),x.vs=w.vs.concat(x.vs),x.barycenter=A/T,x.weight=T,x.i=Math.min(w.i,x.i),w.merged=!0}(m,y)}}function g(m){return function(y){y.in.push(m),--y.indegree==0&&s.push(y)}}for(;s.length;){var p=s.pop();l.push(p),it.forEach(p.in.reverse(),h(p)),it.forEach(p.out,g(p))}return it.map(it.filter(l,function(m){return!m.merged}),function(m){return it.pick(m,["vs","i","barycenter","weight"])})}(it.filter(o,function(s){return!s.indegree}))},Eb=function(i,r){var o=zr.partition(i,function(w){return it.has(w,"barycenter")}),s=o.lhs,l=it.sortBy(o.rhs,function(w){return-w.i}),h=[],g=0,p=0,m=0;s.sort((y=!!r,function(w,A){return w.barycenter<A.barycenter?-1:w.barycenter>A.barycenter?1:y?A.i-w.i:w.i-A.i})),m=g0(h,l,m),it.forEach(s,function(w){m+=w.vs.length,h.push(w.vs),g+=w.barycenter*w.weight,p+=w.weight,m=g0(h,l,m)});var y,x={vs:it.flatten(h,!0)};return p&&(x.barycenter=g/p,x.weight=p),x};function g0(i,r,o){for(var s;r.length&&(s=it.last(r)).i<=o;)r.pop(),i.push(s.vs),o++;return o}var _b=function i(r,o,s,l){var h=r.children(o),g=r.node(o),p=g?g.borderLeft:void 0,m=g?g.borderRight:void 0,y={};p&&(h=it.filter(h,function(I){return I!==p&&I!==m}));var x=xb(r,h);it.forEach(x,function(I){if(r.children(I.v).length){var N=i(r,I.v,s,l);y[I.v]=N,it.has(N,"barycenter")&&(P=I,R=N,it.isUndefined(P.barycenter)?(P.barycenter=R.barycenter,P.weight=R.weight):(P.barycenter=(P.barycenter*P.weight+R.barycenter*R.weight)/(P.weight+R.weight),P.weight+=R.weight))}var P,R});var w=wb(x,s);(function(I,N){it.forEach(I,function(P){P.vs=it.flatten(P.vs.map(function(R){return N[R]?N[R].vs:R}),!0)})})(w,y);var A=Eb(w,l);if(p&&(A.vs=it.flatten([p,A.vs,m],!0),r.predecessors(p).length)){var T=r.node(r.predecessors(p)[0]),O=r.node(r.predecessors(m)[0]);it.has(A,"barycenter")||(A.barycenter=0,A.weight=0),A.barycenter=(A.barycenter*A.weight+T.order+O.order)/(A.weight+2),A.weight+=2}return A},Sb=go.Graph,Ab=function(i,r,o){var s=function(h){for(var g;h.hasNode(g=it.uniqueId("_root")););return g}(i),l=new Sb({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(function(h){return i.node(h)});return it.forEach(i.nodes(),function(h){var g=i.node(h),p=i.parent(h);(g.rank===r||g.minRank<=r&&r<=g.maxRank)&&(l.setNode(h),l.setParent(h,p||s),it.forEach(i[o](h),function(m){var y=m.v===h?m.w:m.v,x=l.edge(y,h),w=it.isUndefined(x)?0:x.weight;l.setEdge(y,h,{weight:i.edge(m).weight+w})}),it.has(g,"minRank")&&l.setNode(h,{borderLeft:g.borderLeft[r],borderRight:g.borderRight[r]}))}),l},Tb=function(i,r,o){var s,l={};it.forEach(o,function(h){for(var g,p,m=i.parent(h);m;){if((g=i.parent(m))?(p=l[g],l[g]=m):(p=s,s=m),p&&p!==m)return void r.setEdge(p,m);m=g}})},Cb=go.Graph,kf=function(i){var r=zr.maxRank(i),o=p0(i,it.range(1,r+1),"inEdges"),s=p0(i,it.range(r-1,-1,-1),"outEdges"),l=vb(i);m0(i,l);for(var h,g=Number.POSITIVE_INFINITY,p=0,m=0;m<4;++p,++m){Ob(p%2?o:s,p%4>=2),l=zr.buildLayerMatrix(i);var y=yb(i,l);y<g&&(m=0,h=it.cloneDeep(l),g=y)}m0(i,h)};function p0(i,r,o){return it.map(r,function(s){return Ab(i,s,o)})}function Ob(i,r){var o=new Cb;it.forEach(i,function(s){var l=s.graph().root,h=_b(s,l,o,r);it.forEach(h.vs,function(g,p){s.node(g).order=p}),Tb(s,o,h.vs)})}function m0(i,r){it.forEach(r,function(o){it.forEach(o,function(s,l){i.node(s).order=l})})}var Ib=go.Graph,Mb=function(i){var r,o=zr.buildLayerMatrix(i),s=it.merge(Nb(i,o),Pb(i,o)),l={};it.forEach(["u","d"],function(g){r=g==="u"?o:it.values(o).reverse(),it.forEach(["l","r"],function(p){p==="r"&&(r=it.map(r,function(w){return it.values(w).reverse()}));var m=(g==="u"?i.predecessors:i.successors).bind(i),y=Rb(i,r,s,m),x=Lb(i,r,y.root,y.align,p==="r");p==="r"&&(x=it.mapValues(x,function(w){return-w})),l[g+p]=x})});var h=kb(i,l);return Bb(l,h),y0(l,i.graph().align)};function Nb(i,r){var o={};return it.reduce(r,function(s,l){var h=0,g=0,p=s.length,m=it.last(l);return it.forEach(l,function(y,x){var w=function(T,O){if(T.node(O).dummy)return it.find(T.predecessors(O),function(I){return T.node(I).dummy})}(i,y),A=w?i.node(w).order:p;(w||y===m)&&(it.forEach(l.slice(g,x+1),function(T){it.forEach(i.predecessors(T),function(O){var I=i.node(O),N=I.order;!(N<h||A<N)||I.dummy&&i.node(T).dummy||v0(o,O,T)})}),g=x+1,h=A)}),l}),o}function Pb(i,r){var o={};function s(l,h,g,p,m){var y;it.forEach(it.range(h,g),function(x){y=l[x],i.node(y).dummy&&it.forEach(i.predecessors(y),function(w){var A=i.node(w);A.dummy&&(A.order<p||A.order>m)&&v0(o,w,y)})})}return it.reduce(r,function(l,h){var g,p=-1,m=0;return it.forEach(h,function(y,x){if(i.node(y).dummy==="border"){var w=i.predecessors(y);w.length&&(g=i.node(w[0]).order,s(h,m,x,p,g),m=x,p=g)}s(h,m,h.length,g,l.length)}),h}),o}function v0(i,r,o){if(r>o){var s=r;r=o,o=s}var l=i[r];l||(i[r]=l={}),l[o]=!0}function Db(i,r,o){if(r>o){var s=r;r=o,o=s}return it.has(i[r],o)}function Rb(i,r,o,s){var l={},h={},g={};return it.forEach(r,function(p){it.forEach(p,function(m,y){l[m]=m,h[m]=m,g[m]=y})}),it.forEach(r,function(p){var m=-1;it.forEach(p,function(y){var x=s(y);if(x.length)for(var w=((x=it.sortBy(x,function(I){return g[I]})).length-1)/2,A=Math.floor(w),T=Math.ceil(w);A<=T;++A){var O=x[A];h[y]===y&&m<g[O]&&!Db(o,y,O)&&(h[O]=y,h[y]=l[y]=l[O],m=g[O])}})}),{root:l,align:h}}function Lb(i,r,o,s,l){var h={},g=function(y,x,w,A){var T=new Ib,O=y.graph(),I=function(N,P,R){return function(k,U,K){var pt,Ot=k.node(U),It=k.node(K),Ct=0;if(Ct+=Ot.width/2,it.has(Ot,"labelpos"))switch(Ot.labelpos.toLowerCase()){case"l":pt=-Ot.width/2;break;case"r":pt=Ot.width/2}if(pt&&(Ct+=R?pt:-pt),pt=0,Ct+=(Ot.dummy?P:N)/2,Ct+=(It.dummy?P:N)/2,Ct+=It.width/2,it.has(It,"labelpos"))switch(It.labelpos.toLowerCase()){case"l":pt=It.width/2;break;case"r":pt=-It.width/2}return pt&&(Ct+=R?pt:-pt),pt=0,Ct}}(O.nodesep,O.edgesep,A);return it.forEach(x,function(N){var P;it.forEach(N,function(R){var k=w[R];if(T.setNode(k),P){var U=w[P],K=T.edge(U,k);T.setEdge(U,k,Math.max(I(y,R,P),K||0))}P=R})}),T}(i,r,o,l),p=l?"borderLeft":"borderRight";function m(y,x){for(var w=g.nodes(),A=w.pop(),T={};A;)T[A]?y(A):(T[A]=!0,w.push(A),w=w.concat(x(A))),A=w.pop()}return m(function(y){h[y]=g.inEdges(y).reduce(function(x,w){return Math.max(x,h[w.v]+g.edge(w))},0)},g.predecessors.bind(g)),m(function(y){var x=g.outEdges(y).reduce(function(A,T){return Math.min(A,h[T.w]-g.edge(T))},Number.POSITIVE_INFINITY),w=i.node(y);x!==Number.POSITIVE_INFINITY&&w.borderType!==p&&(h[y]=Math.max(h[y],x))},g.successors.bind(g)),it.forEach(s,function(y){h[y]=h[o[y]]}),h}function kb(i,r){return it.minBy(it.values(r),function(o){var s=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY;return it.forIn(o,function(h,g){var p=function(m,y){return m.node(y).width}(i,g)/2;s=Math.max(h+p,s),l=Math.min(h-p,l)}),s-l})}function Bb(i,r){var o=it.values(r),s=it.min(o),l=it.max(o);it.forEach(["u","d"],function(h){it.forEach(["l","r"],function(g){var p,m=h+g,y=i[m];if(y!==r){var x=it.values(y);(p=g==="l"?s-it.min(x):l-it.max(x))&&(i[m]=it.mapValues(y,function(w){return w+p}))}})})}function y0(i,r){return it.mapValues(i.ul,function(o,s){if(r)return i[r.toLowerCase()][s];var l=it.sortBy(it.map(i,s));return(l[1]+l[2])/2})}var jb=Mb,Fb=function(i){(function(r){var o=zr.buildLayerMatrix(r),s=r.graph().ranksep,l=0;it.forEach(o,function(h){var g=it.max(it.map(h,function(p){return r.node(p).height}));it.forEach(h,function(p){r.node(p).y=l+g/2}),l+=g+s})})(i=zr.asNonCompoundGraph(i)),it.forEach(jb(i),function(r,o){i.node(o).x=r})},b0=zr.normalizeRanks,Gb=zr.removeEmptyRanks,oa=zr,zb=go.Graph,Ub=function(i,r){var o=r&&r.debugTiming?oa.time:oa.notime;o("layout",function(){var s=o("  buildLayoutGraph",function(){return function(l){var h=new zb({multigraph:!0,compound:!0}),g=Bf(l.graph());return h.setGraph(it.merge({},Hb,Cp(g,Vb),it.pick(g,Ap))),it.forEach(l.nodes(),function(p){var m=Bf(l.node(p));h.setNode(p,it.defaults(Cp(m,Tp),$b)),h.setParent(p,l.parent(p))}),it.forEach(l.edges(),function(p){var m=Bf(l.edge(p));h.setEdge(p,it.merge({},w0,Cp(m,x0),it.pick(m,E0)))}),h}(i)});o("  runLayout",function(){(function(l,h){h("    makeSpaceForEdgeLabels",function(){(function(g){var p=g.graph();p.ranksep/=2,it.forEach(g.edges(),function(m){var y=g.edge(m);y.minlen*=2,y.labelpos.toLowerCase()!=="c"&&(p.rankdir==="TB"||p.rankdir==="BT"?y.width+=y.labeloffset:y.height+=y.labeloffset)})})(l)}),h("    removeSelfEdges",function(){(function(g){it.forEach(g.edges(),function(p){if(p.v===p.w){var m=g.node(p.v);m.selfEdges||(m.selfEdges=[]),m.selfEdges.push({e:p,label:g.edge(p)}),g.removeEdge(p)}})})(l)}),h("    acyclic",function(){qm.run(l)}),h("    nestingGraph.run",function(){$a.run(l)}),h("    rank",function(){pb(oa.asNonCompoundGraph(l))}),h("    injectEdgeLabelProxies",function(){(function(g){it.forEach(g.edges(),function(p){var m=g.edge(p);if(m.width&&m.height){var y=g.node(p.v),x={rank:(g.node(p.w).rank-y.rank)/2+y.rank,e:p};oa.addDummyNode(g,"edge-proxy",x,"_ep")}})})(l)}),h("    removeEmptyRanks",function(){Gb(l)}),h("    nestingGraph.cleanup",function(){$a.cleanup(l)}),h("    normalizeRanks",function(){b0(l)}),h("    assignRankMinMax",function(){(function(g){var p=0;it.forEach(g.nodes(),function(m){var y=g.node(m);y.borderTop&&(y.minRank=g.node(y.borderTop).rank,y.maxRank=g.node(y.borderBottom).rank,p=it.max(p,y.maxRank))}),g.graph().maxRank=p})(l)}),h("    removeEdgeLabelProxies",function(){(function(g){it.forEach(g.nodes(),function(p){var m=g.node(p);m.dummy==="edge-proxy"&&(g.edge(m.e).labelRank=m.rank,g.removeNode(p))})})(l)}),h("    normalize.run",function(){Qm.run(l)}),h("    parentDummyChains",function(){u0(l)}),h("    addBorderSegments",function(){f0(l)}),h("    order",function(){kf(l)}),h("    insertSelfEdges",function(){(function(g){var p=oa.buildLayerMatrix(g);it.forEach(p,function(m){var y=0;it.forEach(m,function(x,w){var A=g.node(x);A.order=w+y,it.forEach(A.selfEdges,function(T){oa.addDummyNode(g,"selfedge",{width:T.label.width,height:T.label.height,rank:A.rank,order:w+ ++y,e:T.e,label:T.label},"_se")}),delete A.selfEdges})})})(l)}),h("    adjustCoordinateSystem",function(){wp.adjust(l)}),h("    position",function(){Fb(l)}),h("    positionSelfEdges",function(){(function(g){it.forEach(g.nodes(),function(p){var m=g.node(p);if(m.dummy==="selfedge"){var y=g.node(m.e.v),x=y.x+y.width/2,w=y.y,A=m.x-x,T=y.height/2;g.setEdge(m.e,m.label),g.removeNode(p),m.label.points=[{x:x+2*A/3,y:w-T},{x:x+5*A/6,y:w-T},{x:x+A,y:w},{x:x+5*A/6,y:w+T},{x:x+2*A/3,y:w+T}],m.label.x=m.x,m.label.y=m.y}})})(l)}),h("    removeBorderNodes",function(){(function(g){it.forEach(g.nodes(),function(p){if(g.children(p).length){var m=g.node(p),y=g.node(m.borderTop),x=g.node(m.borderBottom),w=g.node(it.last(m.borderLeft)),A=g.node(it.last(m.borderRight));m.width=Math.abs(A.x-w.x),m.height=Math.abs(x.y-y.y),m.x=w.x+m.width/2,m.y=y.y+m.height/2}}),it.forEach(g.nodes(),function(p){g.node(p).dummy==="border"&&g.removeNode(p)})})(l)}),h("    normalize.undo",function(){Qm.undo(l)}),h("    fixupEdgeLabelCoords",function(){(function(g){it.forEach(g.edges(),function(p){var m=g.edge(p);if(it.has(m,"x"))switch(m.labelpos!=="l"&&m.labelpos!=="r"||(m.width-=m.labeloffset),m.labelpos){case"l":m.x-=m.width/2+m.labeloffset;break;case"r":m.x+=m.width/2+m.labeloffset}})})(l)}),h("    undoCoordinateSystem",function(){wp.undo(l)}),h("    translateGraph",function(){(function(g){var p=Number.POSITIVE_INFINITY,m=0,y=Number.POSITIVE_INFINITY,x=0,w=g.graph(),A=w.marginx||0,T=w.marginy||0;function O(I){var N=I.x,P=I.y,R=I.width,k=I.height;p=Math.min(p,N-R/2),m=Math.max(m,N+R/2),y=Math.min(y,P-k/2),x=Math.max(x,P+k/2)}it.forEach(g.nodes(),function(I){O(g.node(I))}),it.forEach(g.edges(),function(I){var N=g.edge(I);it.has(N,"x")&&O(N)}),p-=A,y-=T,it.forEach(g.nodes(),function(I){var N=g.node(I);N.x-=p,N.y-=y}),it.forEach(g.edges(),function(I){var N=g.edge(I);it.forEach(N.points,function(P){P.x-=p,P.y-=y}),it.has(N,"x")&&(N.x-=p),it.has(N,"y")&&(N.y-=y)}),w.width=m-p+A,w.height=x-y+T})(l)}),h("    assignNodeIntersects",function(){(function(g){it.forEach(g.edges(),function(p){var m,y,x=g.edge(p),w=g.node(p.v),A=g.node(p.w);x.points?(m=x.points[0],y=x.points[x.points.length-1]):(x.points=[],m=A,y=w),x.points.unshift(oa.intersectRect(w,m)),x.points.push(oa.intersectRect(A,y))})})(l)}),h("    reversePoints",function(){(function(g){it.forEach(g.edges(),function(p){var m=g.edge(p);m.reversed&&m.points.reverse()})})(l)}),h("    acyclic.undo",function(){qm.undo(l)})})(s,o)}),o("  updateInputGraph",function(){(function(l,h){it.forEach(l.nodes(),function(g){var p=l.node(g),m=h.node(g);p&&(p.x=m.x,p.y=m.y,h.children(g).length&&(p.width=m.width,p.height=m.height))}),it.forEach(l.edges(),function(g){var p=l.edge(g),m=h.edge(g);p.points=m.points,it.has(m,"x")&&(p.x=m.x,p.y=m.y)}),l.graph().width=h.graph().width,l.graph().height=h.graph().height})(i,s)})})},Vb=["nodesep","edgesep","ranksep","marginx","marginy"],Hb={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Ap=["acyclicer","ranker","rankdir","align"],Tp=["width","height"],$b={width:0,height:0},x0=["minlen","weight","width","height","labeloffset"],w0={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},E0=["labelpos"];function Cp(i,r){return it.mapValues(it.pick(i,r),Number)}function Bf(i){var r={};return it.forEach(i,function(o,s){r[s.toLowerCase()]=o}),r}var _0=go.Graph,S0={graphlib:go,layout:Ub,debug:{debugOrdering:function(i){var r=zr.buildLayerMatrix(i),o=new _0({compound:!0,multigraph:!0}).setGraph({});return it.forEach(i.nodes(),function(s){o.setNode(s,{label:s}),o.setParent(s,"layer"+i.node(s).rank)}),it.forEach(i.edges(),function(s){o.setEdge(s.v,s.w,{},s.name)}),it.forEach(r,function(s,l){var h="layer"+l;o.setNode(h,{rank:"same"}),it.reduce(s,function(g,p){return o.setEdge(g,p,{style:"invis"}),p})}),o}},util:{time:zr.time,notime:zr.notime},version:"0.8.5"},Wb=S0.graphlib,Xb=S0.layout;class Zb{constructor(r){this.cardinality=1,this.include=rs.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Fr.NODE,this.name=r.name,this.attr=r.attr||{},this.inputs=r.inputs,this.path=r.path||[],this.width=r.width,this.height=r.height}}class qb{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function Yb(i){const r=new qb;return i.nodes.map(o=>new Zb(o)).forEach(o=>{r.nodes[o.name]=o,o.inputs.forEach(s=>{(function(l,h,g){g.name!==h.name&&l.edges.push(Object.assign(Object.assign({},g.attr),{v:g.name,w:h.name}))})(r,o,s)})}),r}class Jb{constructor(r,o={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=rs.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Fr.META,this.path=[],this.name=r,this.metaGraph=Ip(r,is.META,o)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(r=>this.metaGraph.node(r))}leaves(){let r,o=[],s=[this];for(;s.length;){let l=s.shift();l.isGroupNode?(r=l.metaGraph,r.nodes().forEach(h=>s.push(r.node(h)))):o.push(l.name)}return o}}class Kb{constructor(r,o){this.v=r,this.w=o,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(r,o){this.baseEdgeList.push(r)}}function A0(i,r={}){return new Jb(i,r)}function Op(i,r){return new Kb(i,r)}function Ip(i,r,o){const s=o||{},l=new Wb.Graph(s);return l.setGraph({name:i,rankdir:s.rankdir,type:r,align:s.align}),l}class qu{constructor(r={}){this.graphOptions=r,this.index={},this.graphOptions.compound=!0,this.root=A0(ns,this.graphOptions),this.index[ns]=this.root}getNodeMap(){return this.index}node(r){return this.index[r]}setNode(r,o){this.index[r]=o}getBridgeGraph(r){const o=this.index[r];if(!o)throw Error("Could not find node in hierarchy: "+r);if(!("metaGraph"in o))return null;const s=o;if(s.bridgeGraph)return s.bridgeGraph;const l=Ip(Ru,is.BRIDGE,this.graphOptions);if(s.bridgeGraph=l,!o.parentNode||!("metaGraph"in o.parentNode))return l;const h=o.parentNode;return[h.metaGraph,this.getBridgeGraph(h.name)].forEach(g=>{g.edges().filter(p=>p.v===r||p.w===r).forEach(p=>{const m=p.w===r;g.edge(p).baseEdgeList.forEach(y=>{const[x,w]=m?[y.w,p.v]:[y.v,p.w],A=this.getChildName(r,x),T={v:m?w:A,w:m?A:w};let O=l.edge(T);O||(O=Op(T.v,T.w),O.inbound=m,l.setEdge(T.v,T.w,O)),O.addBaseEdge(y,this)})})}),l}getChildName(r,o){let s=this.index[o];for(;s;){if(s.parentNode&&s.parentNode.name===r)return s.name;s=s.parentNode}throw Error("Could not find immediate child for descendant: "+o)}getPredecessors(r){const o=this.index[r];if(!o)throw Error("Could not find node with name: "+r);return this.getOneWayEdges(o,!0)}getSuccessors(r){const o=this.index[r];if(!o)throw Error("Could not find node with name: "+r);return this.getOneWayEdges(o,!1)}getOneWayEdges(r,o){const s=[];if(!r.parentNode||!r.parentNode.isGroupNode)return s;const l=r.parentNode,h=l.metaGraph,g=this.getBridgeGraph(l.name);return Mp(h,r,o,s),Mp(g,r,o,s),s}}function Qb(i,r){const{rankDirection:o,align:s}=r,l=new qu({rankdir:o,align:s});return function(h,g){Object.keys(g.nodes).forEach(p=>{const m=g.nodes[p],y=m.path;let x=h.root;x.depth=Math.max(y.length,x.depth);for(let w=0;w<y.length&&(x.depth=Math.max(x.depth,y.length-w),x.cardinality+=m.cardinality,w!==y.length-1);w++){const A=y[w];let T=h.node(A);T||(T=A0(A,h.graphOptions),T.path=m.path.slice(0,w+1),T.parentNode=x,h.setNode(A,T),x.metaGraph.setNode(A,T)),x=T}h.setNode(m.name,m),m.parentNode=x,x.metaGraph.setNode(m.name,m)})}(l,i),function(h,g){const p=h.getNodeMap();let m=[],y=[];const x=(w,A)=>{let T=0;for(;w;)A[T++]=w.name,w=w.parentNode;return T-1};g.edges.forEach(w=>{m=[],y=[];let A=x(g.nodes[w.v],m),T=x(g.nodes[w.w],y);for(;m[A]===y[T];)if(A--,T--,A<0||T<0)throw Error("No difference found between ancestor paths.");const O=p[m[A+1]],I=m[A],N=y[T];let P=O.metaGraph.edge(I,N);P||(P=Op(I,N),O.metaGraph.setEdge(I,N,P)),P.addBaseEdge(w,h)})}(l,i),l}function Mp(i,r,o,s){(o?i.inEdges(r.name):i.outEdges(r.name)).forEach(l=>{const h=i.edge(l);s.push(h)})}class tx{constructor(r){this.hierarchy=r,this.index={},this.hasSubHierarchy={},this.root=new cl(this.hierarchy.root,this.hierarchy.graphOptions),this.index[r.root.name]=this.root,this.buildSubHierarchy(r.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(r){if(r in this.hasSubHierarchy)return;this.hasSubHierarchy[r]=!0;const o=this.index[r];if(o.node.type!==Fr.META)return;const s=o,l=s.node.metaGraph,h=s.coreGraph;l.nodes().forEach(x=>{const w=this.getOrCreateRenderNodeByName(x);h.setNode(x,w)}),l.edges().forEach(x=>{const w=l.edge(x),A=new T0(w);h.setEdge(x.v,x.w,A)});const g=s.node.parentNode;if(!g)return;const p=this.getRenderNodeByName(g.name),m=(x,...w)=>w.concat([x?"IN":"OUT"]).join("~~"),y=this.hierarchy.getBridgeGraph(r);y.edges().forEach(x=>{const w=y.edge(x),A=!!l.node(x.w),[T,O]=A?[x.w,x.v]:[x.v,x.w],I=K=>{const pt=A?{v:K,w:r}:{v:r,w:K};return p.coreGraph.edge(pt)};let N=I(O);N||(N=I(m(A,O,g.name)));const P=m(A,r),R=m(A,O,r);let k=h.node(R);if(!k){let K=h.node(P);if(!K){const Ot={name:P,type:Fr.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:rs.UNSPECIFIED,inbound:A,attr:{}};K=new jf(Ot),this.index[P]=K,h.setNode(P,K)}const pt={name:R,type:Fr.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:rs.UNSPECIFIED,inbound:A,attr:{}};k=new jf(pt),this.index[R]=k,h.setNode(R,k),h.setParent(R,P),K.node.cardinality++}const U=new T0(w);U.adjoiningMetaEdge=N,A?h.setEdge(R,T,U):h.setEdge(T,R,U)})}getOrCreateRenderNodeByName(r){if(!r)return null;if(r in this.index)return this.index[r];const o=this.getNodeByName(r);return o?(this.index[r]=o.isGroupNode?new cl(o,this.hierarchy.graphOptions):new jf(o),this.index[r]):null}getRenderNodeByName(r){return this.index[r]}getNodeByName(r){return this.hierarchy.node(r)}}class jf{constructor(r){this.node=r,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=r.width||0,this.height=r.height||0,this.displayName=r.name,this.attr=r.attr}}class T0{constructor(r){this.metaEdge=r,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class cl extends jf{constructor(r,o){super(r);const s=r.metaGraph.graph();o.compound=!0,this.coreGraph=Ip(s.name,is.CORE,o)}}function C0(i,r){i.node.isGroupNode&&function(o,s){const l=es(s);o.coreGraph.nodes().map(h=>o.coreGraph.node(h)).forEach(h=>{var g,p,m,y,x,w;const{height:A,width:T}=h;switch(h.node.type){case Fr.NODE:Object.assign(h,l.nodeSize.node),h.height=A||l.nodeSize.node.height,h.width=T||l.nodeSize.node.width;break;case Fr.BRIDGE:Object.assign(h,l.nodeSize.bridge);break;case Fr.META:h.expanded?C0(h,s):(Object.assign(h,l.nodeSize.meta),h.height=l.nodeSize.meta.height,h.width=l.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+h.node.type)}if(!h.expanded){const O=h.attr;(function(I,N=!1){if(I.coreBox.width=I.width,I.coreBox.height=I.height,!N){const P=`${I.displayName}`.length,R=3;I.width=Math.max(I.coreBox.width,P*R)}})(h,s&&(h.node.type===0&&!!(!((p=(g=s==null?void 0:s.nodeSize)===null||g===void 0?void 0:g.meta)===null||p===void 0)&&p.width)||h.node.type===1&&(!!(!((y=(m=s==null?void 0:s.nodeSize)===null||m===void 0?void 0:m.node)===null||y===void 0)&&y.width)||!!O.width)||h.node.type===2&&!!(!((w=(x=s==null?void 0:s.nodeSize)===null||x===void 0?void 0:x.bridge)===null||w===void 0)&&w.width)))}})}(i,r),i.node.type===Fr.META&&function(o,s){const l=es(s),h=l.subScene.meta;Object.assign(o,h);const{nodeSep:g,rankSep:p,edgeSep:m,align:y}=l.graph.meta,x={nodesep:g,ranksep:p,edgesep:m,align:y};Object.assign(o.coreBox,function(T,O){const{ranksep:I,nodesep:N,edgesep:P,align:R}=O;Object.assign(T.graph(),{ranksep:I,nodesep:N,edgesep:P,align:R});const k=[];if(T.nodes().forEach(It=>{T.node(It).node.type!==Fr.BRIDGE&&k.push(It)}),!k.length)return{width:0,height:0};Xb(T);let U=1/0,K=1/0,pt=-1/0,Ot=-1/0;return k.forEach(It=>{const Ct=T.node(It),_t=.5*Ct.width,F=Ct.x-_t,Z=Ct.x+_t;U=F<U?F:U,pt=Z>pt?Z:pt;const yt=.5*Ct.height,bt=Ct.y-yt,de=Ct.y+yt;K=bt<K?bt:K,Ot=de>Ot?de:Ot}),T.edges().forEach(It=>{const Ct=T.edge(It),_t=T.node(Ct.metaEdge.v),F=T.node(Ct.metaEdge.w);if(Ct.points.length===3&&function(bt){let de=O0(bt[0],bt[1]);for(let Ne=1;Ne<bt.length-1;Ne++){const Ee=O0(bt[Ne],bt[Ne+1]);if(Math.abs(Ee-de)>1)return!1;de=Ee}return!0}(Ct.points)){if(_t!=null){const bt=_t.expanded?_t.x:Np(_t);Ct.points[0].x=bt}if(F!=null){const bt=F.expanded?F.x:Np(F);Ct.points[2].x=bt}Ct.points=[Ct.points[0],Ct.points[1]]}const Z=Ct.points[Ct.points.length-2];F!=null&&(Ct.points[Ct.points.length-1]=Ff(Z,F));const yt=Ct.points[1];_t!=null&&(Ct.points[0]=Ff(yt,_t)),Ct.points.forEach(bt=>{U=bt.x<U?bt.x:U,pt=bt.x>pt?bt.x:pt,K=bt.y<K?bt.y:K,Ot=bt.y>Ot?bt.y:Ot})}),T.nodes().forEach(It=>{const Ct=T.node(It);Ct.x-=U,Ct.y-=K}),T.edges().forEach(It=>{T.edge(It).points.forEach(Ct=>{Ct.x-=U,Ct.y-=K})}),{width:pt-U,height:Ot-K}}(o.coreGraph,x));let w=0;o.coreGraph.nodeCount()>0&&w++;const A=w<=1?0:w;o.coreBox.width+=A+A,o.coreBox.height=h.labelHeight+o.coreBox.height,o.width=o.coreBox.width+h.paddingLeft+h.paddingRight,o.height=o.paddingTop+o.coreBox.height+o.paddingBottom}(i,r)}function O0(i,r){const o=r.x-i.x,s=r.y-i.y;return 180*Math.atan(s/o)/Math.PI}function Np(i){return i.expanded?i.x:i.x-i.width/2+0+i.coreBox.width/2}function Ff(i,r){const o=r.expanded?r.x:Np(r),s=r.y,l=i.x-o,h=i.y-s;let g,p,m=r.expanded?r.width:r.coreBox.width,y=r.expanded?r.height:r.coreBox.height;return Math.abs(h)*m/2>Math.abs(l)*y/2?(h<0&&(y=-y),g=h===0?0:y/2*l/h,p=y/2):(l<0&&(m=-m),g=m/2,p=l===0?0:m/2*h/l),{x:o+g,y:s+p}}function ex(i,r,o){var s,l,h,g;const p=i.nodes.filter((w,A,T)=>T.findIndex(O=>O.id===w.id)!==A).map(w=>w.id);if(p.length)throw new Error(`Duplicated ids found: ${p.join(", ")}`);const m=function(w){const A={nodes:[]},T=w.compound,O=Object.keys(T||{}),I=new Map,N=(R,k=[])=>{if(I.has(R))return I.get(R);for(let U=0;U<O.length;U++){let K=O[U];if(T&&T[K].indexOf(R)!==-1)return k.unshift(K),N(K,k)}return k.length===0&&I.set(R,k),k},P=R=>w.edges.filter(k=>k.w===R).map(k=>({name:k.v}));return w.nodes.forEach(R=>{const k=R.id,U=[...N(k),k];let K=P(k);A.nodes.push({name:k,path:U,inputs:K,width:R.width,height:R.height,attr:Object.assign({},R)})}),A}(i),y=function(w,A){const T=(I,N)=>{for(let P of N.values())if(P.includes(I))return!0;return!1},O=(I,N=[])=>{if(Object.keys(I).length===0)return[...new Set(N)];const P=new Map(Object.keys(I).map(k=>[k,I[k]])),R={};for(let[k,U]of P)T(k,P)?R[k]=U:N=N.concat(k,U);return O(R,N)};return O(w).filter(I=>A.includes(I))}(i.compound||{},(r==null?void 0:r.expanded)||[]),x=function(w,A){return function(T){return new tx(T)}(Qb(Yb(w),A))}(m,{rankDirection:((l=(s=o==null?void 0:o.graph)===null||s===void 0?void 0:s.meta)===null||l===void 0?void 0:l.rankDir)||(r==null?void 0:r.rankDirection)||Ws.graph.meta.rankDir,align:((g=(h=o==null?void 0:o.graph)===null||h===void 0?void 0:h.meta)===null||g===void 0?void 0:g.align)||Ws.graph.meta.align});return function(w,A){A.forEach(T=>{const O=w.getRenderInfoNodes().find(P=>P.displayName===T);let I=O&&O.node&&O.node.name||"";const N=w.getRenderNodeByName(I);if(!N)throw new Error(`No nodes found: ${I}`);N.expanded=!0,w.buildSubHierarchy(I)})}(x,y),C0(x.root,o),Pp(x.root)}function nx(i,r=!1){const o=JSON.parse(JSON.stringify(i)),s={nodes:[o],edges:[...o.edges]};return o.nodes.forEach(function l(h){(h.type===0||h.type===1)&&s.nodes.push(h),h.type===0&&(s.edges=s.edges.concat(h.edges)),Array.isArray(h.nodes)&&h.nodes.forEach(l)}),r&&s.nodes.forEach(l=>{const h=s.nodes.find(g=>g.id===l.parentNodeName);if(h){const g=h.x-h.width/2+h.paddingLeft,p=h.y-h.height/2+h.labelHeight+h.paddingTop;h.id!==ns&&(l.x+=g,l.y+=p),l.type===0&&l.edges.forEach(m=>{m.points.forEach(y=>{y.x+=l.x-l.width/2+l.paddingLeft,y.y+=l.y-l.height/2+l.labelHeight+l.paddingTop})})}}),s}function sa(i,r,o,s){var l,h;let g=[];const p=((l=o.find(w=>w.id===i))===null||l===void 0?void 0:l.path)||[],m=((h=o.find(w=>w.id===r))===null||h===void 0?void 0:h.path)||[],y=[ns,...p].slice(0,p.length).reverse(),x=[ns,...m].slice(0,m.length);return y.forEach(w=>{const A=o.find(T=>T.id===w);g=g.concat(A.edges.filter(T=>T.baseEdgeList.some(O=>O.v===((s==null?void 0:s.v)||i)&&O.w===((s==null?void 0:s.w)||r))))}),x.filter(w=>!y.includes(w)).forEach(w=>{const A=o.find(T=>T.id===w);g=g.concat(A.edges.filter(T=>T.baseEdgeList.some(O=>O.v===((s==null?void 0:s.v)||i)&&O.w===((s==null?void 0:s.w)||r))))}),g}function Pp(i){const r=i.coreGraph.nodes().map(s=>i.coreGraph.node(s));return Object.assign(Object.assign({},Gf(i)),{expanded:i.expanded,nodes:i.expanded?(o=r,o.map(s=>s.node.type===Fr.META?Pp(s):Gf(s))):[],edges:i.expanded?Vx(i):[]});var o}function Gf(i){return{id:i.node.name,name:i.node.name,type:i.node.type,cardinality:i.node.cardinality,attr:i.attr,parentNodeName:i.node.parentNode?i.node.parentNode.name:null,coreBox:Object.assign({},i.coreBox),x:i.x,y:i.y,width:i.width,height:i.height,radius:i.radius,labelHeight:i.labelHeight,labelOffset:i.labelOffset,outboxWidth:i.outboxWidth,paddingLeft:i.paddingLeft,paddingTop:i.paddingTop,paddingRight:i.paddingRight,paddingBottom:i.paddingBottom,path:i.node.path}}function Vx(i){return i.coreGraph.edges().map(r=>({renderInfoEdge:i.coreGraph.edge(r),edge:r})).filter(({renderInfoEdge:r})=>r.metaEdge).map(({edge:r,renderInfoEdge:o})=>{const s=function(l,h){const g=h.points.map(p=>Object.assign({},p));if(h.adjoiningMetaEdge){const p=h.adjoiningMetaEdge.points,m=h.metaEdge.inbound,y=m?p[p.length-1]:p[0],x=g[m?0:g.length-1],w=l.x-l.width/2,A=l.y-l.height/2,T=y.x-w,O=y.y-A,I=-l.paddingLeft,N=-(l.paddingTop+l.labelHeight);x.x=T+I,x.y=O+N}return g}(i,o);return{adjoiningEdge:o.adjoiningMetaEdge?{w:o.adjoiningMetaEdge.metaEdge.w,v:o.adjoiningMetaEdge.metaEdge.v}:null,inbound:o.metaEdge.inbound,w:r.w,v:r.v,points:s,weight:o.weight,baseEdgeList:o.metaEdge.baseEdgeList,parentNodeName:i.node.name}})}class Hx extends vn{constructor(r){super(),this.rankdir="TB",this.nodesep=50,this.edgesep=5,this.ranksep=50,this.controlPoints=!0,this.anchorPoint=!0,this.nodes=[],this.edges=[],this.combos=[],this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}}init(r){const o=r.hiddenNodes||[],s=r.hiddenEdges||[],l=r.hiddenCombos||[];this.nodes=this.getDataByOrder((r.nodes||[]).concat(o)),this.edges=this.getDataByOrder((r.edges||[]).concat(s)),this.combos=(r.combos||[]).concat(l.map(h=>Object.assign(Object.assign({},h),{collapsed:!0})))}execute(){const r=this,{nodes:o,edges:s}=r;if(!o)return;const{graphDef:l,graphOption:h,graphSettings:g}=r.getLayoutConfig(),p=ex(l,h,g),m=nx(p,!0);return this.updatePosition(m),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s}}getNodePath(r){const o=this,{nodes:s,combos:l}=o,h=s.find(p=>p.id===r),g=(p,m=[])=>{const y=l.find(x=>x.id===p);return y?(m.unshift(p),y.parentId?g(y.parentId,m):m):m};return h&&h.comboId?g(h.comboId,[r]):[r]}getLayoutConfig(){var r,o,s;const l=this,{nodes:h,edges:g,combos:p,nodeSize:m,rankdir:y,align:x,edgesep:w,nodesep:A,ranksep:T,settings:O}=l,I=(p||[]).reduce((yt,bt)=>{const de=h.filter(Ee=>Ee.comboId===bt.id).map(Ee=>Ee.id),Ne=(p||[]).filter(Ee=>Ee.parentId===bt.id).map(Ee=>Ee.id);return(de.length||Ne.length)&&(yt[bt.id]=[...de,...Ne]),yt},{});let N;m?Jt(m)?N=()=>m:N=()=>[m,m]:N=yt=>yt&&yt.size?Jt(yt.size)?yt.size:Q(yt.size)?[yt.size.width||40,yt.size.height||40]:[yt.size,yt.size]:[40,40];const P=yt=>yt&&yt.size?Jt(yt.size)?yt.size:[yt.size,yt.size]:[80,40],[R,k]=P(p==null?void 0:p[0]),U=(o=(r=l.graphSettings)===null||r===void 0?void 0:r.subScene)===null||o===void 0?void 0:o.meta,[K,pt,Ot,It]=((s=p.find(yt=>!yt.collapsed))===null||s===void 0?void 0:s.padding)||[20,20,20,20],Ct={compound:I,nodes:[...(h||[]).map(yt=>{const bt=N(yt),de=bt[0],Ne=bt[1];return Object.assign(Object.assign({},yt),{width:de,height:Ne})})],edges:[...(g||[]).map(yt=>Object.assign(Object.assign({},yt),{v:yt.source,w:yt.target}))]},_t={expanded:(p||[]).filter(yt=>!yt.collapsed).map(yt=>yt.id)},F={graph:{meta:{align:x,rankDir:y,nodeSep:A,edgeSep:w,rankSep:T}},subScene:{meta:{paddingTop:K||(U==null?void 0:U.paddingTop)||20,paddingRight:pt||(U==null?void 0:U.paddingRight)||20,paddingBottom:Ot||(U==null?void 0:U.paddingBottom)||20,paddingLeft:It||(U==null?void 0:U.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:R,height:k}}},Z=es(O,Object.assign({},es(F,Ws)));return l.graphSettings=Z,{graphDef:Ct,graphOption:_t,graphSettings:Z}}updatePosition(r){const{nodes:o,edges:s}=r;this.updateNodePosition(o,s),this.updateEdgePosition(o,s)}getBegin(r,o){const s=this,{begin:l}=s,h=[0,0];if(l){let g=1/0,p=1/0;r.forEach(m=>{g>m.x&&(g=m.x),p>m.y&&(p=m.y)}),o.forEach(m=>{m.points.forEach(y=>{g>y.x&&(g=y.x),p>y.y&&(p=y.y)})}),h[0]=l[0]-g,h[1]=l[1]-p}return h}updateNodePosition(r,o){const s=this,{combos:l,nodes:h,edges:g,anchorPoint:p,graphSettings:m}=s,y=this.getBegin(r,o);r.forEach(x=>{var w;const{x:A,y:T,id:O,type:I,coreBox:N}=x;if(I===Xs.META&&O!==ns){const P=l.findIndex(k=>k.id===O),R=(w=m==null?void 0:m.subScene)===null||w===void 0?void 0:w.meta;l[P].offsetX=A+y[0],l[P].offsetY=T+y[1],l[P].fixSize=[N.width,N.height],l[P].fixCollapseSize=[N.width,N.height],x.expanded?l[P].padding=[R==null?void 0:R.paddingTop,R==null?void 0:R.paddingRight,R==null?void 0:R.paddingBottom,R==null?void 0:R.paddingLeft]:l[P].padding=[0,0,0,0]}else if(I===Xs.OP){const P=h.findIndex(R=>R.id===O);if(h[P].x=A+y[0],h[P].y=T+y[1],p){const R=[],k=o.filter(K=>K.v===O),U=o.filter(K=>K.w===O);k.length>0&&k.forEach(K=>{const pt=K.points[0],Ot=(pt.x-A)/x.width+.5,It=(pt.y-T)/x.height+.5;R.push([Ot,It]),K.baseEdgeList.forEach(Ct=>{const _t=g.find(F=>F.source===Ct.v&&F.target===Ct.w);_t&&(_t.sourceAnchor=R.length-1)})}),U.length>0&&U.forEach(K=>{const pt=K.points[K.points.length-1],Ot=(pt.x-A)/x.width+.5,It=(pt.y-T)/x.height+.5;R.push([Ot,It]),K.baseEdgeList.forEach(Ct=>{const _t=g.find(F=>F.source===Ct.v&&F.target===Ct.w);_t&&(_t.targetAnchor=R.length-1)})}),h[P].anchorPoints=R.length>0?R:h[P].anchorPoints||[]}}})}updateEdgePosition(r,o){const s=this,{combos:l,edges:h,controlPoints:g}=s,p=this.getBegin(r,o);g&&(l.forEach(m=>{m.inEdges=[],m.outEdges=[]}),h.forEach(m=>{var y,x,w,A;let T=r.find(P=>P.id===m.source),O=r.find(P=>P.id===m.target),I=[],N=[];if(T&&O)N=sa(T==null?void 0:T.id,O==null?void 0:O.id,r);else if(!T||!O){const P=s.getNodePath(m.source),R=s.getNodePath(m.target),k=P.reverse().slice(T?0:1).find(K=>r.find(pt=>pt.id===K)),U=R.reverse().slice(O?0:1).find(K=>r.find(pt=>pt.id===K));T=r.find(K=>K.id===k),O=r.find(K=>K.id===U),N=sa(T==null?void 0:T.id,O==null?void 0:O.id,r,{v:m.source,w:m.target})}if(I=N.reduce((P,R)=>[...P,...R.points.map(k=>Object.assign(Object.assign({},k),{x:k.x+p[0],y:k.y+p[1]}))],[]),I=I.slice(1,-1),m.controlPoints=I,(O==null?void 0:O.type)===Fr.META){const P=l.findIndex(R=>R.id===(O==null?void 0:O.id));if(!l[P]||!((y=l[P].inEdges)===null||y===void 0)&&y.some(R=>R.source===T.id&&R.target===O.id))return;(x=l[P].inEdges)===null||x===void 0||x.push({source:T.id,target:O.id,controlPoints:I})}if((T==null?void 0:T.type)===Fr.META){const P=l.findIndex(R=>R.id===(T==null?void 0:T.id));if(!l[P]||!((w=l[P].outEdges)===null||w===void 0)&&w.some(R=>R.source===T.id&&R.target===O.id))return;(A=l[P].outEdges)===null||A===void 0||A.push({source:T.id,target:O.id,controlPoints:I})}}))}getType(){return"dagreCompound"}getDataByOrder(r){return r.every(o=>o.layoutOrder!==void 0)||r.forEach((o,s)=>{o.layoutOrder=s}),r.sort((o,s)=>o.layoutOrder-s.layoutOrder)}}const $x=Object.prototype.toString;function Dp(i){const r=$x.call(i);return r.endsWith("Array]")&&!r.includes("Big")}function Wx(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Dp(i))throw new TypeError("input must be an array");if(i.length===0)throw new TypeError("input must not be empty");var o=r.fromIndex,s=o===void 0?0:o,l=r.toIndex,h=l===void 0?i.length:l;if(s<0||s>=i.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=s||h>i.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var g=i[s],p=s+1;p<h;p++)i[p]>g&&(g=i[p]);return g}function Rp(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Dp(i))throw new TypeError("input must be an array");if(i.length===0)throw new TypeError("input must not be empty");var o=r.fromIndex,s=o===void 0?0:o,l=r.toIndex,h=l===void 0?i.length:l;if(s<0||s>=i.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=s||h>i.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var g=i[s],p=s+1;p<h;p++)i[p]<g&&(g=i[p]);return g}function Yu(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Dp(i)){if(i.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var o;if(r.output!==void 0){if(!Dp(r.output))throw new TypeError("output option must be an array if specified");o=r.output}else o=new Array(i.length);var s=Rp(i),l=Wx(i);if(s===l)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=r.min,g=h===void 0?r.autoMinMax?s:0:h,p=r.max,m=p===void 0?r.autoMinMax?l:1:p;if(g>=m)throw new RangeError("min option must be smaller than max option");for(var y=(m-g)/(l-s),x=0;x<i.length;x++)o[x]=(i[x]-s)*y+g;return o}const zf=" ".repeat(2),I0=" ".repeat(4);function rx(){return M0(this)}function M0(i,r={}){const{maxRows:o=15,maxColumns:s=10,maxNumSize:l=8}=r;return`${i.constructor.name} {
${zf}[
${I0}${Lp(i,o,s,l)}
${zf}]
${zf}rows: ${i.rows}
${zf}columns: ${i.columns}
}`}function Lp(i,r,o,s){const{rows:l,columns:h}=i,g=Math.min(l,r),p=Math.min(h,o),m=[];for(let y=0;y<g;y++){let x=[];for(let w=0;w<p;w++)x.push(ix(i.get(y,w),s));m.push(`${x.join(" ")}`)}return p!==h&&(m[m.length-1]+=` ... ${h-o} more columns`),g!==l&&m.push(`... ${l-r} more rows`),m.join(`
${I0}`)}function ix(i,r){const o=String(i);if(o.length<=r)return o.padEnd(r," ");const s=i.toPrecision(r-2);if(s.length<=r)return s;const l=i.toExponential(r-2),h=l.indexOf("e"),g=l.slice(h);return l.slice(0,r-g.length)+g}function ox(i,r){i.prototype.add=function(s){return typeof s=="number"?this.addS(s):this.addM(s)},i.prototype.addS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)+s);return this},i.prototype.addM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)+s.get(l,h));return this},i.add=function(s,l){return new r(s).add(l)},i.prototype.sub=function(s){return typeof s=="number"?this.subS(s):this.subM(s)},i.prototype.subS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)-s);return this},i.prototype.subM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)-s.get(l,h));return this},i.sub=function(s,l){return new r(s).sub(l)},i.prototype.subtract=i.prototype.sub,i.prototype.subtractS=i.prototype.subS,i.prototype.subtractM=i.prototype.subM,i.subtract=i.sub,i.prototype.mul=function(s){return typeof s=="number"?this.mulS(s):this.mulM(s)},i.prototype.mulS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)*s);return this},i.prototype.mulM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)*s.get(l,h));return this},i.mul=function(s,l){return new r(s).mul(l)},i.prototype.multiply=i.prototype.mul,i.prototype.multiplyS=i.prototype.mulS,i.prototype.multiplyM=i.prototype.mulM,i.multiply=i.mul,i.prototype.div=function(s){return typeof s=="number"?this.divS(s):this.divM(s)},i.prototype.divS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)/s);return this},i.prototype.divM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)/s.get(l,h));return this},i.div=function(s,l){return new r(s).div(l)},i.prototype.divide=i.prototype.div,i.prototype.divideS=i.prototype.divS,i.prototype.divideM=i.prototype.divM,i.divide=i.div,i.prototype.mod=function(s){return typeof s=="number"?this.modS(s):this.modM(s)},i.prototype.modS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)%s);return this},i.prototype.modM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)%s.get(l,h));return this},i.mod=function(s,l){return new r(s).mod(l)},i.prototype.modulus=i.prototype.mod,i.prototype.modulusS=i.prototype.modS,i.prototype.modulusM=i.prototype.modM,i.modulus=i.mod,i.prototype.and=function(s){return typeof s=="number"?this.andS(s):this.andM(s)},i.prototype.andS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)&s);return this},i.prototype.andM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)&s.get(l,h));return this},i.and=function(s,l){return new r(s).and(l)},i.prototype.or=function(s){return typeof s=="number"?this.orS(s):this.orM(s)},i.prototype.orS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)|s);return this},i.prototype.orM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)|s.get(l,h));return this},i.or=function(s,l){return new r(s).or(l)},i.prototype.xor=function(s){return typeof s=="number"?this.xorS(s):this.xorM(s)},i.prototype.xorS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)^s);return this},i.prototype.xorM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)^s.get(l,h));return this},i.xor=function(s,l){return new r(s).xor(l)},i.prototype.leftShift=function(s){return typeof s=="number"?this.leftShiftS(s):this.leftShiftM(s)},i.prototype.leftShiftS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)<<s);return this},i.prototype.leftShiftM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)<<s.get(l,h));return this},i.leftShift=function(s,l){return new r(s).leftShift(l)},i.prototype.signPropagatingRightShift=function(s){return typeof s=="number"?this.signPropagatingRightShiftS(s):this.signPropagatingRightShiftM(s)},i.prototype.signPropagatingRightShiftS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)>>s);return this},i.prototype.signPropagatingRightShiftM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)>>s.get(l,h));return this},i.signPropagatingRightShift=function(s,l){return new r(s).signPropagatingRightShift(l)},i.prototype.rightShift=function(s){return typeof s=="number"?this.rightShiftS(s):this.rightShiftM(s)},i.prototype.rightShiftS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)>>>s);return this},i.prototype.rightShiftM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,this.get(l,h)>>>s.get(l,h));return this},i.rightShift=function(s,l){return new r(s).rightShift(l)},i.prototype.zeroFillRightShift=i.prototype.rightShift,i.prototype.zeroFillRightShiftS=i.prototype.rightShiftS,i.prototype.zeroFillRightShiftM=i.prototype.rightShiftM,i.zeroFillRightShift=i.rightShift,i.prototype.not=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,~this.get(s,l));return this},i.not=function(s){return new r(s).not()},i.prototype.abs=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.abs(this.get(s,l)));return this},i.abs=function(s){return new r(s).abs()},i.prototype.acos=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.acos(this.get(s,l)));return this},i.acos=function(s){return new r(s).acos()},i.prototype.acosh=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.acosh(this.get(s,l)));return this},i.acosh=function(s){return new r(s).acosh()},i.prototype.asin=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.asin(this.get(s,l)));return this},i.asin=function(s){return new r(s).asin()},i.prototype.asinh=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.asinh(this.get(s,l)));return this},i.asinh=function(s){return new r(s).asinh()},i.prototype.atan=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.atan(this.get(s,l)));return this},i.atan=function(s){return new r(s).atan()},i.prototype.atanh=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.atanh(this.get(s,l)));return this},i.atanh=function(s){return new r(s).atanh()},i.prototype.cbrt=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.cbrt(this.get(s,l)));return this},i.cbrt=function(s){return new r(s).cbrt()},i.prototype.ceil=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.ceil(this.get(s,l)));return this},i.ceil=function(s){return new r(s).ceil()},i.prototype.clz32=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.clz32(this.get(s,l)));return this},i.clz32=function(s){return new r(s).clz32()},i.prototype.cos=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.cos(this.get(s,l)));return this},i.cos=function(s){return new r(s).cos()},i.prototype.cosh=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.cosh(this.get(s,l)));return this},i.cosh=function(s){return new r(s).cosh()},i.prototype.exp=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.exp(this.get(s,l)));return this},i.exp=function(s){return new r(s).exp()},i.prototype.expm1=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.expm1(this.get(s,l)));return this},i.expm1=function(s){return new r(s).expm1()},i.prototype.floor=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.floor(this.get(s,l)));return this},i.floor=function(s){return new r(s).floor()},i.prototype.fround=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.fround(this.get(s,l)));return this},i.fround=function(s){return new r(s).fround()},i.prototype.log=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.log(this.get(s,l)));return this},i.log=function(s){return new r(s).log()},i.prototype.log1p=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.log1p(this.get(s,l)));return this},i.log1p=function(s){return new r(s).log1p()},i.prototype.log10=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.log10(this.get(s,l)));return this},i.log10=function(s){return new r(s).log10()},i.prototype.log2=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.log2(this.get(s,l)));return this},i.log2=function(s){return new r(s).log2()},i.prototype.round=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.round(this.get(s,l)));return this},i.round=function(s){return new r(s).round()},i.prototype.sign=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.sign(this.get(s,l)));return this},i.sign=function(s){return new r(s).sign()},i.prototype.sin=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.sin(this.get(s,l)));return this},i.sin=function(s){return new r(s).sin()},i.prototype.sinh=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.sinh(this.get(s,l)));return this},i.sinh=function(s){return new r(s).sinh()},i.prototype.sqrt=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.sqrt(this.get(s,l)));return this},i.sqrt=function(s){return new r(s).sqrt()},i.prototype.tan=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.tan(this.get(s,l)));return this},i.tan=function(s){return new r(s).tan()},i.prototype.tanh=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.tanh(this.get(s,l)));return this},i.tanh=function(s){return new r(s).tanh()},i.prototype.trunc=function(){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.set(s,l,Math.trunc(this.get(s,l)));return this},i.trunc=function(s){return new r(s).trunc()},i.pow=function(s,l){return new r(s).pow(l)},i.prototype.pow=function(s){return typeof s=="number"?this.powS(s):this.powM(s)},i.prototype.powS=function(s){for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,Math.pow(this.get(l,h),s));return this},i.prototype.powM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(let l=0;l<this.rows;l++)for(let h=0;h<this.columns;h++)this.set(l,h,Math.pow(this.get(l,h),s.get(l,h)));return this}}function po(i,r,o){let s=o?i.rows:i.rows-1;if(r<0||r>s)throw new RangeError("Row index out of range")}function hr(i,r,o){let s=o?i.columns:i.columns-1;if(r<0||r>s)throw new RangeError("Column index out of range")}function ll(i,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==i.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function ul(i,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==i.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function Po(i,r,o){return{row:$i(i,r),column:sx(i,o)}}function $i(i,r){if(typeof r!="object")throw new TypeError("unexpected type for row indices");if(r.some(s=>s<0||s>=i.rows))throw new RangeError("row indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function sx(i,r){if(typeof r!="object")throw new TypeError("unexpected type for column indices");if(r.some(s=>s<0||s>=i.columns))throw new RangeError("column indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function ps(i,r,o,s,l){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Ju("startRow",r),Ju("endRow",o),Ju("startColumn",s),Ju("endColumn",l),r>o||s>l||r<0||r>=i.rows||o<0||o>=i.rows||s<0||s>=i.columns||l<0||l>=i.columns)throw new RangeError("Submatrix indices are out of range")}function hl(i,r=0){let o=[];for(let s=0;s<i;s++)o.push(r);return o}function Ju(i,r){if(typeof r!="number")throw new TypeError(`${i} must be a number`)}function N0(i){let r=hl(i.rows);for(let o=0;o<i.rows;++o)for(let s=0;s<i.columns;++s)r[o]+=i.get(o,s);return r}function P0(i){let r=hl(i.columns);for(let o=0;o<i.rows;++o)for(let s=0;s<i.columns;++s)r[s]+=i.get(o,s);return r}function D0(i){let r=0;for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)r+=i.get(o,s);return r}function R0(i){let r=hl(i.rows,1);for(let o=0;o<i.rows;++o)for(let s=0;s<i.columns;++s)r[o]*=i.get(o,s);return r}function L0(i){let r=hl(i.columns,1);for(let o=0;o<i.rows;++o)for(let s=0;s<i.columns;++s)r[s]*=i.get(o,s);return r}function k0(i){let r=1;for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)r*=i.get(o,s);return r}function B0(i,r,o){const s=i.rows,l=i.columns,h=[];for(let g=0;g<s;g++){let p=0,m=0,y=0;for(let x=0;x<l;x++)y=i.get(g,x)-o[g],p+=y,m+=y*y;r?h.push((m-p*p/l)/(l-1)):h.push((m-p*p/l)/l)}return h}function j0(i,r,o){const s=i.rows,l=i.columns,h=[];for(let g=0;g<l;g++){let p=0,m=0,y=0;for(let x=0;x<s;x++)y=i.get(x,g)-o[g],p+=y,m+=y*y;r?h.push((m-p*p/s)/(s-1)):h.push((m-p*p/s)/s)}return h}function F0(i,r,o){const s=i.rows,l=i.columns,h=s*l;let g=0,p=0,m=0;for(let y=0;y<s;y++)for(let x=0;x<l;x++)m=i.get(y,x)-o,g+=m,p+=m*m;return r?(p-g*g/h)/(h-1):(p-g*g/h)/h}function G0(i,r){for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)i.set(o,s,i.get(o,s)-r[o])}function z0(i,r){for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)i.set(o,s,i.get(o,s)-r[s])}function U0(i,r){for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)i.set(o,s,i.get(o,s)-r)}function V0(i){const r=[];for(let o=0;o<i.rows;o++){let s=0;for(let l=0;l<i.columns;l++)s+=Math.pow(i.get(o,l),2)/(i.columns-1);r.push(Math.sqrt(s))}return r}function H0(i,r){for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)i.set(o,s,i.get(o,s)/r[o])}function ms(i){const r=[];for(let o=0;o<i.columns;o++){let s=0;for(let l=0;l<i.rows;l++)s+=Math.pow(i.get(l,o),2)/(i.rows-1);r.push(Math.sqrt(s))}return r}function kp(i,r){for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)i.set(o,s,i.get(o,s)/r[s])}function Bp(i){const r=i.size-1;let o=0;for(let s=0;s<i.columns;s++)for(let l=0;l<i.rows;l++)o+=Math.pow(i.get(l,s),2)/r;return Math.sqrt(o)}function fl(i,r){for(let o=0;o<i.rows;o++)for(let s=0;s<i.columns;s++)i.set(o,s,i.get(o,s)/r)}class dn{static from1DArray(r,o,s){if(r*o!==s.length)throw new RangeError("data length does not match given dimensions");let h=new xe(r,o);for(let g=0;g<r;g++)for(let p=0;p<o;p++)h.set(g,p,s[g*o+p]);return h}static rowVector(r){let o=new xe(1,r.length);for(let s=0;s<r.length;s++)o.set(0,s,r[s]);return o}static columnVector(r){let o=new xe(r.length,1);for(let s=0;s<r.length;s++)o.set(s,0,r[s]);return o}static zeros(r,o){return new xe(r,o)}static ones(r,o){return new xe(r,o).fill(1)}static rand(r,o,s={}){if(typeof s!="object")throw new TypeError("options must be an object");const{random:l=Math.random}=s;let h=new xe(r,o);for(let g=0;g<r;g++)for(let p=0;p<o;p++)h.set(g,p,l());return h}static randInt(r,o,s={}){if(typeof s!="object")throw new TypeError("options must be an object");const{min:l=0,max:h=1e3,random:g=Math.random}=s;if(!Number.isInteger(l))throw new TypeError("min must be an integer");if(!Number.isInteger(h))throw new TypeError("max must be an integer");if(l>=h)throw new RangeError("min must be smaller than max");let p=h-l,m=new xe(r,o);for(let y=0;y<r;y++)for(let x=0;x<o;x++){let w=l+Math.round(g()*p);m.set(y,x,w)}return m}static eye(r,o,s){o===void 0&&(o=r),s===void 0&&(s=1);let l=Math.min(r,o),h=this.zeros(r,o);for(let g=0;g<l;g++)h.set(g,g,s);return h}static diag(r,o,s){let l=r.length;o===void 0&&(o=l),s===void 0&&(s=o);let h=Math.min(l,o,s),g=this.zeros(o,s);for(let p=0;p<h;p++)g.set(p,p,r[p]);return g}static min(r,o){r=this.checkMatrix(r),o=this.checkMatrix(o);let s=r.rows,l=r.columns,h=new xe(s,l);for(let g=0;g<s;g++)for(let p=0;p<l;p++)h.set(g,p,Math.min(r.get(g,p),o.get(g,p)));return h}static max(r,o){r=this.checkMatrix(r),o=this.checkMatrix(o);let s=r.rows,l=r.columns,h=new this(s,l);for(let g=0;g<s;g++)for(let p=0;p<l;p++)h.set(g,p,Math.max(r.get(g,p),o.get(g,p)));return h}static checkMatrix(r){return dn.isMatrix(r)?r:new xe(r)}static isMatrix(r){return r!=null&&r.klass==="Matrix"}get size(){return this.rows*this.columns}apply(r){if(typeof r!="function")throw new TypeError("callback must be a function");for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)r.call(this,o,s);return this}to1DArray(){let r=[];for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)r.push(this.get(o,s));return r}to2DArray(){let r=[];for(let o=0;o<this.rows;o++){r.push([]);for(let s=0;s<this.columns;s++)r[o].push(this.get(o,s))}return r}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(let r=0;r<this.rows;r++)for(let o=0;o<=r;o++)if(this.get(r,o)!==this.get(o,r))return!1;return!0}return!1}isEchelonForm(){let r=0,o=0,s=-1,l=!0,h=!1;for(;r<this.rows&&l;){for(o=0,h=!1;o<this.columns&&h===!1;)this.get(r,o)===0?o++:this.get(r,o)===1&&o>s?(h=!0,s=o):(l=!1,h=!0);r++}return l}isReducedEchelonForm(){let r=0,o=0,s=-1,l=!0,h=!1;for(;r<this.rows&&l;){for(o=0,h=!1;o<this.columns&&h===!1;)this.get(r,o)===0?o++:this.get(r,o)===1&&o>s?(h=!0,s=o):(l=!1,h=!0);for(let g=o+1;g<this.rows;g++)this.get(r,g)!==0&&(l=!1);r++}return l}echelonForm(){let r=this.clone(),o=0,s=0;for(;o<r.rows&&s<r.columns;){let l=o;for(let h=o;h<r.rows;h++)r.get(h,s)>r.get(l,s)&&(l=h);if(r.get(l,s)===0)s++;else{r.swapRows(o,l);let h=r.get(o,s);for(let g=s;g<r.columns;g++)r.set(o,g,r.get(o,g)/h);for(let g=o+1;g<r.rows;g++){let p=r.get(g,s)/r.get(o,s);r.set(g,s,0);for(let m=s+1;m<r.columns;m++)r.set(g,m,r.get(g,m)-r.get(o,m)*p)}o++,s++}}return r}reducedEchelonForm(){let r=this.echelonForm(),o=r.columns,s=r.rows,l=s-1;for(;l>=0;)if(r.maxRow(l)===0)l--;else{let h=0,g=!1;for(;h<s&&g===!1;)r.get(l,h)===1?g=!0:h++;for(let p=0;p<l;p++){let m=r.get(p,h);for(let y=h;y<o;y++){let x=r.get(p,y)-m*r.get(l,y);r.set(p,y,x)}}l--}return r}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{rows:o=1,columns:s=1}=r;if(!Number.isInteger(o)||o<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(s)||s<=0)throw new TypeError("columns must be a positive integer");let l=new xe(this.rows*o,this.columns*s);for(let h=0;h<o;h++)for(let g=0;g<s;g++)l.setSubMatrix(this,this.rows*h,this.columns*g);return l}fill(r){for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,r);return this}neg(){return this.mulS(-1)}getRow(r){po(this,r);let o=[];for(let s=0;s<this.columns;s++)o.push(this.get(r,s));return o}getRowVector(r){return xe.rowVector(this.getRow(r))}setRow(r,o){po(this,r),o=ll(this,o);for(let s=0;s<this.columns;s++)this.set(r,s,o[s]);return this}swapRows(r,o){po(this,r),po(this,o);for(let s=0;s<this.columns;s++){let l=this.get(r,s);this.set(r,s,this.get(o,s)),this.set(o,s,l)}return this}getColumn(r){hr(this,r);let o=[];for(let s=0;s<this.rows;s++)o.push(this.get(s,r));return o}getColumnVector(r){return xe.columnVector(this.getColumn(r))}setColumn(r,o){hr(this,r),o=ul(this,o);for(let s=0;s<this.rows;s++)this.set(s,r,o[s]);return this}swapColumns(r,o){hr(this,r),hr(this,o);for(let s=0;s<this.rows;s++){let l=this.get(s,r);this.set(s,r,this.get(s,o)),this.set(s,o,l)}return this}addRowVector(r){r=ll(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)+r[s]);return this}subRowVector(r){r=ll(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)-r[s]);return this}mulRowVector(r){r=ll(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)*r[s]);return this}divRowVector(r){r=ll(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)/r[s]);return this}addColumnVector(r){r=ul(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)+r[o]);return this}subColumnVector(r){r=ul(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)-r[o]);return this}mulColumnVector(r){r=ul(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)*r[o]);return this}divColumnVector(r){r=ul(this,r);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.set(o,s,this.get(o,s)/r[o]);return this}mulRow(r,o){po(this,r);for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)*o);return this}mulColumn(r,o){hr(this,r);for(let s=0;s<this.rows;s++)this.set(s,r,this.get(s,r)*o);return this}max(){let r=this.get(0,0);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.get(o,s)>r&&(r=this.get(o,s));return r}maxIndex(){let r=this.get(0,0),o=[0,0];for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.get(s,l)>r&&(r=this.get(s,l),o[0]=s,o[1]=l);return o}min(){let r=this.get(0,0);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)this.get(o,s)<r&&(r=this.get(o,s));return r}minIndex(){let r=this.get(0,0),o=[0,0];for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)this.get(s,l)<r&&(r=this.get(s,l),o[0]=s,o[1]=l);return o}maxRow(r){po(this,r);let o=this.get(r,0);for(let s=1;s<this.columns;s++)this.get(r,s)>o&&(o=this.get(r,s));return o}maxRowIndex(r){po(this,r);let o=this.get(r,0),s=[r,0];for(let l=1;l<this.columns;l++)this.get(r,l)>o&&(o=this.get(r,l),s[1]=l);return s}minRow(r){po(this,r);let o=this.get(r,0);for(let s=1;s<this.columns;s++)this.get(r,s)<o&&(o=this.get(r,s));return o}minRowIndex(r){po(this,r);let o=this.get(r,0),s=[r,0];for(let l=1;l<this.columns;l++)this.get(r,l)<o&&(o=this.get(r,l),s[1]=l);return s}maxColumn(r){hr(this,r);let o=this.get(0,r);for(let s=1;s<this.rows;s++)this.get(s,r)>o&&(o=this.get(s,r));return o}maxColumnIndex(r){hr(this,r);let o=this.get(0,r),s=[0,r];for(let l=1;l<this.rows;l++)this.get(l,r)>o&&(o=this.get(l,r),s[0]=l);return s}minColumn(r){hr(this,r);let o=this.get(0,r);for(let s=1;s<this.rows;s++)this.get(s,r)<o&&(o=this.get(s,r));return o}minColumnIndex(r){hr(this,r);let o=this.get(0,r),s=[0,r];for(let l=1;l<this.rows;l++)this.get(l,r)<o&&(o=this.get(l,r),s[0]=l);return s}diag(){let r=Math.min(this.rows,this.columns),o=[];for(let s=0;s<r;s++)o.push(this.get(s,s));return o}norm(r="frobenius"){let o=0;if(r==="max")return this.max();if(r==="frobenius"){for(let s=0;s<this.rows;s++)for(let l=0;l<this.columns;l++)o=o+this.get(s,l)*this.get(s,l);return Math.sqrt(o)}else throw new RangeError(`unknown norm type: ${r}`)}cumulativeSum(){let r=0;for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)r+=this.get(o,s),this.set(o,s,r);return this}dot(r){dn.isMatrix(r)&&(r=r.to1DArray());let o=this.to1DArray();if(o.length!==r.length)throw new RangeError("vectors do not have the same size");let s=0;for(let l=0;l<o.length;l++)s+=o[l]*r[l];return s}mmul(r){r=xe.checkMatrix(r);let o=this.rows,s=this.columns,l=r.columns,h=new xe(o,l),g=new Float64Array(s);for(let p=0;p<l;p++){for(let m=0;m<s;m++)g[m]=r.get(m,p);for(let m=0;m<o;m++){let y=0;for(let x=0;x<s;x++)y+=this.get(m,x)*g[x];h.set(m,p,y)}}return h}strassen2x2(r){r=xe.checkMatrix(r);let o=new xe(2,2);const s=this.get(0,0),l=r.get(0,0),h=this.get(0,1),g=r.get(0,1),p=this.get(1,0),m=r.get(1,0),y=this.get(1,1),x=r.get(1,1),w=(s+y)*(l+x),A=(p+y)*l,T=s*(g-x),O=y*(m-l),I=(s+h)*x,N=(p-s)*(l+g),P=(h-y)*(m+x),R=w+O-I+P,k=T+I,U=A+O,K=w-A+T+N;return o.set(0,0,R),o.set(0,1,k),o.set(1,0,U),o.set(1,1,K),o}strassen3x3(r){r=xe.checkMatrix(r);let o=new xe(3,3);const s=this.get(0,0),l=this.get(0,1),h=this.get(0,2),g=this.get(1,0),p=this.get(1,1),m=this.get(1,2),y=this.get(2,0),x=this.get(2,1),w=this.get(2,2),A=r.get(0,0),T=r.get(0,1),O=r.get(0,2),I=r.get(1,0),N=r.get(1,1),P=r.get(1,2),R=r.get(2,0),k=r.get(2,1),U=r.get(2,2),K=(s+l+h-g-p-x-w)*N,pt=(s-g)*(-T+N),Ot=p*(-A+T+I-N-P-R+U),It=(-s+g+p)*(A-T+N),Ct=(g+p)*(-A+T),_t=s*A,F=(-s+y+x)*(A-O+P),Z=(-s+y)*(O-P),yt=(y+x)*(-A+O),bt=(s+l+h-p-m-y-x)*P,de=x*(-A+O+I-N-P-R+k),Ne=(-h+x+w)*(N+R-k),Ee=(h-w)*(N-k),Ie=h*R,Ge=(x+w)*(-R+k),Qe=(-h+p+m)*(P+R-U),Xn=(h-m)*(P-U),Mn=(p+m)*(-R+U),Un=l*I,Ut=m*k,un=g*O,Nn=y*T,En=w*U,xn=_t+Ie+Un,We=K+It+Ct+_t+Ne+Ie+Ge,Xe=_t+F+yt+bt+Ie+Qe+Mn,rr=pt+Ot+It+_t+Ie+Qe+Xn,Lr=pt+It+Ct+_t+Ut,Tr=Ie+Qe+Xn+Mn+un,kn=_t+F+Z+de+Ne+Ee+Ie,fr=Ne+Ee+Ie+Ge+Nn,Vr=_t+F+Z+yt+En;return o.set(0,0,xn),o.set(0,1,We),o.set(0,2,Xe),o.set(1,0,rr),o.set(1,1,Lr),o.set(1,2,Tr),o.set(2,0,kn),o.set(2,1,fr),o.set(2,2,Vr),o}mmulStrassen(r){r=xe.checkMatrix(r);let o=this.clone(),s=o.rows,l=o.columns,h=r.rows,g=r.columns;l!==h&&console.warn(`Multiplying ${s} x ${l} and ${h} x ${g} matrix: dimensions do not match.`);function p(w,A,T){let O=w.rows,I=w.columns;if(O===A&&I===T)return w;{let N=dn.zeros(A,T);return N=N.setSubMatrix(w,0,0),N}}let m=Math.max(s,h),y=Math.max(l,g);o=p(o,m,y),r=p(r,m,y);function x(w,A,T,O){if(T<=512||O<=512)return w.mmul(A);T%2===1&&O%2===1?(w=p(w,T+1,O+1),A=p(A,T+1,O+1)):T%2===1?(w=p(w,T+1,O),A=p(A,T+1,O)):O%2===1&&(w=p(w,T,O+1),A=p(A,T,O+1));let I=parseInt(w.rows/2,10),N=parseInt(w.columns/2,10),P=w.subMatrix(0,I-1,0,N-1),R=A.subMatrix(0,I-1,0,N-1),k=w.subMatrix(0,I-1,N,w.columns-1),U=A.subMatrix(0,I-1,N,A.columns-1),K=w.subMatrix(I,w.rows-1,0,N-1),pt=A.subMatrix(I,A.rows-1,0,N-1),Ot=w.subMatrix(I,w.rows-1,N,w.columns-1),It=A.subMatrix(I,A.rows-1,N,A.columns-1),Ct=x(dn.add(P,Ot),dn.add(R,It),I,N),_t=x(dn.add(K,Ot),R,I,N),F=x(P,dn.sub(U,It),I,N),Z=x(Ot,dn.sub(pt,R),I,N),yt=x(dn.add(P,k),It,I,N),bt=x(dn.sub(K,P),dn.add(R,U),I,N),de=x(dn.sub(k,Ot),dn.add(pt,It),I,N),Ne=dn.add(Ct,Z);Ne.sub(yt),Ne.add(de);let Ee=dn.add(F,yt),Ie=dn.add(_t,Z),Ge=dn.sub(Ct,_t);Ge.add(F),Ge.add(bt);let Qe=dn.zeros(2*Ne.rows,2*Ne.columns);return Qe=Qe.setSubMatrix(Ne,0,0),Qe=Qe.setSubMatrix(Ee,Ne.rows,0),Qe=Qe.setSubMatrix(Ie,0,Ne.columns),Qe=Qe.setSubMatrix(Ge,Ne.rows,Ne.columns),Qe.subMatrix(0,T-1,0,O-1)}return x(o,r,m,y)}scaleRows(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:o=0,max:s=1}=r;if(!Number.isFinite(o))throw new TypeError("min must be a number");if(!Number.isFinite(s))throw new TypeError("max must be a number");if(o>=s)throw new RangeError("min must be smaller than max");let l=new xe(this.rows,this.columns);for(let h=0;h<this.rows;h++){const g=this.getRow(h);Yu(g,{min:o,max:s,output:g}),l.setRow(h,g)}return l}scaleColumns(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:o=0,max:s=1}=r;if(!Number.isFinite(o))throw new TypeError("min must be a number");if(!Number.isFinite(s))throw new TypeError("max must be a number");if(o>=s)throw new RangeError("min must be smaller than max");let l=new xe(this.rows,this.columns);for(let h=0;h<this.columns;h++){const g=this.getColumn(h);Yu(g,{min:o,max:s,output:g}),l.setColumn(h,g)}return l}flipRows(){const r=Math.ceil(this.columns/2);for(let o=0;o<this.rows;o++)for(let s=0;s<r;s++){let l=this.get(o,s),h=this.get(o,this.columns-1-s);this.set(o,s,h),this.set(o,this.columns-1-s,l)}return this}flipColumns(){const r=Math.ceil(this.rows/2);for(let o=0;o<this.columns;o++)for(let s=0;s<r;s++){let l=this.get(s,o),h=this.get(this.rows-1-s,o);this.set(s,o,h),this.set(this.rows-1-s,o,l)}return this}kroneckerProduct(r){r=xe.checkMatrix(r);let o=this.rows,s=this.columns,l=r.rows,h=r.columns,g=new xe(o*l,s*h);for(let p=0;p<o;p++)for(let m=0;m<s;m++)for(let y=0;y<l;y++)for(let x=0;x<h;x++)g.set(l*p+y,h*m+x,this.get(p,m)*r.get(y,x));return g}transpose(){let r=new xe(this.columns,this.rows);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)r.set(s,o,this.get(o,s));return r}sortRows(r=aa){for(let o=0;o<this.rows;o++)this.setRow(o,this.getRow(o).sort(r));return this}sortColumns(r=aa){for(let o=0;o<this.columns;o++)this.setColumn(o,this.getColumn(o).sort(r));return this}subMatrix(r,o,s,l){ps(this,r,o,s,l);let h=new xe(o-r+1,l-s+1);for(let g=r;g<=o;g++)for(let p=s;p<=l;p++)h.set(g-r,p-s,this.get(g,p));return h}subMatrixRow(r,o,s){if(o===void 0&&(o=0),s===void 0&&(s=this.columns-1),o>s||o<0||o>=this.columns||s<0||s>=this.columns)throw new RangeError("Argument out of range");let l=new xe(r.length,s-o+1);for(let h=0;h<r.length;h++)for(let g=o;g<=s;g++){if(r[h]<0||r[h]>=this.rows)throw new RangeError(`Row index out of range: ${r[h]}`);l.set(h,g-o,this.get(r[h],g))}return l}subMatrixColumn(r,o,s){if(o===void 0&&(o=0),s===void 0&&(s=this.rows-1),o>s||o<0||o>=this.rows||s<0||s>=this.rows)throw new RangeError("Argument out of range");let l=new xe(s-o+1,r.length);for(let h=0;h<r.length;h++)for(let g=o;g<=s;g++){if(r[h]<0||r[h]>=this.columns)throw new RangeError(`Column index out of range: ${r[h]}`);l.set(g-o,h,this.get(g,r[h]))}return l}setSubMatrix(r,o,s){r=xe.checkMatrix(r);let l=o+r.rows-1,h=s+r.columns-1;ps(this,o,l,s,h);for(let g=0;g<r.rows;g++)for(let p=0;p<r.columns;p++)this.set(o+g,s+p,r.get(g,p));return this}selection(r,o){let s=Po(this,r,o),l=new xe(r.length,o.length);for(let h=0;h<s.row.length;h++){let g=s.row[h];for(let p=0;p<s.column.length;p++){let m=s.column[p];l.set(h,p,this.get(g,m))}}return l}trace(){let r=Math.min(this.rows,this.columns),o=0;for(let s=0;s<r;s++)o+=this.get(s,s);return o}clone(){let r=new xe(this.rows,this.columns);for(let o=0;o<this.rows;o++)for(let s=0;s<this.columns;s++)r.set(o,s,this.get(o,s));return r}sum(r){switch(r){case"row":return N0(this);case"column":return P0(this);case void 0:return D0(this);default:throw new Error(`invalid option: ${r}`)}}product(r){switch(r){case"row":return R0(this);case"column":return L0(this);case void 0:return k0(this);default:throw new Error(`invalid option: ${r}`)}}mean(r){const o=this.sum(r);switch(r){case"row":{for(let s=0;s<this.rows;s++)o[s]/=this.columns;return o}case"column":{for(let s=0;s<this.columns;s++)o[s]/=this.rows;return o}case void 0:return o/this.size;default:throw new Error(`invalid option: ${r}`)}}variance(r,o={}){if(typeof r=="object"&&(o=r,r=void 0),typeof o!="object")throw new TypeError("options must be an object");const{unbiased:s=!0,mean:l=this.mean(r)}=o;if(typeof s!="boolean")throw new TypeError("unbiased must be a boolean");switch(r){case"row":{if(!Array.isArray(l))throw new TypeError("mean must be an array");return B0(this,s,l)}case"column":{if(!Array.isArray(l))throw new TypeError("mean must be an array");return j0(this,s,l)}case void 0:{if(typeof l!="number")throw new TypeError("mean must be a number");return F0(this,s,l)}default:throw new Error(`invalid option: ${r}`)}}standardDeviation(r,o){typeof r=="object"&&(o=r,r=void 0);const s=this.variance(r,o);if(r===void 0)return Math.sqrt(s);for(let l=0;l<s.length;l++)s[l]=Math.sqrt(s[l]);return s}center(r,o={}){if(typeof r=="object"&&(o=r,r=void 0),typeof o!="object")throw new TypeError("options must be an object");const{center:s=this.mean(r)}=o;switch(r){case"row":{if(!Array.isArray(s))throw new TypeError("center must be an array");return G0(this,s),this}case"column":{if(!Array.isArray(s))throw new TypeError("center must be an array");return z0(this,s),this}case void 0:{if(typeof s!="number")throw new TypeError("center must be a number");return U0(this,s),this}default:throw new Error(`invalid option: ${r}`)}}scale(r,o={}){if(typeof r=="object"&&(o=r,r=void 0),typeof o!="object")throw new TypeError("options must be an object");let s=o.scale;switch(r){case"row":{if(s===void 0)s=V0(this);else if(!Array.isArray(s))throw new TypeError("scale must be an array");return H0(this,s),this}case"column":{if(s===void 0)s=ms(this);else if(!Array.isArray(s))throw new TypeError("scale must be an array");return kp(this,s),this}case void 0:{if(s===void 0)s=Bp(this);else if(typeof s!="number")throw new TypeError("scale must be a number");return fl(this,s),this}default:throw new Error(`invalid option: ${r}`)}}toString(r){return M0(this,r)}}dn.prototype.klass="Matrix",typeof Symbol<"u"&&(dn.prototype[Symbol.for("nodejs.util.inspect.custom")]=rx);function aa(i,r){return i-r}dn.random=dn.rand,dn.randomInt=dn.randInt,dn.diagonal=dn.diag,dn.prototype.diagonal=dn.prototype.diag,dn.identity=dn.eye,dn.prototype.negate=dn.prototype.neg,dn.prototype.tensorProduct=dn.prototype.kroneckerProduct;class xe extends dn{constructor(r,o){if(super(),xe.isMatrix(r))return r.clone();if(Number.isInteger(r)&&r>0)if(this.data=[],Number.isInteger(o)&&o>0)for(let s=0;s<r;s++)this.data.push(new Float64Array(o));else throw new TypeError("nColumns must be a positive integer");else if(Array.isArray(r)){const s=r;if(r=s.length,o=s[0].length,typeof o!="number"||o===0)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let l=0;l<r;l++){if(s[l].length!==o)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(s[l]))}}else throw new TypeError("First argument must be a positive number or an array");return this.rows=r,this.columns=o,this}set(r,o,s){return this.data[r][o]=s,this}get(r,o){return this.data[r][o]}removeRow(r){if(po(this,r),this.rows===1)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(r,1),this.rows-=1,this}addRow(r,o){return o===void 0&&(o=r,r=this.rows),po(this,r,!0),o=Float64Array.from(ll(this,o,!0)),this.data.splice(r,0,o),this.rows+=1,this}removeColumn(r){if(hr(this,r),this.columns===1)throw new RangeError("A matrix cannot have less than one column");for(let o=0;o<this.rows;o++){const s=new Float64Array(this.columns-1);for(let l=0;l<r;l++)s[l]=this.data[o][l];for(let l=r+1;l<this.columns;l++)s[l-1]=this.data[o][l];this.data[o]=s}return this.columns-=1,this}addColumn(r,o){typeof o>"u"&&(o=r,r=this.columns),hr(this,r,!0),o=ul(this,o);for(let s=0;s<this.rows;s++){const l=new Float64Array(this.columns+1);let h=0;for(;h<r;h++)l[h]=this.data[s][h];for(l[h++]=o[s];h<this.columns+1;h++)l[h]=this.data[s][h-1];this.data[s]=l}return this.columns+=1,this}}ox(dn,xe);class Mi extends dn{constructor(r){super(),this.data=r,this.rows=r.length,this.columns=r[0].length}set(r,o,s){return this.data[r][o]=s,this}get(r,o){return this.data[r][o]}}function ca(i,r){let o=0;return Math.abs(i)>Math.abs(r)?(o=r/i,Math.abs(i)*Math.sqrt(1+o*o)):r!==0?(o=i/r,Math.abs(r)*Math.sqrt(1+o*o)):0}class jp{constructor(r,o={}){r=Mi.checkMatrix(r);let s=r.rows,l=r.columns;const{computeLeftSingularVectors:h=!0,computeRightSingularVectors:g=!0,autoTranspose:p=!1}=o;let m=!!h,y=!!g,x=!1,w;if(s<l)if(!p)w=r.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{w=r.transpose(),s=w.rows,l=w.columns,x=!0;let F=m;m=y,y=F}else w=r.clone();let A=Math.min(s,l),T=Math.min(s+1,l),O=new Float64Array(T),I=new xe(s,A),N=new xe(l,l),P=new Float64Array(l),R=new Float64Array(s),k=new Float64Array(T);for(let F=0;F<T;F++)k[F]=F;let U=Math.min(s-1,l),K=Math.max(0,Math.min(l-2,s)),pt=Math.max(U,K);for(let F=0;F<pt;F++){if(F<U){O[F]=0;for(let Z=F;Z<s;Z++)O[F]=ca(O[F],w.get(Z,F));if(O[F]!==0){w.get(F,F)<0&&(O[F]=-O[F]);for(let Z=F;Z<s;Z++)w.set(Z,F,w.get(Z,F)/O[F]);w.set(F,F,w.get(F,F)+1)}O[F]=-O[F]}for(let Z=F+1;Z<l;Z++){if(F<U&&O[F]!==0){let yt=0;for(let bt=F;bt<s;bt++)yt+=w.get(bt,F)*w.get(bt,Z);yt=-yt/w.get(F,F);for(let bt=F;bt<s;bt++)w.set(bt,Z,w.get(bt,Z)+yt*w.get(bt,F))}P[Z]=w.get(F,Z)}if(m&&F<U)for(let Z=F;Z<s;Z++)I.set(Z,F,w.get(Z,F));if(F<K){P[F]=0;for(let Z=F+1;Z<l;Z++)P[F]=ca(P[F],P[Z]);if(P[F]!==0){P[F+1]<0&&(P[F]=0-P[F]);for(let Z=F+1;Z<l;Z++)P[Z]/=P[F];P[F+1]+=1}if(P[F]=-P[F],F+1<s&&P[F]!==0){for(let Z=F+1;Z<s;Z++)R[Z]=0;for(let Z=F+1;Z<s;Z++)for(let yt=F+1;yt<l;yt++)R[Z]+=P[yt]*w.get(Z,yt);for(let Z=F+1;Z<l;Z++){let yt=-P[Z]/P[F+1];for(let bt=F+1;bt<s;bt++)w.set(bt,Z,w.get(bt,Z)+yt*R[bt])}}if(y)for(let Z=F+1;Z<l;Z++)N.set(Z,F,P[Z])}}let Ot=Math.min(l,s+1);if(U<l&&(O[U]=w.get(U,U)),s<Ot&&(O[Ot-1]=0),K+1<Ot&&(P[K]=w.get(K,Ot-1)),P[Ot-1]=0,m){for(let F=U;F<A;F++){for(let Z=0;Z<s;Z++)I.set(Z,F,0);I.set(F,F,1)}for(let F=U-1;F>=0;F--)if(O[F]!==0){for(let Z=F+1;Z<A;Z++){let yt=0;for(let bt=F;bt<s;bt++)yt+=I.get(bt,F)*I.get(bt,Z);yt=-yt/I.get(F,F);for(let bt=F;bt<s;bt++)I.set(bt,Z,I.get(bt,Z)+yt*I.get(bt,F))}for(let Z=F;Z<s;Z++)I.set(Z,F,-I.get(Z,F));I.set(F,F,1+I.get(F,F));for(let Z=0;Z<F-1;Z++)I.set(Z,F,0)}else{for(let Z=0;Z<s;Z++)I.set(Z,F,0);I.set(F,F,1)}}if(y)for(let F=l-1;F>=0;F--){if(F<K&&P[F]!==0)for(let Z=F+1;Z<l;Z++){let yt=0;for(let bt=F+1;bt<l;bt++)yt+=N.get(bt,F)*N.get(bt,Z);yt=-yt/N.get(F+1,F);for(let bt=F+1;bt<l;bt++)N.set(bt,Z,N.get(bt,Z)+yt*N.get(bt,F))}for(let Z=0;Z<l;Z++)N.set(Z,F,0);N.set(F,F,1)}let It=Ot-1,Ct=0,_t=Number.EPSILON;for(;Ot>0;){let F,Z;for(F=Ot-2;F>=-1&&F!==-1;F--){const yt=Number.MIN_VALUE+_t*Math.abs(O[F]+Math.abs(O[F+1]));if(Math.abs(P[F])<=yt||Number.isNaN(P[F])){P[F]=0;break}}if(F===Ot-2)Z=4;else{let yt;for(yt=Ot-1;yt>=F&&yt!==F;yt--){let bt=(yt!==Ot?Math.abs(P[yt]):0)+(yt!==F+1?Math.abs(P[yt-1]):0);if(Math.abs(O[yt])<=_t*bt){O[yt]=0;break}}yt===F?Z=3:yt===Ot-1?Z=1:(Z=2,F=yt)}switch(F++,Z){case 1:{let yt=P[Ot-2];P[Ot-2]=0;for(let bt=Ot-2;bt>=F;bt--){let de=ca(O[bt],yt),Ne=O[bt]/de,Ee=yt/de;if(O[bt]=de,bt!==F&&(yt=-Ee*P[bt-1],P[bt-1]=Ne*P[bt-1]),y)for(let Ie=0;Ie<l;Ie++)de=Ne*N.get(Ie,bt)+Ee*N.get(Ie,Ot-1),N.set(Ie,Ot-1,-Ee*N.get(Ie,bt)+Ne*N.get(Ie,Ot-1)),N.set(Ie,bt,de)}break}case 2:{let yt=P[F-1];P[F-1]=0;for(let bt=F;bt<Ot;bt++){let de=ca(O[bt],yt),Ne=O[bt]/de,Ee=yt/de;if(O[bt]=de,yt=-Ee*P[bt],P[bt]=Ne*P[bt],m)for(let Ie=0;Ie<s;Ie++)de=Ne*I.get(Ie,bt)+Ee*I.get(Ie,F-1),I.set(Ie,F-1,-Ee*I.get(Ie,bt)+Ne*I.get(Ie,F-1)),I.set(Ie,bt,de)}break}case 3:{const yt=Math.max(Math.abs(O[Ot-1]),Math.abs(O[Ot-2]),Math.abs(P[Ot-2]),Math.abs(O[F]),Math.abs(P[F])),bt=O[Ot-1]/yt,de=O[Ot-2]/yt,Ne=P[Ot-2]/yt,Ee=O[F]/yt,Ie=P[F]/yt,Ge=((de+bt)*(de-bt)+Ne*Ne)/2,Qe=bt*Ne*(bt*Ne);let Xn=0;(Ge!==0||Qe!==0)&&(Ge<0?Xn=0-Math.sqrt(Ge*Ge+Qe):Xn=Math.sqrt(Ge*Ge+Qe),Xn=Qe/(Ge+Xn));let Mn=(Ee+bt)*(Ee-bt)+Xn,Un=Ee*Ie;for(let Ut=F;Ut<Ot-1;Ut++){let un=ca(Mn,Un);un===0&&(un=Number.MIN_VALUE);let Nn=Mn/un,En=Un/un;if(Ut!==F&&(P[Ut-1]=un),Mn=Nn*O[Ut]+En*P[Ut],P[Ut]=Nn*P[Ut]-En*O[Ut],Un=En*O[Ut+1],O[Ut+1]=Nn*O[Ut+1],y)for(let xn=0;xn<l;xn++)un=Nn*N.get(xn,Ut)+En*N.get(xn,Ut+1),N.set(xn,Ut+1,-En*N.get(xn,Ut)+Nn*N.get(xn,Ut+1)),N.set(xn,Ut,un);if(un=ca(Mn,Un),un===0&&(un=Number.MIN_VALUE),Nn=Mn/un,En=Un/un,O[Ut]=un,Mn=Nn*P[Ut]+En*O[Ut+1],O[Ut+1]=-En*P[Ut]+Nn*O[Ut+1],Un=En*P[Ut+1],P[Ut+1]=Nn*P[Ut+1],m&&Ut<s-1)for(let xn=0;xn<s;xn++)un=Nn*I.get(xn,Ut)+En*I.get(xn,Ut+1),I.set(xn,Ut+1,-En*I.get(xn,Ut)+Nn*I.get(xn,Ut+1)),I.set(xn,Ut,un)}P[Ot-2]=Mn,Ct=Ct+1;break}case 4:{if(O[F]<=0&&(O[F]=O[F]<0?-O[F]:0,y))for(let yt=0;yt<=It;yt++)N.set(yt,F,-N.get(yt,F));for(;F<It&&!(O[F]>=O[F+1]);){let yt=O[F];if(O[F]=O[F+1],O[F+1]=yt,y&&F<l-1)for(let bt=0;bt<l;bt++)yt=N.get(bt,F+1),N.set(bt,F+1,N.get(bt,F)),N.set(bt,F,yt);if(m&&F<s-1)for(let bt=0;bt<s;bt++)yt=I.get(bt,F+1),I.set(bt,F+1,I.get(bt,F)),I.set(bt,F,yt);F++}Ct=0,Ot--;break}}}if(x){let F=N;N=I,I=F}this.m=s,this.n=l,this.s=O,this.U=I,this.V=N}solve(r){let o=r,s=this.threshold,l=this.s.length,h=xe.zeros(l,l);for(let A=0;A<l;A++)Math.abs(this.s[A])<=s?h.set(A,A,0):h.set(A,A,1/this.s[A]);let g=this.U,p=this.rightSingularVectors,m=p.mmul(h),y=p.rows,x=g.rows,w=xe.zeros(y,x);for(let A=0;A<y;A++)for(let T=0;T<x;T++){let O=0;for(let I=0;I<l;I++)O+=m.get(A,I)*g.get(T,I);w.set(A,T,O)}return w.mmul(o)}solveForDiagonal(r){return this.solve(xe.diag(r))}inverse(){let r=this.V,o=this.threshold,s=r.rows,l=r.columns,h=new xe(s,this.s.length);for(let x=0;x<s;x++)for(let w=0;w<l;w++)Math.abs(this.s[w])>o&&h.set(x,w,r.get(x,w)/this.s[w]);let g=this.U,p=g.rows,m=g.columns,y=new xe(s,p);for(let x=0;x<s;x++)for(let w=0;w<p;w++){let A=0;for(let T=0;T<m;T++)A+=h.get(x,T)*g.get(w,T);y.set(x,w,A)}return y}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let r=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,o=0,s=this.s;for(let l=0,h=s.length;l<h;l++)s[l]>r&&o++;return o}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return xe.diag(this.s)}}class $0{constructor(r){this.distances=r.distances,this.dimension=r.dimension||2,this.linkDistance=r.linkDistance}layout(){const r=this,{dimension:o,distances:s,linkDistance:l}=r;try{const h=xe.mul(xe.pow(s,2),-.5),g=h.mean("row"),p=h.mean("column"),m=h.mean();h.add(m).subRowVector(g).subColumnVector(p);const y=new jp(h),x=xe.sqrt(y.diagonalMatrix).diagonal();return y.leftSingularVectors.toJSON().map(w=>xe.mul([w],[x]).toJSON()[0].splice(0,o))}catch(h){const g=[];for(let p=0;p<s.length;p++){const m=Math.random()*l,y=Math.random()*l;g.push([m,y])}return g}}}const Uf=800;class vs{constructor(r){this.disp=[],this.positions=r.positions,this.adjMatrix=r.adjMatrix,this.focusID=r.focusID,this.radii=r.radii,this.iterations=r.iterations||10,this.height=r.height||10,this.width=r.width||10,this.speed=r.speed||100,this.gravity=r.gravity||10,this.nodeSizeFunc=r.nodeSizeFunc,this.k=r.k||5,this.strictRadial=r.strictRadial,this.nodes=r.nodes}layout(){const r=this,o=r.positions,s=[],l=r.iterations,h=r.width/10;r.maxDisplace=h,r.disp=s;for(let g=0;g<l;g++)o.forEach((p,m)=>{s[m]={x:0,y:0}}),r.getRepulsion(),r.updatePositions();return o}getRepulsion(){const r=this,o=r.positions,s=r.nodes,l=r.disp,h=r.k,g=r.radii||[];o.forEach((p,m)=>{l[m]={x:0,y:0},o.forEach((y,x)=>{if(m===x||g[m]!==g[x])return;let w=p[0]-y[0],A=p[1]-y[1],T=Math.sqrt(w*w+A*A);if(T===0){T=1;const O=m>x?1:-1;w=.01*O,A=.01*O}if(T<r.nodeSizeFunc(s[m])/2+r.nodeSizeFunc(s[x])/2){const O=h*h/T;l[m].x+=w/T*O,l[m].y+=A/T*O}})})}updatePositions(){const r=this,o=r.positions,s=r.disp,l=r.speed,h=r.strictRadial,g=r.focusID,p=r.maxDisplace||r.width/10;h&&s.forEach((y,x)=>{const w=o[x][0]-o[g][0],A=o[x][1]-o[g][1],T=Math.sqrt(w*w+A*A);let O=A/T,I=-w/T;const N=Math.sqrt(y.x*y.x+y.y*y.y);let P=Math.acos((O*y.x+I*y.y)/N);P>Math.PI/2&&(P-=Math.PI/2,O*=-1,I*=-1);const R=Math.cos(P)*N;y.x=O*R,y.y=I*R});const m=r.radii;o.forEach((y,x)=>{if(x===g)return;const w=Math.sqrt(s[x].x*s[x].x+s[x].y*s[x].y);if(w>0&&x!==g){const A=Math.min(p*(l/Uf),w);if(y[0]+=s[x].x/w*A,y[1]+=s[x].y/w*A,h){let T=y[0]-o[g][0],O=y[1]-o[g][1];const I=Math.sqrt(T*T+O*O);T=T/I*m[x],O=O/I*m[x],y[0]=o[g][0]+T,y[1]=o[g][1]+O}}})}}function Dr(i){const r=i.length,o=i[0].length,s=[];for(let l=0;l<r;l++){const h=[];for(let g=0;g<o;g++)i[l][g]!==0?h.push(1/(i[l][g]*i[l][g])):h.push(0);s.push(h)}return s}function Fp(i,r){let o=-1;return i.forEach((s,l)=>{s.id===r&&(o=l)}),o}function Vf(i,r){return Math.sqrt((i[0]-r[0])*(i[0]-r[0])+(i[1]-r[1])*(i[1]-r[1]))}class Hf extends vn{constructor(r){super(),this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(r)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const r=this,o=r.nodes,s=r.edges||[];if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const l=r.center;if(o.length===1){o[0].x=l[0],o[0].y=l[1],r.onLayoutEnd&&r.onLayoutEnd();return}const h=r.linkDistance;let g=null;if(mn(r.focusNode)){let F=!1;for(let Z=0;Z<o.length;Z++)o[Z].id===r.focusNode&&(g=o[Z],r.focusNode=g,F=!0,Z=o.length);F||(g=null)}else g=r.focusNode;g||(g=o[0],r.focusNode=g);let p=Fp(o,g.id);p<0&&(p=0),r.focusIndex=p;const m=De({nodes:o,edges:s},!1),y=Xt(m),x=r.maxToFocus(y,p);r.handleInfinity(y,p,x+1),r.distances=y;const w=y[p],A=r.width||500,T=r.height||500;let O=A-l[0]>l[0]?l[0]:A-l[0],I=T-l[1]>l[1]?l[1]:T-l[1];O===0&&(O=A/2),I===0&&(I=T/2);const N=I>O?O:I,P=Math.max(...w),R=[];w.forEach((F,Z)=>{r.unitRadius||(r.unitRadius=N/P),R[Z]=F*r.unitRadius}),r.radii=R;const k=r.eIdealDisMatrix();r.eIdealDistances=k;const U=Dr(k);r.weights=U;let pt=new $0({linkDistance:h,distances:k}).layout();pt.forEach(F=>{te(F[0])&&(F[0]=Math.random()*h),te(F[1])&&(F[1]=Math.random()*h)}),r.positions=pt,pt.forEach((F,Z)=>{o[Z].x=F[0]+l[0],o[Z].y=F[1]+l[1]}),pt.forEach(F=>{F[0]-=pt[p][0],F[1]-=pt[p][1]}),r.run();const Ot=r.preventOverlap,It=r.nodeSize;let Ct;const _t=r.strictRadial;if(Ot){const F=r.nodeSpacing;let Z;kt(F)?Z=()=>F:Ue(F)?Z=F:Z=()=>0,It?Jt(It)?Ct=de=>(It[0]>It[1]?It[0]:It[1])+Z(de):Ct=de=>It+Z(de):Ct=de=>de.size?Jt(de.size)?(de.size[0]>de.size[1]?de.size[0]:de.size[1])+Z(de):Q(de.size)?(de.size.width>de.size.height?de.size.width:de.size.height)+Z(de):de.size+Z(de):10+Z(de);const yt={nodes:o,nodeSizeFunc:Ct,adjMatrix:m,positions:pt,radii:R,height:T,width:A,strictRadial:_t,focusID:p,iterations:r.maxPreventOverlapIteration||200,k:pt.length/4.5};pt=new vs(yt).layout()}return pt.forEach((F,Z)=>{o[Z].x=F[0]+l[0],o[Z].y=F[1]+l[1]}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s}}run(){const r=this,o=r.maxIteration,s=r.positions||[],l=r.weights||[],h=r.eIdealDistances||[],g=r.radii||[];for(let p=0;p<=o;p++){const m=p/o;r.oneIteration(m,s,g,h,l)}}oneIteration(r,o,s,l,h){const g=this,p=1-r,m=g.focusIndex;o.forEach((y,x)=>{const w=Vf(y,[0,0]),A=w===0?0:1/w;if(x===m)return;let T=0,O=0,I=0;o.forEach((P,R)=>{if(x===R)return;const k=Vf(y,P),U=k===0?0:1/k,K=l[R][x];I+=h[x][R],T+=h[x][R]*(P[0]+K*(y[0]-P[0])*U),O+=h[x][R]*(P[1]+K*(y[1]-P[1])*U)});const N=s[x]===0?0:1/s[x];I*=p,I+=r*N*N,T*=p,T+=r*N*y[0]*A,y[0]=T/I,O*=p,O+=r*N*y[1]*A,y[1]=O/I})}eIdealDisMatrix(){const r=this,o=r.nodes;if(!o)return[];const s=r.distances,l=r.linkDistance,h=r.radii||[],g=r.unitRadius||50,p=[];return s&&s.forEach((m,y)=>{const x=[];m.forEach((w,A)=>{if(y===A)x.push(0);else if(h[y]===h[A])if(r.sortBy==="data")x.push(w*(Math.abs(y-A)*r.sortStrength)/(h[y]/g));else if(r.sortBy){let T=o[y][r.sortBy]||0,O=o[A][r.sortBy]||0;mn(T)&&(T=T.charCodeAt(0)),mn(O)&&(O=O.charCodeAt(0)),x.push(w*(Math.abs(T-O)*r.sortStrength)/(h[y]/g))}else x.push(w*l/(h[y]/g));else{const T=(l+g)/2;x.push(w*T)}}),p.push(x)}),p}handleInfinity(r,o,s){const l=r.length;for(let h=0;h<l;h++)if(r[o][h]===1/0){r[o][h]=s,r[h][o]=s;for(let g=0;g<l;g++)r[h][g]!==1/0&&r[o][g]===1/0&&(r[o][g]=s+r[h][g],r[g][o]=s+r[h][g])}for(let h=0;h<l;h++)if(h!==o){for(let g=0;g<l;g++)if(r[h][g]===1/0){let p=Math.abs(r[o][h]-r[o][g]);p=p===0?1:p,r[h][g]=p}}}maxToFocus(r,o){let s=0;for(let l=0;l<r[o].length;l++)r[o][l]!==1/0&&(s=r[o][l]>s?r[o][l]:s);return s}getType(){return"radial"}}class Ni extends vn{constructor(r){super(),this.nodeSize=30,this.minNodeSpacing=10,this.nodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){var r,o;const s=this,{nodes:l,edges:h}=s,g=l.length;if(g===0){(r=s.onLayoutEnd)===null||r===void 0||r.call(s);return}!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight),s.center||(s.center=[s.width/2,s.height/2]);const p=s.center;if(g===1){l[0].x=p[0],l[0].y=p[1],(o=s.onLayoutEnd)===null||o===void 0||o.call(s);return}const{nodeSize:m,nodeSpacing:y}=s,x=[];let w,A=0;Jt(m)?w=Math.max(m[0],m[1]):w=m,Jt(y)?A=Math.max(y[0],y[1]):kt(y)&&(A=y),l.forEach(k=>{x.push(k);let U=w;Jt(k.size)?U=Math.max(k.size[0],k.size[1]):kt(k.size)?U=k.size:Q(k.size)&&(U=Math.max(k.size.width,k.size.height)),w=Math.max(w,U),Ue(y)&&(A=Math.max(y(k),A))}),s.clockwise=s.counterclockwise!==void 0?!s.counterclockwise:s.clockwise;const T={},O={};if(x.forEach((k,U)=>{T[k.id]=k,O[k.id]=U}),(s.sortBy==="degree"||!mn(s.sortBy)||x[0][s.sortBy]===void 0)&&(s.sortBy="degree",!kt(l[0].degree))){const k=jt(l.length,O,h);x.forEach((U,K)=>{U.degree=k[K].all})}x.sort((k,U)=>U[s.sortBy]-k[s.sortBy]),s.maxValueNode=x[0],s.maxLevelDiff=s.maxLevelDiff||s.maxValueNode[s.sortBy]/4;const I=[[]];let N=I[0];x.forEach(k=>{if(N.length>0){const U=Math.abs(N[0][s.sortBy]-k[s.sortBy]);s.maxLevelDiff&&U>=s.maxLevelDiff&&(N=[],I.push(N))}N.push(k)});let P=w+(A||s.minNodeSpacing);if(!s.preventOverlap){const k=I.length>0&&I[0].length>1,K=(Math.min(s.width,s.height)/2-P)/(I.length+(k?1:0));P=Math.min(P,K)}let R=0;if(I.forEach(k=>{let U=s.sweep;U===void 0&&(U=2*Math.PI-2*Math.PI/k.length);const K=k.dTheta=U/Math.max(1,k.length-1);if(k.length>1&&s.preventOverlap){const pt=Math.cos(K)-Math.cos(0),Ot=Math.sin(K)-Math.sin(0),It=Math.sqrt(P*P/(pt*pt+Ot*Ot));R=Math.max(It,R)}k.r=R,R+=P}),s.equidistant){let k=0,U=0;for(let K=0;K<I.length;K++){const Ot=I[K].r-U;k=Math.max(k,Ot)}U=0,I.forEach((K,pt)=>{pt===0&&(U=K.r),K.r=U,U+=k})}return I.forEach(k=>{const U=k.dTheta,K=k.r;k.forEach((pt,Ot)=>{const It=s.startAngle+(s.clockwise?1:-1)*U*Ot;pt.x=p[0]+K*Math.cos(It),pt.y=p[1]+K*Math.sin(It)})}),s.onLayoutEnd&&s.onLayoutEnd(),{nodes:l,edges:h}}getType(){return"concentric"}}class dl extends vn{constructor(r){super(),this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const r=this,{nodes:o,edges:s=[]}=r,l=r.center;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}if(o.length===1){o[0].x=l[0],o[0].y=l[1],r.onLayoutEnd&&r.onLayoutEnd();return}const h=r.linkDistance,g=De({nodes:o,edges:s},!1),p=Xt(g);r.handleInfinity(p);const m=Ze(p,h);r.scaledDistances=m;const y=r.runMDS();return r.positions=y,y.forEach((x,w)=>{o[w].x=x[0]+l[0],o[w].y=x[1]+l[1]}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s}}runMDS(){const r=this,o=2,s=r.scaledDistances,l=xe.mul(xe.pow(s,2),-.5),h=l.mean("row"),g=l.mean("column"),p=l.mean();l.add(p).subRowVector(h).subColumnVector(g);const m=new jp(l),y=xe.sqrt(m.diagonalMatrix).diagonal();return m.leftSingularVectors.toJSON().map(x=>xe.mul([x],[y]).toJSON()[0].splice(0,o))}handleInfinity(r){let o=-999999;r.forEach(s=>{s.forEach(l=>{l!==1/0&&o<l&&(o=l)})}),r.forEach((s,l)=>{s.forEach((h,g)=>{h===1/0&&(r[l][g]=o)})})}getType(){return"mds"}}const W0=800;class X0 extends vn{constructor(r){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.animate=!0,this.updateCfg(r)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}}execute(){var r,o;const s=this,l=s.nodes;if(s.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(s.timeInterval),!l||l.length===0){(r=s.onLayoutEnd)===null||r===void 0||r.call(s);return}!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight),s.center||(s.center=[s.width/2,s.height/2]);const h=s.center;if(l.length===1){l[0].x=h[0],l[0].y=h[1],(o=s.onLayoutEnd)===null||o===void 0||o.call(s);return}const g={},p={};return l.forEach((m,y)=>{kt(m.x)||(m.x=Math.random()*this.width),kt(m.y)||(m.y=Math.random()*this.height),g[m.id]=m,p[m.id]=y}),s.nodeMap=g,s.nodeIdxMap=p,s.run()}run(){var r;const o=this,s=o.nodes;if(!s)return;const{edges:l,maxIteration:h,workerEnabled:g,clustering:p,animate:m}=o,y={};if(p&&s.forEach(x=>{y[x.cluster]===void 0&&(y[x.cluster]={name:x.cluster,cx:0,cy:0,count:0})}),g||!m){for(let x=0;x<h;x++)o.runOneStep(y);(r=o.onLayoutEnd)===null||r===void 0||r.call(o)}else{if(typeof window>"u")return;let x=0;this.timeInterval=window.setInterval(()=>{var w;o.runOneStep(y),x++,x>=h&&((w=o.onLayoutEnd)===null||w===void 0||w.call(o),window.clearInterval(o.timeInterval))},0)}return{nodes:s,edges:l}}runOneStep(r){var o;const s=this,l=s.nodes;if(!l)return;const{edges:h,center:g,gravity:p,speed:m,clustering:y}=s,x=s.height*s.width,w=Math.sqrt(x)/10,A=x/(l.length+1),T=Math.sqrt(A),O=[];if(l.forEach((I,N)=>{O[N]={x:0,y:0}}),s.applyCalculate(l,h,O,T,A),y){for(const N in r)r[N].cx=0,r[N].cy=0,r[N].count=0;l.forEach(N=>{const P=r[N.cluster];kt(N.x)&&(P.cx+=N.x),kt(N.y)&&(P.cy+=N.y),P.count++});for(const N in r)r[N].cx/=r[N].count,r[N].cy/=r[N].count;const I=s.clusterGravity||p;l.forEach((N,P)=>{if(!kt(N.x)||!kt(N.y))return;const R=r[N.cluster],k=Math.sqrt((N.x-R.cx)*(N.x-R.cx)+(N.y-R.cy)*(N.y-R.cy)),U=T*I;O[P].x-=U*(N.x-R.cx)/k,O[P].y-=U*(N.y-R.cy)/k})}l.forEach((I,N)=>{if(!kt(I.x)||!kt(I.y))return;const P=.01*T*p;O[N].x-=P*(I.x-g[0]),O[N].y-=P*(I.y-g[1])}),l.forEach((I,N)=>{if(kt(I.fx)&&kt(I.fy)){I.x=I.fx,I.y=I.fy;return}if(!kt(I.x)||!kt(I.y))return;const P=Math.sqrt(O[N].x*O[N].x+O[N].y*O[N].y);if(P>0){const R=Math.min(w*(m/W0),P);I.x+=O[N].x/P*R,I.y+=O[N].y/P*R}}),(o=s.tick)===null||o===void 0||o.call(s)}applyCalculate(r,o,s,l,h){const g=this;g.calRepulsive(r,s,h),o&&g.calAttractive(o,s,l)}calRepulsive(r,o,s){r.forEach((l,h)=>{o[h]={x:0,y:0},r.forEach((g,p)=>{if(h===p||!kt(l.x)||!kt(g.x)||!kt(l.y)||!kt(g.y))return;let m=l.x-g.x,y=l.y-g.y,x=m*m+y*y;if(x===0){x=1;const A=h>p?1:-1;m=.01*A,y=.01*A}const w=s/x;o[h].x+=m*w,o[h].y+=y*w})})}calAttractive(r,o,s){r.forEach(l=>{const h=at(l,"source"),g=at(l,"target");if(!h||!g)return;const p=this.nodeIdxMap[h],m=this.nodeIdxMap[g];if(p===m)return;const y=this.nodeMap[h],x=this.nodeMap[g];if(!kt(x.x)||!kt(y.x)||!kt(x.y)||!kt(y.y))return;const w=x.x-y.x,A=x.y-y.y,T=Math.sqrt(w*w+A*A),O=T*T/s;o[m].x-=w/T*O,o[m].y-=A/T*O,o[p].x+=w/T*O,o[p].y+=A/T*O})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const r=this;r.stop(),r.tick=null,r.nodes=null,r.edges=null,r.destroyed=!0}getType(){return"fruchterman"}}var mo=Nt(15861),pe=Nt(4942),Wi=Nt(15671),Pi=Nt(43144),Gp=Nt(36719),Do=Nt.n(Gp),gl=Nt(81763),pl=Nt.n(gl),Z0=Nt(1469),$f=Nt.n(Z0),ax=Nt(64687),Xr=Nt.n(ax),cx=null,zp=1;function q0(){return zp++}var Y0=null,lx=null,qt;(function(i){i[i.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",i[i.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",i[i.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i[i.ZERO=0]="ZERO",i[i.ONE=1]="ONE",i[i.SRC_COLOR=768]="SRC_COLOR",i[i.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",i[i.SRC_ALPHA=770]="SRC_ALPHA",i[i.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",i[i.DST_ALPHA=772]="DST_ALPHA",i[i.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",i[i.DST_COLOR=774]="DST_COLOR",i[i.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",i[i.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",i[i.FUNC_ADD=32774]="FUNC_ADD",i[i.BLEND_EQUATION=32777]="BLEND_EQUATION",i[i.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",i[i.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",i[i.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",i[i.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",i[i.MAX_EXT=32776]="MAX_EXT",i[i.MIN_EXT=32775]="MIN_EXT",i[i.BLEND_DST_RGB=32968]="BLEND_DST_RGB",i[i.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",i[i.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",i[i.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",i[i.CONSTANT_COLOR=32769]="CONSTANT_COLOR",i[i.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",i[i.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",i[i.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",i[i.BLEND_COLOR=32773]="BLEND_COLOR",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",i[i.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",i[i.STREAM_DRAW=35040]="STREAM_DRAW",i[i.STATIC_DRAW=35044]="STATIC_DRAW",i[i.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",i[i.BUFFER_SIZE=34660]="BUFFER_SIZE",i[i.BUFFER_USAGE=34661]="BUFFER_USAGE",i[i.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",i[i.FRONT=1028]="FRONT",i[i.BACK=1029]="BACK",i[i.FRONT_AND_BACK=1032]="FRONT_AND_BACK",i[i.CULL_FACE=2884]="CULL_FACE",i[i.BLEND=3042]="BLEND",i[i.DITHER=3024]="DITHER",i[i.STENCIL_TEST=2960]="STENCIL_TEST",i[i.DEPTH_TEST=2929]="DEPTH_TEST",i[i.SCISSOR_TEST=3089]="SCISSOR_TEST",i[i.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",i[i.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",i[i.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",i[i.NO_ERROR=0]="NO_ERROR",i[i.INVALID_ENUM=1280]="INVALID_ENUM",i[i.INVALID_VALUE=1281]="INVALID_VALUE",i[i.INVALID_OPERATION=1282]="INVALID_OPERATION",i[i.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",i[i.CW=2304]="CW",i[i.CCW=2305]="CCW",i[i.LINE_WIDTH=2849]="LINE_WIDTH",i[i.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",i[i.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",i[i.CULL_FACE_MODE=2885]="CULL_FACE_MODE",i[i.FRONT_FACE=2886]="FRONT_FACE",i[i.DEPTH_RANGE=2928]="DEPTH_RANGE",i[i.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",i[i.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",i[i.DEPTH_FUNC=2932]="DEPTH_FUNC",i[i.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",i[i.STENCIL_FUNC=2962]="STENCIL_FUNC",i[i.STENCIL_FAIL=2964]="STENCIL_FAIL",i[i.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",i[i.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",i[i.STENCIL_REF=2967]="STENCIL_REF",i[i.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",i[i.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",i[i.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",i[i.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",i[i.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",i[i.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",i[i.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",i[i.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",i[i.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",i[i.VIEWPORT=2978]="VIEWPORT",i[i.SCISSOR_BOX=3088]="SCISSOR_BOX",i[i.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",i[i.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",i[i.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",i[i.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",i[i.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",i[i.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",i[i.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",i[i.RED_BITS=3410]="RED_BITS",i[i.GREEN_BITS=3411]="GREEN_BITS",i[i.BLUE_BITS=3412]="BLUE_BITS",i[i.ALPHA_BITS=3413]="ALPHA_BITS",i[i.DEPTH_BITS=3414]="DEPTH_BITS",i[i.STENCIL_BITS=3415]="STENCIL_BITS",i[i.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",i[i.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",i[i.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",i[i.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",i[i.SAMPLES=32937]="SAMPLES",i[i.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",i[i.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",i[i.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",i[i.DONT_CARE=4352]="DONT_CARE",i[i.FASTEST=4353]="FASTEST",i[i.NICEST=4354]="NICEST",i[i.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",i[i.BYTE=5120]="BYTE",i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.SHORT=5122]="SHORT",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.INT=5124]="INT",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.FLOAT=5126]="FLOAT",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.ALPHA=6406]="ALPHA",i[i.RGB=6407]="RGB",i[i.RGBA=6408]="RGBA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",i[i.VERTEX_SHADER=35633]="VERTEX_SHADER",i[i.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",i[i.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",i[i.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",i[i.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",i[i.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",i[i.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",i[i.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",i[i.SHADER_TYPE=35663]="SHADER_TYPE",i[i.DELETE_STATUS=35712]="DELETE_STATUS",i[i.LINK_STATUS=35714]="LINK_STATUS",i[i.VALIDATE_STATUS=35715]="VALIDATE_STATUS",i[i.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",i[i.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",i[i.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",i[i.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",i[i.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",i[i.NEVER=512]="NEVER",i[i.LESS=513]="LESS",i[i.EQUAL=514]="EQUAL",i[i.LEQUAL=515]="LEQUAL",i[i.GREATER=516]="GREATER",i[i.NOTEQUAL=517]="NOTEQUAL",i[i.GEQUAL=518]="GEQUAL",i[i.ALWAYS=519]="ALWAYS",i[i.KEEP=7680]="KEEP",i[i.REPLACE=7681]="REPLACE",i[i.INCR=7682]="INCR",i[i.DECR=7683]="DECR",i[i.INVERT=5386]="INVERT",i[i.INCR_WRAP=34055]="INCR_WRAP",i[i.DECR_WRAP=34056]="DECR_WRAP",i[i.VENDOR=7936]="VENDOR",i[i.RENDERER=7937]="RENDERER",i[i.VERSION=7938]="VERSION",i[i.NEAREST=9728]="NEAREST",i[i.LINEAR=9729]="LINEAR",i[i.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",i[i.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",i[i.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",i[i.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",i[i.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",i[i.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",i[i.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",i[i.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE=5890]="TEXTURE",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i[i.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",i[i.TEXTURE0=33984]="TEXTURE0",i[i.TEXTURE1=33985]="TEXTURE1",i[i.TEXTURE2=33986]="TEXTURE2",i[i.TEXTURE3=33987]="TEXTURE3",i[i.TEXTURE4=33988]="TEXTURE4",i[i.TEXTURE5=33989]="TEXTURE5",i[i.TEXTURE6=33990]="TEXTURE6",i[i.TEXTURE7=33991]="TEXTURE7",i[i.TEXTURE8=33992]="TEXTURE8",i[i.TEXTURE9=33993]="TEXTURE9",i[i.TEXTURE10=33994]="TEXTURE10",i[i.TEXTURE11=33995]="TEXTURE11",i[i.TEXTURE12=33996]="TEXTURE12",i[i.TEXTURE13=33997]="TEXTURE13",i[i.TEXTURE14=33998]="TEXTURE14",i[i.TEXTURE15=33999]="TEXTURE15",i[i.TEXTURE16=34e3]="TEXTURE16",i[i.TEXTURE17=34001]="TEXTURE17",i[i.TEXTURE18=34002]="TEXTURE18",i[i.TEXTURE19=34003]="TEXTURE19",i[i.TEXTURE20=34004]="TEXTURE20",i[i.TEXTURE21=34005]="TEXTURE21",i[i.TEXTURE22=34006]="TEXTURE22",i[i.TEXTURE23=34007]="TEXTURE23",i[i.TEXTURE24=34008]="TEXTURE24",i[i.TEXTURE25=34009]="TEXTURE25",i[i.TEXTURE26=34010]="TEXTURE26",i[i.TEXTURE27=34011]="TEXTURE27",i[i.TEXTURE28=34012]="TEXTURE28",i[i.TEXTURE29=34013]="TEXTURE29",i[i.TEXTURE30=34014]="TEXTURE30",i[i.TEXTURE31=34015]="TEXTURE31",i[i.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",i[i.REPEAT=10497]="REPEAT",i[i.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i[i.FLOAT_VEC2=35664]="FLOAT_VEC2",i[i.FLOAT_VEC3=35665]="FLOAT_VEC3",i[i.FLOAT_VEC4=35666]="FLOAT_VEC4",i[i.INT_VEC2=35667]="INT_VEC2",i[i.INT_VEC3=35668]="INT_VEC3",i[i.INT_VEC4=35669]="INT_VEC4",i[i.BOOL=35670]="BOOL",i[i.BOOL_VEC2=35671]="BOOL_VEC2",i[i.BOOL_VEC3=35672]="BOOL_VEC3",i[i.BOOL_VEC4=35673]="BOOL_VEC4",i[i.FLOAT_MAT2=35674]="FLOAT_MAT2",i[i.FLOAT_MAT3=35675]="FLOAT_MAT3",i[i.FLOAT_MAT4=35676]="FLOAT_MAT4",i[i.SAMPLER_2D=35678]="SAMPLER_2D",i[i.SAMPLER_CUBE=35680]="SAMPLER_CUBE",i[i.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",i[i.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",i[i.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",i[i.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",i[i.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",i[i.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",i[i.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",i[i.COMPILE_STATUS=35713]="COMPILE_STATUS",i[i.LOW_FLOAT=36336]="LOW_FLOAT",i[i.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",i[i.HIGH_FLOAT=36338]="HIGH_FLOAT",i[i.LOW_INT=36339]="LOW_INT",i[i.MEDIUM_INT=36340]="MEDIUM_INT",i[i.HIGH_INT=36341]="HIGH_INT",i[i.FRAMEBUFFER=36160]="FRAMEBUFFER",i[i.RENDERBUFFER=36161]="RENDERBUFFER",i[i.RGBA4=32854]="RGBA4",i[i.RGB5_A1=32855]="RGB5_A1",i[i.RGB565=36194]="RGB565",i[i.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",i[i.STENCIL_INDEX=6401]="STENCIL_INDEX",i[i.STENCIL_INDEX8=36168]="STENCIL_INDEX8",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i[i.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",i[i.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",i[i.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",i[i.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",i[i.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",i[i.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",i[i.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",i[i.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",i[i.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",i[i.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",i[i.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",i[i.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",i[i.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",i[i.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",i[i.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",i[i.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",i[i.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",i[i.NONE=0]="NONE",i[i.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",i[i.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",i[i.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",i[i.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",i[i.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",i[i.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",i[i.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",i[i.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",i[i.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",i[i.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",i[i.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",i[i.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",i[i.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",i[i.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",i[i.COPY_SRC=1]="COPY_SRC",i[i.COPY_DST=2]="COPY_DST",i[i.SAMPLED=4]="SAMPLED",i[i.STORAGE=8]="STORAGE",i[i.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(qt||(qt={}));var Wf=function(){function i(){(0,Wi.Z)(this,i),this.config=void 0}return(0,Pi.Z)(i,[{key:"get",value:function(){return this.config}},{key:"set",value:function(o){this.config=o}}]),i}(),J0=typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Dn;(function(i){i.Void="Void",i.Boolean="Boolean",i.Float="Float",i.Uint32="Uint32",i.Int32="Int32",i.Vector="Vector",i.Vector2Float="vec2<f32>",i.Vector3Float="vec3<f32>",i.Vector4Float="vec4<f32>",i.Vector2Boolean="vec2<bool>",i.Vector3Boolean="vec3<bool>",i.Vector4Boolean="vec4<bool>",i.Vector2Uint="vec2<u32>",i.Vector3Uint="vec3<u32>",i.Vector4Uint="vec4<u32>",i.Vector2Int="vec2<i32>",i.Vector3Int="vec3<i32>",i.Vector4Int="vec4<i32>",i.Matrix="Matrix",i.Matrix3x3Float="mat3x3<f32>",i.Matrix4x4Float="mat4x4<i32>",i.Struct="Struct",i.FloatArray="Float[]",i.Vector4FloatArray="vec4<f32>[]"})(Dn||(Dn={}));var Xf;(function(i){i.Program="Program",i.Identifier="Identifier",i.VariableDeclaration="VariableDeclaration",i.BlockStatement="BlockStatement",i.ReturnStatement="ReturnStatement",i.FunctionDeclaration="FunctionDeclaration",i.VariableDeclarator="VariableDeclarator",i.AssignmentExpression="AssignmentExpression",i.LogicalExpression="LogicalExpression",i.BinaryExpression="BinaryExpression",i.ArrayExpression="ArrayExpression",i.UnaryExpression="UnaryExpression",i.UpdateExpression="UpdateExpression",i.FunctionExpression="FunctionExpression",i.MemberExpression="MemberExpression",i.ConditionalExpression="ConditionalExpression",i.ExpressionStatement="ExpressionStatement",i.CallExpression="CallExpression",i.NumThreadStatement="NumThreadStatement",i.StorageStatement="StorageStatement",i.DoWhileStatement="DoWhileStatement",i.WhileStatement="WhileStatement",i.ForStatement="ForStatement",i.BreakStatement="BreakStatement",i.ContinueStatement="ContinueStatement",i.IfStatement="IfStatement",i.ImportedFunctionStatement="ImportedFunctionStatement"})(Xf||(Xf={}));var vo;(function(i){i.Input="Input",i.Output="Output",i.Uniform="Uniform",i.Workgroup="Workgroup",i.UniformConstant="UniformConstant",i.Image="Image",i.StorageBuffer="StorageBuffer",i.Private="Private",i.Function="Function"})(vo||(vo={}));var ys;(function(i){i.GLSL100="GLSL100",i.GLSL450="GLSL450",i.WGSL="WGSL"})(ys||(ys={}));var Zf="__DefineValuePlaceholder__";function ux(){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function hx(i,r){var o=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),o.push.apply(o,s)}return o}function fx(i){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?hx(Object(o),!0).forEach(function(s){(0,pe.Z)(i,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):hx(Object(o)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(o,s))})}return i}var Xx=function(){function i(r,o){(0,Wi.Z)(this,i),this.engine=r,this.configService=o,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,Pi.Z)(i,[{key:"init",value:function(){var o=this.configService.get(),s=o.canvas,l=o.engineOptions;this.initPromise=this.engine.init(fx({canvas:s||ux(),antialiasing:!1},l))}},{key:"setBundle",value:function(o){this.compiledBundle=JSON.parse(JSON.stringify(o))}},{key:"setDispatch",value:function(o){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=o),this}},{key:"setMaxIteration",value:function(o){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=o),this}},{key:"setBinding",value:function(o,s){var l=this;if(typeof o=="string"){var h=pl()(s)||Do()(s)||$f()(s);if(this.compiledBundle&&this.compiledBundle.context){var g=this.compiledBundle.context.defines.find(function(m){return m.name===o});if(g)return g.value=s,this;var p=this.compiledBundle.context.uniforms.find(function(m){return m.name===o});p&&(h?(p.data=s,p.isReferer=!1,p.storageClass===vo.Uniform?this.model&&this.model.updateUniform(o,s):this.model&&this.model.updateBuffer(o,s)):(p.isReferer=!0,p.data=s))}}else Object.keys(o).forEach(function(m){l.setBinding(m,o[m])});return this}},{key:"execute",value:function(){var r=(0,mo.Z)(Xr().mark(function s(){var l=this,h,g,p=arguments;return Xr().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(h=p.length>0&&p[0]!==void 0?p[0]:1,!this.dirty){y.next=6;break}return this.compiledBundle.context&&(h>1?this.compiledBundle.context.maxIteration=h:this.compiledBundle.context.maxIteration++),y.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(x){var w=x.isReferer;return w}).forEach(function(x){var w=x.data,A=x.name;l.model.confirmInput(w.model,A)}),g=0;g<h;g++)this.model.run();return this.engine.endFrame(),y.abrupt("return",this);case 12:case"end":return y.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"getOutput",value:function(){var r=(0,mo.Z)(Xr().mark(function s(){return Xr().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.model.readData());case 1:case"end":return h.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"compile",value:function(){var r=(0,mo.Z)(Xr().mark(function s(){var l,h,g;return Xr().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initPromise;case 2:return l=fx({},this.compiledBundle.context),h=this.engine.supportWebGPU?this.engine.useWGSL?ys.WGSL:ys.GLSL450:ys.GLSL100,g=this.compiledBundle.shaders[h],l.defines.filter(function(y){return y.runtime}).forEach(function(y){var x="".concat(Zf).concat(y.name);g=g.replace(x,"".concat(y.value))}),l.shader=g,l.uniforms.forEach(function(y){if(!y.data&&y.storageClass===vo.StorageBuffer){var x=1;y.type===Dn.FloatArray?x=1:y.type===Dn.Vector4FloatArray&&(x=4),y.data=new Float32Array(l.output.length*x).fill(0)}}),this.compiledBundle.context=l,m.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=m.sent;case 12:case"end":return m.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()}]),i}(),dx=Nt(93943),Up=Nt.n(dx),Wa=function(){function i(r,o){(0,Wi.Z)(this,i),this.attribute=void 0,this.buffer=void 0;var s=o.buffer,l=o.offset,h=o.stride,g=o.normalized,p=o.size,m=o.divisor;this.buffer=s,this.attribute={buffer:s.get(),offset:l||0,stride:h||0,normalized:g||!1,divisor:m||0},p&&(this.attribute.size=p)}return(0,Pi.Z)(i,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(o){this.buffer.subData(o)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),i}(),bs,ml,xs,Xi,Xa,ws,vl,qf,Zi,Za,Ar,Ro,Lo,Yf,K0=(bs={},(0,pe.Z)(bs,qt.POINTS,"points"),(0,pe.Z)(bs,qt.LINES,"lines"),(0,pe.Z)(bs,qt.LINE_LOOP,"line loop"),(0,pe.Z)(bs,qt.LINE_STRIP,"line strip"),(0,pe.Z)(bs,qt.TRIANGLES,"triangles"),(0,pe.Z)(bs,qt.TRIANGLE_FAN,"triangle fan"),(0,pe.Z)(bs,qt.TRIANGLE_STRIP,"triangle strip"),bs),yl=(ml={},(0,pe.Z)(ml,qt.STATIC_DRAW,"static"),(0,pe.Z)(ml,qt.DYNAMIC_DRAW,"dynamic"),(0,pe.Z)(ml,qt.STREAM_DRAW,"stream"),ml),qa=(xs={},(0,pe.Z)(xs,qt.BYTE,"int8"),(0,pe.Z)(xs,qt.UNSIGNED_INT,"int16"),(0,pe.Z)(xs,qt.INT,"int32"),(0,pe.Z)(xs,qt.UNSIGNED_BYTE,"uint8"),(0,pe.Z)(xs,qt.UNSIGNED_SHORT,"uint16"),(0,pe.Z)(xs,qt.UNSIGNED_INT,"uint32"),(0,pe.Z)(xs,qt.FLOAT,"float"),xs),gx=(Xi={},(0,pe.Z)(Xi,qt.ALPHA,"alpha"),(0,pe.Z)(Xi,qt.LUMINANCE,"luminance"),(0,pe.Z)(Xi,qt.LUMINANCE_ALPHA,"luminance alpha"),(0,pe.Z)(Xi,qt.RGB,"rgb"),(0,pe.Z)(Xi,qt.RGBA,"rgba"),(0,pe.Z)(Xi,qt.RGBA4,"rgba4"),(0,pe.Z)(Xi,qt.RGB5_A1,"rgb5 a1"),(0,pe.Z)(Xi,qt.RGB565,"rgb565"),(0,pe.Z)(Xi,qt.DEPTH_COMPONENT,"depth"),(0,pe.Z)(Xi,qt.DEPTH_STENCIL,"depth stencil"),Xi),bl=(Xa={},(0,pe.Z)(Xa,qt.DONT_CARE,"dont care"),(0,pe.Z)(Xa,qt.NICEST,"nice"),(0,pe.Z)(Xa,qt.FASTEST,"fast"),Xa),Ku=(ws={},(0,pe.Z)(ws,qt.NEAREST,"nearest"),(0,pe.Z)(ws,qt.LINEAR,"linear"),(0,pe.Z)(ws,qt.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,pe.Z)(ws,qt.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,pe.Z)(ws,qt.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,pe.Z)(ws,qt.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),ws),Jf=(vl={},(0,pe.Z)(vl,qt.REPEAT,"repeat"),(0,pe.Z)(vl,qt.CLAMP_TO_EDGE,"clamp"),(0,pe.Z)(vl,qt.MIRRORED_REPEAT,"mirror"),vl),Q0=(qf={},(0,pe.Z)(qf,qt.NONE,"none"),(0,pe.Z)(qf,qt.BROWSER_DEFAULT_WEBGL,"browser"),qf),la=(Zi={},(0,pe.Z)(Zi,qt.NEVER,"never"),(0,pe.Z)(Zi,qt.ALWAYS,"always"),(0,pe.Z)(Zi,qt.LESS,"less"),(0,pe.Z)(Zi,qt.LEQUAL,"lequal"),(0,pe.Z)(Zi,qt.GREATER,"greater"),(0,pe.Z)(Zi,qt.GEQUAL,"gequal"),(0,pe.Z)(Zi,qt.EQUAL,"equal"),(0,pe.Z)(Zi,qt.NOTEQUAL,"notequal"),Zi),tv=(Za={},(0,pe.Z)(Za,qt.FUNC_ADD,"add"),(0,pe.Z)(Za,qt.MIN_EXT,"min"),(0,pe.Z)(Za,qt.MAX_EXT,"max"),(0,pe.Z)(Za,qt.FUNC_SUBTRACT,"subtract"),(0,pe.Z)(Za,qt.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Za),Qu=(Ar={},(0,pe.Z)(Ar,qt.ZERO,"zero"),(0,pe.Z)(Ar,qt.ONE,"one"),(0,pe.Z)(Ar,qt.SRC_COLOR,"src color"),(0,pe.Z)(Ar,qt.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,pe.Z)(Ar,qt.SRC_ALPHA,"src alpha"),(0,pe.Z)(Ar,qt.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,pe.Z)(Ar,qt.DST_COLOR,"dst color"),(0,pe.Z)(Ar,qt.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,pe.Z)(Ar,qt.DST_ALPHA,"dst alpha"),(0,pe.Z)(Ar,qt.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,pe.Z)(Ar,qt.CONSTANT_COLOR,"constant color"),(0,pe.Z)(Ar,qt.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,pe.Z)(Ar,qt.CONSTANT_ALPHA,"constant alpha"),(0,pe.Z)(Ar,qt.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,pe.Z)(Ar,qt.SRC_ALPHA_SATURATE,"src alpha saturate"),Ar),sn=(Ro={},(0,pe.Z)(Ro,qt.NEVER,"never"),(0,pe.Z)(Ro,qt.ALWAYS,"always"),(0,pe.Z)(Ro,qt.LESS,"less"),(0,pe.Z)(Ro,qt.LEQUAL,"lequal"),(0,pe.Z)(Ro,qt.GREATER,"greater"),(0,pe.Z)(Ro,qt.GEQUAL,"gequal"),(0,pe.Z)(Ro,qt.EQUAL,"equal"),(0,pe.Z)(Ro,qt.NOTEQUAL,"notequal"),Ro),xl=(Lo={},(0,pe.Z)(Lo,qt.ZERO,"zero"),(0,pe.Z)(Lo,qt.KEEP,"keep"),(0,pe.Z)(Lo,qt.REPLACE,"replace"),(0,pe.Z)(Lo,qt.INVERT,"invert"),(0,pe.Z)(Lo,qt.INCR,"increment"),(0,pe.Z)(Lo,qt.DECR,"decrement"),(0,pe.Z)(Lo,qt.INCR_WRAP,"increment wrap"),(0,pe.Z)(Lo,qt.DECR_WRAP,"decrement wrap"),Lo),px=(Yf={},(0,pe.Z)(Yf,qt.FRONT,"front"),(0,pe.Z)(Yf,qt.BACK,"back"),Yf),ev=function(){function i(r,o){(0,Wi.Z)(this,i),this.buffer=void 0;var s=o.data,l=o.usage,h=o.type;this.buffer=r.buffer({data:s,usage:yl[l||qt.STATIC_DRAW],type:qa[h||qt.UNSIGNED_BYTE]})}return(0,Pi.Z)(i,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(o){var s=o.data,l=o.offset;this.buffer.subdata(s,l)}}]),i}(),Kf=Nt(89062);function nv(i,r){var o=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),o.push.apply(o,s)}return o}function Qf(i){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?nv(Object(o),!0).forEach(function(s){(0,pe.Z)(i,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):nv(Object(o)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(o,s))})}return i}var wl=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,td=0,El=!1,ed=function(){function i(r,o){var s=this;(0,Wi.Z)(this,i),this.reGl=r,this.context=o,this.entity=q0(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var l={};this.context.uniforms.forEach(function(y){var x=y.name,w=y.type,A=y.data,T=y.isReferer,O=y.storageClass;if(O===vo.StorageBuffer){if(T)s.textureCache[x]={data:void 0},l["".concat(x,"Size")]=function(){return A.compiledBundle.context.output.textureSize};else{s.textureCache[x]=s.calcDataTexture(x,w,A);var I=s.textureCache[x],N=I.textureWidth,P=I.isOutput;l["".concat(x,"Size")]=[N,N],P&&(s.outputTextureName=x,s.context.needPingpong&&(s.outputTextureName="".concat(x,"Output"),s.textureCache[s.outputTextureName]=s.calcDataTexture(x,w,A)))}l[x]=function(){return El&&console.log("[".concat(s.entity,"]: ").concat(x," ").concat(s.textureCache[x].id)),s.textureCache[x].texture}}else if(O===vo.Uniform){if(A&&(Array.isArray(A)||Do()(A))&&A.length>16)throw new Error("invalid data type ".concat(w));l[x]=function(){return y.data}}});var h=this.getOuputDataTexture(),g=h.textureWidth,p=h.texelCount;l.u_OutputTextureSize=[g,g],l.u_OutputTexelCount=p,this.context.output.textureSize=[g,g];var m={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:l,vert:wl,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(m)}return(0,Pi.Z)(i,[{key:"run",value:function(){var o=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){o.computeCommand()}),El&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var r=(0,mo.Z)(Xr().mark(function s(){var l=this,h,g,p,m,y,x,w,A;return Xr().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){h=l.reGl.read()}),!h){O.next=6;break}if(g=this.getOuputDataTexture(),p=g.originalDataLength,m=g.elementsPerTexel,y=g.typedArrayConstructor,x=y===void 0?Float32Array:y,w=[],m!==4)for(A=0;A<h.length;A+=4)m===1?w.push(h[A]):m===2?w.push(h[A],h[A+1]):w.push(h[A],h[A+1],h[A+2]);else w=h;return O.abrupt("return",new x(w.slice(0,p)));case 6:return O.abrupt("return",new Float32Array);case 7:case"end":return O.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"confirmInput",value:function(o,s){var l;this.entity===o.entity?(this.dynamicPingpong=!0,l=this):l=o,this.textureCache[s].id=l.getOuputDataTexture().id,this.textureCache[s].texture=l.getOuputDataTexture().texture,El&&console.log("[".concat(this.entity,"]: confirm input ").concat(s," from model ").concat(l.entity,", ").concat(l.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(o,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=this.context.uniforms.find(function(y){var x=y.name;return x===o});if(h){var g=this.calcDataTexture(o,h.type,s),p=g.texture,m=g.data;this.textureCache[o].data=m,this.textureCache[o].texture=p}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var o=this.context.output.name;this.textureCache[o].id=this.getOuputDataTexture().id,this.textureCache[o].texture=this.getOuputDataTexture().texture}var s=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=s,El&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var o=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=o}},{key:"cloneDataTexture",value:function(o){var s=o.data,l=o.textureWidth;return Qf(Qf({},o),{},{id:td++,texture:this.reGl.texture({width:l,height:l,data:s,type:"float"})})}},{key:"calcDataTexture",value:function(o,s,l){var h=1;s===Dn.Vector4FloatArray&&(h=4);for(var g=[],p=0;p<l.length;p+=h)h===1?g.push(l[p],0,0,0):h===2?g.push(l[p],l[p+1],0,0):h===3?g.push(l[p],l[p+1],l[p+2],0):h===4&&g.push(l[p],l[p+1],l[p+2],l[p+3]);var m=l.length,y=Math.ceil(m/h),x=Math.ceil(Math.sqrt(y)),w=x*x;y<w&&g.push.apply(g,(0,Kf.Z)(new Array((w-y)*4).fill(0)));var A=this.reGl.texture({width:x,height:x,data:g,type:"float"});return{id:td++,data:g,originalDataLength:m,typedArrayConstructor:Do()(l)?l.constructor:void 0,textureWidth:x,texture:A,texelCount:y,elementsPerTexel:h,isOutput:o===this.context.output.name}}}]),i}(),Zr=function(){function i(r,o){(0,Wi.Z)(this,i),this.elements=void 0;var s=o.data,l=o.usage,h=o.type,g=o.count;this.elements=r.elements({data:s,usage:yl[l||qt.STATIC_DRAW],type:qa[h||qt.UNSIGNED_BYTE],count:g})}return(0,Pi.Z)(i,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(o){var s=o.data;this.elements.subdata(s)}},{key:"destroy",value:function(){this.elements.destroy()}}]),i}(),rv=function(){function i(r,o){(0,Wi.Z)(this,i),this.framebuffer=void 0;var s=o.width,l=o.height,h=o.color,g=o.colors,p=o.depth,m=o.stencil,y={width:s,height:l};Array.isArray(g)&&(y.colors=g.map(function(x){return x.get()})),h&&typeof h!="boolean"&&(y.color=h.get()),this.framebuffer=r.framebuffer(y)}return(0,Pi.Z)(i,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(o){var s=o.width,l=o.height;this.framebuffer.resize(s,l)}}]),i}(),iv=Nt(71002),ov=Nt(68630),sv=Nt.n(ov);function nd(i){var r={};return Object.keys(i).forEach(function(o){Ya(o,i[o],r,"")}),r}function Ya(i,r,o,s){if(r===null||typeof r=="number"||typeof r=="boolean"||Array.isArray(r)&&typeof r[0]=="number"||Do()(r)||r===""||r.resize!==void 0){o["".concat(s&&s+".").concat(i)]=r;return}sv()(r)&&Object.keys(r).forEach(function(l){Ya(l,r[l],o,"".concat(s&&s+".").concat(i))}),Array.isArray(r)&&r.forEach(function(l,h){Object.keys(l).forEach(function(g){Ya(g,l[g],o,"".concat(s&&s+".").concat(i,"[").concat(h,"]"))})})}function Vp(i,r){var o=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),o.push.apply(o,s)}return o}function Ja(i){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?Vp(Object(o),!0).forEach(function(s){(0,pe.Z)(i,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):Vp(Object(o)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(o,s))})}return i}var av=function(){function i(r,o){(0,Wi.Z)(this,i),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=r;var s=o.vs,l=o.fs,h=o.defines,g=o.attributes,p=o.uniforms,m=o.primitive,y=o.count,x=o.elements,w=o.depth,A=o.blend,T=o.stencil,O=o.cull,I=o.instances,N=o.scissor,P=o.viewport,R={};p&&(this.uniforms=nd(p),Object.keys(p).forEach(function(pt){R[pt]=r.prop(pt)}));var k={};Object.keys(g).forEach(function(pt){k[pt]=g[pt].get()});var U=h&&this.generateDefines(h)||"",K={attributes:k,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(U,`
`).concat(l),uniforms:R,vert:`
`.concat(U,`
`).concat(s),primitive:K0[m===void 0?qt.TRIANGLES:m]};I&&(K.instances=I),y&&(K.count=y),x&&(K.elements=x.get()),N&&(K.scissor=N),P&&(K.viewport=P),this.initDepthDrawParams({depth:w},K),this.initBlendDrawParams({blend:A},K),this.initStencilDrawParams({stencil:T},K),this.initCullDrawParams({cull:O},K),this.drawCommand=r(K)}return(0,Pi.Z)(i,[{key:"addUniforms",value:function(o){this.uniforms=Ja(Ja({},this.uniforms),nd(o))}},{key:"draw",value:function(o){var s=Ja(Ja({},this.uniforms),nd(o.uniforms||{})),l={};Object.keys(s).forEach(function(h){var g=(0,iv.Z)(s[h]);g==="boolean"||g==="number"||Array.isArray(s[h])||s[h].BYTES_PER_ELEMENT?l[h]=s[h]:g==="string"||(l[h]=s[h].get())}),this.drawCommand(l)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(o,s){var l=o.depth;l&&(s.depth={enable:l.enable===void 0?!0:!!l.enable,mask:l.mask===void 0?!0:!!l.mask,func:la[l.func||qt.LESS],range:l.range||[0,1]})}},{key:"initBlendDrawParams",value:function(o,s){var l=o.blend;if(l){var h=l.enable,g=l.func,p=l.equation,m=l.color,y=m===void 0?[0,0,0,0]:m;s.blend={enable:!!h,func:{srcRGB:Qu[g&&g.srcRGB||qt.SRC_ALPHA],srcAlpha:Qu[g&&g.srcAlpha||qt.SRC_ALPHA],dstRGB:Qu[g&&g.dstRGB||qt.ONE_MINUS_SRC_ALPHA],dstAlpha:Qu[g&&g.dstAlpha||qt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:tv[p&&p.rgb||qt.FUNC_ADD],alpha:tv[p&&p.alpha||qt.FUNC_ADD]},color:y}}}},{key:"initStencilDrawParams",value:function(o,s){var l=o.stencil;if(l){var h=l.enable,g=l.mask,p=g===void 0?-1:g,m=l.func,y=m===void 0?{cmp:qt.ALWAYS,ref:0,mask:-1}:m,x=l.opFront,w=x===void 0?{fail:qt.KEEP,zfail:qt.KEEP,zpass:qt.KEEP}:x,A=l.opBack,T=A===void 0?{fail:qt.KEEP,zfail:qt.KEEP,zpass:qt.KEEP}:A;s.stencil={enable:!!h,mask:p,func:Ja(Ja({},y),{},{cmp:sn[y.cmp]}),opFront:{fail:xl[w.fail],zfail:xl[w.zfail],zpass:xl[w.zpass]},opBack:{fail:xl[T.fail],zfail:xl[T.zfail],zpass:xl[T.zpass]}}}}},{key:"initCullDrawParams",value:function(o,s){var l=o.cull;if(l){var h=l.enable,g=l.face,p=g===void 0?qt.BACK:g;s.cull={enable:!!h,face:px[p]}}}},{key:"generateDefines",value:function(o){return Object.keys(o).map(function(s){return"#define ".concat(s," ").concat(Number(o[s]))}).join(`
`)}}]),i}(),Hp=function(){function i(r,o){(0,Wi.Z)(this,i),this.texture=void 0,this.width=void 0,this.height=void 0;var s=o.data,l=o.type,h=l===void 0?qt.UNSIGNED_BYTE:l,g=o.width,p=o.height,m=o.flipY,y=m===void 0?!1:m,x=o.format,w=x===void 0?qt.RGBA:x,A=o.mipmap,T=A===void 0?!1:A,O=o.wrapS,I=O===void 0?qt.CLAMP_TO_EDGE:O,N=o.wrapT,P=N===void 0?qt.CLAMP_TO_EDGE:N,R=o.aniso,k=R===void 0?0:R,U=o.alignment,K=U===void 0?1:U,pt=o.premultiplyAlpha,Ot=pt===void 0?!1:pt,It=o.mag,Ct=It===void 0?qt.NEAREST:It,_t=o.min,F=_t===void 0?qt.NEAREST:_t,Z=o.colorSpace,yt=Z===void 0?qt.BROWSER_DEFAULT_WEBGL:Z;this.width=g,this.height=p;var bt={width:g,height:p,type:qa[h],format:gx[w],wrapS:Jf[I],wrapT:Jf[P],mag:Ku[Ct],min:Ku[F],alignment:K,flipY:y,colorSpace:Q0[yt],premultiplyAlpha:Ot,aniso:k};s&&(bt.data=s),typeof T=="number"?bt.mipmap=bl[T]:typeof T=="boolean"&&(bt.mipmap=T),this.texture=r.texture(bt)}return(0,Pi.Z)(i,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(o){var s=o.width,l=o.height;this.texture.resize(s,l),this.width=s,this.height=l}},{key:"destroy",value:function(){this.texture.destroy()}}]),i}(),cv=function(){function i(){var r=this;(0,Wi.Z)(this,i),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var o=(0,mo.Z)(Xr().mark(function s(l){return Xr().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!l.uniforms){g.next=3;break}return g.next=3,Promise.all(Object.keys(l.uniforms).map(function(){var p=(0,mo.Z)(Xr().mark(function m(y){var x;return Xr().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(!(l.uniforms[y]&&l.uniforms[y].load!==void 0)){A.next=5;break}return A.next=3,l.uniforms[y].load();case 3:x=A.sent,l.uniforms[y]=x;case 5:case"end":return A.stop()}},m)}));return function(m){return p.apply(this,arguments)}}()));case 3:return g.abrupt("return",new av(r.gl,l));case 4:case"end":return g.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),this.createAttribute=function(o){return new Wa(r.gl,o)},this.createBuffer=function(o){return new ev(r.gl,o)},this.createElements=function(o){return new Zr(r.gl,o)},this.createTexture2D=function(o){return new Hp(r.gl,o)},this.createFramebuffer=function(o){return new rv(r.gl,o)},this.useFramebuffer=function(o,s){r.gl({framebuffer:o?o.get():null})(s)},this.createComputeModel=function(){var o=(0,mo.Z)(Xr().mark(function s(l){return Xr().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",new ed(r.gl,l));case 1:case"end":return g.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),this.clear=function(o){var s=o.color,l=o.depth,h=o.stencil,g=o.framebuffer,p=g===void 0?null:g,m={color:s,depth:l,stencil:h};m.framebuffer=p===null?p:p.get(),r.gl.clear(m)},this.setScissor=function(o){r.gl&&r.gl._gl&&(o.enable&&o.box?(r.gl._gl.enable(qt.SCISSOR_TEST),r.gl._gl.scissor(o.box.x,o.box.y,o.box.width,o.box.height)):r.gl._gl.disable(qt.SCISSOR_TEST),r.gl._refresh())},this.viewport=function(o){var s=o.x,l=o.y,h=o.width,g=o.height;r.gl&&r.gl._gl&&(r.gl._gl.viewport(s,l,h,g),r.gl._refresh())},this.readPixels=function(o){var s=o.framebuffer,l=o.x,h=o.y,g=o.width,p=o.height,m={x:l,y:h,width:g,height:p};return s&&(m.framebuffer=s.get()),r.gl.read(m)},this.getCanvas=function(){return r.$canvas},this.getGLContext=function(){return r.gl._gl},this.destroy=function(){r.gl&&(r.gl.destroy(),r.inited=!1)}}return(0,Pi.Z)(i,[{key:"init",value:function(){var r=(0,mo.Z)(Xr().mark(function s(l){return Xr().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.inited){g.next=2;break}return g.abrupt("return");case 2:return this.$canvas=l.canvas,g.next=5,new Promise(function(p,m){Up()({canvas:l.canvas,attributes:{alpha:!0,antialias:l.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(x,w){(x||!w)&&m(x),p(w)}})});case 5:this.gl=g.sent,this.inited=!0;case 7:case"end":return g.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),i}(),_l=function(){function i(){(0,Wi.Z)(this,i),this.engine=void 0,this.configService=new Wf}return(0,Pi.Z)(i,[{key:"setConfig",value:function(o){this.configService.set(o)}},{key:"setEngine",value:function(o){this.engine=o}},{key:"createEntity",value:function(){return q0()}},{key:"createKernel",value:function(o){var s=new Xx(this.engine,this.configService);return typeof o=="string"?s.setBundle(JSON.parse(o)):s.setBundle(o),s.init(),s}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=new i;return s.setConfig(o),s.setEngine(new cv),s}}]),i}();const Sl=(i,r)=>{let o;return i?kt(i)?o=()=>i:o=i:o=()=>r||1,o},mx=(i,r)=>{const o=[],s=[],l={};let h=0;for(h=0;h<i.length;h++){const p=i[h];l[p.id]=h,o.push(p.x),o.push(p.y),o.push(0),o.push(0),s.push([])}for(h=0;h<r.length;h++){const p=r[h],m=at(p,"source"),y=at(p,"target");!isNaN(l[m])&&!isNaN(l[y])&&(s[l[m]].push(l[y]),s[l[y]].push(l[m]))}let g=0;for(h=0;h<i.length;h++){const p=o.length,m=s[h],y=m.length;o[h*4+2]=p,o[h*4+3]=y,g=Math.max(g,y);for(let x=0;x<y;++x){const w=m[x];o.push(+w)}}for(;o.length%4!==0;)o.push(0);return{maxEdgePerVetex:g,array:new Float32Array(o)}},lv=(i,r,o,s)=>{const l=[],h=[],g={};let p=0;for(p=0;p<i.length;p++){const y=i[p];g[y.id]=p,l.push(y.x),l.push(y.y),l.push(0),l.push(0),h.push([])}for(p=0;p<r.length;p++){const y=r[p],x=at(y,"source"),w=at(y,"target");h[g[x]].push(g[w]),h[g[x]].push(o(y)),h[g[x]].push(s(y)),h[g[x]].push(0),h[g[w]].push(g[x]),h[g[w]].push(o(y)),h[g[w]].push(s(y)),h[g[w]].push(0)}let m=0;for(p=0;p<i.length;p++){const y=l.length,x=h[p],w=x.length;l[p*4+2]=y+1048576*w/4,l[p*4+3]=0,m=Math.max(m,w/4);for(let A=0;A<w;++A){const T=x[A];l.push(+T)}}for(;l.length%4!==0;)l.push(0);return{maxEdgePerVetex:m,array:new Float32Array(l)}},vx=(i,r)=>{const o=[],s=i.length,l={};return r.forEach(h=>{i.forEach((g,p)=>{if(l[h[g]]===void 0&&(l[h[g]]=Object.keys(l).length),o.push(l[h[g]]),p===s-1)for(;o.length%4!==0;)o.push(0)})}),{array:new Float32Array(o),count:Object.keys(l).length}},$p=i=>{const r=[],o=i.length,s=i[0].length;for(let l=0;l<s;l++)i.forEach((h,g)=>{if(r.push(h[l]),g===o-1)for(;r.length%4!==0;)r.push(0)});return new Float32Array(r)},Ur=null,Al='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',th=null,Ka='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var ua=function(i,r,o,s){function l(h){return h instanceof o?h:new o(function(g){g(h)})}return new(o||(o=Promise))(function(h,g){function p(x){try{y(s.next(x))}catch(w){g(w)}}function m(x){try{y(s.throw(x))}catch(w){g(w)}}function y(x){x.done?h(x.value):l(x.value).then(p,m)}y((s=s.apply(i,r||[])).next())})};class Wp extends vn{constructor(r){super(),this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(r)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return ua(this,void 0,void 0,function*(){const r=this,o=r.nodes;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}const l={},h={};o.forEach((g,p)=>{kt(g.x)||(g.x=Math.random()*this.width),kt(g.y)||(g.y=Math.random()*this.height),l[g.id]=g,h[g.id]=p}),r.nodeMap=l,r.nodeIdxMap=h,yield r.run()})}executeWithWorker(r,o){return ua(this,void 0,void 0,function*(){const s=this,l=s.nodes,h=s.center;if(!l||l.length===0)return;if(l.length===1){l[0].x=h[0],l[0].y=h[1];return}const g={},p={};l.forEach((m,y)=>{kt(m.x)||(m.x=Math.random()*this.width),kt(m.y)||(m.y=Math.random()*this.height),g[m.id]=m,p[m.id]=y}),s.nodeMap=g,s.nodeIdxMap=p,yield s.run(r,o)})}run(r,o){return ua(this,void 0,void 0,function*(){const s=this,l=s.nodes,h=s.edges,g=s.maxIteration,p=s.center,m=s.height*s.width;let y=Math.sqrt(m)/10;const x=m/(l.length+1),w=Math.sqrt(x),A=s.speed,T=s.clustering,{array:O,count:I}=vx([s.clusterField],l);l.forEach((_t,F)=>{let Z=0,yt=0;kt(_t.fx)&&kt(_t.fy)&&(Z=_t.fx||.001,yt=_t.fy||.001),O[4*F+1]=Z,O[4*F+2]=yt});const N=l.length,{maxEdgePerVetex:P,array:R}=mx(l,h),k=s.workerEnabled;let U;k?U=_l.create({canvas:r,engineOptions:{supportCompute:!0}}):U=_l.create({engineOptions:{supportCompute:!0}});const K=s.onLayoutEnd,pt=[];for(let _t=0;_t<I;_t++)pt.push(0,0,0,0);const Ot=U.createKernel(Al).setDispatch([N,1,1]).setBinding({u_Data:R,u_K:w,u_K2:x,u_Gravity:s.gravity,u_ClusterGravity:s.clusterGravity||s.gravity||1,u_Speed:A,u_MaxDisplace:y,u_Clustering:T?1:0,u_Center:p,u_AttributeArray:O,u_ClusterCenters:pt,MAX_EDGE_PER_VERTEX:P,VERTEX_COUNT:N});let It;T&&(It=U.createKernel(Ka).setDispatch([I,1,1]).setBinding({u_Data:R,u_NodeAttributes:O,u_ClusterCenters:pt,VERTEX_COUNT:N,CLUSTER_COUNT:I})),yield ua(this,void 0,void 0,function*(){for(let F=0;F<g;F++)yield Ot.execute(),T&&(It.setBinding({u_Data:Ot}),yield It.execute(),Ot.setBinding({u_ClusterCenters:It})),Ot.setBinding({u_MaxDisplace:y*=.99});const _t=yield Ot.getOutput();r?o.postMessage({type:Wl.GPUEND,vertexEdgeData:_t}):l.forEach((F,Z)=>{const yt=_t[4*Z],bt=_t[4*Z+1];F.x=yt,F.y=bt}),K&&K()})})}getType(){return"fruchterman-gpu"}}const yx=null,uv='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',bx=null,hv='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var Es=function(i,r,o,s){function l(h){return h instanceof o?h:new o(function(g){g(h)})}return new(o||(o=Promise))(function(h,g){function p(x){try{y(s.next(x))}catch(w){g(w)}}function m(x){try{y(s.throw(x))}catch(w){g(w)}}function y(x){x.done?h(x.value):l(x.value).then(p,m)}y((s=s.apply(i,r||[])).next())})};class Xp extends vn{constructor(r){super(),this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(r)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return Es(this,void 0,void 0,function*(){const r=this,o=r.nodes;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}const l={},h={};o.forEach((g,p)=>{kt(g.x)||(g.x=Math.random()*r.width),kt(g.y)||(g.y=Math.random()*r.height),l[g.id]=g,h[g.id]=p}),r.nodeMap=l,r.nodeIdxMap=h,r.nodeStrength=Sl(r.nodeStrength,1),r.edgeStrength=Sl(r.edgeStrength,1),yield r.run()})}executeWithWorker(r,o){const s=this,l=s.nodes,h=s.center;if(!l||l.length===0)return;if(l.length===1){l[0].x=h[0],l[0].y=h[1];return}const g={},p={};l.forEach((m,y)=>{kt(m.x)||(m.x=Math.random()*s.width),kt(m.y)||(m.y=Math.random()*s.height),g[m.id]=m,p[m.id]=y}),s.nodeMap=g,s.nodeIdxMap=p,s.nodeStrength=Sl(s.nodeStrength,1),s.edgeStrength=Sl(s.edgeStrength,1),s.run(r,o)}run(r,o){return Es(this,void 0,void 0,function*(){const s=this,l=s.nodes,h=s.edges,g=s.maxIteration;!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight);const p=l.length;s.linkDistance=Sl(s.linkDistance),s.edgeStrength=Sl(s.edgeStrength);const{maxEdgePerVetex:m,array:y}=lv(l,h,s.linkDistance,s.edgeStrength);s.degrees=jt(l.length,s.nodeIdxMap,h).map(Z=>Z.all);const x=[],w=[],A=[],T=[],O=[],I=[],N=[];s.getMass||(s.getMass=Z=>s.degrees[s.nodeIdxMap[Z.id]]||1);const P=s.gravity,R=s.center;l.forEach((Z,yt)=>{x.push(s.getMass(Z)),w.push(s.nodeStrength(Z)),s.degrees[yt]||(s.degrees[yt]=0);let bt=[R[0],R[1],P];if(s.getCenter){const de=s.getCenter(Z,s.degrees[yt]);de&&kt(de[0])&&kt(de[1])&&kt(de[2])&&(bt=de)}A.push(bt[0]),T.push(bt[1]),O.push(bt[2]),kt(Z.fx)&&kt(Z.fy)?(I.push(Z.fx||.001),N.push(Z.fy||.001)):(I.push(0),N.push(0))});const k=$p([x,s.degrees,w,I]),U=$p([A,T,O,N]),K=s.workerEnabled;let pt;K?pt=_l.create({canvas:r,engineOptions:{supportCompute:!0}}):pt=_l.create({engineOptions:{supportCompute:!0}});const Ot=s.onLayoutEnd,It=[];y.forEach(Z=>{It.push(Z)});for(let Z=0;Z<4;Z++)It.push(0);const Ct=pt.createKernel(uv).setDispatch([p,1,1]).setBinding({u_Data:y,u_damping:s.damping,u_maxSpeed:s.maxSpeed,u_minMovement:s.minMovement,u_coulombDisScale:s.coulombDisScale,u_factor:s.factor,u_NodeAttributeArray1:k,u_NodeAttributeArray2:U,MAX_EDGE_PER_VERTEX:m,VERTEX_COUNT:p,u_AveMovement:It,u_interval:s.interval}),_t=pt.createKernel(hv).setDispatch([1,1,1]).setBinding({u_Data:y,VERTEX_COUNT:p,u_AveMovement:[0,0,0,0]});yield Es(this,void 0,void 0,function*(){for(let yt=0;yt<g;yt++){yield Ct.execute(),_t.setBinding({u_Data:Ct}),yield _t.execute();const bt=Math.max(.02,s.interval-yt*.002);Ct.setBinding({u_interval:bt,u_AveMovement:_t})}const Z=yield Ct.getOutput();r?o.postMessage({type:Wl.GPUEND,vertexEdgeData:Z}):l.forEach((yt,bt)=>{const de=Z[4*bt],Ne=Z[4*bt+1];yt.x=de,yt.y=Ne}),Ot&&Ot()})})}getType(){return"gForce-gpu"}}class rd extends vn{constructor(r){super(),this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(r)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const r=this,o=r.nodes,s=r.center;if(r.comboTree={id:"comboTreeRoot",depth:-1,children:r.comboTrees},!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}r.initVals(),r.run(),r.onLayoutEnd&&r.onLayoutEnd()}run(){const r=this,o=r.nodes,s=r.previousLayouted?r.maxIteration/5:r.maxIteration;!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight);const l=r.center,h=r.velocityDecay,g=r.comboMap;r.previousLayouted||r.initPos(g);for(let y=0;y<s;y++){const x=[];o.forEach((w,A)=>{x[A]={x:0,y:0}}),r.applyCalculate(x),r.applyComboCenterForce(x),o.forEach((w,A)=>{!kt(w.x)||!kt(w.y)||(w.x+=x[A].x*h,w.y+=x[A].y*h)}),r.alpha+=(r.alphaTarget-r.alpha)*r.alphaDecay,r.onTick()}const p=[0,0];o.forEach(y=>{!kt(y.x)||!kt(y.y)||(p[0]+=y.x,p[1]+=y.y)}),p[0]/=o.length,p[1]/=o.length;const m=[l[0]-p[0],l[1]-p[1]];o.forEach((y,x)=>{!kt(y.x)||!kt(y.y)||(y.x+=m[0],y.y+=m[1])}),r.combos.forEach(y=>{const x=g[y.id];x&&x.empty&&(y.x=x.cx||y.x,y.y=x.cy||y.y)}),r.previousLayouted=!0}initVals(){const r=this,o=r.edges,s=r.nodes,l=r.combos,h={},g={},p={};s.forEach((_t,F)=>{g[_t.id]=_t,p[_t.id]=F}),r.nodeMap=g,r.indexMap=p;const m={};l.forEach(_t=>{m[_t.id]=_t}),r.oriComboMap=m,r.comboMap=r.getComboMap();const y=r.preventOverlap;r.preventComboOverlap=r.preventComboOverlap||y,r.preventNodeOverlap=r.preventNodeOverlap||y;const x=r.collideStrength;x&&(r.comboCollideStrength=x,r.nodeCollideStrength=x),r.comboCollideStrength=r.comboCollideStrength?r.comboCollideStrength:0,r.nodeCollideStrength=r.nodeCollideStrength?r.nodeCollideStrength:0;for(let _t=0;_t<o.length;++_t){const F=at(o[_t],"source"),Z=at(o[_t],"target");h[F]?h[F]++:h[F]=1,h[Z]?h[Z]++:h[Z]=1}const w=[];for(let _t=0;_t<o.length;++_t){const F=at(o[_t],"source"),Z=at(o[_t],"target");w[_t]=h[F]/(h[F]+h[Z])}this.bias=w;const A=r.nodeSize,T=r.nodeSpacing;let O,I;if(kt(T)?I=()=>T:Ue(T)?I=T:I=()=>0,this.nodeSpacing=I,!A)O=_t=>_t.size?Jt(_t.size)?(_t.size[0]>_t.size[1]?_t.size[0]:_t.size[1])/2:Q(_t.size)?(_t.size.width>_t.size.height?_t.size.width:_t.size.height)/2:_t.size/2:10;else if(Ue(A))O=_t=>A(_t);else if(Jt(A)){const F=(A[0]>A[1]?A[0]:A[1])/2;O=Z=>F}else{const _t=A/2;O=F=>_t}this.nodeSize=O;const N=r.comboSpacing;let P;kt(N)?P=()=>N:Ue(N)?P=N:P=()=>0,this.comboSpacing=P;const R=r.comboPadding;let k;kt(R)?k=()=>R:Jt(R)?k=()=>Math.max.apply(null,R):Ue(R)?k=R:k=()=>0,this.comboPadding=k;let U=this.linkDistance,K;U||(U=10),kt(U)?K=_t=>U:K=U,this.linkDistance=K;let pt=this.edgeStrength,Ot;pt||(pt=1),kt(pt)?Ot=_t=>pt:Ot=pt,this.edgeStrength=Ot;let It=this.nodeStrength,Ct;It||(It=30),kt(It)?Ct=_t=>It:Ct=It,this.nodeStrength=Ct}initPos(r){this.nodes.forEach((l,h)=>{const g=l.comboId,p=r[g];g&&p?(l.x=p.cx+100/(h+1),l.y=p.cy+100/(h+1)):(l.x=100/(h+1),l.y=100/(h+1))})}getComboMap(){const r=this,o=r.nodeMap,s=r.comboTrees,l=r.oriComboMap,h={};return(s||[]).forEach(g=>{const p=[];Ce(g,m=>{if(m.itemType==="node"||!l[m.id])return!0;if(h[m.id]===void 0){const w={id:m.id,name:m.id,cx:0,cy:0,count:0,depth:r.oriComboMap[m.id].depth||0,children:[]};h[m.id]=w}const y=m.children;y&&y.forEach(w=>{if(!h[w.id]&&!o[w.id])return!0;p.push(w)});const x=h[m.id];if(x.cx=0,x.cy=0,p.length===0){x.empty=!0;const w=l[m.id];x.cx=w.x,x.cy=w.y}return p.forEach(w=>{if(x.count++,w.itemType!=="node"){const T=h[w.id];kt(T.cx)&&(x.cx+=T.cx),kt(T.cy)&&(x.cy+=T.cy);return}const A=o[w.id];A&&(kt(A.x)&&(x.cx+=A.x),kt(A.y)&&(x.cy+=A.y))}),x.cx/=x.count||1,x.cy/=x.count||1,x.children=p,!0})}),h}applyComboCenterForce(r){const o=this,s=o.gravity,l=o.comboGravity||s,h=this.alpha,g=o.comboTrees,p=o.indexMap,m=o.nodeMap,y=o.comboMap;(g||[]).forEach(x=>{Ce(x,w=>{if(w.itemType==="node"||!y[w.id])return!0;const T=y[w.id],O=(T.depth+1)/10*.5,I=T.cx,N=T.cy;return T.cx=0,T.cy=0,T.children.forEach(P=>{if(P.itemType!=="node"){const It=y[P.id];It&&kt(It.cx)&&(T.cx+=It.cx),It&&kt(It.cy)&&(T.cy+=It.cy);return}const R=m[P.id],k=R.x-I||.005,U=R.y-N||.005,K=Math.sqrt(k*k+U*U),pt=p[R.id],Ot=l*h/K*O;r[pt].x-=k*Ot,r[pt].y-=U*Ot,kt(R.x)&&(T.cx+=R.x),kt(R.y)&&(T.cy+=R.y)}),T.cx/=T.count||1,T.cy/=T.count||1,!0})})}applyCalculate(r){const o=this,s=o.comboMap,l=o.nodes,h={};l.forEach((p,m)=>{l.forEach((y,x)=>{if(m<x)return;const w=p.x-y.x||.005,A=p.y-y.y||.005;let T=w*w+A*A;const O=Math.sqrt(T);T<1&&(T=O),h[`${p.id}-${y.id}`]={vx:w,vy:A,vl2:T,vl:O},h[`${y.id}-${p.id}`]={vl2:T,vl:O,vx:-w,vy:-A}})}),o.updateComboSizes(s),o.calRepulsive(r,h),o.calAttractive(r,h),o.preventComboOverlap&&o.comboNonOverlapping(r,s)}updateComboSizes(r){const o=this,s=o.comboTrees,l=o.nodeMap,h=o.nodeSize,g=o.comboSpacing,p=o.comboPadding;(s||[]).forEach(m=>{const y=[];Ce(m,x=>{if(x.itemType==="node")return!0;const w=r[x.id];if(!w)return!1;const A=x.children;A&&A.forEach(I=>{!r[I.id]&&!l[I.id]||y.push(I)}),w.minX=1/0,w.minY=1/0,w.maxX=-1/0,w.maxY=-1/0,y.forEach(I=>{if(I.itemType!=="node")return!0;const N=l[I.id];if(!N)return!0;const P=h(N),R=N.x-P,k=N.y-P,U=N.x+P,K=N.y+P;w.minX>R&&(w.minX=R),w.minY>k&&(w.minY=k),w.maxX<U&&(w.maxX=U),w.maxY<K&&(w.maxY=K)});let T=o.oriComboMap[x.id].size||10;Jt(T)&&(T=T[0]);const O=Math.max(w.maxX-w.minX,w.maxY-w.minY,T);return w.r=O/2+g(w)/2+p(w),!0})})}comboNonOverlapping(r,o){const s=this,l=s.comboTree,h=s.comboCollideStrength,g=s.indexMap,p=s.nodeMap;Ce(l,m=>{if(!o[m.id]&&!p[m.id]&&m.id!=="comboTreeRoot")return!1;const y=m.children;return y&&y.length>1&&y.forEach((x,w)=>{if(x.itemType==="node")return!1;const A=o[x.id];A&&y.forEach((T,O)=>{if(w<=O||T.itemType==="node")return!1;const I=o[T.id];if(!I)return!1;const N=A.cx-I.cx||.005,P=A.cy-I.cy||.005,R=N*N+P*P,k=A.r||1,U=I.r||1,K=k+U,pt=U*U,Ot=k*k;if(R<K*K){const It=x.children;if(!It||It.length===0)return!1;const Ct=T.children;if(!Ct||Ct.length===0)return!1;const _t=Math.sqrt(R),F=(K-_t)/_t*h,Z=N*F,yt=P*F,bt=pt/(Ot+pt),de=1-bt;It.forEach(Ne=>{if(Ne.itemType!=="node")return!1;if(!p[Ne.id])return;const Ee=g[Ne.id];Ct.forEach(Ie=>{if(Ie.itemType!=="node"||!p[Ie.id])return!1;const Ge=g[Ie.id];r[Ee].x+=Z*bt,r[Ee].y+=yt*bt,r[Ge].x-=Z*de,r[Ge].y-=yt*de})})}})}),!0})}calRepulsive(r,o){const s=this,l=s.nodes,h=s.width*s.optimizeRangeFactor,g=s.nodeStrength,p=s.alpha,m=s.nodeCollideStrength,y=s.preventNodeOverlap,x=s.nodeSize,w=s.nodeSpacing,A=s.depthRepulsiveForceScale,T=s.center;l.forEach((O,I)=>{if(!(!O.x||!O.y)){if(T){const N=s.gravity,P=O.x-T[0]||.005,R=O.y-T[1]||.005,k=Math.sqrt(P*P+R*R);r[I].x-=P*N*p/k,r[I].y-=R*N*p/k}l.forEach((N,P)=>{if(I===P||!N.x||!N.y)return;const{vl2:R,vl:k}=o[`${O.id}-${N.id}`];if(k>h)return;const{vx:U,vy:K}=o[`${O.id}-${N.id}`];let pt=Math.log(Math.abs(N.depth-O.depth)/10)+1||1;pt=pt<1?1:pt,N.comboId!==O.comboId&&(pt+=1);const Ot=pt?Math.pow(A,pt):1,It=g(N)*p/R*Ot;if(r[I].x+=U*It,r[I].y+=K*It,I<P&&y){const Ct=x(O)+w(O)||1,_t=x(N)+w(N)||1,F=Ct+_t;if(R<F*F){const Z=(F-k)/k*m,yt=_t*_t;let bt=yt/(Ct*Ct+yt);const de=U*Z,Ne=K*Z;r[I].x+=de*bt,r[I].y+=Ne*bt,bt=1-bt,r[P].x-=de*bt,r[P].y-=Ne*bt}}})}})}calAttractive(r,o){const s=this,l=s.edges,h=s.linkDistance,g=s.alpha,p=s.edgeStrength,m=s.bias,y=s.depthAttractiveForceScale;l.forEach((x,w)=>{const A=at(x,"source"),T=at(x,"target");if(!A||!T||A===T)return;const O=s.indexMap[A],I=s.indexMap[T],N=s.nodeMap[A],P=s.nodeMap[T];if(!N||!P)return;let R=N.depth===P.depth?0:Math.log(Math.abs(N.depth-P.depth)/10);N.comboId===P.comboId&&(R=R/2);let k=R?Math.pow(y,R):1;if(N.comboId!==P.comboId&&k===1?k=y/2:N.comboId===P.comboId&&(k=2),!kt(P.x)||!kt(N.x)||!kt(P.y)||!kt(N.y))return;const{vl:U,vx:K,vy:pt}=o[`${T}-${A}`],Ot=(U-h(x))/U*g*p(x)*k,It=K*Ot,Ct=pt*Ot,_t=m[w];r[I].x-=It*_t,r[I].y-=Ct*_t,r[O].x+=It*(1-_t),r[O].y+=Ct*(1-_t)})}getType(){return"comboForce"}}class id extends vn{constructor(r){super(),this.center=[0,0],this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.comboPadding=10,this.comboTrees=[],this.updateCfg(r)}getDefaultCfg(){return{}}execute(){const r=this,o=r.nodes,s=r.center;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}r.initVals(),r.run(),r.onLayoutEnd&&r.onLayoutEnd()}run(){var r;const o=this,{nodes:s,edges:l,combos:h,comboEdges:g,center:p}=o,m={};s.forEach(P=>{m[P.id]=P});const y={};h.forEach(P=>{y[P.id]=P});const x=o.getInnerGraphs(m),w=[],A=[],T={};let O=!0;this.comboTrees.forEach(P=>{const R=x[P.id];if(!R)return;const k=Object.assign(Object.assign({},P),{x:R.x||y[P.id].x,y:R.y||y[P.id].y,fx:R.fx||y[P.id].fx,fy:R.fy||y[P.id].fy,mass:R.mass||y[P.id].mass,size:R.size});A.push(k),!isNaN(k.x)&&k.x!==0&&!isNaN(k.y)&&k.y!==0?O=!1:(k.x=Math.random()*100,k.y=Math.random()*100),w.push(P.id),Ce(P,U=>(U.id!==P.id&&(T[U.id]=P.id),!0))}),s.forEach(P=>{if(P.comboId&&y[P.comboId])return;const R=Object.assign({},P);A.push(R),!isNaN(R.x)&&R.x!==0&&!isNaN(R.y)&&R.y!==0?O=!1:(R.x=Math.random()*100,R.y=Math.random()*100),w.push(P.id)});const I=[];if(l.concat(g).forEach(P=>{const R=T[P.source]||P.source,k=T[P.target]||P.target;R!==k&&w.includes(R)&&w.includes(k)&&I.push({source:R,target:k})}),A!=null&&A.length){if(A.length===1)A[0].x=p[0],A[0].y=p[1];else{const P={nodes:A,edges:I},R=this.outerLayout||new dr({gravity:1,factor:4,linkDistance:(U,K,pt)=>{var Ot,It;const Ct=((((Ot=K.size)===null||Ot===void 0?void 0:Ot[0])||30)+(((It=pt.size)===null||It===void 0?void 0:It[0])||30))/2;return Math.min(Ct*1.5,700)}}),k=(r=R.getType)===null||r===void 0?void 0:r.call(R);R.updateCfg({center:p,kg:5,preventOverlap:!0,animate:!1}),O&&Fd[k]&&(A.length<100?new dl:new Bn).layout(P),R.layout(P)}A.forEach(P=>{const R=x[P.id];if(!R){const k=m[P.id];k&&(k.x=P.x,k.y=P.y);return}R.visited=!0,R.x=P.x,R.y=P.y,R.nodes.forEach(k=>{k.x+=P.x,k.y+=P.y})})}const N=Object.keys(x);for(let P=N.length-1;P>=0;P--){const R=N[P],k=x[R];k&&(k.nodes.forEach(U=>{k.visited||(U.x+=k.x||0,U.y+=k.y||0),m[U.id]&&(m[U.id].x=U.x,m[U.id].y=U.y)}),y[R]&&(y[R].x=k.x,y[R].y=k.y))}return{nodes:s,edges:l,combos:h,comboEdges:g}}getInnerGraphs(r){const o=this,{comboTrees:s,nodeSize:l,edges:h,comboPadding:g,spacing:p}=o,m={},y=this.innerLayout||new Ni({type:"concentric",sortBy:"id"});return y.center=[0,0],y.preventOverlap=!0,y.nodeSpacing=p,(s||[]).forEach(x=>{Ce(x,w=>{var A;let T=(g==null?void 0:g(w))||10;if(Jt(T)&&(T=Math.max(...T)),!((A=w.children)===null||A===void 0)&&A.length){const O=w.children.map(Ct=>{if(Ct.itemType==="combo")return m[Ct.id];const _t=r[Ct.id]||{};return Object.assign(Object.assign({},_t),Ct)}),I=O.map(Ct=>Ct.id),N={nodes:O,edges:h.filter(Ct=>I.includes(Ct.source)&&I.includes(Ct.target))};let P=1/0;O.forEach(Ct=>{var _t;Ct.size||(Ct.size=((_t=m[Ct.id])===null||_t===void 0?void 0:_t.size)||(l==null?void 0:l(Ct))||[30,30]),kt(Ct.size)&&(Ct.size=[Ct.size,Ct.size]),P>Ct.size[0]&&(P=Ct.size[0]),P>Ct.size[1]&&(P=Ct.size[1])}),y.layout(N);const{minX:R,minY:k,maxX:U,maxY:K}=Me(O),pt={x:(U+R)/2,y:(K+k)/2};N.nodes.forEach(Ct=>{Ct.x-=pt.x,Ct.y-=pt.y});const Ot=Math.max(U-R,P)+T*2,It=Math.max(K-k,P)+T*2;m[w.id]={id:w.id,nodes:O,size:[Ot,It]}}else if(w.itemType==="combo"){const O=T?[T*2,T*2]:[30,30];m[w.id]={id:w.id,nodes:[],size:O}}return!0})}),m}initVals(){const r=this,o=r.nodeSize,s=r.spacing;let l,h;if(kt(s)?h=()=>s:Ue(s)?h=s:h=()=>0,this.spacing=h,!o)l=m=>{const y=h(m);return m.size?Jt(m.size)?((m.size[0]>m.size[1]?m.size[0]:m.size[1])+y)/2:Q(m.size)?((m.size.width>m.size.height?m.size.width:m.size.height)+y)/2:(m.size+y)/2:10+y/2};else if(Ue(o))l=m=>{const y=o(m),x=h(m);return Jt(m.size)?((m.size[0]>m.size[1]?m.size[0]:m.size[1])+x)/2:((y||10)+x)/2};else if(Jt(o)){const y=(o[0]>o[1]?o[0]:o[1])/2;l=x=>y+h(x)/2}else{const m=o/2;l=y=>m+h(y)/2}this.nodeSize=l;const g=r.comboPadding;let p;kt(g)?p=()=>g:Jt(g)?p=()=>Math.max.apply(null,g):Ue(g)?p=g:p=()=>0,this.comboPadding=p}getType(){return"comboCombined"}}class ha{constructor(r){this.id=r.id||0,this.rx=r.rx,this.ry=r.ry,this.fx=0,this.fy=0,this.mass=r.mass,this.degree=r.degree,this.g=r.g||0}distanceTo(r){const o=this.rx-r.rx,s=this.ry-r.ry;return Math.hypot(o,s)}setPos(r,o){this.rx=r,this.ry=o}resetForce(){this.fx=0,this.fy=0}addForce(r){const o=r.rx-this.rx,s=r.ry-this.ry;let l=Math.hypot(o,s);l=l<1e-4?1e-4:l;const h=this.g*(this.degree+1)*(r.degree+1)/l;this.fx+=h*o/l,this.fy+=h*s/l}in(r){return r.contains(this.rx,this.ry)}add(r){const o=this.mass+r.mass,s=(this.rx*this.mass+r.rx*r.mass)/o,l=(this.ry*this.mass+r.ry*r.mass)/o,h=this.degree+r.degree,g={rx:s,ry:l,mass:o,degree:h};return new ha(g)}}class Qa{constructor(r){this.xmid=r.xmid,this.ymid=r.ymid,this.length=r.length,this.massCenter=r.massCenter||[0,0],this.mass=r.mass||1}getLength(){return this.length}contains(r,o){const s=this.length/2;return r<=this.xmid+s&&r>=this.xmid-s&&o<=this.ymid+s&&o>=this.ymid-s}NW(){const r=this.xmid-this.length/4,o=this.ymid+this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new Qa(l)}NE(){const r=this.xmid+this.length/4,o=this.ymid+this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new Qa(l)}SW(){const r=this.xmid-this.length/4,o=this.ymid-this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new Qa(l)}SE(){const r=this.xmid+this.length/4,o=this.ymid-this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new Qa(l)}}class tc{constructor(r){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,r!=null&&(this.quad=r)}insert(r){if(this.body==null){this.body=r;return}this._isExternal()?(this.quad&&(this.NW=new tc(this.quad.NW()),this.NE=new tc(this.quad.NE()),this.SW=new tc(this.quad.SW()),this.SE=new tc(this.quad.SE())),this._putBody(this.body),this._putBody(r),this.body=this.body.add(r)):(this.body=this.body.add(r),this._putBody(r))}_putBody(r){this.quad&&(r.in(this.quad.NW())&&this.NW?this.NW.insert(r):r.in(this.quad.NE())&&this.NE?this.NE.insert(r):r.in(this.quad.SW())&&this.SW?this.SW.insert(r):r.in(this.quad.SE())&&this.SE&&this.SE.insert(r))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(r){if(!(this.body==null||r===this.body))if(this._isExternal())r.addForce(this.body);else{const o=this.quad?this.quad.getLength():0,s=this.body.distanceTo(r);o/s<this.theta?r.addForce(this.body):(this.NW&&this.NW.updateForce(r),this.NE&&this.NE.updateForce(r),this.SW&&this.SW.updateForce(r),this.SE&&this.SE.updateForce(r))}}}class Di extends vn{constructor(r){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(r)}getDefaultCfg(){return{}}execute(){const r=this,{nodes:o,onLayoutEnd:s,prune:l}=r;let h=r.maxIteration;!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight);const g=[],p=o.length;for(let m=0;m<p;m+=1){const y=o[m];let x=10,w=10;kt(y.size)&&(x=y.size,w=y.size),Jt(y.size)?(isNaN(y.size[0])||(x=y.size[0]),isNaN(y.size[1])||(w=y.size[1])):Q(y.size)&&(x=y.size.width,w=y.size.height),r.getWidth&&!isNaN(r.getWidth(y))&&(w=r.getWidth(y)),r.getHeight&&!isNaN(r.getHeight(y))&&(x=r.getHeight(y));const A=Math.max(x,w);g.push(A)}r.barnesHut===void 0&&p>250&&(r.barnesHut=!0),r.prune===void 0&&p>100&&(r.prune=!0),this.maxIteration===0&&!r.prune?(h=250,p<=200&&p>100?h=1e3:p>200&&(h=1200),this.maxIteration=h):this.maxIteration===0&&l&&(h=100,p<=200&&p>100?h=500:p>200&&(h=950),this.maxIteration=h),r.kr||(r.kr=50,p>100&&p<=500?r.kr=20:p>500&&(r.kr=1)),r.kg||(r.kg=20,p>100&&p<=500?r.kg=10:p>500&&(r.kg=1)),this.nodes=r.updateNodesByForces(g),s()}updateNodesByForces(r){const o=this,{edges:s,maxIteration:l}=o;let h=o.nodes;const g=s.filter(O=>{const I=at(O,"source"),N=at(O,"target");return I!==N}),p=h.length,m=g.length,y=[],x={},w={},A=[];for(let O=0;O<p;O+=1)x[h[O].id]=O,y[O]=0,(h[O].x===void 0||isNaN(h[O].x))&&(h[O].x=Math.random()*1e3),(h[O].y===void 0||isNaN(h[O].y))&&(h[O].y=Math.random()*1e3),A.push({x:h[O].x,y:h[O].y});for(let O=0;O<m;O+=1){let I,N,P=0,R=0;for(let k=0;k<p;k+=1){const U=at(g[O],"source"),K=at(g[O],"target");h[k].id===U?(I=h[k],P=k):h[k].id===K&&(N=h[k],R=k),w[O]={sourceIdx:P,targetIdx:R}}I&&(y[x[I.id]]+=1),N&&(y[x[N.id]]+=1)}let T=l;if(h=this.iterate(T,x,w,m,y,r),o.prune){for(let O=0;O<m;O+=1)y[w[O].sourceIdx]<=1?(h[w[O].sourceIdx].x=h[w[O].targetIdx].x,h[w[O].sourceIdx].y=h[w[O].targetIdx].y):y[w[O].targetIdx]<=1&&(h[w[O].targetIdx].x=h[w[O].sourceIdx].x,h[w[O].targetIdx].y=h[w[O].sourceIdx].y);o.prune=!1,o.barnesHut=!1,T=100,h=this.iterate(T,x,w,m,y,r)}return h}iterate(r,o,s,l,h,g){const p=this;let{nodes:m}=p;const{kr:y,preventOverlap:x}=p,{barnesHut:w}=p,A=m.length;let T=0;const O=100;let I=r;const N=50;let P=[];const R=[],k=[];for(let U=0;U<A;U+=1)if(P[2*U]=0,P[2*U+1]=0,w){const K={id:U,rx:m[U].x,ry:m[U].y,mass:1,g:y,degree:h[U]};k[U]=new ha(K)}for(;I>0;){for(let K=0;K<A;K+=1)R[2*K]=P[2*K],R[2*K+1]=P[2*K+1],P[2*K]=0,P[2*K+1]=0;P=this.getAttrForces(I,N,l,o,s,h,g,P),w&&(x&&I>N||!x)?P=this.getOptRepGraForces(P,k,h):P=this.getRepGraForces(I,N,P,O,g,h);const U=this.updatePos(P,R,T,h);m=U.nodes,T=U.sg,I--,p.tick&&p.tick()}return m}getAttrForces(r,o,s,l,h,g,p,m){const y=this,{nodes:x,preventOverlap:w,dissuadeHubs:A,mode:T,prune:O}=y;for(let I=0;I<s;I+=1){const N=x[h[I].sourceIdx],P=h[I].sourceIdx,R=x[h[I].targetIdx],k=h[I].targetIdx;if(O&&(g[P]<=1||g[k]<=1))continue;const U=[R.x-N.x,R.y-N.y];let K=Math.hypot(U[0],U[1]);K=K<1e-4?1e-4:K,U[0]=U[0]/K,U[1]=U[1]/K,w&&r<o&&(K=K-p[P]-p[k]);let pt=K,Ot=pt;T==="linlog"&&(pt=Math.log(1+K),Ot=pt),A&&(pt=K/g[P],Ot=K/g[k]),w&&r<o&&K<=0?(pt=0,Ot=0):w&&r<o&&K>0&&(pt=K,Ot=K),m[2*l[N.id]]+=pt*U[0],m[2*l[R.id]]-=Ot*U[0],m[2*l[N.id]+1]+=pt*U[1],m[2*l[R.id]+1]-=Ot*U[1]}return m}getRepGraForces(r,o,s,l,h,g){const p=this,{nodes:m,preventOverlap:y,kr:x,kg:w,center:A,prune:T}=p,O=m.length;for(let I=0;I<O;I+=1){for(let k=I+1;k<O;k+=1){if(T&&(g[I]<=1||g[k]<=1))continue;const U=[m[k].x-m[I].x,m[k].y-m[I].y];let K=Math.hypot(U[0],U[1]);K=K<1e-4?1e-4:K,U[0]=U[0]/K,U[1]=U[1]/K,y&&r<o&&(K=K-h[I]-h[k]);let pt=x*(g[I]+1)*(g[k]+1)/K;y&&r<o&&K<0?pt=l*(g[I]+1)*(g[k]+1):y&&r<o&&K===0?pt=0:y&&r<o&&K>0&&(pt=x*(g[I]+1)*(g[k]+1)/K),s[2*I]-=pt*U[0],s[2*k]+=pt*U[0],s[2*I+1]-=pt*U[1],s[2*k+1]+=pt*U[1]}const N=[m[I].x-A[0],m[I].y-A[1]],P=Math.hypot(N[0],N[1]);N[0]=N[0]/P,N[1]=N[1]/P;const R=w*(g[I]+1);s[2*I]-=R*N[0],s[2*I+1]-=R*N[1]}return s}getOptRepGraForces(r,o,s){const l=this,{nodes:h,kg:g,center:p,prune:m}=l,y=h.length;let x=9e10,w=-9e10,A=9e10,T=-9e10;for(let R=0;R<y;R+=1)m&&s[R]<=1||(o[R].setPos(h[R].x,h[R].y),h[R].x>=w&&(w=h[R].x),h[R].x<=x&&(x=h[R].x),h[R].y>=T&&(T=h[R].y),h[R].y<=A&&(A=h[R].y));const O=Math.max(w-x,T-A),I={xmid:(w+x)/2,ymid:(T+A)/2,length:O,massCenter:p,mass:y},N=new Qa(I),P=new tc(N);for(let R=0;R<y;R+=1)m&&s[R]<=1||o[R].in(N)&&P.insert(o[R]);for(let R=0;R<y;R+=1){if(m&&s[R]<=1)continue;o[R].resetForce(),P.updateForce(o[R]),r[2*R]-=o[R].fx,r[2*R+1]-=o[R].fy;const k=[h[R].x-p[0],h[R].y-p[1]];let U=Math.hypot(k[0],k[1]);U=U<1e-4?1e-4:U,k[0]=k[0]/U,k[1]=k[1]/U;const K=g*(s[R]+1);r[2*R]-=K*k[0],r[2*R+1]-=K*k[1]}return r}updatePos(r,o,s,l){const h=this,{nodes:g,ks:p,tao:m,prune:y,ksmax:x}=h,w=g.length,A=[],T=[];let O=0,I=0;for(let P=0;P<w;P+=1){if(y&&l[P]<=1)continue;const R=[r[2*P]-o[2*P],r[2*P+1]-o[2*P+1]],k=Math.hypot(R[0],R[1]),U=[r[2*P]+o[2*P],r[2*P+1]+o[2*P+1]],K=Math.hypot(U[0],U[1]);A[P]=k,T[P]=K/2,O+=(l[P]+1)*A[P],I+=(l[P]+1)*T[P]}const N=s;s=m*I/O,N!==0&&(s=s>1.5*N?1.5*N:s);for(let P=0;P<w;P+=1){if(y&&l[P]<=1||kt(g[P].fx)&&kt(g[P].fy))continue;let R=p*s/(1+s*Math.sqrt(A[P])),k=Math.hypot(r[2*P],r[2*P+1]);k=k<1e-4?1e-4:k;const U=x/k;R=R>U?U:R;const K=R*r[2*P],pt=R*r[2*P+1];g[P].x+=K,g[P].y+=pt}return{nodes:g,sg:s}}}class ui{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(r,o,s){this.cells=[],this.CELL_W=s.CELL_W||ui.DEFAULT_CELL_W,this.CELL_H=s.CELL_H||ui.DEFAULT_CELL_H,this.columnNum=Math.ceil(r/this.CELL_W),this.rowNum=Math.ceil(o/this.CELL_H),ui.MIN_DIST=Math.pow(r,2)+Math.pow(o,2);for(let l=0;l<this.columnNum;l++){const h=[];for(let g=0;g<this.rowNum;g++){const p={dx:l,dy:g,x:l*this.CELL_W,y:g*this.CELL_H,occupied:!1};h.push(p)}this.cells.push(h)}}findGridByNodeId(r){var o,s;for(let l=0;l<this.columnNum;l++)for(let h=0;h<this.rowNum;h++)if(this.cells[l][h].node&&((s=(o=this.cells[l][h])===null||o===void 0?void 0:o.node)===null||s===void 0?void 0:s.id)===r)return{column:l,row:h};return null}sqdist(r,o){return Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)}occupyNearest(r){let o=ui.MIN_DIST,s,l=null;for(let h=0;h<this.columnNum;h++)for(let g=0;g<this.rowNum;g++)!this.cells[h][g].occupied&&(s=this.sqdist(r,this.cells[h][g]))<o&&(o=s,l=this.cells[h][g]);return l&&(l.occupied=!0),l}insertColumn(r,o){if(!(o<=0)){for(let s=0;s<o;s++){this.cells[s+this.columnNum]=[];for(let l=0;l<this.rowNum;l++)this.cells[s+this.columnNum][l]={dx:s,dy:l,x:s*this.CELL_W,y:l*this.CELL_H,occupied:!1,node:null}}for(let s=this.columnNum-1;s>r;s--)for(let l=0;l<this.rowNum;l++)this.cells[s+o][l]=Object.assign(Object.assign({},this.cells[s][l]),{x:(s+o)*this.CELL_W,y:l*this.CELL_H}),this.cells[s][l]={x:s*this.CELL_W,y:l*this.CELL_H,occupied:!0,node:null};for(let s=0;s<this.additionColumn.length;s++)this.additionColumn[s]>=r&&(this.additionColumn[s]+=o);for(let s=0;s<o;s++)this.additionColumn.push(r+s+1);this.columnNum+=o}}insertRow(r,o){if(!(o<=0)){for(let s=0;s<o;s++)for(let l=0;l<this.columnNum;l++)this.cells[l][s+this.rowNum]={dx:l,dy:s,x:l*this.CELL_W,y:s*this.CELL_H,occupied:!1,node:null};for(let s=0;s<this.columnNum;s++)for(let l=this.rowNum-1;l>r;l--)this.cells[s][l+o]=Object.assign(Object.assign({},this.cells[s][l]),{dx:s,dy:l+o,x:s*this.CELL_W,y:(l+o)*this.CELL_H}),this.cells[s][l]={dx:s,dy:l,x:s*this.CELL_W,y:l*this.CELL_H,occupied:!1,node:null};for(let s=0;s<this.additionRow.length;s++)this.additionRow[s]>=r&&(this.additionRow[s]+=o);for(let s=0;s<o;s++)this.additionRow.push(r+s+1);this.rowNum+=o}}getNodes(){const r=[];for(let o=0;o<this.columnNum;o++)for(let s=0;s<this.rowNum;s++)this.cells[o][s].node&&r.push(this.cells[o][s]);return r}}ui.MIN_DIST=50,ui.DEFAULT_CELL_W=80,ui.DEFAULT_CELL_H=80;function gn(i,r){if(!i.nodes||i.nodes.length===0)return i;const o=r.width,s=r.height,l=r.nodeMinGap;let h=1e4,g=1e4;i.nodes.forEach(m=>{const y=m.size[0]||50,x=m.size[1]||50;h=Math.min(y,h),g=Math.min(x,g)});const p=new ui;p.init(o,s,{CELL_H:g,CELL_W:h}),i.nodes.forEach(m=>{const y=p.occupyNearest(m);y&&(y.node={id:m.id,size:m.size},m.x=y.x,m.y=y.y,m.dx=y.dx,m.dy=y.dy)});for(let m=0;m<i.nodes.length;m++){const y=i.nodes[m],x=p.findGridByNodeId(y.id);if(!x)throw new Error("can not find node cell");const{column:w,row:A}=x;if(y.size[0]+l>h){const T=Math.ceil((y.size[0]+l)/h)-1;let O=T;for(let I=0;I<T&&(p.additionColumn.indexOf(w+I+1)>-1&&!p.cells[w+I+1][A].node);I++)O--;p.insertColumn(w,O)}if(y.size[1]+l>g){const T=Math.ceil((y.size[1]+l)/g)-1;let O=T;for(let I=0;I<T&&(p.additionRow.indexOf(A+I+1)>-1&&!p.cells[w][A+I+1].node);I++)O--;p.insertRow(A,O)}}for(let m=0;m<p.columnNum;m++)for(let y=0;y<p.rowNum;y++){const x=p.cells[m][y];if(x.node){const w=i.nodes.find(A=>{var T;return A.id===((T=x==null?void 0:x.node)===null||T===void 0?void 0:T.id)});w&&(w.x=x.x+w.size[0]/2,w.y=x.y+w.size[1]/2)}}}const qi=1200,ec=800,od=1e7,_s=10,Rr=3.141592653589793,nc=1.5707963267948966,Zp=Rr*.375,qp=Rr*.625,sd=new Map,xx=10,wx=10;let ad=.8;const fv=.1,Ex=.5;function _x(i,r,o){const s=i.x-i.size[0]/2,l=i.y-i.size[1]/2,h=i.x+i.size[0]/2,g=i.y+i.size[1]/2,p=r.x-r.size[0]/2,m=r.y-r.size[1]/2,y=r.x+r.size[0]/2,x=r.y+r.size[1]/2,w=i.x,A=i.y,T=r.x,O=r.y,I=T-w,N=Math.atan2(I,O-A);let P=0,R=0,k=0,U=0;N>nc?(R=l-x,P=p-h,k=parseFloat(R?(R/Math.cos(N)).toFixed(2):P.toFixed(2)),U=parseFloat(P?(P/Math.sin(N)).toFixed(2):R.toFixed(2))):0<N&&N<=nc?(R=m-g,P=p-h,R>P?k=U=parseFloat(R?(R/Math.cos(N)).toFixed(2):P.toFixed(2)):k=U=parseFloat(P?(P/Math.sin(N)).toFixed(2):R.toFixed(2))):N<-nc?(R=l-x,P=-(y-s),R>P?k=U=parseFloat(R?(R/Math.cos(N)).toFixed(2):P.toFixed(2)):k=U=parseFloat(P?(P/Math.sin(N)).toFixed(2):R.toFixed(2))):(R=m-g,Math.abs(I)>(h-s)/2?P=s-y:P=I,R>P?k=U=parseFloat(R?(R/Math.cos(N)).toFixed(2):P.toFixed(2)):k=U=parseFloat(P&&N!==0?(P/Math.sin(N)).toFixed(2):R.toFixed(2)));const K=parseFloat(N.toFixed(2));let pt=o;return o&&(pt=Zp<K&&K<qp),{distance:Math.abs(k<U?k:U),isHoriz:pt}}function eh(i,r){const s=(sd.get(i.id)||[]).find(Ot=>Ot.source===r.id||Ot.target===r.id),l=i.size[0]*i.size[1],h=r.size[0]*r.size[1],g=l>h?r:i,p=l>h?i:r,m=g.x-g.size[0]/2,y=g.y-g.size[1]/2,x=g.x+g.size[0]/2,w=g.y+g.size[1]/2,A=p.x-p.size[0]/2,T=p.y-p.size[1]/2,O=p.x+p.size[0]/2,I=p.y+p.size[1]/2,N=g.x,P=g.y,R=p.x,k=p.y,U=x>=A&&O>=m&&w>=T&&I>=y;let K=0,pt=0;if(U){pt=Math.sqrt(Math.pow(R-N,2)+Math.pow(k-P,2));const Ot=m>A?m:A,It=y>T?y:T,Ct=x<O?x:O,_t=w<I?w:I,F=Ct-Ot,Z=_t-It,yt=F*Z;pt===0&&(pt=1e-7),K=_s*1/pt*100+yt,K*=od}else{let Ot=!1;const It=_x(g,p,Ot);pt=It.distance,Ot=It.isHoriz,pt<=_s?pt!==0?s?K+=_s+od*1/pt:K+=_s+od*_s/pt:K+=od:(K+=pt,s&&(K+=pt*pt))}return K}function Tl(i){let r=0;for(let o=0;o<i.length;o++){const s=i[o];(s.x<0||s.y<0||s.x>qi||s.y>ec)&&(r+=1e12);for(let l=o+1;l<i.length;l++)r+=eh(s,i[l])}return r}function Yp(i,r,o,s){const l=new Map;o.forEach((m,y)=>{l.set(m.id,m)});const h=s.filter(m=>m.source===i.id||m.target===i.id)||[],g=[];h.forEach(m=>{const y=m.source===i.id?m.target:m.source,x=l.get(y);x&&g.push(x)});let p=!0;for(let m=0;m<g.length;m++){const y=g[m],x=Math.atan((i.y-y.y)/(y.x-i.y))*180,w=Math.atan((r.y-y.y)/(y.x-r.y))*180,A=x<30||x>150,T=w<30||w>150,O=x>70&&x<110,I=w>70&&w<110;if(A&&!T||x*w<0){p=!1;break}else if(O&&!I||x*w<0){p=!1;break}else if((y.x-i.x)*(y.x-r.x)<0){p=!1;break}else if((y.y-i.y)*(y.y-r.y)<0){p=!1;break}}return p}function Ss(i,r){let o=!1;const s=1,l=xx*s,h=wx*s,g=[l,-l,0,0],p=[0,0,h,-h];for(let m=0;m<i.length;++m){const y=i[m];let x=cd(y,i);for(let w=0;w<g.length;w++)if(Yp(y,{x:y.x+g[w],y:y.y+p[w]},i,r)){y.x+=g[w],y.y+=p[w];const T=cd(y,i),O=Math.random();T<x||O<ad&&O>fv?(x=T,o=!0):(y.x-=g[w],y.y-=p[w])}}return ad>fv&&(ad*=Ex),o?Tl(i):0}function cd(i,r){let o=0;(i.x<0||i.y<0||i.x+i.size[0]+20>qi||i.y+i.size[1]+20>ec)&&(o+=1e12);for(let s=0;s<r.length;++s)i.id!==r[s].id&&(o+=eh(i,r[s]));return o}function rc(i,r){if(i.length===0)return{nodes:i,edges:r};i.forEach(m=>{const y=r.filter(x=>x.source===m.id||x.target===m.id);sd.set(m,y)}),i.sort((m,y)=>{var x,w;return((x=sd.get(m.id))===null||x===void 0?void 0:x.length)-((w=sd.get(y.id))===null||w===void 0?void 0:w.length)});let o=Tl(i),s=20,l=1,h=0;const g=50;let p=0;for(;s>0&&(p++,!(p>=g));){const m=Ss(i,r);m!==0&&(h=m),l=h-o,o=h,l===0?--s:s=20}return i.forEach(m=>{m.x=m.x-m.size[0]/2,m.y=m.y-m.size[1]/2}),{nodes:i,edges:r}}const ic=rc;function oc(i,r){const{nodes:o,edges:s}=i,l=r.width,h=r.height;if(!(o!=null&&o.length))return Promise.resolve();const g=[];o.forEach(O=>{if(s.filter(N=>N.source===O.id||N.target===O.id).length>1){const N=Object.assign({},O);delete N.size,g.push(N)}});const p=[];s.forEach(O=>{const I=g.find(P=>P.id===O.source),N=g.find(P=>P.id===O.target);I&&N&&p.push(O)});const m=new eo({type:"dagre",ranksep:r.nodeMinGap,nodesep:r.nodeMinGap}),{nodes:y}=m.layout({nodes:g,edges:p});o.forEach(O=>{const I=(y||[]).find(N=>N.id===O.id);O.x=(I==null?void 0:I.x)||l/2,O.y=(I==null?void 0:I.y)||h/2});const x=JSON.parse(JSON.stringify(o)),w=JSON.parse(JSON.stringify(s)),A=Hl().nodes(x).force("link",yc(w).id(O=>O.id).distance(O=>p.find(N=>N.source===O.source&&N.target===O.target)?30:20)).force("charge",$l()).force("center",hh(l/2,h/2)).force("x",gh(l/2)).force("y",ph(h/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(O=>{A.on("end",()=>{o.forEach(K=>{const pt=x.find(Ot=>Ot.id===K.id);pt&&(K.x=pt.x,K.y=pt.y)});const I=Math.min(...o.map(K=>K.x)),N=Math.max(...o.map(K=>K.x)),P=Math.min(...o.map(K=>K.y)),R=Math.max(...o.map(K=>K.y)),k=l/(N-I),U=h/(R-P);o.forEach(K=>{K.x!==void 0&&k<1&&(K.x=(K.x-I)*k),K.y!==void 0&&U<1&&(K.y=(K.y-P)*U)}),o.forEach(K=>{K.sizeTemp=K.size,K.size=[10,10]}),ic(o,s),o.forEach(K=>{K.size=K.sizeTemp||[],delete K.sizeTemp}),gn({nodes:o,edges:s},r),O()})})}class nh extends vn{constructor(r){super(),this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},r&&this.updateCfg(r)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const r=this,o=r.nodes,s=r.edges;return o==null||o.forEach(l=>{l.size||(l.size=[50,50])}),oc({nodes:o,edges:s},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(()=>{r.onLayoutEnd&&r.onLayoutEnd()})}getType(){return"er"}}class dv extends vn{constructor(r){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const r=this,o=r.nodes,s=.9,l=r.center;return!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),o&&o.forEach(h=>{h.x=(Math.random()-.5)*s*r.width+l[0],h.y=(Math.random()-.5)*s*r.height+l[1]}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:this.edges}}getType(){return"random"}}class Sx{constructor(r){const o=getLayoutByName(r.type);this.layoutInstance=new o(r)}layout(r){return this.layoutInstance.layout(r)}updateCfg(r){this.layoutInstance.updateCfg(r)}init(r){this.correctLayers(r.nodes),this.layoutInstance.init(r)}correctLayers(r){if(!(r!=null&&r.length))return;let o=1/0;const s=[];if(r.forEach(l=>{isString(l.layer)&&(l.layer=parseInt(l.layer,10)),!(l.layer===void 0||isNaN(l.layer))&&(s.push(l),l.layer<o&&(o=l.layer))}),o<=0){const l=Math.abs(o)+1;s.forEach(h=>h.layer+=l)}}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const Wn={force:Gd,fruchterman:X0,forceAtlas2:Di,gForce:dr,force2:Ad,dagre:eo,dagreCompound:Hx,circular:Xl,radial:Hf,concentric:Ni,grid:Bn,mds:dl,comboForce:rd,comboCombined:id,random:dv,"gForce-gpu":Xp,"fruchterman-gpu":Wp,er:nh}},90591:()=>{typeof window=="object"&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window<"u"&&function(yo){yo.forEach(wn=>{Object.prototype.hasOwnProperty.call(wn,"append")||Object.defineProperty(wn,"append",{configurable:!0,enumerable:!0,writable:!0,value(...Nt){const Lt=document.createDocumentFragment();Nt.forEach(mn=>{const An=mn instanceof Node;Lt.appendChild(An?mn:document.createTextNode(String(mn)))}),this.appendChild(Lt)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype])},14923:(yo,wn,Nt)=>{"use strict";Nt.d(wn,{D:()=>An});var Lt=Nt(52729);Lt.kJ.prototype.toSVG=function(Te,Be){const Jt=this.getPlugin("export");Jt&&Jt.toSVG(Te,Be)},Lt.kJ.prototype.toPNG=function(Te,Be){const Jt=this.getPlugin("export");Jt&&Jt.toPNG(Te,Be)},Lt.kJ.prototype.toJPEG=function(Te,Be){const Jt=this.getPlugin("export");Jt&&Jt.toJPEG(Te,Be)},Lt.kJ.prototype.exportPNG=function(Te,Be){const Jt=this.getPlugin("export");Jt&&Jt.exportPNG(Te,Be)},Lt.kJ.prototype.exportJPEG=function(Te,Be){const Jt=this.getPlugin("export");Jt&&Jt.exportJPEG(Te,Be)},Lt.kJ.prototype.exportSVG=function(Te,Be){const Jt=this.getPlugin("export");Jt&&Jt.exportSVG(Te,Be)};var mn=function(Te,Be,Jt,kt){var te=arguments.length,Y=te<3?Be:kt===null?kt=Object.getOwnPropertyDescriptor(Be,Jt):kt,Q;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Y=Reflect.decorate(Te,Be,Jt,kt);else for(var st=Te.length-1;st>=0;st--)(Q=Te[st])&&(Y=(te<3?Q(Y):te>3?Q(Be,Jt,Y):Q(Be,Jt))||Y);return te>3&&Y&&Object.defineProperty(Be,Jt,Y),Y};class An extends Lt.ew{constructor(){super(),this.name="export"}get view(){return this.graph.view}init(Be){this.graph=Be}exportPNG(Be="chart",Jt={}){this.toPNG(kt=>{Lt.Vb.downloadDataUri(kt,Be)},Jt)}exportJPEG(Be="chart",Jt={}){this.toPNG(kt=>{Lt.Vb.downloadDataUri(kt,Be)},Jt)}exportSVG(Be="chart",Jt={}){this.toSVG(kt=>{Lt.Vb.downloadDataUri(Lt.Vb.svgToDataUrl(kt),Be)},Jt)}toSVG(Be,Jt={}){this.notify("before:export",Jt);const kt=this.view.svg,te=Lt.OW.create(kt).clone();let Y=te.node;const Q=te.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`),st=Jt.viewBox||this.graph.graphToLocal(this.graph.getContentBBox()),at=Jt.preserveDimensions;if(at){const Xt=typeof at=="boolean"?st:at;te.attr({width:Xt.width,height:Xt.height})}if(te.removeAttribute("style").attr("viewBox",[st.x,st.y,st.width,st.height].join(" ")),Q.removeAttribute("transform"),Jt.copyStyles!==!1){const Xt=kt.ownerDocument,De=Array.from(kt.querySelectorAll("*")),Ze=Array.from(Y.querySelectorAll("*")),hn=Xt.styleSheets.length,Ce=[];for(let fe=hn-1;fe>=0;fe-=1)Ce[fe]=Xt.styleSheets[fe],Xt.styleSheets[fe].disabled=!0;const Me={};De.forEach((fe,Se)=>{const Ve=window.getComputedStyle(fe,null),rn={};Object.keys(Ve).forEach(Ue=>{rn[Ue]=Ve.getPropertyValue(Ue)}),Me[Se]=rn}),hn!==Xt.styleSheets.length&&Ce.forEach((fe,Se)=>{Xt.styleSheets[Se]=fe});for(let fe=0;fe<hn;fe+=1)Xt.styleSheets[fe].disabled=!1;const tn={};De.forEach((fe,Se)=>{const Ve=window.getComputedStyle(fe,null),rn=Me[Se],Ue={};Object.keys(Ve).forEach(Tn=>{!Lt.GH.isNumber(Tn)&&Ve.getPropertyValue(Tn)!==rn[Tn]&&(Ue[Tn]=Ve.getPropertyValue(Tn))}),tn[Se]=Ue}),Ze.forEach((fe,Se)=>{Lt.is.css(fe,tn[Se])})}const jt=Jt.stylesheet;if(typeof jt=="string"){const Xt=kt.ownerDocument.implementation.createDocument(null,"xml",null).createCDATASection(jt);te.prepend(Lt.OW.create("style",{type:"text/css"},[Xt]))}const Ht=()=>{const Xt=Jt.beforeSerialize;if(typeof Xt=="function"){const Ze=Lt.Iw.call(Xt,this.graph,Y);Ze instanceof SVGSVGElement&&(Y=Ze)}const De=new XMLSerializer().serializeToString(Y).replace(/&nbsp;/g,"\xA0");this.notify("after:export",Jt),Be(De)};if(Jt.serializeImages){const Xt=te.find("image").map(De=>new Promise(Ze=>{const hn=De.attr("xlink:href")||De.attr("href");Lt.Vb.imageToDataUri(hn,(Ce,Me)=>{!Ce&&Me&&De.attr("xlink:href",Me),Ze()})}));Promise.all(Xt).then(Ht)}else Ht()}toDataURL(Be,Jt){let kt=Jt.viewBox||this.graph.getContentBBox();const te=Lt.GH.normalizeSides(Jt.padding);Jt.width&&Jt.height&&(te.left+te.right>=Jt.width&&(te.left=te.right=0),te.top+te.bottom>=Jt.height&&(te.top=te.bottom=0));const Y=new Lt.Ae(-te.left,-te.top,te.left+te.right,te.top+te.bottom);if(Jt.width&&Jt.height){const Ht=kt.width+te.left+te.right,Xt=kt.height+te.top+te.bottom;Y.scale(Ht/Jt.width,Xt/Jt.height)}kt=Lt.Ae.create(kt).moveAndExpand(Y);const Q=typeof Jt.width=="number"&&typeof Jt.height=="number"?{width:Jt.width,height:Jt.height}:kt;let st=Jt.ratio?parseFloat(Jt.ratio):1;(!Number.isFinite(st)||st===0)&&(st=1);const at={width:Math.max(Math.round(Q.width*st),1),height:Math.max(Math.round(Q.height*st),1)};{const Ht=document.createElement("canvas"),Xt=Ht.getContext("2d");Ht.width=at.width,Ht.height=at.height;const De=at.width-1,Ze=at.height-1;Xt.fillStyle="rgb(1,1,1)",Xt.fillRect(De,Ze,1,1);const hn=Xt.getImageData(De,Ze,1,1).data;if(hn[0]!==1||hn[1]!==1||hn[2]!==1)throw new Error("size exceeded")}const jt=new Image;jt.onload=()=>{const Ht=document.createElement("canvas");Ht.width=at.width,Ht.height=at.height;const Xt=Ht.getContext("2d");Xt.fillStyle=Jt.backgroundColor||"white",Xt.fillRect(0,0,at.width,at.height);try{Xt.drawImage(jt,0,0,at.width,at.height);const De=Ht.toDataURL(Jt.type,Jt.quality);Be(De)}catch(De){}},this.toSVG(Ht=>{jt.src=`data:image/svg+xml,${encodeURIComponent(Ht)}`},Object.assign(Object.assign({},Jt),{viewBox:kt,serializeImages:!0,preserveDimensions:Object.assign({},at)}))}toPNG(Be,Jt={}){this.toDataURL(Be,Object.assign(Object.assign({},Jt),{type:"image/png"}))}toJPEG(Be,Jt={}){this.toDataURL(Be,Object.assign(Object.assign({},Jt),{type:"image/jpeg"}))}notify(Be,Jt){this.trigger(Be,Jt),this.graph.trigger(Be,Jt)}dispose(){this.off()}}mn([Lt.ew.dispose()],An.prototype,"dispose",null)},34881:(yo,wn,Nt)=>{"use strict";Nt.d(wn,{T:()=>kt});var Lt=Nt(52729),mn=function(te,Y,Q,st){var at=arguments.length,jt=at<3?Y:st===null?st=Object.getOwnPropertyDescriptor(Y,Q):st,Ht;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")jt=Reflect.decorate(te,Y,Q,st);else for(var Xt=te.length-1;Xt>=0;Xt--)(Ht=te[Xt])&&(jt=(at<3?Ht(jt):at>3?Ht(Y,Q,jt):Ht(Y,Q))||jt);return at>3&&jt&&Object.defineProperty(Y,Q,jt),jt},An=function(te,Y){var Q={};for(var st in te)Object.prototype.hasOwnProperty.call(te,st)&&Y.indexOf(st)<0&&(Q[st]=te[st]);if(te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var at=0,st=Object.getOwnPropertySymbols(te);at<st.length;at++)Y.indexOf(st[at])<0&&Object.prototype.propertyIsEnumerable.call(te,st[at])&&(Q[st[at]]=te[st[at]]);return Q};class Te extends Lt.G7{get graph(){return this.options.graph}get model(){return this.graph.model}constructor(Y){super(),this.padding={left:0,top:0,right:0,bottom:0},this.options=Te.getOptions(Y),this.onUpdate=Lt.Iw.debounce(this.onUpdate,200);const Q=this.graph.transform.getScale();this.sx=Q.sx,this.sy=Q.sy;const st=this.options.width||this.graph.options.width,at=this.options.height||this.graph.options.height;this.container=document.createElement("div"),Lt.is.addClass(this.container,this.prefixClassName(Te.containerClass)),Lt.is.css(this.container,{width:st,height:at}),this.options.pageVisible&&Lt.is.addClass(this.container,this.prefixClassName(Te.pagedClass)),this.options.className&&Lt.is.addClass(this.container,this.options.className);const jt=this.graph.container;jt.parentNode&&Lt.is.before(jt,this.container),this.content=document.createElement("div"),Lt.is.addClass(this.content,this.prefixClassName(Te.contentClass)),Lt.is.css(this.content,{width:this.graph.options.width,height:this.graph.options.height}),this.background=document.createElement("div"),Lt.is.addClass(this.background,this.prefixClassName(Te.backgroundClass)),Lt.is.append(this.content,this.background),this.options.pageVisible||Lt.is.append(this.content,this.graph.view.grid),Lt.is.append(this.content,jt),Lt.is.appendTo(this.content,this.container),this.startListening(),this.options.pageVisible||this.graph.grid.update(),this.backgroundManager=new Te.Background(this),this.options.autoResize||this.update()}startListening(){const Y=this.graph,Q=this.model;Y.on("scale",this.onScale,this),Y.on("resize",this.onResize,this),Y.on("before:print",this.storeScrollPosition,this),Y.on("before:export",this.storeScrollPosition,this),Y.on("after:print",this.restoreScrollPosition,this),Y.on("after:export",this.restoreScrollPosition,this),Q.on("reseted",this.onUpdate,this),Q.on("cell:added",this.onUpdate,this),Q.on("cell:removed",this.onUpdate,this),Q.on("cell:changed",this.onUpdate,this),this.delegateBackgroundEvents()}stopListening(){const Y=this.graph,Q=this.model;Y.off("scale",this.onScale,this),Y.off("resize",this.onResize,this),Y.off("beforeprint",this.storeScrollPosition,this),Y.off("beforeexport",this.storeScrollPosition,this),Y.off("afterprint",this.restoreScrollPosition,this),Y.off("afterexport",this.restoreScrollPosition,this),Q.off("reseted",this.onUpdate,this),Q.off("cell:added",this.onUpdate,this),Q.off("cell:removed",this.onUpdate,this),Q.off("cell:changed",this.onUpdate,this),this.undelegateBackgroundEvents()}enableAutoResize(){this.options.autoResize=!0}disableAutoResize(){this.options.autoResize=!1}onUpdate(){this.options.autoResize&&this.update()}delegateBackgroundEvents(Y){const Q=Y||Lt.tw.events;this.delegatedHandlers=Object.keys(Q).reduce((st,at)=>{const jt=Q[at];if(at.indexOf(" ")===-1)if(typeof jt=="function")st[at]=jt;else{let Ht=this.graph.view[jt];typeof Ht=="function"&&(Ht=Ht.bind(this.graph.view),st[at]=Ht)}return st},{}),this.onBackgroundEvent=this.onBackgroundEvent.bind(this),Object.keys(this.delegatedHandlers).forEach(st=>{this.delegateEvent(st,{guarded:!1},this.onBackgroundEvent)})}undelegateBackgroundEvents(){Object.keys(this.delegatedHandlers).forEach(Y=>{this.undelegateEvent(Y,this.onBackgroundEvent)})}onBackgroundEvent(Y){let Q=!1;const st=Y.target;if(this.options.pageVisible)this.options.background?Q=this.background===st:Q=this.content===st;else{const at=this.graph.view;Q=at.background===st||at.grid===st}if(Q){const at=this.delegatedHandlers[Y.type];typeof at=="function"&&at.apply(this.graph,arguments)}}onResize(){this.cachedCenterPoint&&(this.centerPoint(this.cachedCenterPoint.x,this.cachedCenterPoint.y),this.updatePageBreak())}onScale({sx:Y,sy:Q,ox:st,oy:at}){this.updateScale(Y,Q),(st||at)&&(this.centerPoint(st,at),this.updatePageBreak()),typeof this.options.autoResizeOptions=="function"&&this.update()}storeScrollPosition(){this.cachedScrollLeft=this.container.scrollLeft,this.cachedScrollTop=this.container.scrollTop}restoreScrollPosition(){this.container.scrollLeft=this.cachedScrollLeft,this.container.scrollTop=this.cachedScrollTop,this.cachedScrollLeft=null,this.cachedScrollTop=null}storeClientSize(){this.cachedClientSize={width:this.container.clientWidth,height:this.container.clientHeight}}restoreClientSize(){this.cachedClientSize=null}beforeManipulation(){(Lt.t4.IS_IE||Lt.t4.IS_EDGE)&&Lt.is.css(this.container,{visibility:"hidden"})}afterManipulation(){(Lt.t4.IS_IE||Lt.t4.IS_EDGE)&&Lt.is.css(this.container,{visibility:"visible"})}updatePageSize(Y,Q){Y!=null&&(this.options.pageWidth=Y),Q!=null&&(this.options.pageHeight=Q),this.updatePageBreak()}updatePageBreak(){if(this.pageBreak&&this.pageBreak.parentNode&&this.pageBreak.parentNode.removeChild(this.pageBreak),this.pageBreak=null,this.options.pageVisible&&this.options.pageBreak){const Y=this.graph.options.width,Q=this.graph.options.height,st=this.options.pageWidth*this.sx,at=this.options.pageHeight*this.sy;if(st===0||at===0)return;if(Y>st||Q>at){let jt=!1;const Ht=document.createElement("div");for(let Xt=1,De=Math.floor(Y/st);Xt<De;Xt+=1){const Ze=document.createElement("div");Lt.is.addClass(Ze,this.prefixClassName("graph-pagebreak-vertical")),Lt.is.css(Ze,{left:Xt*st}),Lt.is.appendTo(Ze,Ht),jt=!0}for(let Xt=1,De=Math.floor(Q/at);Xt<De;Xt+=1){const Ze=document.createElement("div");Lt.is.addClass(Ze,this.prefixClassName("graph-pagebreak-horizontal")),Lt.is.css(Ze,{top:Xt*at}),Lt.is.appendTo(Ze,Ht),jt=!0}jt&&(Lt.is.addClass(Ht,this.prefixClassName("graph-pagebreak")),Lt.is.after(this.graph.view.grid,Ht),this.pageBreak=Ht)}}}update(){const Y=this.getClientSize();this.cachedCenterPoint=this.clientToLocalPoint(Y.width/2,Y.height/2);let Q=this.options.autoResizeOptions;typeof Q=="function"&&(Q=Lt.Iw.call(Q,this,this));const st=Object.assign({gridWidth:this.options.pageWidth,gridHeight:this.options.pageHeight,allowNewOrigin:"negative"},Q);this.graph.fitToContent(this.getFitToContentOptions(st))}getFitToContentOptions(Y){const Q=this.sx,st=this.sy;return Y.gridWidth&&(Y.gridWidth*=Q),Y.gridHeight&&(Y.gridHeight*=st),Y.minWidth&&(Y.minWidth*=Q),Y.minHeight&&(Y.minHeight*=st),typeof Y.padding=="object"?Y.padding={left:(Y.padding.left||0)*Q,right:(Y.padding.right||0)*Q,top:(Y.padding.top||0)*st,bottom:(Y.padding.bottom||0)*st}:typeof Y.padding=="number"&&(Y.padding*=Q),this.options.autoResize||(Y.contentArea=Lt.Ae.create()),Y}updateScale(Y,Q){const st=this.graph.options,at=Y/this.sx,jt=Q/this.sy;this.sx=Y,this.sy=Q,this.graph.translate(st.x*at,st.y*jt),this.graph.transform.resize(st.width*at,st.height*jt)}scrollbarPosition(Y,Q){if(Y==null&&Q==null)return{left:this.container.scrollLeft,top:this.container.scrollTop};const st={};return typeof Y=="number"&&(st.scrollLeft=Y),typeof Q=="number"&&(st.scrollTop=Q),Lt.is.prop(this.container,st),this}scrollToPoint(Y,Q){const st=this.getClientSize(),at=this.graph.matrix(),jt={};return typeof Y=="number"&&(jt.scrollLeft=Y-st.width/2+at.e+(this.padding.left||0)),typeof Q=="number"&&(jt.scrollTop=Q-st.height/2+at.f+(this.padding.top||0)),Lt.is.prop(this.container,jt),this}scrollToContent(){const Y=this.sx,Q=this.sy,st=this.graph.getContentArea().getCenter();return this.scrollToPoint(st.x*Y,st.y*Q)}scrollToCell(Y){const Q=this.sx,st=this.sy,at=Y.getBBox().getCenter();return this.scrollToPoint(at.x*Q,at.y*st)}center(Y){return this.centerPoint(Y)}centerPoint(Y,Q,st){const at=this.graph.matrix(),jt=at.a,Ht=at.d,Xt=-at.e,De=-at.f,Ze=Xt+this.graph.options.width,hn=De+this.graph.options.height;let Ce;if(this.storeClientSize(),typeof Y=="number"||typeof Q=="number"){Ce=st;const Zn=this.getVisibleArea().getCenter();typeof Y=="number"?Y*=jt:Y=Zn.x,typeof Q=="number"?Q*=Ht:Q=Zn.y}else Ce=Y,Y=(Xt+Ze)/2,Q=(De+hn)/2;if(Ce&&Ce.padding)return this.positionPoint({x:Y,y:Q},"50%","50%",Ce);const Me=this.getPadding(),tn=this.getClientSize(),fe=tn.width/2,Se=tn.height/2,Ve=fe-Me.left-Y+Xt,rn=fe-Me.right+Y-Ze,Ue=Se-Me.top-Q+De,Tn=Se-Me.bottom+Q-hn;this.addPadding(Math.max(Ve,0),Math.max(rn,0),Math.max(Ue,0),Math.max(Tn,0));const Qn=this.scrollToPoint(Y,Q);return this.restoreClientSize(),Qn}centerContent(Y){return this.positionContent("center",Y)}centerCell(Y,Q){return this.positionCell(Y,"center",Q)}positionContent(Y,Q){const st=this.graph.getContentArea(Q);return this.positionRect(st,Y,Q)}positionCell(Y,Q,st){const at=Y.getBBox();return this.positionRect(at,Q,st)}positionRect(Y,Q,st){const at=Lt.Ae.create(Y);switch(Q){case"center":return this.positionPoint(at.getCenter(),"50%","50%",st);case"top":return this.positionPoint(at.getTopCenter(),"50%",0,st);case"top-right":return this.positionPoint(at.getTopRight(),"100%",0,st);case"right":return this.positionPoint(at.getRightMiddle(),"100%","50%",st);case"bottom-right":return this.positionPoint(at.getBottomRight(),"100%","100%",st);case"bottom":return this.positionPoint(at.getBottomCenter(),"50%","100%",st);case"bottom-left":return this.positionPoint(at.getBottomLeft(),0,"100%",st);case"left":return this.positionPoint(at.getLeftMiddle(),0,"50%",st);case"top-left":return this.positionPoint(at.getTopLeft(),0,0,st);default:return this}}positionPoint(Y,Q,st,at={}){const{padding:jt}=at,Ht=An(at,["padding"]),Xt=Lt.GH.normalizeSides(jt),De=Lt.Ae.fromSize(this.getClientSize()),Ze=De.clone().moveAndExpand({x:Xt.left,y:Xt.top,width:-Xt.right-Xt.left,height:-Xt.top-Xt.bottom});Q=Lt.GH.normalizePercentage(Q,Math.max(0,Ze.width)),Q<0&&(Q=Ze.width+Q),st=Lt.GH.normalizePercentage(st,Math.max(0,Ze.height)),st<0&&(st=Ze.height+st);const hn=Ze.getTopLeft().translate(Q,st),Ce=De.getCenter().diff(hn),Me=this.zoom(),tn=Ce.scale(1/Me,1/Me),fe=Lt.E9.create(Y).translate(tn);return this.centerPoint(fe.x,fe.y,Ht)}zoom(Y,Q){if(Y==null)return this.sx;Q=Q||{};let st,at;const jt=this.getClientSize(),Ht=this.clientToLocalPoint(jt.width/2,jt.height/2);let Xt=Y,De=Y;if(Q.absolute||(Xt+=this.sx,De+=this.sy),Q.scaleGrid&&(Xt=Math.round(Xt/Q.scaleGrid)*Q.scaleGrid,De=Math.round(De/Q.scaleGrid)*Q.scaleGrid),Q.maxScale&&(Xt=Math.min(Q.maxScale,Xt),De=Math.min(Q.maxScale,De)),Q.minScale&&(Xt=Math.max(Q.minScale,Xt),De=Math.max(Q.minScale,De)),Xt=this.graph.transform.clampScale(Xt),De=this.graph.transform.clampScale(De),Q.center){const Ze=Xt/this.sx,hn=De/this.sy;st=Q.center.x-(Q.center.x-Ht.x)/Ze,at=Q.center.y-(Q.center.y-Ht.y)/hn}else st=Ht.x,at=Ht.y;return this.beforeManipulation(),this.graph.transform.scale(Xt,De),this.centerPoint(st,at),this.afterManipulation(),this}zoomToRect(Y,Q={}){const st=Lt.Ae.create(Y),at=this.graph;if(Q.contentArea=st,Q.viewportArea==null){const Ht=this.container.getBoundingClientRect();Q.viewportArea={x:at.options.x,y:at.options.y,width:Ht.width,height:Ht.height}}this.beforeManipulation(),at.transform.scaleContentToFitImpl(Q,!1);const jt=st.getCenter();return this.centerPoint(jt.x,jt.y),this.afterManipulation(),this}zoomToFit(Y={}){return this.zoomToRect(this.graph.getContentArea(Y),Y)}transitionToPoint(Y,Q,st){typeof Y=="object"?(st=Q,Q=Y.y,Y=Y.x):Q=Q,st==null&&(st={});let at,jt;const Ht=this.sx,Xt=Math.max(st.scale||Ht,1e-6),De=this.getClientSize(),Ze=new Lt.E9(Y,Q),hn=this.clientToLocalPoint(De.width/2,De.height/2);if(Ht===Xt){const Me=hn.diff(Ze).scale(Ht,Ht).round();at=`translate(${Me.x}px,${Me.y}px)`}else{const Me=Xt/(Ht-Xt)*Ze.distance(hn),tn=hn.clone().move(Ze,Me),fe=this.localToBackgroundPoint(tn).round();at=`scale(${Xt/Ht})`,jt=`${fe.x}px ${fe.y}px`}const Ce=st.onTransitionEnd;return Lt.is.addClass(this.container,Te.transitionClassName),Lt.is.Event.off(this.content,Te.transitionEventName),Lt.is.Event.on(this.content,Te.transitionEventName,Me=>{this.syncTransition(Xt,{x:Y,y:Q}),typeof Ce=="function"&&Lt.Iw.call(Ce,this,Me.originalEvent)}),Lt.is.css(this.content,{transform:at,transformOrigin:jt,transition:"transform",transitionDuration:st.duration||"1s",transitionDelay:st.delay,transitionTimingFunction:st.timing}),this}syncTransition(Y,Q){return this.beforeManipulation(),this.graph.scale(Y),this.removeTransition(),this.centerPoint(Q.x,Q.y),this.afterManipulation(),this}removeTransition(){return Lt.is.removeClass(this.container,Te.transitionClassName),Lt.is.Event.off(this.content,Te.transitionEventName),Lt.is.css(this.content,{transform:"",transformOrigin:"",transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:""}),this}transitionToRect(Y,Q={}){const st=Lt.Ae.create(Y),at=Q.maxScale||1/0,jt=Q.minScale||Number.MIN_VALUE,Ht=Q.scaleGrid||null,Xt=Q.visibility||1,De=Q.center?Lt.E9.create(Q.center):st.getCenter(),Ze=this.getClientSize(),hn=Ze.width*Xt,Ce=Ze.height*Xt;let Me=new Lt.Ae(De.x-hn/2,De.y-Ce/2,hn,Ce).getMaxUniformScaleToFit(st,De);return Me=Math.min(Me,at),Ht&&(Me=Math.floor(Me/Ht)*Ht),Me=Math.max(jt,Me),this.transitionToPoint(De,Object.assign({scale:Me},Q))}startPanning(Y){const Q=this.normalizeEvent(Y);this.clientX=Q.clientX,this.clientY=Q.clientY,this.trigger("pan:start",{e:Q}),Lt.is.Event.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Lt.is.Event.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(Y){const Q=this.normalizeEvent(Y),st=Q.clientX-this.clientX,at=Q.clientY-this.clientY;this.container.scrollTop-=at,this.container.scrollLeft-=st,this.clientX=Q.clientX,this.clientY=Q.clientY,this.trigger("panning",{e:Q})}stopPanning(Y){Lt.is.Event.off(document.body,".panning"),Lt.is.Event.off(window,".panning"),this.trigger("pan:stop",{e:Y})}clientToLocalPoint(Y,Q){let st=typeof Y=="object"?Y.x:Y,at=typeof Y=="object"?Y.y:Q;const jt=this.graph.matrix();return st+=this.container.scrollLeft-this.padding.left-jt.e,at+=this.container.scrollTop-this.padding.top-jt.f,new Lt.E9(st/jt.a,at/jt.d)}localToBackgroundPoint(Y,Q){const st=typeof Y=="object"?Lt.E9.create(Y):new Lt.E9(Y,Q),at=this.graph.matrix(),jt=this.padding;return Lt.Zr.transformPoint(st,at).translate(jt.left,jt.top)}resize(Y,Q){let st=Y!=null?Y:this.container.offsetWidth,at=Q!=null?Q:this.container.offsetHeight;typeof st=="number"&&(st=Math.round(st)),typeof at=="number"&&(at=Math.round(at)),this.options.width=st,this.options.height=at,Lt.is.css(this.container,{width:st,height:at}),this.update()}getClientSize(){return this.cachedClientSize?this.cachedClientSize:{width:this.container.clientWidth,height:this.container.clientHeight}}autoScroll(Y,Q){const at=this.container,jt=at.getBoundingClientRect();let Ht=0,Xt=0;return Y<=jt.left+10&&(Ht=-10),Q<=jt.top+10&&(Xt=-10),Y>=jt.right-10&&(Ht=10),Q>=jt.bottom-10&&(Xt=10),Ht!==0&&(at.scrollLeft+=Ht),Xt!==0&&(at.scrollTop+=Xt),{scrollerX:Ht,scrollerY:Xt}}addPadding(Y,Q,st,at){let jt=this.getPadding();this.padding={left:Math.round(jt.left+(Y||0)),top:Math.round(jt.top+(st||0)),bottom:Math.round(jt.bottom+(at||0)),right:Math.round(jt.right+(Q||0))},jt=this.padding,Lt.is.css(this.content,{width:jt.left+this.graph.options.width+jt.right,height:jt.top+this.graph.options.height+jt.bottom});const Ht=this.graph.container;return Ht.style.left=`${this.padding.left}px`,Ht.style.top=`${this.padding.top}px`,this}getPadding(){const Y=this.options.padding;return typeof Y=="function"?Lt.GH.normalizeSides(Lt.Iw.call(Y,this,this)):Lt.GH.normalizeSides(Y)}getVisibleArea(){const Y=this.graph.matrix(),Q=this.getClientSize(),st={x:this.container.scrollLeft||0,y:this.container.scrollTop||0,width:Q.width,height:Q.height},at=Lt.Zr.transformRectangle(st,Y.inverse());return at.x-=(this.padding.left||0)/this.sx,at.y-=(this.padding.top||0)/this.sy,at}isCellVisible(Y,Q={}){const st=Y.getBBox(),at=this.getVisibleArea();return Q.strict?at.containsRect(st):at.isIntersectWithRect(st)}isPointVisible(Y){return this.getVisibleArea().containsPoint(Y)}lock(){return Lt.is.css(this.container,{overflow:"hidden"}),this}unlock(){return Lt.is.css(this.container,{overflow:"scroll"}),this}onRemove(){this.stopListening()}dispose(){Lt.is.before(this.container,this.graph.container),this.remove()}}mn([Lt.G7.dispose()],Te.prototype,"dispose",null),function(te){class Y extends Lt.iC{get elem(){return this.scroller.background}constructor(st){super(st.graph),this.scroller=st,st.options.background&&this.draw(st.options.background)}init(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}updateBackgroundOptions(st){this.scroller.options.background=st}}te.Background=Y}(Te||(Te={})),function(te){te.containerClass="graph-scroller",te.panningClass=`${te.containerClass}-panning`,te.pannableClass=`${te.containerClass}-pannable`,te.pagedClass=`${te.containerClass}-paged`,te.contentClass=`${te.containerClass}-content`,te.backgroundClass=`${te.containerClass}-background`,te.transitionClassName="transition-in-progress",te.transitionEventName="transitionend.graph-scroller-transition",te.defaultOptions={padding(){const Q=this.getClientSize(),st=Math.max(this.options.minVisibleWidth||0,1)||1,at=Math.max(this.options.minVisibleHeight||0,1)||1,jt=Math.max(Q.width-st,0),Ht=Math.max(Q.height-at,0);return{left:jt,top:Ht,right:jt,bottom:Ht}},minVisibleWidth:50,minVisibleHeight:50,pageVisible:!1,pageBreak:!1,autoResize:!0};function Y(Q){const st=Lt.QK.merge({},te.defaultOptions,Q);st.pageWidth==null&&(st.pageWidth=Q.graph.options.width),st.pageHeight==null&&(st.pageHeight=Q.graph.options.height);const at=Q.graph.options;return at.background&&st.enabled&&st.background==null&&(st.background=at.background,Q.graph.background.clear()),st}te.getOptions=Y}(Te||(Te={}));const Be=`.x6-graph-scroller {
  position: relative;
  box-sizing: border-box;
  overflow: scroll;
  outline: none;
}
.x6-graph-scroller-content {
  position: relative;
}
.x6-graph-scroller-background {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-scroller .x6-graph {
  position: absolute;
  display: inline-block;
  margin: 0;
  box-shadow: none;
}
.x6-graph-scroller .x6-graph > svg {
  display: block;
}
.x6-graph-scroller.x6-graph-scroller-paged .x6-graph {
  box-shadow: 0 0 4px 0 #eee;
}
.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='false'] {
  cursor: grab;
}
.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='true'] {
  cursor: grabbing;
  user-select: none;
}
.x6-graph-pagebreak {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-pagebreak-vertical {
  position: absolute;
  top: 0;
  bottom: 0;
  box-sizing: border-box;
  width: 1px;
  border-left: 1px dashed #bdbdbd;
}
.x6-graph-pagebreak-horizontal {
  position: absolute;
  right: 0;
  left: 0;
  box-sizing: border-box;
  height: 1px;
  border-top: 1px dashed #bdbdbd;
}
`;Lt.kJ.prototype.lockScroller=function(){const te=this.getPlugin("scroller");return te&&te.lockScroller(),this},Lt.kJ.prototype.unlockScroller=function(){const te=this.getPlugin("scroller");return te&&te.unlockScroller(),this},Lt.kJ.prototype.updateScroller=function(){const te=this.getPlugin("scroller");return te&&te.updateScroller(),this},Lt.kJ.prototype.getScrollbarPosition=function(){const te=this.getPlugin("scroller");return te?te.getScrollbarPosition():{left:0,top:0}},Lt.kJ.prototype.setScrollbarPosition=function(te,Y){const Q=this.getPlugin("scroller");return Q&&Q.setScrollbarPosition(te,Y),this};var Jt=function(te,Y,Q,st){var at=arguments.length,jt=at<3?Y:st===null?st=Object.getOwnPropertyDescriptor(Y,Q):st,Ht;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")jt=Reflect.decorate(te,Y,Q,st);else for(var Xt=te.length-1;Xt>=0;Xt--)(Ht=te[Xt])&&(jt=(at<3?Ht(jt):at>3?Ht(Y,Q,jt):Ht(Y,Q))||jt);return at>3&&jt&&Object.defineProperty(Y,Q,jt),jt};class kt extends Lt.ew{get pannable(){return this.options?typeof this.options.pannable=="object"?this.options.pannable.enabled:!!this.options.pannable:!1}get container(){return this.scrollerImpl.container}constructor(Y={}){super(),this.name="scroller",this.options=Y,Lt.mf.ensure(this.name,Be)}init(Y){this.graph=Y;const Q=Te.getOptions(Object.assign(Object.assign({enabled:!0},this.options),{graph:Y}));this.options=Q,this.scrollerImpl=new Te(Q),this.setup(),this.startListening(),this.updateClassName(),this.scrollerImpl.center()}resize(Y,Q){this.scrollerImpl.resize(Y,Q)}resizePage(Y,Q){this.scrollerImpl.updatePageSize(Y,Q)}zoom(Y,Q){return typeof Y>"u"?this.scrollerImpl.zoom():(this.scrollerImpl.zoom(Y,Q),this)}zoomTo(Y,Q={}){return this.scrollerImpl.zoom(Y,Object.assign(Object.assign({},Q),{absolute:!0})),this}zoomToRect(Y,Q={}){return this.scrollerImpl.zoomToRect(Y,Q),this}zoomToFit(Y={}){return this.scrollerImpl.zoomToFit(Y),this}center(Y){return this.centerPoint(Y)}centerPoint(Y,Q,st){return this.scrollerImpl.centerPoint(Y,Q,st),this}centerContent(Y){return this.scrollerImpl.centerContent(Y),this}centerCell(Y,Q){return this.scrollerImpl.centerCell(Y,Q),this}positionPoint(Y,Q,st,at={}){return this.scrollerImpl.positionPoint(Y,Q,st,at),this}positionRect(Y,Q,st){return this.scrollerImpl.positionRect(Y,Q,st),this}positionCell(Y,Q,st){return this.scrollerImpl.positionCell(Y,Q,st),this}positionContent(Y,Q){return this.scrollerImpl.positionContent(Y,Q),this}drawBackground(Y,Q){return(this.graph.options.background==null||!Q)&&this.scrollerImpl.backgroundManager.draw(Y),this}clearBackground(Y){return(this.graph.options.background==null||!Y)&&this.scrollerImpl.backgroundManager.clear(),this}isPannable(){return this.pannable}enablePanning(){this.pannable||(this.options.pannable=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.options.pannable=!1,this.updateClassName())}togglePanning(Y){return Y==null?this.isPannable()?this.disablePanning():this.enablePanning():Y!==this.isPannable()&&(Y?this.enablePanning():this.disablePanning()),this}lockScroller(){return this.scrollerImpl.lock(),this}unlockScroller(){return this.scrollerImpl.unlock(),this}updateScroller(){return this.scrollerImpl.update(),this}getScrollbarPosition(){return this.scrollerImpl.scrollbarPosition()}setScrollbarPosition(Y,Q){return this.scrollerImpl.scrollbarPosition(Y,Q),this}scrollToPoint(Y,Q){return this.scrollerImpl.scrollToPoint(Y,Q),this}scrollToContent(){return this.scrollerImpl.scrollToContent(),this}scrollToCell(Y){return this.scrollerImpl.scrollToCell(Y),this}transitionToPoint(Y,Q,st){return this.scrollerImpl.transitionToPoint(Y,Q,st),this}transitionToRect(Y,Q={}){return this.scrollerImpl.transitionToRect(Y,Q),this}enableAutoResize(){this.scrollerImpl.enableAutoResize()}disableAutoResize(){this.scrollerImpl.disableAutoResize()}autoScroll(Y,Q){return this.scrollerImpl.autoScroll(Y,Q)}clientToLocalPoint(Y,Q){return this.scrollerImpl.clientToLocalPoint(Y,Q)}setup(){this.scrollerImpl.on("*",(Y,Q)=>{this.trigger(Y,Q)})}startListening(){let Y=[];const Q=this.options.pannable;typeof Q=="object"?Y=Q.eventTypes||[]:Y=["leftMouseDown"],Y.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),Y.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),Lt.is.Event.on(this.scrollerImpl.container,"mousedown",this.onRightMouseDown))}stopListening(){let Y=[];const Q=this.options.pannable;typeof Q=="object"?Y=Q.eventTypes||[]:Y=["leftMouseDown"],Y.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),Y.includes("rightMouseDown")&&Lt.is.Event.off(this.scrollerImpl.container,"mousedown",this.onRightMouseDown)}onRightMouseDown(Y){Y.button===2&&this.allowPanning(Y,!0)&&(this.updateClassName(!0),this.scrollerImpl.startPanning(Y),this.scrollerImpl.once("pan:stop",()=>this.updateClassName(!1)))}preparePanning({e:Y}){const Q=this.allowPanning(Y,!0),st=this.graph.getPlugin("selection"),at=st&&st.allowRubberband(Y,!0);(Q||this.allowPanning(Y)&&!at)&&(this.updateClassName(!0),this.scrollerImpl.startPanning(Y),this.scrollerImpl.once("pan:stop",()=>this.updateClassName(!1)))}allowPanning(Y,Q){return this.pannable&&Lt.tx.isMatch(Y,this.options.modifiers,Q)}updateClassName(Y){const Q=this.scrollerImpl.container,st=Lt.De.prefix("graph-scroller-pannable");this.pannable?(Lt.is.addClass(Q,st),Q.dataset.panning=(!!Y).toString()):Lt.is.removeClass(Q,st)}dispose(){this.scrollerImpl.dispose(),this.stopListening(),this.off(),Lt.mf.clean(this.name)}}Jt([Lt.ew.dispose()],kt.prototype,"dispose",null)},8605:(yo,wn,Nt)=>{"use strict";Nt.d(wn,{z2:()=>te});var Lt=Nt(52729);class mn extends Lt.NB{}(function(st){function at(jt){const Ht=[],Xt=Lt.Lu.getForeignObjectMarkup();return jt?Ht.push({tagName:jt,selector:"body"},Xt):Ht.push(Xt),Ht}st.config({view:"react-shape-view",markup:at(),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}},propHooks(jt){if(jt.markup==null){const Ht=jt.primer;if(Ht){jt.markup=at(Ht);let Xt={};switch(Ht){case"circle":Xt={refCx:"50%",refCy:"50%",refR:"50%"};break;case"ellipse":Xt={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"};break;default:break}jt.attrs=Lt.QK.merge({},{body:Object.assign({refWidth:null,refHeight:null},Xt)},jt.attrs||{})}}return jt}}),Lt.NB.registry.register("react-shape",st,!0)})(mn||(mn={}));var An=Nt(67294),Te=Nt(73935),Be;(function(st){let at=!1,jt;const Ht=(Ce,Me)=>{const tn=Me.payload;switch(Me.type){case"add":{const fe=Ce.findIndex(Se=>Se.id===tn.id);return fe>=0?(Ce[fe]=tn,[...Ce]):[...Ce,tn]}case"remove":{const fe=Ce.findIndex(Se=>Se.id===tn.id);if(fe>=0){const Se=[...Ce];return Se.splice(fe,1),Se}break}default:break}return Ce};function Xt(Ce,Me){at&&jt({type:"add",payload:{id:Ce,portal:Me}})}st.connect=Xt;function De(Ce){at&&jt({type:"remove",payload:{id:Ce}})}st.disconnect=De;function Ze(){return at}st.isActive=Ze;function hn(){return()=>{at=!0;const[Ce,Me]=(0,An.useReducer)(Ht,[]);return jt=Me,An.createElement(An.Fragment,{children:Ce.map(tn=>tn.portal)})}}st.getProvider=hn})(Be||(Be={}));var Jt=function(st,at){var jt={};for(var Ht in st)Object.prototype.hasOwnProperty.call(st,Ht)&&at.indexOf(Ht)<0&&(jt[Ht]=st[Ht]);if(st!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Xt=0,Ht=Object.getOwnPropertySymbols(st);Xt<Ht.length;Xt++)at.indexOf(Ht[Xt])<0&&Object.prototype.propertyIsEnumerable.call(st,Ht[Xt])&&(jt[Ht[Xt]]=st[Ht[Xt]]);return jt};const kt={};function te(st){const{shape:at,component:jt,effect:Ht,inherit:Xt}=st,De=Jt(st,["shape","component","effect","inherit"]);if(!at)throw new Error("should specify shape in config");kt[at]={component:jt,effect:Ht},Lt.kJ.registerNode(at,Object.assign({inherit:Xt||"react-shape"},De),!0)}class Y extends An.PureComponent{constructor(at){super(at),this.state={tick:0}}componentDidMount(){const{node:at}=this.props;at.on("change:*",({key:jt})=>{const Ht=kt[at.shape];if(Ht){const{effect:Xt}=Ht;(!Xt||Xt.includes(jt))&&this.setState({tick:this.state.tick+1})}})}clone(at){const{node:jt,graph:Ht}=this.props;return typeof at.type=="string"?An.cloneElement(at):An.cloneElement(at,{node:jt,graph:Ht})}render(){const{node:at}=this.props,jt=kt[at.shape];if(!jt)return null;const{component:Ht}=jt;if(An.isValidElement(Ht))return this.clone(Ht);const Xt=Ht;return this.clone(An.createElement(Xt,null))}}class Q extends Lt.DK{getComponentContainer(){return this.selectors&&this.selectors.foContent}confirmUpdate(at){const jt=super.confirmUpdate(at);return this.handleAction(jt,Q.action,()=>{this.renderReactComponent()})}renderReactComponent(){this.unmountReactComponent();const at=this.getComponentContainer(),jt=this.cell;if(at){const Ht=jt.model?jt.model.graph:null,Xt=An.createElement(Y,{node:jt,graph:Ht});if(Be.isActive()){const De=(0,Te.createPortal)(Xt,at);Be.connect(this.cell.id,De)}else Te.render(Xt,at)}}unmountReactComponent(){const at=this.getComponentContainer();at&&Te.unmountComponentAtNode(at)}onMouseDown(at,jt,Ht){const Xt=at.target;if(Xt.tagName.toLowerCase()==="input"){const Ze=Xt.getAttribute("type");if(Ze==null||["text","password","number","email","search","tel","url"].includes(Ze))return}super.onMouseDown(at,jt,Ht)}unmount(){return Be.isActive()&&Be.disconnect(this.cell.id),this.unmountReactComponent(),super.unmount(),this}}(function(st){st.action="react",st.config({bootstrap:[st.action],actions:{component:st.action}}),Lt.DK.registry.register("react-shape-view",st,!0)})(Q||(Q={}))},52729:(yo,wn,Nt)=>{"use strict";Nt.d(wn,{iC:()=>Dv,ew:()=>vi,De:()=>ri,mf:()=>Be,Vb:()=>Up,is:()=>Te,Iw:()=>An,kJ:()=>Li,tw:()=>Ts,Lu:()=>or,tx:()=>rc,NB:()=>Cr,DK:()=>Bo,GH:()=>mn,QK:()=>Lt,t4:()=>ms,E9:()=>o,Ae:()=>s,bn:()=>Me,Zr:()=>Fn,OW:()=>sn,G7:()=>ir});var Lt={};Nt.r(Lt),Nt.d(Lt,{applyMixins:()=>Em,clone:()=>_f,cloneDeep:()=>ur,createClass:()=>al,defaults:()=>Jg,defaultsDeep:()=>Qg,ensure:()=>ep,flatten:()=>Cm,getBoolean:()=>Tm,getByPath:()=>Sf,getNumber:()=>Am,getValue:()=>Sm,has:()=>Aa,inherit:()=>_m,isEmpty:()=>M,isEqual:()=>mi,isMaliciousProp:()=>np,isObject:()=>Ue,isPlainObject:()=>fi.Z,merge:()=>Yn,pick:()=>Bc,setByPath:()=>ia,unsetByPath:()=>rp});var mn={};Nt.r(mn),Nt.d(mn,{clamp:()=>hr,isNumber:()=>Lp,isPercentage:()=>Po,mod:()=>ll,normalizePercentage:()=>$i,normalizeSides:()=>ps,parseCssNumeric:()=>sx,random:()=>ul});var An={};Nt.r(An),Nt.d(An,{apply:()=>$,call:()=>Ke,debounce:()=>Bl,isAsync:()=>jl,isAsyncLike:()=>Br,throttle:()=>ga,toAsyncBoolean:()=>pa,toDeferredBoolean:()=>zo});var Te={};Nt.r(Te),Nt.d(Te,{CASE_SENSITIVE_ATTR:()=>Y0,Event:()=>Rr,EventHook:()=>Di,EventObject:()=>qi,KAPPA:()=>ed,MouseWheelHandle:()=>Zp,addClass:()=>xe,after:()=>ax,append:()=>pl,appendTo:()=>Xr,attr:()=>Dn,before:()=>$f,breakText:()=>El,children:()=>q0,circleToPathData:()=>Vp,clearSelection:()=>Lo,computeStyle:()=>yl,computeStyleInt:()=>qa,contains:()=>Gp,createElement:()=>Vf,createElementNS:()=>Hf,createSVGMatrix:()=>Ur,createSVGPoint:()=>$p,createSVGTransform:()=>Al,createSlicePathData:()=>Sl,createSvgDocument:()=>dl,createSvgElement:()=>Ni,css:()=>bl,data:()=>la,decomposeMatrix:()=>yx,ellipseToPathData:()=>Ja,empty:()=>gl,ensureId:()=>Uf,find:()=>pe,findOne:()=>Wi,findParentByClass:()=>Pi,getAttribute:()=>lx,getClass:()=>dn,getComputedStyle:()=>Ar,getData:()=>Jf,getPointsFromSvgElement:()=>Ya,getTransformToElement:()=>ha,getTransformToParentElement:()=>Qa,getVendorPrefixedName:()=>Zi,hasClass:()=>aa,hasScrollbars:()=>Ro,height:()=>xx,index:()=>mo,isCSSVariable:()=>K0,isElement:()=>cx,isHTMLElement:()=>zp,isSVGGraphicsElement:()=>vs,kebablizeAttrs:()=>vo,lineToPathData:()=>iv,matrixToRotation:()=>bx,matrixToScale:()=>uv,matrixToTransformString:()=>Ka,matrixToTranslation:()=>hv,measureText:()=>wl,mergeAttrs:()=>Zf,ns:()=>Dr,offset:()=>qp,parseTransformString:()=>ua,parseXML:()=>W0,polygonToPathData:()=>ov,polylineToPathData:()=>sv,position:()=>wx,prepend:()=>Z0,prop:()=>Qu,qualifyAttr:()=>Xf,rectToPathData:()=>Hp,rectangleToPathData:()=>av,remove:()=>Do,removeAttribute:()=>qt,removeClass:()=>Mi,rotate:()=>rd,sample:()=>rv,scale:()=>id,setAttribute:()=>Wf,setAttributes:()=>J0,setData:()=>Q0,setPrefixedStyle:()=>Za,splitTextByLength:()=>td,styleToObject:()=>ys,svgVersion:()=>Fp,tagName:()=>X0,text:()=>Qf,toLocalPoint:()=>tc,toPath:()=>cv,toPathData:()=>_l,toggleClass:()=>ca,transform:()=>Es,transformStringToMatrix:()=>th,translate:()=>Xp,uniqueId:()=>$0,width:()=>sd});var Be={};Nt.r(Be),Nt.d(Be,{clean:()=>Sx,ensure:()=>dv});var Jt={};Nt.r(Jt),Nt.d(Jt,{dot:()=>yt,doubleMesh:()=>Ne,fixedDot:()=>bt,mesh:()=>de});var kt={};Nt.r(kt),Nt.d(kt,{flipX:()=>Ie,flipXY:()=>Qe,flipY:()=>Ge,watermark:()=>Xn});var te={};Nt.r(te),Nt.d(te,{blur:()=>En,brightness:()=>kn,contrast:()=>fr,dropShadow:()=>xn,grayScale:()=>We,highlight:()=>Nn,hueRotate:()=>Lr,invert:()=>Tr,outline:()=>un,saturate:()=>rr,sepia:()=>Xe});var Y={};Nt.r(Y),Nt.d(Y,{async:()=>jE,block:()=>IE,circle:()=>ow,circlePlus:()=>FE,classic:()=>ME,cross:()=>kE,diamond:()=>PE,ellipse:()=>zE,path:()=>RE});var Q={};Nt.r(Q),Nt.d(Q,{annotations:()=>yE,atConnectionLength:()=>YE,atConnectionLengthIgnoreGradient:()=>ZE,atConnectionLengthKeepGradient:()=>sw,atConnectionRatio:()=>JE,atConnectionRatioIgnoreGradient:()=>qE,atConnectionRatioKeepGradient:()=>aw,connection:()=>XE,displayEmpty:()=>xE,eol:()=>bE,fill:()=>fE,filter:()=>CE,html:()=>TE,lineHeight:()=>pE,port:()=>OE,ref:()=>Ri,refCx:()=>eE,refCy:()=>nE,refD:()=>sE,refDKeepOffset:()=>rE,refDResetOffset:()=>qx,refDx:()=>Ax,refDy:()=>pv,refHeight:()=>Kp,refHeight2:()=>hE,refPoints:()=>aE,refPointsKeepOffset:()=>iE,refPointsResetOffset:()=>Yx,refR:()=>oE,refRCircumscribed:()=>tE,refRInscribed:()=>Zx,refRx:()=>Kw,refRy:()=>Qw,refWidth:()=>mv,refWidth2:()=>uE,refX:()=>gv,refX2:()=>cE,refY:()=>Jp,refY2:()=>lE,resetOffset:()=>SE,sourceMarker:()=>VE,stroke:()=>dE,style:()=>AE,targetMarker:()=>HE,text:()=>tw,textPath:()=>vE,textVerticalAnchor:()=>mE,textWrap:()=>gE,title:()=>wE,vertexMarker:()=>$E,xAlign:()=>EE,yAlign:()=>_E});var st={};Nt.r(st),Nt.d(st,{className:()=>KE,opacity:()=>QE,stroke:()=>e1});var at={};Nt.r(at),Nt.d(at,{absolute:()=>n1,bottom:()=>u1,ellipse:()=>r1,ellipseSpread:()=>i1,left:()=>a1,line:()=>s1,right:()=>c1,top:()=>l1});var jt={};Nt.r(jt),Nt.d(jt,{bottom:()=>m1,inside:()=>b1,insideOriented:()=>x1,left:()=>d1,manual:()=>f1,outside:()=>v1,outsideOriented:()=>y1,radial:()=>w1,radialOriented:()=>E1,right:()=>g1,top:()=>p1});var Ht={};Nt.r(Ht),Nt.d(Ht,{noop:()=>C1,pinAbsolute:()=>N1,pinRelative:()=>M1});var Xt={};Nt.r(Xt),Nt.d(Xt,{bottom:()=>G1,bottomLeft:()=>$1,bottomRight:()=>W1,center:()=>j1,left:()=>z1,midSide:()=>q1,nodeCenter:()=>Z1,orth:()=>X1,right:()=>U1,top:()=>F1,topLeft:()=>V1,topRight:()=>H1});var De={};Nt.r(De),Nt.d(De,{closest:()=>K1,length:()=>J1,orth:()=>Q1,ratio:()=>Y1});var Ze={};Nt.r(Ze),Nt.d(Ze,{anchor:()=>i_,bbox:()=>Sw,boundary:()=>n_,rect:()=>e_});var hn={};Nt.r(hn),Nt.d(hn,{er:()=>S_,loop:()=>A_,manhattan:()=>Bw,metro:()=>__,normal:()=>o_,oneSide:()=>s_,orth:()=>Cw});var Ce={};Nt.r(Ce),Nt.d(Ce,{jumpover:()=>R_,loop:()=>C_,normal:()=>T_,rounded:()=>O_,smooth:()=>I_});var Me={};Nt.r(Me),Nt.d(Me,{kS:()=>Vw});var tn=Nt(90591);class fe{get disposed(){return this._disposed===!0}dispose(){this._disposed=!0}}(function(a){function t(){return(e,n,c)=>{const u=c.value,f=e.__proto__;c.value=function(...d){this.disposed||(u.call(this,...d),f.dispose.call(this))}}}a.dispose=t})(fe||(fe={}));class Se{constructor(t){this.callback=t}get disposed(){return!this.callback}dispose(){if(!this.callback)return;const t=this.callback;this.callback=null,t()}}class Ve{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach(t=>{t.dispose()}),this.items.clear())}contains(t){return this.items.has(t)}add(t){this.items.add(t)}remove(t){this.items.delete(t)}clear(){this.items.clear()}}(function(a){function t(e){const n=new a;return e.forEach(c=>{n.add(c)}),n}a.from=t})(Ve||(Ve={}));function rn(a){var t=typeof a;return a!=null&&(t=="object"||t=="function")}const Ue=rn;var Tn=Nt(66092),Qn=function(){return Tn.Z.Date.now()};const Zn=Qn;var xi=/\s/;function Or(a){for(var t=a.length;t--&&xi.test(a.charAt(t)););return t}const ki=Or;var vn=/^\s+/;function Bn(a){return a&&a.slice(0,ki(a)+1).replace(vn,"")}const oi=Bn;var dr=Nt(34492),ar=Nt(18533),jo="[object Symbol]";function da(a){return typeof a=="symbol"||(0,ar.Z)(a)&&(0,dr.Z)(a)==jo}const Ir=da;var bo=NaN,Cs=/^[-+]0x[0-9a-f]+$/i,cr=/^0b[01]+$/i,Fo=/^0o[0-7]+$/i,Go=parseInt;function xo(a){if(typeof a=="number")return a;if(Ir(a))return bo;if(Ue(a)){var t=typeof a.valueOf=="function"?a.valueOf():a;a=Ue(t)?t+"":t}if(typeof a!="string")return a===0?a:+a;a=oi(a);var e=cr.test(a);return e||Fo.test(a)?Go(a.slice(2),e?2:8):Cs.test(a)?bo:+a}const wi=xo;var Jr="Expected a function",Yi=Math.max,_d=Math.min;function si(a,t,e){var n,c,u,f,d,v,b=0,E=!1,S=!1,_=!0;if(typeof a!="function")throw new TypeError(Jr);t=wi(t)||0,Ue(e)&&(E=!!e.leading,S="maxWait"in e,u=S?Yi(wi(e.maxWait)||0,t):u,_="trailing"in e?!!e.trailing:_);function C(At){var le=n,ye=c;return n=c=void 0,b=At,f=a.apply(ye,le),f}function D(At){return b=At,d=setTimeout(H,t),E?C(At):f}function L(At){var le=At-v,ye=At-b,be=t-le;return S?_d(be,u-ye):be}function B(At){var le=At-v,ye=At-b;return v===void 0||le>=t||le<0||S&&ye>=u}function H(){var At=Zn();if(B(At))return J(At);d=setTimeout(H,L(At))}function J(At){return d=void 0,_&&n?C(At):(n=c=void 0,f)}function V(){d!==void 0&&clearTimeout(d),b=0,n=v=c=d=void 0}function ct(){return d===void 0?f:J(Zn())}function dt(){var At=Zn(),le=B(At);if(n=arguments,c=this,v=At,le){if(d===void 0)return D(v);if(S)return clearTimeout(d),d=setTimeout(H,t),C(v)}return d===void 0&&(d=setTimeout(H,t)),f}return dt.cancel=V,dt.flush=ct,dt}const Bl=si;var fc="Expected a function";function Sd(a,t,e){var n=!0,c=!0;if(typeof a!="function")throw new TypeError(fc);return Ue(e)&&(n="leading"in e?!!e.leading:n,c="trailing"in e?!!e.trailing:c),Bl(a,t,{leading:n,maxWait:t,trailing:c})}const ga=Sd;function $(a,t,e){if(e)switch(e.length){case 0:return a.call(t);case 1:return a.call(t,e[0]);case 2:return a.call(t,e[0],e[1]);case 3:return a.call(t,e[0],e[1],e[2]);case 4:return a.call(t,e[0],e[1],e[2],e[3]);case 5:return a.call(t,e[0],e[1],e[2],e[3],e[4]);case 6:return a.call(t,e[0],e[1],e[2],e[3],e[4],e[5]);default:return a.apply(t,e)}return a.call(t)}function Ke(a,t,...e){return $(a,t,e)}function Br(a){return typeof a=="object"&&a.then&&typeof a.then=="function"}function jl(a){return a!=null&&(a instanceof Promise||Br(a))}function pa(...a){const t=[];if(a.forEach(n=>{Array.isArray(n)?t.push(...n):t.push(n)}),t.some(n=>jl(n))){const n=t.map(c=>jl(c)?c:Promise.resolve(c!==!1));return Promise.all(n).then(c=>c.reduce((u,f)=>f!==!1&&u,!0))}return t.every(n=>n!==!1)}function zo(...a){const t=pa(a);return typeof t=="boolean"?Promise.resolve(t):t}function dc(a,t){const e=[];for(let n=0;n<a.length;n+=2){const c=a[n],u=a[n+1],f=Array.isArray(t)?t:[t],d=$(c,u,f);e.push(d)}return pa(e)}class ma{constructor(){this.listeners={}}on(t,e,n){return e==null?this:(this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e,n),this)}once(t,e,n){const c=(...u)=>(this.off(t,c),dc([e,n],u));return this.on(t,c,this)}off(t,e,n){if(!(t||e||n))return this.listeners={},this;const c=this.listeners;return(t?[t]:Object.keys(c)).forEach(f=>{const d=c[f];if(d){if(!(e||n)){delete c[f];return}for(let v=d.length-2;v>=0;v-=2)e&&d[v]!==e||n&&d[v+1]!==n||d.splice(v,2)}}),this}trigger(t,...e){let n=!0;if(t!=="*"){const u=this.listeners[t];u!=null&&(n=dc([...u],e))}const c=this.listeners["*"];return c!=null?pa([n,dc([...c],[t,...e])]):n}emit(t,...e){return this.trigger(t,...e)}}var oh=Object.prototype,Fl=oh.hasOwnProperty;function Ad(a,t){return a!=null&&Fl.call(a,t)}const jr=Ad;var gr=Array.isArray;const wr=gr;var Gl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gc=/^\w*$/;function Td(a,t){if(wr(a))return!1;var e=typeof a;return e=="number"||e=="symbol"||e=="boolean"||a==null||Ir(a)?!0:gc.test(a)||!Gl.test(a)||t!=null&&a in Object(t)}const zl=Td;var sh="[object AsyncFunction]",Cd="[object Function]",Uo="[object GeneratorFunction]",Os="[object Proxy]";function va(a){if(!Ue(a))return!1;var t=(0,dr.Z)(a);return t==Cd||t==Uo||t==sh||t==Os}const pc=va;var Mr=Tn.Z["__core-js_shared__"];const Vo=Mr;var ya=function(){var a=/[^.]+$/.exec(Vo&&Vo.keys&&Vo.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function Ho(a){return!!ya&&ya in a}const mc=Ho;var ba=Function.prototype,ah=ba.toString;function ch(a){if(a!=null){try{return ah.call(a)}catch(t){}try{return a+""}catch(t){}}return""}const $o=ch;var vc=/[\\^$.*+?()[\]{}|]/g,Ul=/^\[object .+?Constructor\]$/,tr=Function.prototype,lh=Object.prototype,Od=tr.toString,Id=lh.hasOwnProperty,Vl=RegExp("^"+Od.call(Id).replace(vc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Md(a){if(!Ue(a)||mc(a))return!1;var t=pc(a)?Vl:Ul;return t.test($o(a))}const Nd=Md;function uh(a,t){return a==null?void 0:a[t]}const Pd=uh;function Dd(a,t){var e=Pd(a,t);return Nd(e)?e:void 0}const Wo=Dd;var Rd=Wo(Object,"create");const xa=Rd;function Hl(){this.__data__=xa?xa(null):{},this.size=0}const $l=Hl;function hh(a){var t=this.has(a)&&delete this.__data__[a];return this.size-=t?1:0,t}const Ld=hh;var fh="__lodash_hash_undefined__",yc=Object.prototype,kd=yc.hasOwnProperty;function Bd(a){var t=this.__data__;if(xa){var e=t[a];return e===fh?void 0:e}return kd.call(t,a)?t[a]:void 0}const dh=Bd;var gh=Object.prototype,ph=gh.hasOwnProperty;function jd(a){var t=this.__data__;return xa?t[a]!==void 0:ph.call(t,a)}const Wl=jd;var Fd="__lodash_hash_undefined__";function Gd(a,t){var e=this.__data__;return this.size+=this.has(a)?0:1,e[a]=xa&&t===void 0?Fd:t,this}const bc=Gd;function Xo(a){var t=-1,e=a==null?0:a.length;for(this.clear();++t<e;){var n=a[t];this.set(n[0],n[1])}}Xo.prototype.clear=$l,Xo.prototype.delete=Ld,Xo.prototype.get=dh,Xo.prototype.has=Wl,Xo.prototype.set=bc;const mh=Xo;function zd(){this.__data__=[],this.size=0}const wa=zd;function Xl(a,t){return a===t||a!==a&&t!==t}const Zo=Xl;function xc(a,t){for(var e=a.length;e--;)if(Zo(a[e][0],t))return e;return-1}const wc=xc;var Is=Array.prototype,vh=Is.splice;function yh(a){var t=this.__data__,e=wc(t,a);if(e<0)return!1;var n=t.length-1;return e==n?t.pop():vh.call(t,e,1),--this.size,!0}const hi=yh;function Kr(a){var t=this.__data__,e=wc(t,a);return e<0?void 0:t[e][1]}const Ms=Kr;function bh(a){return wc(this.__data__,a)>-1}const Ud=bh;function xh(a,t){var e=this.__data__,n=wc(e,a);return n<0?(++this.size,e.push([a,t])):e[n][1]=t,this}const wh=xh;function Ns(a){var t=-1,e=a==null?0:a.length;for(this.clear();++t<e;){var n=a[t];this.set(n[0],n[1])}}Ns.prototype.clear=wa,Ns.prototype.delete=hi,Ns.prototype.get=Ms,Ns.prototype.has=Ud,Ns.prototype.set=wh;const Ea=Ns;var Ec=Wo(Tn.Z,"Map");const _a=Ec;function Vd(){this.size=0,this.__data__={hash:new mh,map:new(_a||Ea),string:new mh}}const Eh=Vd;function Hd(a){var t=typeof a;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?a!=="__proto__":a===null}const $d=Hd;function Sa(a,t){var e=a.__data__;return $d(t)?e[typeof t=="string"?"string":"hash"]:e.map}const Ps=Sa;function lm(a){var t=Ps(this,a).delete(a);return this.size-=t?1:0,t}const wo=lm;function um(a){return Ps(this,a).get(a)}const Zl=um;function _c(a){return Ps(this,a).has(a)}const _h=_c;function Sc(a,t){var e=Ps(this,a),n=e.size;return e.set(a,t),this.size+=e.size==n?0:1,this}const Wd=Sc;function Ds(a){var t=-1,e=a==null?0:a.length;for(this.clear();++t<e;){var n=a[t];this.set(n[0],n[1])}}Ds.prototype.clear=Eh,Ds.prototype.delete=wo,Ds.prototype.get=Zl,Ds.prototype.has=_h,Ds.prototype.set=Wd;const Rs=Ds;var ql="Expected a function";function Qr(a,t){if(typeof a!="function"||t!=null&&typeof t!="function")throw new TypeError(ql);var e=function(){var n=arguments,c=t?t.apply(this,n):n[0],u=e.cache;if(u.has(c))return u.get(c);var f=a.apply(this,n);return e.cache=u.set(c,f)||u,f};return e.cache=new(Qr.Cache||Rs),e}Qr.Cache=Rs;const Yl=Qr;var Xd=500;function Zd(a){var t=Yl(a,function(n){return e.size===Xd&&e.clear(),n}),e=t.cache;return t}const qd=Zd;var Yd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sh=/\\(\\)?/g,Jd=qd(function(a){var t=[];return a.charCodeAt(0)===46&&t.push(""),a.replace(Yd,function(e,n,c,u){t.push(c?u.replace(Sh,"$1"):n||e)}),t});const Kd=Jd;var Eo=Nt(17685);function Qd(a,t){for(var e=-1,n=a==null?0:a.length,c=Array(n);++e<n;)c[e]=t(a[e],e,a);return c}const Bi=Qd;var tg=1/0,Ah=Eo.Z?Eo.Z.prototype:void 0,qo=Ah?Ah.toString:void 0;function Th(a){if(typeof a=="string")return a;if(wr(a))return Bi(a,Th)+"";if(Ir(a))return qo?qo.call(a):"";var t=a+"";return t=="0"&&1/a==-tg?"-0":t}const Ls=Th;function eg(a){return a==null?"":Ls(a)}const ji=eg;function ng(a,t){return wr(a)?a:zl(a,t)?[a]:Kd(ji(a))}const Ji=ng;var Ch="[object Arguments]";function hm(a){return(0,ar.Z)(a)&&(0,dr.Z)(a)==Ch}const Oh=hm;var Ih=Object.prototype,Mh=Ih.hasOwnProperty,rg=Ih.propertyIsEnumerable,ig=Oh(function(){return arguments}())?Oh:function(a){return(0,ar.Z)(a)&&Mh.call(a,"callee")&&!rg.call(a,"callee")};const Ki=ig;var qn=9007199254740991,Ac=/^(?:0|[1-9]\d*)$/;function og(a,t){var e=typeof a;return t=t==null?qn:t,!!t&&(e=="number"||e!="symbol"&&Ac.test(a))&&a>-1&&a%1==0&&a<t}const ai=og;var Jl=9007199254740991;function Kl(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=Jl}const Fi=Kl;var Ei=1/0;function Tc(a){if(typeof a=="string"||Ir(a))return a;var t=a+"";return t=="0"&&1/a==-Ei?"-0":t}const ti=Tc;function Cc(a,t,e){t=Ji(t,a);for(var n=-1,c=t.length,u=!1;++n<c;){var f=ti(t[n]);if(!(u=a!=null&&e(a,f)))break;a=a[f]}return u||++n!=c?u:(c=a==null?0:a.length,!!c&&Fi(c)&&ai(f,c)&&(wr(a)||Ki(a)))}const Oc=Cc;function Ic(a,t){return a!=null&&Oc(a,t,jr)}const Aa=Ic;function fm(a,t){t=Ji(t,a);for(var e=0,n=t.length;a!=null&&e<n;)a=a[ti(t[e++])];return e&&e==n?a:void 0}const Ta=fm;var Ca=function(){try{var a=Wo(Object,"defineProperty");return a({},"",{}),a}catch(t){}}();const Mc=Ca;function Ql(a,t,e){t=="__proto__"&&Mc?Mc(a,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):a[t]=e}const _o=Ql;var Nc=Object.prototype,tu=Nc.hasOwnProperty;function Yo(a,t,e){var n=a[t];(!(tu.call(a,t)&&Zo(n,e))||e===void 0&&!(t in a))&&_o(a,t,e)}const ks=Yo;function Oa(a,t,e,n){if(!Ue(a))return a;t=Ji(t,a);for(var c=-1,u=t.length,f=u-1,d=a;d!=null&&++c<u;){var v=ti(t[c]),b=e;if(v==="__proto__"||v==="constructor"||v==="prototype")return a;if(c!=f){var E=d[v];b=n?n(E,v,d):void 0,b===void 0&&(b=Ue(E)?E:ai(t[c+1])?[]:{})}ks(d,v,b),d=d[v]}return a}const eu=Oa;function nu(a,t,e){for(var n=-1,c=t.length,u={};++n<c;){var f=t[n],d=Ta(a,f);e(d,f)&&eu(u,Ji(f,a),d)}return u}const sg=nu;function ru(a,t){return a!=null&&t in Object(a)}const Pc=ru;function iu(a,t){return a!=null&&Oc(a,t,Pc)}const _i=iu;function ag(a,t){return sg(a,t,function(e,n){return _i(a,n)})}const ou=ag;function Nh(a,t){for(var e=-1,n=t.length,c=a.length;++e<n;)a[c+e]=t[e];return a}const Qi=Nh;var Dc=Eo.Z?Eo.Z.isConcatSpreadable:void 0;function Rc(a){return wr(a)||Ki(a)||!!(Dc&&a&&a[Dc])}const Bs=Rc;function cg(a,t,e,n,c){var u=-1,f=a.length;for(e||(e=Bs),c||(c=[]);++u<f;){var d=a[u];t>0&&e(d)?t>1?cg(d,t-1,e,n,c):Qi(c,d):n||(c[c.length]=d)}return c}const Lc=cg;function lg(a){var t=a==null?0:a.length;return t?Lc(a,1):[]}const su=lg;function Ph(a,t,e){switch(e.length){case 0:return a.call(t);case 1:return a.call(t,e[0]);case 2:return a.call(t,e[0],e[1]);case 3:return a.call(t,e[0],e[1],e[2])}return a.apply(t,e)}const Dh=Ph;var Rh=Math.max;function kc(a,t,e){return t=Rh(t===void 0?a.length-1:t,0),function(){for(var n=arguments,c=-1,u=Rh(n.length-t,0),f=Array(u);++c<u;)f[c]=n[t+c];c=-1;for(var d=Array(t+1);++c<t;)d[c]=n[c];return d[t]=e(f),Dh(a,this,d)}}const au=kc;function cu(a){return function(){return a}}const Lh=cu;function kh(a){return a}const So=kh;var ug=Mc?function(a,t){return Mc(a,"toString",{configurable:!0,enumerable:!1,value:Lh(t),writable:!0})}:So;const Ia=ug;var hg=800,fg=16,dg=Date.now;function Bh(a){var t=0,e=0;return function(){var n=dg(),c=fg-(n-e);if(e=n,c>0){if(++t>=hg)return arguments[0]}else t=0;return a.apply(void 0,arguments)}}var gg=Bh(Ia);const jh=gg;function Fh(a){return jh(au(a,void 0,su),a+"")}var pg=Fh(function(a,t){return a==null?{}:ou(a,t)});const Bc=pg;function ci(){this.__data__=new Ea,this.size=0}const js=ci;function Gh(a){var t=this.__data__,e=t.delete(a);return this.size=t.size,e}const mg=Gh;function uu(a){return this.__data__.get(a)}const zh=uu;function hu(a){return this.__data__.has(a)}const Uh=hu;var vg=200;function Fs(a,t){var e=this.__data__;if(e instanceof Ea){var n=e.__data__;if(!_a||n.length<vg-1)return n.push([a,t]),this.size=++e.size,this;e=this.__data__=new Rs(n)}return e.set(a,t),this.size=e.size,this}const br=Fs;function Ao(a){var t=this.__data__=new Ea(a);this.size=t.size}Ao.prototype.clear=js,Ao.prototype.delete=mg,Ao.prototype.get=zh,Ao.prototype.has=Uh,Ao.prototype.set=br;const Jo=Ao;function to(a,t,e){(e!==void 0&&!Zo(a[t],e)||e===void 0&&!(t in a))&&_o(a,t,e)}const jc=to;function Fc(a){return function(t,e,n){for(var c=-1,u=Object(t),f=n(t),d=f.length;d--;){var v=f[a?d:++c];if(e(u[v],v,u)===!1)break}return t}}var fu=Fc();const bg=fu;var du=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Gc=du&&typeof module=="object"&&module&&!module.nodeType&&module,xg=Gc&&Gc.exports===du,gu=xg?Tn.Z.Buffer:void 0,pu=gu?gu.allocUnsafe:void 0;function Vh(a,t){if(t)return a.slice();var e=a.length,n=pu?pu(e):new a.constructor(e);return a.copy(n),n}const Hh=Vh;var mu=Tn.Z.Uint8Array;const zc=mu;function Ko(a){var t=new a.constructor(a.byteLength);return new zc(t).set(new zc(a)),t}const Gs=Ko;function $h(a,t){var e=t?Gs(a.buffer):a.buffer;return new a.constructor(e,a.byteOffset,a.length)}const vu=$h;function Wh(a,t){var e=-1,n=a.length;for(t||(t=Array(n));++e<n;)t[e]=a[e];return t}const yu=Wh;var bu=Object.create,xu=function(){function a(){}return function(t){if(!Ue(t))return{};if(bu)return bu(t);a.prototype=t;var e=new a;return a.prototype=void 0,e}}();const Xh=xu;var wu=Nt(12513),Eu=Object.prototype;function Si(a){var t=a&&a.constructor,e=typeof t=="function"&&t.prototype||Eu;return a===e}const Ma=Si;function wg(a){return typeof a.constructor=="function"&&!Ma(a)?Xh((0,wu.Z)(a)):{}}const Gi=wg;function Uc(a){return a!=null&&Fi(a.length)&&!pc(a)}const ei=Uc;function zs(a){return(0,ar.Z)(a)&&ei(a)}const Na=zs;function Zh(){return!1}const _u=Zh;var Su=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Vc=Su&&typeof module=="object"&&module&&!module.nodeType&&module,qh=Vc&&Vc.exports===Su,Yh=qh?Tn.Z.Buffer:void 0,Jh=Yh?Yh.isBuffer:void 0,Eg=Jh||_u;const Qo=Eg;var fi=Nt(37514),_g="[object Arguments]",Au="[object Array]",Tu="[object Boolean]",Kh="[object Date]",gm="[object Error]",Cu="[object Function]",Hc="[object Map]",Sg="[object Number]",Ag="[object Object]",pm="[object RegExp]",Tg="[object Set]",mm="[object String]",Qh="[object WeakMap]",Cg="[object ArrayBuffer]",Og="[object DataView]",Ig="[object Float32Array]",Mg="[object Float64Array]",Ng="[object Int8Array]",Us="[object Int16Array]",Ou="[object Int32Array]",Pg="[object Uint8Array]",tf="[object Uint8ClampedArray]",Iu="[object Uint16Array]",Dg="[object Uint32Array]",Rn={};Rn[Ig]=Rn[Mg]=Rn[Ng]=Rn[Us]=Rn[Ou]=Rn[Pg]=Rn[tf]=Rn[Iu]=Rn[Dg]=!0,Rn[_g]=Rn[Au]=Rn[Cg]=Rn[Tu]=Rn[Og]=Rn[Kh]=Rn[gm]=Rn[Cu]=Rn[Hc]=Rn[Sg]=Rn[Ag]=Rn[pm]=Rn[Tg]=Rn[mm]=Rn[Qh]=!1;function Rg(a){return(0,ar.Z)(a)&&Fi(a.length)&&!!Rn[(0,dr.Z)(a)]}const Lg=Rg;function kg(a){return function(t){return a(t)}}const Pa=kg;var Bg=Nt(13413),Vs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Da=Vs&&typeof module=="object"&&module&&!module.nodeType&&module,$c=Da&&Da.exports===Vs,Mu=$c&&Bg.Z.process,Hs=function(){try{var a=Da&&Da.require&&Da.require("util").types;return a||Mu&&Mu.binding&&Mu.binding("util")}catch(t){}}();const Ai=Hs;var ef=Ai&&Ai.isTypedArray,$s=ef?Pa(ef):Lg;const ts=$s;function To(a,t){if(!(t==="constructor"&&typeof a[t]=="function")&&t!="__proto__")return a[t]}const Wc=To;function Nu(a,t,e,n){var c=!e;e||(e={});for(var u=-1,f=t.length;++u<f;){var d=t[u],v=n?n(e[d],a[d],d,e,a):void 0;v===void 0&&(v=a[d]),c?_o(e,d,v):ks(e,d,v)}return e}const eo=Nu;function Pu(a,t){for(var e=-1,n=Array(a);++e<a;)n[e]=t(e);return n}const Ws=Pu;var es=Object.prototype,Du=es.hasOwnProperty;function ns(a,t){var e=wr(a),n=!e&&Ki(a),c=!e&&!n&&Qo(a),u=!e&&!n&&!c&&ts(a),f=e||n||c||u,d=f?Ws(a.length,String):[],v=d.length;for(var b in a)(t||Du.call(a,b))&&!(f&&(b=="length"||c&&(b=="offset"||b=="parent")||u&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||ai(b,v)))&&d.push(b);return d}const Ru=ns;function Fr(a){var t=[];if(a!=null)for(var e in Object(a))t.push(e);return t}const rs=Fr;var is=Object.prototype,Xs=is.hasOwnProperty;function Ra(a){if(!Ue(a))return rs(a);var t=Ma(a),e=[];for(var n in a)n=="constructor"&&(t||!Xs.call(a,n))||e.push(n);return e}const Xc=Ra;function nf(a){return ei(a)?Ru(a,!0):Xc(a)}const di=nf;function Zs(a){return eo(a,di(a))}const rf=Zs;function of(a,t,e,n,c,u,f){var d=Wc(a,e),v=Wc(t,e),b=f.get(v);if(b){jc(a,e,b);return}var E=u?u(d,v,e+"",a,t,f):void 0,S=E===void 0;if(S){var _=wr(v),C=!_&&Qo(v),D=!_&&!C&&ts(v);E=v,_||C||D?wr(d)?E=d:Na(d)?E=yu(d):C?(S=!1,E=Hh(v,!0)):D?(S=!1,E=vu(v,!0)):E=[]:(0,fi.Z)(v)||Ki(v)?(E=d,Ki(d)?E=rf(d):(!Ue(d)||pc(d))&&(E=Gi(v))):S=!1}S&&(f.set(v,E),c(E,v,n,u,f),f.delete(v)),jc(a,e,E)}const Lu=of;function Zc(a,t,e,n,c){a!==t&&bg(t,function(u,f){if(c||(c=new Jo),Ue(u))Lu(a,t,f,e,Zc,n,c);else{var d=n?n(Wc(a,f),u,f+"",a,t,c):void 0;d===void 0&&(d=u),jc(a,f,d)}},di)}const qc=Zc;function Co(a,t){return jh(au(a,t,So),a+"")}const zi=Co;function sf(a,t,e){if(!Ue(e))return!1;var n=typeof t;return(n=="number"?ei(e)&&ai(t,e.length):n=="string"&&t in e)?Zo(e[t],a):!1}const qs=sf;function af(a){return zi(function(t,e){var n=-1,c=e.length,u=c>1?e[c-1]:void 0,f=c>2?e[2]:void 0;for(u=a.length>3&&typeof u=="function"?(c--,u):void 0,f&&qs(e[0],e[1],f)&&(u=c<3?void 0:u,c=1),t=Object(t);++n<c;){var d=e[n];d&&a(t,d,n,u)}return t})}const ku=af;var Yc=ku(function(a,t,e){qc(a,t,e)});const Yn=Yc;var $r="__lodash_hash_undefined__";function li(a){return this.__data__.set(a,$r),this}const La=li;function no(a){return this.__data__.has(a)}const ka=no;function ni(a){var t=-1,e=a==null?0:a.length;for(this.__data__=new Rs;++t<e;)this.add(a[t])}ni.prototype.add=ni.prototype.push=La,ni.prototype.has=ka;const os=ni;function Ba(a,t){for(var e=-1,n=a==null?0:a.length;++e<n;)if(t(a[e],e,a))return!0;return!1}const ss=Ba;function Oo(a,t){return a.has(t)}const Gr=Oo;var Nr=1,ja=2;function ro(a,t,e,n,c,u){var f=e&Nr,d=a.length,v=t.length;if(d!=v&&!(f&&v>d))return!1;var b=u.get(a),E=u.get(t);if(b&&E)return b==t&&E==a;var S=-1,_=!0,C=e&ja?new os:void 0;for(u.set(a,t),u.set(t,a);++S<d;){var D=a[S],L=t[S];if(n)var B=f?n(L,D,S,t,a,u):n(D,L,S,a,t,u);if(B!==void 0){if(B)continue;_=!1;break}if(C){if(!ss(t,function(H,J){if(!Gr(C,J)&&(D===H||c(D,H,e,n,u)))return C.push(J)})){_=!1;break}}else if(!(D===L||c(D,L,e,n,u))){_=!1;break}}return u.delete(a),u.delete(t),_}const Ys=ro;function Jc(a){var t=-1,e=Array(a.size);return a.forEach(function(n,c){e[++t]=[c,n]}),e}const Js=Jc;function Ks(a){var t=-1,e=Array(a.size);return a.forEach(function(n){e[++t]=n}),e}const io=Ks;var jg=1,cf=2,lf="[object Boolean]",uf="[object Date]",Fg="[object Error]",Qs="[object Map]",Gg="[object Number]",zg="[object RegExp]",as="[object Set]",ta="[object String]",Fa="[object Symbol]",Ug="[object ArrayBuffer]",Vg="[object DataView]",hf=Eo.Z?Eo.Z.prototype:void 0,Bu=hf?hf.valueOf:void 0;function Hg(a,t,e,n,c,u,f){switch(e){case Vg:if(a.byteLength!=t.byteLength||a.byteOffset!=t.byteOffset)return!1;a=a.buffer,t=t.buffer;case Ug:return!(a.byteLength!=t.byteLength||!u(new zc(a),new zc(t)));case lf:case uf:case Gg:return Zo(+a,+t);case Fg:return a.name==t.name&&a.message==t.message;case zg:case ta:return a==t+"";case Qs:var d=Js;case as:var v=n&jg;if(d||(d=io),a.size!=t.size&&!v)return!1;var b=f.get(a);if(b)return b==t;n|=cf,f.set(a,t);var E=Ys(d(a),d(t),n,c,u,f);return f.delete(a),E;case Fa:if(Bu)return Bu.call(a)==Bu.call(t)}return!1}const $g=Hg;function Wg(a,t,e){var n=t(a);return wr(a)?n:Qi(n,e(a))}const cs=Wg;function ff(a,t){for(var e=-1,n=a==null?0:a.length,c=0,u=[];++e<n;){var f=a[e];t(f,e,a)&&(u[c++]=f)}return u}const ju=ff;function Kc(){return[]}const Io=Kc;var Qc=Object.prototype,Fu=Qc.propertyIsEnumerable,Ga=Object.getOwnPropertySymbols,tl=Ga?function(a){return a==null?[]:(a=Object(a),ju(Ga(a),function(t){return Fu.call(a,t)}))}:Io;const Ti=tl;var ea=Nt(1851),el=(0,ea.Z)(Object.keys,Object);const oo=el;var so=Object.prototype,ls=so.hasOwnProperty;function Mo(a){if(!Ma(a))return oo(a);var t=[];for(var e in Object(a))ls.call(a,e)&&e!="constructor"&&t.push(e);return t}const ao=Mo;function za(a){return ei(a)?Ru(a):ao(a)}const gi=za;function na(a){return cs(a,gi,Ti)}const us=na;var Pr=1,Gu=Object.prototype,nl=Gu.hasOwnProperty;function Xg(a,t,e,n,c,u){var f=e&Pr,d=us(a),v=d.length,b=us(t),E=b.length;if(v!=E&&!f)return!1;for(var S=v;S--;){var _=d[S];if(!(f?_ in t:nl.call(t,_)))return!1}var C=u.get(a),D=u.get(t);if(C&&D)return C==t&&D==a;var L=!0;u.set(a,t),u.set(t,a);for(var B=f;++S<v;){_=d[S];var H=a[_],J=t[_];if(n)var V=f?n(J,H,_,t,a,u):n(H,J,_,a,t,u);if(!(V===void 0?H===J||c(H,J,e,n,u):V)){L=!1;break}B||(B=_=="constructor")}if(L&&!B){var ct=a.constructor,dt=t.constructor;ct!=dt&&"constructor"in a&&"constructor"in t&&!(typeof ct=="function"&&ct instanceof ct&&typeof dt=="function"&&dt instanceof dt)&&(L=!1)}return u.delete(a),u.delete(t),L}const Zg=Xg;var ra=Wo(Tn.Z,"DataView");const In=ra;var df=Wo(Tn.Z,"Promise");const Ui=df;var gf=Wo(Tn.Z,"Set");const co=gf;var rl=Wo(Tn.Z,"WeakMap");const jn=rl;var Ci="[object Map]",Ua="[object Object]",pi="[object Promise]",Vi="[object Set]",hs="[object WeakMap]",il="[object DataView]",Va=$o(In),pf=$o(_a),Er=$o(Ui),lo=$o(co),er=$o(jn),pr=dr.Z;(In&&pr(new In(new ArrayBuffer(1)))!=il||_a&&pr(new _a)!=Ci||Ui&&pr(Ui.resolve())!=pi||co&&pr(new co)!=Vi||jn&&pr(new jn)!=hs)&&(pr=function(a){var t=(0,dr.Z)(a),e=t==Ua?a.constructor:void 0,n=e?$o(e):"";if(n)switch(n){case Va:return il;case pf:return Ci;case Er:return pi;case lo:return Vi;case er:return hs}return t});const uo=pr;var ho=1,fo="[object Arguments]",mf="[object Array]",ol="[object Object]",vf=Object.prototype,yf=vf.hasOwnProperty;function fs(a,t,e,n,c,u){var f=wr(a),d=wr(t),v=f?mf:uo(a),b=d?mf:uo(t);v=v==fo?ol:v,b=b==fo?ol:b;var E=v==ol,S=b==ol,_=v==b;if(_&&Qo(a)){if(!Qo(t))return!1;f=!0,E=!1}if(_&&!E)return u||(u=new Jo),f||ts(a)?Ys(a,t,e,n,c,u):$g(a,t,v,e,n,c,u);if(!(e&ho)){var C=E&&yf.call(a,"__wrapped__"),D=S&&yf.call(t,"__wrapped__");if(C||D){var L=C?a.value():a,B=D?t.value():t;return u||(u=new Jo),c(L,B,e,n,u)}}return _?(u||(u=new Jo),Zg(a,t,e,n,c,u)):!1}const qg=fs;function zu(a,t,e,n,c){return a===t?!0:a==null||t==null||!(0,ar.Z)(a)&&!(0,ar.Z)(t)?a!==a&&t!==t:qg(a,t,e,n,zu,c)}const sl=zu;function Uu(a,t){return sl(a,t)}const mi=Uu;var bf="[object Map]",xf="[object Set]",Vu=Object.prototype,wf=Vu.hasOwnProperty;function Hu(a){if(a==null)return!0;if(ei(a)&&(wr(a)||typeof a=="string"||typeof a.splice=="function"||Qo(a)||ts(a)||Ki(a)))return!a.length;var t=uo(a);if(t==bf||t==xf)return!a.size;if(Ma(a))return!ao(a).length;for(var e in a)if(wf.call(a,e))return!1;return!0}const M=Hu;function G(a,t){for(var e=-1,n=a==null?0:a.length;++e<n&&t(a[e],e,a)!==!1;);return a}const tt=G;function wt(a,t){return a&&eo(t,gi(t),a)}const Dt=wt;function xt(a,t){return a&&eo(t,di(t),a)}const Tt=xt;function $t(a,t){return eo(a,Ti(a),t)}const Wt=$t;var Kt=Object.getOwnPropertySymbols,Yt=Kt?function(a){for(var t=[];a;)Qi(t,Ti(a)),a=(0,wu.Z)(a);return t}:Io;const re=Yt;function ce(a,t){return eo(a,re(a),t)}const Zt=ce;function ie(a){return cs(a,di,re)}const ft=ie;var St=Object.prototype,ee=St.hasOwnProperty;function ue(a){var t=a.length,e=new a.constructor(t);return t&&typeof a[0]=="string"&&ee.call(a,"index")&&(e.index=a.index,e.input=a.input),e}const Ft=ue;function ge(a,t){var e=t?Gs(a.buffer):a.buffer;return new a.constructor(e,a.byteOffset,a.byteLength)}const Vt=ge;var se=/\w*$/;function zt(a){var t=new a.constructor(a.source,se.exec(a));return t.lastIndex=a.lastIndex,t}const oe=zt;var Pe=Eo.Z?Eo.Z.prototype:void 0,ze=Pe?Pe.valueOf:void 0;function ae(a){return ze?Object(ze.call(a)):{}}const ne=ae;var Gt="[object Boolean]",je="[object Date]",qe="[object Map]",we="[object Number]",on="[object RegExp]",He="[object Set]",en="[object String]",yn="[object Symbol]",nr="[object ArrayBuffer]",cn="[object DataView]",ln="[object Float32Array]",lr="[object Float64Array]",Pn="[object Int8Array]",Vn="[object Int16Array]",Jn="[object Int32Array]",Hn="[object Uint8Array]",Gn="[object Uint8ClampedArray]",xr="[object Uint16Array]",$n="[object Uint32Array]";function Ye(a,t,e){var n=a.constructor;switch(t){case nr:return Gs(a);case Gt:case je:return new n(+a);case cn:return Vt(a,e);case ln:case lr:case Pn:case Vn:case Jn:case Hn:case Gn:case xr:case $n:return vu(a,e);case qe:return new n;case we:case en:return new n(a);case on:return oe(a);case He:return new n;case yn:return ne(a)}}const _r=Ye;var _n="[object Map]";function Le(a){return(0,ar.Z)(a)&&uo(a)==_n}const nn=Le;var fn=Ai&&Ai.isMap,Kn=fn?Pa(fn):nn;const Oi=Kn;var No="[object Set]";function q(a){return(0,ar.Z)(a)&&uo(a)==No}const Et=q;var vt=Ai&&Ai.isSet,me=vt?Pa(vt):Et;const an=me;var X=1,j=2,nt=4,ht="[object Arguments]",gt="[object Array]",ot="[object Boolean]",rt="[object Date]",lt="[object Error]",W="[object Function]",et="[object GeneratorFunction]",z="[object Map]",ut="[object Number]",mt="[object Object]",Pt="[object RegExp]",Rt="[object Set]",Mt="[object String]",Qt="[object Symbol]",Oe="[object WeakMap]",Je="[object ArrayBuffer]",ve="[object DataView]",ke="[object Float32Array]",$e="[object Float64Array]",bn="[object Int8Array]",zn="[object Int16Array]",Sr="[object Int32Array]",ds="[object Uint8Array]",Wr="[object Uint8ClampedArray]",Ef="[object Uint16Array]",Ii="[object Uint32Array]",Ln={};Ln[ht]=Ln[gt]=Ln[Je]=Ln[ve]=Ln[ot]=Ln[rt]=Ln[ke]=Ln[$e]=Ln[bn]=Ln[zn]=Ln[Sr]=Ln[z]=Ln[ut]=Ln[mt]=Ln[Pt]=Ln[Rt]=Ln[Mt]=Ln[Qt]=Ln[ds]=Ln[Wr]=Ln[Ef]=Ln[Ii]=!0,Ln[lt]=Ln[W]=Ln[Oe]=!1;function $u(a,t,e,n,c,u){var f,d=t&X,v=t&j,b=t&nt;if(e&&(f=c?e(a,n,c,u):e(a)),f!==void 0)return f;if(!Ue(a))return a;var E=wr(a);if(E){if(f=Ft(a),!d)return yu(a,f)}else{var S=uo(a),_=S==W||S==et;if(Qo(a))return Hh(a,d);if(S==mt||S==ht||_&&!c){if(f=v||_?{}:Gi(a),!d)return v?Zt(a,Tt(f,a)):Wt(a,Dt(f,a))}else{if(!Ln[S])return c?a:{};f=_r(a,S,d)}}u||(u=new Jo);var C=u.get(a);if(C)return C;u.set(a,f),an(a)?a.forEach(function(B){f.add($u(B,t,e,B,a,u))}):Oi(a)&&a.forEach(function(B,H){f.set(H,$u(B,t,e,H,a,u))});var D=b?v?ft:us:v?di:gi,L=E?void 0:D(a);return tt(L||a,function(B,H){L&&(H=B,B=a[H]),ks(f,H,$u(B,t,e,H,a,u))}),f}const vm=$u;var ym=4;function Bv(a){return vm(a,ym)}const _f=Bv;var gs=1,bm=4;function jv(a){return vm(a,gs|bm)}const ur=jv;var Yg=Object.prototype,Fv=Yg.hasOwnProperty,Gv=zi(function(a,t){a=Object(a);var e=-1,n=t.length,c=n>2?t[2]:void 0;for(c&&qs(t[0],t[1],c)&&(n=1);++e<n;)for(var u=t[e],f=di(u),d=-1,v=f.length;++d<v;){var b=f[d],E=a[b];(E===void 0||Zo(E,Yg[b])&&!Fv.call(a,b))&&(a[b]=u[b])}return a});const Jg=Gv;function Kg(a,t,e,n,c,u){return Ue(a)&&Ue(t)&&(u.set(t,a),qc(a,t,void 0,Kg,u),u.delete(t)),a}const xm=Kg;var zv=ku(function(a,t,e,n){qc(a,t,e,n)});const Uv=zv;var wm=zi(function(a){return a.push(void 0,xm),Dh(Uv,void 0,a)});const Qg=wm;function Em(a,...t){t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(a.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))})})}const Vv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(a[e]=t[e])};function _m(a,t){Vv(a,t);function e(){this.constructor=a}a.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}class Hv{}const tp=/^\s*class\s+/.test(`${Hv}`)||/^\s*class\s*\{/.test(`${class{}}`);function al(a,t){let e;return tp?e=class extends t{}:(e=function(){return t.apply(this,arguments)},_m(e,t)),Object.defineProperty(e,"name",{value:a}),e}function ep(a,t){return a!=null?a:t}function Sm(a,t,e){const n=a!=null?a[t]:null;return e!==void 0?ep(n,e):n}function Am(a,t,e){let n=a!=null?a[t]:null;return n==null||(n=+n,Number.isNaN(n)||!Number.isFinite(n))?e:n}function Tm(a,t,e){const n=a!=null?a[t]:null;return n==null?e:!!n}function np(a){return a==="__proto__"}function Sf(a,t,e="/"){let n;const c=Array.isArray(t)?t:t.split(e);if(c.length)for(n=a;c.length;){const u=c.shift();if(Object(n)===n&&u&&u in n)n=n[u];else return}return n}function ia(a,t,e,n="/"){const c=Array.isArray(t)?t:t.split(n),u=c.pop();if(u&&!np(u)){let f=a;c.forEach(d=>{np(d)||(f[d]==null&&(f[d]={}),f=f[d])}),f[u]=e}return a}function rp(a,t,e="/"){const n=Array.isArray(t)?t.slice():t.split(e),c=n.pop();if(c)if(n.length>0){const u=Sf(a,n);u&&delete u[c]}else delete a[c];return a}function Cm(a,t="/",e){const n={};Object.keys(a).forEach(c=>{const u=a[c];let f=typeof u=="object"||Array.isArray(u);if(f&&e&&e(u)&&(f=!1),f){const d=Cm(u,t,e);Object.keys(d).forEach(v=>{n[c+t+v]=d[v]})}else n[c]=u});for(const c in a)Object.prototype.hasOwnProperty.call(a,c);return n}var $v=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class vi extends ma{dispose(){this.off()}}$v([fe.dispose()],vi.prototype,"dispose",null),function(a){a.dispose=fe.dispose}(vi||(vi={})),Em(vi,fe);class Wv extends null{get disabled(){return this._disabled===!0}enable(){delete this._disabled}disable(){this._disabled=!0}}function Xv(a,t,e,n){for(var c=a.length,u=e+(n?1:-1);n?u--:++u<c;)if(t(a[u],u,a))return u;return-1}const ip=Xv;function Zv(a){return a!==a}const Om=Zv;function Im(a,t,e){for(var n=e-1,c=a.length;++n<c;)if(a[n]===t)return n;return-1}const qv=Im;function Yv(a,t,e){return t===t?qv(a,t,e):ip(a,Om,e)}const Mm=Yv;function Af(a,t){var e=a==null?0:a.length;return!!e&&Mm(a,t,0)>-1}const op=Af;function Jv(a,t,e){for(var n=-1,c=a==null?0:a.length;++n<c;)if(e(t,a[n]))return!0;return!1}const Nm=Jv;function Kv(){}const Qv=Kv;var ty=1/0,ey=co&&1/io(new co([,-0]))[1]==ty?function(a){return new co(a)}:Qv;const ny=ey;var ry=200;function Pm(a,t,e){var n=-1,c=op,u=a.length,f=!0,d=[],v=d;if(e)f=!1,c=Nm;else if(u>=ry){var b=t?null:ny(a);if(b)return io(b);f=!1,c=Gr,v=new os}else v=t?[]:d;t:for(;++n<u;){var E=a[n],S=t?t(E):E;if(E=e||E!==0?E:0,f&&S===S){for(var _=v.length;_--;)if(v[_]===S)continue t;t&&v.push(S),d.push(E)}else c(v,S,e)||(v!==d&&v.push(S),d.push(E))}return d}const Dm=Pm;function iy(a){return a&&a.length?Dm(a):[]}const Wu=iy;var Rm=zi(function(a){return Dm(Lc(a,1,Na,!0))});const _e=Rm;var sp=4294967295,Sn=sp-1,Lm=Math.floor,km=Math.min;function Xu(a,t,e,n){var c=0,u=a==null?0:a.length;if(u===0)return 0;t=e(t);for(var f=t!==t,d=t===null,v=Ir(t),b=t===void 0;c<u;){var E=Lm((c+u)/2),S=e(a[E]),_=S!==void 0,C=S===null,D=S===S,L=Ir(S);if(f)var B=n||D;else b?B=D&&(n||_):d?B=D&&_&&(n||!C):v?B=D&&_&&!C&&(n||!L):C||L?B=!1:B=n?S<=t:S<t;B?c=E+1:u=E}return km(u,Sn)}const Bm=Xu;var ap=4294967295,jm=ap>>>1;function oy(a,t,e){var n=0,c=a==null?n:a.length;if(typeof t=="number"&&t===t&&c<=jm){for(;n<c;){var u=n+c>>>1,f=a[u];f!==null&&!Ir(f)&&(e?f<=t:f<t)?n=u+1:c=u}return c}return Bm(a,t,So,e)}const sy=oy;function ay(a,t){return sy(a,t)}const cy=ay;var Fm=1,Hi=2;function Gm(a,t,e,n){var c=e.length,u=c,f=!n;if(a==null)return!u;for(a=Object(a);c--;){var d=e[c];if(f&&d[2]?d[1]!==a[d[0]]:!(d[0]in a))return!1}for(;++c<u;){d=e[c];var v=d[0],b=a[v],E=d[1];if(f&&d[2]){if(b===void 0&&!(v in a))return!1}else{var S=new Jo;if(n)var _=n(b,E,v,a,t,S);if(!(_===void 0?sl(E,b,Fm|Hi,n,S):_))return!1}}return!0}const ly=Gm;function uy(a){return a===a&&!Ue(a)}const cp=uy;function hy(a){for(var t=gi(a),e=t.length;e--;){var n=t[e],c=a[n];t[e]=[n,c,cp(c)]}return t}const fy=hy;function dy(a,t){return function(e){return e==null?!1:e[a]===t&&(t!==void 0||a in Object(e))}}const Tf=dy;function zm(a){var t=fy(a);return t.length==1&&t[0][2]?Tf(t[0][0],t[0][1]):function(e){return e===a||ly(e,a,t)}}const Cf=zm;function Um(a,t,e){var n=a==null?void 0:Ta(a,t);return n===void 0?e:n}const Vm=Um;var Of=1,gy=2;function go(a,t){return zl(a)&&cp(t)?Tf(ti(a),t):function(e){var n=Vm(e,a);return n===void 0&&n===t?_i(e,a):sl(t,n,Of|gy)}}const py=go;function Zu(a){return function(t){return t==null?void 0:t[a]}}const Hm=Zu;function my(a){return function(t){return Ta(t,a)}}const vy=my;function yy(a){return zl(a)?Hm(ti(a)):vy(a)}const by=yy;function xy(a){return typeof a=="function"?a:a==null?So:typeof a=="object"?wr(a)?py(a[0],a[1]):Cf(a):by(a)}const lp=xy;function wy(a,t,e){return Bm(a,t,lp(e,2))}const Ey=wy;function _y(a,t){return a&&bg(a,t,gi)}const If=_y;function Sy(a,t){return function(e,n){if(e==null)return e;if(!ei(e))return a(e,n);for(var c=e.length,u=t?c:-1,f=Object(e);(t?u--:++u<c)&&n(f[u],u,f)!==!1;);return e}}var Ay=Sy(If);const up=Ay;function Ty(a,t){var e=-1,n=ei(a)?Array(a.length):[];return up(a,function(c,u,f){n[++e]=t(c,u,f)}),n}const Cy=Ty;function Oy(a,t){var e=a.length;for(a.sort(t);e--;)a[e]=a[e].value;return a}const hp=Oy;function Iy(a,t){if(a!==t){var e=a!==void 0,n=a===null,c=a===a,u=Ir(a),f=t!==void 0,d=t===null,v=t===t,b=Ir(t);if(!d&&!b&&!u&&a>t||u&&f&&v&&!d&&!b||n&&f&&v||!e&&v||!c)return 1;if(!n&&!u&&!b&&a<t||b&&e&&c&&!n&&!u||d&&e&&c||!f&&c||!v)return-1}return 0}const My=Iy;function fp(a,t,e){for(var n=-1,c=a.criteria,u=t.criteria,f=c.length,d=e.length;++n<f;){var v=My(c[n],u[n]);if(v){if(n>=d)return v;var b=e[n];return v*(b=="desc"?-1:1)}}return a.index-t.index}const Ny=fp;function Py(a,t,e){t.length?t=Bi(t,function(u){return wr(u)?function(f){return Ta(f,u.length===1?u[0]:u)}:u}):t=[So];var n=-1;t=Bi(t,Pa(lp));var c=Cy(a,function(u,f,d){var v=Bi(t,function(b){return b(u)});return{criteria:v,index:++n,value:u}});return hp(c,function(u,f){return Ny(u,f,e)})}const $m=Py;var Dy=zi(function(a,t){if(a==null)return[];var e=t.length;return e>1&&qs(a,t[0],t[1])?t=[]:e>2&&qs(t[0],t[1],t[2])&&(t=[t[0]]),$m(a,Lc(t,1),[])});const Ry=Dy;function Ly(a,t,e,n){for(var c=-1,u=a==null?0:a.length;++c<u;){var f=a[c];t(n,f,e(f),a)}return n}const dp=Ly;function ky(a,t,e,n){return up(a,function(c,u,f){t(n,c,e(c),f)}),n}const By=ky;function jy(a,t){return function(e,n){var c=wr(e)?dp:By,u=t?t():{};return c(e,a,lp(n,2),u)}}const Fy=jy;var Wm=Object.prototype,Gy=Wm.hasOwnProperty,zy=Fy(function(a,t,e){Gy.call(a,e)?a[e].push(t):_o(a,e,[t])});const Xm=zy;var Uy=200;function Vy(a,t,e,n){var c=-1,u=op,f=!0,d=a.length,v=[],b=t.length;if(!d)return v;e&&(t=Bi(t,Pa(e))),n?(u=Nm,f=!1):t.length>=Uy&&(u=Gr,f=!1,t=new os(t));t:for(;++c<d;){var E=a[c],S=e==null?E:e(E);if(E=n||E!==0?E:0,f&&S===S){for(var _=b;_--;)if(t[_]===S)continue t;v.push(E)}else u(t,S,n)||v.push(E)}return v}const Hy=Vy;var $y=zi(function(a,t){return Na(a)?Hy(a,Lc(t,1,Na,!0)):[]});const Wy=$y;function Xy(a,t,e){for(var n=-1,c=a.length;++n<c;){var u=a[n],f=t(u);if(f!=null&&(d===void 0?f===f&&!Ir(f):e(f,d)))var d=f,v=u}return v}const Zy=Xy;function qy(a,t){return a>t}const Yy=qy;function Jy(a){return a&&a.length?Zy(a,So,Yy):void 0}const Ky=Jy;var Qy=0;function tb(a){var t=++Qy;return ji(a)+t}const Ux=tb;function eb(a,t,e,n){var c=-1,u=a==null?0:a.length;for(n&&u&&(e=a[++c]);++c<u;)e=t(e,a[c],c,a);return e}const nb=eb;function Mf(a){return function(t){return a==null?void 0:a[t]}}const rb=Mf;var it={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},ib=rb(it);const Nf=ib;var Zm=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ob="\\u0300-\\u036f",sb="\\ufe20-\\ufe2f",ab="\\u20d0-\\u20ff",cb=ob+sb+ab,gp="["+cb+"]",pp=RegExp(gp,"g");function qm(a){return a=ji(a),a&&a.replace(Zm,Nf).replace(pp,"")}const Ym=qm;var zr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Jm(a){return a.match(zr)||[]}const Km=Jm;var Qm=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function t0(a){return Qm.test(a)}const e0=t0;var n0="\\ud800-\\udfff",Pf="\\u0300-\\u036f",r0="\\ufe20-\\ufe2f",lb="\\u20d0-\\u20ff",ub=Pf+r0+lb,i0="\\u2700-\\u27bf",o0="a-z\\xdf-\\xf6\\xf8-\\xff",hb="\\xac\\xb1\\xd7\\xf7",fb="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",db="\\u2000-\\u206f",gb=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",s0="A-Z\\xc0-\\xd6\\xd8-\\xde",Ha="\\ufe0e\\ufe0f",Df=hb+fb+db+gb,mp="['\u2019]",Rf="["+Df+"]",a0="["+ub+"]",vp="\\d+",c0="["+i0+"]",yp="["+o0+"]",bp="[^"+n0+Df+vp+i0+o0+s0+"]",l0="\\ud83c[\\udffb-\\udfff]",pb="(?:"+a0+"|"+l0+")",mb="[^"+n0+"]",xp="(?:\\ud83c[\\udde6-\\uddff]){2}",u0="[\\ud800-\\udbff][\\udc00-\\udfff]",$a="["+s0+"]",h0="\\u200d",f0="(?:"+yp+"|"+bp+")",d0="(?:"+$a+"|"+bp+")",wp="(?:"+mp+"(?:d|ll|m|re|s|t|ve))?",Ep="(?:"+mp+"(?:D|LL|M|RE|S|T|VE))?",_p=pb+"?",Lf="["+Ha+"]?",Sp="(?:"+h0+"(?:"+[mb,xp,u0].join("|")+")"+Lf+_p+")*",vb="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",yb="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bb=Lf+_p+Sp,xb="(?:"+[c0,xp,u0].join("|")+")"+bb,wb=RegExp([$a+"?"+yp+"+"+wp+"(?="+[Rf,$a,"$"].join("|")+")",d0+"+"+Ep+"(?="+[Rf,$a+f0,"$"].join("|")+")",$a+"?"+f0+"+"+wp,$a+"+"+Ep,yb,vb,vp,xb].join("|"),"g");function Eb(a){return a.match(wb)||[]}const g0=Eb;function _b(a,t,e){return a=ji(a),t=e?void 0:t,t===void 0?e0(a)?g0(a):Km(a):a.match(t)||[]}const Sb=_b;var Ab="['\u2019]",Tb=RegExp(Ab,"g");function Cb(a){return function(t){return nb(Sb(Ym(t).replace(Tb,"")),a,"")}}const kf=Cb;function p0(a,t,e){var n=-1,c=a.length;t<0&&(t=-t>c?0:c+t),e=e>c?c:e,e<0&&(e+=c),c=t>e?0:e-t>>>0,t>>>=0;for(var u=Array(c);++n<c;)u[n]=a[n+t];return u}const Ob=p0;function m0(a,t,e){var n=a.length;return e=e===void 0?n:e,!t&&e>=n?a:Ob(a,t,e)}const Ib=m0;var Mb="\\ud800-\\udfff",Nb="\\u0300-\\u036f",Pb="\\ufe20-\\ufe2f",v0="\\u20d0-\\u20ff",Db=Nb+Pb+v0,Rb="\\ufe0e\\ufe0f",Lb="\\u200d",kb=RegExp("["+Lb+Mb+Db+Rb+"]");function Bb(a){return kb.test(a)}const y0=Bb;function jb(a){return a.split("")}const Fb=jb;var b0="\\ud800-\\udfff",Gb="\\u0300-\\u036f",oa="\\ufe20-\\ufe2f",zb="\\u20d0-\\u20ff",Ub=Gb+oa+zb,Vb="\\ufe0e\\ufe0f",Hb="["+b0+"]",Ap="["+Ub+"]",Tp="\\ud83c[\\udffb-\\udfff]",$b="(?:"+Ap+"|"+Tp+")",x0="[^"+b0+"]",w0="(?:\\ud83c[\\udde6-\\uddff]){2}",E0="[\\ud800-\\udbff][\\udc00-\\udfff]",Cp="\\u200d",Bf=$b+"?",_0="["+Vb+"]?",S0="(?:"+Cp+"(?:"+[x0,w0,E0].join("|")+")"+_0+Bf+")*",Wb=_0+Bf+S0,Xb="(?:"+[x0+Ap+"?",Ap,w0,E0,Hb].join("|")+")",Zb=RegExp(Tp+"(?="+Tp+")|"+Xb+Wb,"g");function qb(a){return a.match(Zb)||[]}const Yb=qb;function Jb(a){return y0(a)?Yb(a):Fb(a)}const Kb=Jb;function A0(a){return function(t){t=ji(t);var e=y0(t)?Kb(t):void 0,n=e?e[0]:t.charAt(0),c=e?Ib(e,1).join(""):t.slice(1);return n[a]()+c}}const Op=A0;var Ip=Op("toUpperCase");const qu=Ip;var Qb=kf(function(a,t,e){return a+(e?" ":"")+qu(t)});const Mp=Qb;function tx(a){return qu(ji(a).toLowerCase())}const jf=tx;var T0=kf(function(a,t,e){return t=t.toLowerCase(),a+(e?jf(t):t)});const cl=T0;var C0=kf(function(a,t,e){return a+(e?" ":"")+t.toUpperCase()});const O0=C0;var Np=kf(function(a,t,e){return a+(e?" ":"")+t.toLowerCase()});const Ff=Np;var ex=Op("toLowerCase");const nx=ex,sa=a=>{const t=Object.create(null);return e=>t[e]||(t[e]=a(e))},Pp=sa(a=>a.replace(/\B([A-Z])/g,"-$1").toLowerCase()),Gf=sa(a=>Mp(cl(a)).replace(/ /g,"")),Vx=sa(a=>O0(a).replace(/ /g,"_")),Hx=sa(a=>Ff(a).replace(/ /g,".")),$x=sa(a=>Ff(a).replace(/ /g,"/")),Dp=sa(a=>qu(Ff(a))),Wx=sa(a=>Mp(cl(a)));function Rp(a){let t=2166136261,e=!1,n=a;for(let c=0,u=n.length;c<u;c+=1){let f=n.charCodeAt(c);f>127&&!e&&(n=unescape(encodeURIComponent(n)),f=n.charCodeAt(c),e=!0),t^=f,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function Yu(){let a="";const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let e=0,n=t.length;e<n;e+=1){const c=t[e],u=Math.random()*16|0,f=c==="x"?u:c==="y"?u&3|8:c;a+=f.toString(16)}return a}function zf(a,t,e){const n=Math.min(2,Math.floor(a.length*.34));let c=Math.floor(a.length*.4)+1,u,f=!1;const d=a.toLowerCase();for(const v of t){const b=e(v);if(b!==void 0&&Math.abs(b.length-d.length)<=n){const E=b.toLowerCase();if(E===d){if(b===a)continue;return v}if(f||b.length<3)continue;const S=I0(d,E,c-1);if(S===void 0)continue;S<3?(f=!0,u=v):(c=S,u=v)}}return u}function I0(a,t,e){let n=new Array(t.length+1),c=new Array(t.length+1);const u=e+1;for(let d=0;d<=t.length;d+=1)n[d]=d;for(let d=1;d<=a.length;d+=1){const v=a.charCodeAt(d-1),b=d>e?d-e:1,E=t.length>e+d?e+d:t.length;c[0]=d;let S=d;for(let C=1;C<b;C+=1)c[C]=u;for(let C=b;C<=E;C+=1){const D=v===t.charCodeAt(C-1)?n[C-1]:Math.min(n[C]+1,c[C-1]+1,n[C-1]+2);c[C]=D,S=Math.min(S,D)}for(let C=E+1;C<=t.length;C+=1)c[C]=u;if(S>e)return;const _=n;n=c,c=_}const f=n[t.length];return f>e?void 0:f}var rx="[object Number]";function M0(a){return typeof a=="number"||(0,ar.Z)(a)&&(0,dr.Z)(a)==rx}const Lp=M0;function ix(a,t,e){return a===a&&(e!==void 0&&(a=a<=e?a:e),t!==void 0&&(a=a>=t?a:t)),a}const ox=ix;function po(a,t,e){return e===void 0&&(e=t,t=void 0),e!==void 0&&(e=wi(e),e=e===e?e:0),t!==void 0&&(t=wi(t),t=t===t?t:0),ox(wi(a),t,e)}const hr=po;function ll(a,t){return(a%t+t)%t}function ul(a,t){if(t==null)t=a==null?1:a,a=0;else if(t<a){const e=a;a=t,t=e}return Math.floor(Math.random()*(t-a+1)+a)}function Po(a){return typeof a=="string"&&a.slice(-1)==="%"}function $i(a,t){if(a==null)return 0;let e;if(typeof a=="string"){if(e=parseFloat(a),Po(a)&&(e/=100,Number.isFinite(e)))return e*t}else e=a;return Number.isFinite(e)?e>0&&e<1?e*t:e:0}function sx(a,t){function e(f){const d=new RegExp(`(?:\\d+(?:\\.\\d+)*)(${f})$`).exec(a);return d?d[1]:null}const n=parseFloat(a);if(Number.isNaN(n))return null;let c;if(t==null)c="[A-Za-z]*";else if(Array.isArray(t)){if(t.length===0)return null;c=t.join("|")}else typeof t=="string"&&(c=t);const u=e(c);return u===null?null:{unit:u,value:n}}function ps(a){if(typeof a=="object"){let e=0,n=0,c=0,u=0;return a.vertical!=null&&Number.isFinite(a.vertical)&&(n=u=a.vertical),a.horizontal!=null&&Number.isFinite(a.horizontal)&&(c=e=a.horizontal),a.left!=null&&Number.isFinite(a.left)&&(e=a.left),a.top!=null&&Number.isFinite(a.top)&&(n=a.top),a.right!=null&&Number.isFinite(a.right)&&(c=a.right),a.bottom!=null&&Number.isFinite(a.bottom)&&(u=a.bottom),{top:n,right:c,bottom:u,left:e}}let t=0;return a!=null&&Number.isFinite(a)&&(t=a),{top:t,right:t,bottom:t,left:t}}let hl=!1,Ju=!1,N0=!1,P0=!1,D0=!1,R0=!1,L0=!1,k0=!1,B0=!1,j0=!1,F0=!1,G0=!1,z0=!1,U0=!1,V0=!1,H0=!1;if(typeof navigator=="object"){const a=navigator.userAgent;hl=a.indexOf("Macintosh")>=0,Ju=!!a.match(/(iPad|iPhone|iPod)/g),N0=a.indexOf("Windows")>=0,P0=a.indexOf("MSIE")>=0,D0=!!a.match(/Trident\/7\./),R0=!!a.match(/Edge\//),L0=a.indexOf("Mozilla/")>=0&&a.indexOf("MSIE")<0&&a.indexOf("Edge/")<0,B0=a.indexOf("Chrome/")>=0&&a.indexOf("Edge/")<0,j0=a.indexOf("Opera/")>=0||a.indexOf("OPR/")>=0,F0=a.indexOf("Firefox/")>=0,G0=a.indexOf("AppleWebKit/")>=0&&a.indexOf("Chrome/")<0&&a.indexOf("Edge/")<0,typeof document=="object"&&(H0=!document.createElementNS||`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`!="[object SVGForeignObjectElement]"||a.indexOf("Opera/")>=0)}if(typeof window=="object"&&(k0=window.chrome!=null&&window.chrome.app!=null&&window.chrome.app.runtime!=null,U0=window.PointerEvent!=null&&!hl),typeof document=="object"){z0="ontouchstart"in document.documentElement;try{const a=Object.defineProperty({},"passive",{get(){V0=!0}}),t=document.createElement("div");t.addEventListener&&t.addEventListener("click",()=>{},a)}catch(a){}}var ms;(function(a){a.IS_MAC=hl,a.IS_IOS=Ju,a.IS_WINDOWS=N0,a.IS_IE=P0,a.IS_IE11=D0,a.IS_EDGE=R0,a.IS_NETSCAPE=L0,a.IS_CHROME_APP=k0,a.IS_CHROME=B0,a.IS_OPERA=j0,a.IS_FIREFOX=F0,a.IS_SAFARI=G0,a.SUPPORT_TOUCH=z0,a.SUPPORT_POINTER=U0,a.SUPPORT_PASSIVE=V0,a.NO_FOREIGNOBJECT=H0,a.SUPPORT_FOREIGNOBJECT=!a.NO_FOREIGNOBJECT})(ms||(ms={})),function(a){function t(){const u=window.module;return u!=null&&u.hot!=null&&u.hot.status!=null?u.hot.status():"unkonwn"}a.getHMRStatus=t;function e(){return t()==="apply"}a.isApplyingHMR=e;const n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function c(u){const f=document.createElement(n[u]||"div"),d=`on${u}`;let v=d in f;return v||(f.setAttribute(d,"return;"),v=typeof f[d]=="function"),v}a.isEventSupported=c}(ms||(ms={}));const kp=/[\t\r\n\f]/g,Bp=/\S+/g,fl=a=>` ${a} `;function dn(a){return a&&a.getAttribute&&a.getAttribute("class")||""}function aa(a,t){if(a==null||t==null)return!1;const e=fl(dn(a)),n=fl(t);return a.nodeType===1?e.replace(kp," ").includes(n):!1}function xe(a,t){if(!(a==null||t==null)){if(typeof t=="function")return xe(a,t(dn(a)));if(typeof t=="string"&&a.nodeType===1){const e=t.match(Bp)||[],n=fl(dn(a)).replace(kp," ");let c=e.reduce((u,f)=>u.indexOf(fl(f))<0?`${u}${f} `:u,n);c=c.trim(),n!==c&&a.setAttribute("class",c)}}}function Mi(a,t){if(a!=null){if(typeof t=="function")return Mi(a,t(dn(a)));if((!t||typeof t=="string")&&a.nodeType===1){const e=(t||"").match(Bp)||[],n=fl(dn(a)).replace(kp," ");let c=e.reduce((u,f)=>{const d=fl(f);return u.indexOf(d)>-1?u.replace(d," "):u},n);c=t?c.trim():"",n!==c&&a.setAttribute("class",c)}}}function ca(a,t,e){if(!(a==null||t==null)){if(e!=null&&typeof t=="string"){e?xe(a,t):Mi(a,t);return}if(typeof t=="function")return ca(a,t(dn(a),e),e);typeof t=="string"&&(t.match(Bp)||[]).forEach(c=>{aa(a,c)?Mi(a,c):xe(a,c)})}}let jp=0;function $0(){return jp+=1,`v${jp}`}function Uf(a){return(a.id==null||a.id==="")&&(a.id=$0()),a.id}function vs(a){return a==null?!1:typeof a.getScreenCTM=="function"&&a instanceof SVGElement}const Dr={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},Fp="1.1";function Vf(a,t=document){return t.createElement(a)}function Hf(a,t=Dr.xhtml,e=document){return e.createElementNS(t,a)}function Ni(a,t=document){return Hf(a,Dr.svg,t)}function dl(a){if(a){const e=`<svg xmlns="${Dr.svg}" xmlns:xlink="${Dr.xlink}" version="${Fp}">${a}</svg>`,{documentElement:n}=W0(e,{async:!1});return n}const t=document.createElementNS(Dr.svg,"svg");return t.setAttributeNS(Dr.xmlns,"xmlns:xlink",Dr.xlink),t.setAttribute("version",Fp),t}function W0(a,t={}){let e;try{const n=new DOMParser;if(t.async!=null){const c=n;c.async=t.async}e=n.parseFromString(a,t.mimeType||"text/xml")}catch(n){e=void 0}if(!e||e.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${a}`);return e}function X0(a,t=!0){const e=a.nodeName;return t?e.toLowerCase():e.toUpperCase()}function mo(a){let t=0,e=a.previousSibling;for(;e;)e.nodeType===1&&(t+=1),e=e.previousSibling;return t}function pe(a,t){return a.querySelectorAll(t)}function Wi(a,t){return a.querySelector(t)}function Pi(a,t,e){const n=a.ownerSVGElement;let c=a.parentNode;for(;c&&c!==e&&c!==n;){if(aa(c,t))return c;c=c.parentNode}return null}function Gp(a,t){const e=t&&t.parentNode;return a===e||!!(e&&e.nodeType===1&&a.compareDocumentPosition(e)&16)}function Do(a){a&&(Array.isArray(a)?a:[a]).forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}function gl(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function pl(a,t){(Array.isArray(t)?t:[t]).forEach(n=>{n!=null&&a.appendChild(n)})}function Z0(a,t){const e=a.firstChild;return e?$f(e,t):pl(a,t)}function $f(a,t){const e=a.parentNode;e&&(Array.isArray(t)?t:[t]).forEach(c=>{c!=null&&e.insertBefore(c,a)})}function ax(a,t){const e=a.parentNode;e&&(Array.isArray(t)?t:[t]).forEach(c=>{c!=null&&e.insertBefore(c,a.nextSibling)})}function Xr(a,t){t!=null&&t.appendChild(a)}function cx(a){return!!a&&a.nodeType===1}function zp(a){try{return a instanceof HTMLElement}catch(t){return typeof a=="object"&&a.nodeType===1&&typeof a.style=="object"&&typeof a.ownerDocument=="object"}}function q0(a,t){const e=[];let n=a.firstChild;for(;n;n=n.nextSibling)n.nodeType===1&&(!t||aa(n,t))&&e.push(n);return e}const Y0=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function lx(a,t){return a.getAttribute(t)}function qt(a,t){const e=Xf(t);e.ns?a.hasAttributeNS(e.ns,e.local)&&a.removeAttributeNS(e.ns,e.local):a.hasAttribute(t)&&a.removeAttribute(t)}function Wf(a,t,e){if(e==null)return qt(a,t);const n=Xf(t);n.ns&&typeof e=="string"?a.setAttributeNS(n.ns,t,e):t==="id"?a.id=`${e}`:a.setAttribute(t,`${e}`)}function J0(a,t){Object.keys(t).forEach(e=>{Wf(a,e,t[e])})}function Dn(a,t,e){if(t==null){const n=a.attributes,c={};for(let u=0;u<n.length;u+=1)c[n[u].name]=n[u].value;return c}if(typeof t=="string"&&e===void 0)return a.getAttribute(t);typeof t=="object"?J0(a,t):Wf(a,t,e)}function Xf(a){if(a.indexOf(":")!==-1){const t=a.split(":");return{ns:Dr[t[0]],local:t[1]}}return{ns:null,local:a}}function vo(a){const t={};return Object.keys(a).forEach(e=>{const n=Y0.includes(e)?e:Pp(e);t[n]=a[e]}),t}function ys(a){const t={};return a.split(";").forEach(n=>{const c=n.trim();if(c){const u=c.split("=");u.length&&(t[u[0].trim()]=u[1]?u[1].trim():"")}}),t}function Zf(a,t){return Object.keys(t).forEach(e=>{if(e==="class")a[e]=a[e]?`${a[e]} ${t[e]}`:t[e];else if(e==="style"){const n=typeof a[e]=="object",c=typeof t[e]=="object";let u,f;n&&c?(u=a[e],f=t[e]):n?(u=a[e],f=ys(t[e])):c?(u=ys(a[e]),f=t[e]):(u=ys(a[e]),f=ys(t[e])),a[e]=Zf(u,f)}else a[e]=t[e]}),a}function ux(a,t,e={}){const n=e.offset||0,c=[],u=[];let f,d,v=null;for(let b=0;b<a.length;b+=1){f=u[b]=a[b];for(let E=0,S=t.length;E<S;E+=1){const _=t[E],C=_.start+n,D=_.end+n;b>=C&&b<D&&(typeof f=="string"?f=u[b]={t:a[b],attrs:_.attrs}:f.attrs=Zf(Zf({},f.attrs),_.attrs),e.includeAnnotationIndices&&(f.annotations==null&&(f.annotations=[]),f.annotations.push(E)))}d=u[b-1],d?Ue(f)&&Ue(d)?(v=v,JSON.stringify(f.attrs)===JSON.stringify(d.attrs)?v.t+=f.t:(c.push(v),v=f)):Ue(f)||Ue(d)?(v=v,c.push(v),v=f):v=(v||"")+f:v=f}return v!=null&&c.push(v),c}function hx(a,t){return a?a.filter(e=>e.start<t&&t<=e.end):[]}function fx(a,t,e){return a?a.filter(n=>t>=n.start&&t<n.end||e>n.start&&e<=n.end||n.start>=t&&n.end<e):[]}function Xx(a,t,e){return a&&a.forEach(n=>{n.start<t&&n.end>=t?n.end+=e:n.start>=t&&(n.start+=e,n.end+=e)}),a}function dx(a){return a.replace(/ /g,"\xA0")}var Up;(function(a){function t(b){const E="data:";return b.substr(0,E.length)===E}a.isDataUrl=t;function e(b,E){if(!b||t(b)){setTimeout(()=>E(null,b));return}const S=()=>{E(new Error(`Failed to load image: ${b}`))},_=window.FileReader?D=>{if(D.status===200){const L=new FileReader;L.onload=B=>{const H=B.target.result;E(null,H)},L.onerror=S,L.readAsDataURL(D.response)}else S()}:D=>{const L=B=>{const J=[];for(let V=0;V<B.length;V+=32768)J.push(String.fromCharCode.apply(null,B.subarray(V,V+32768)));return J.join("")};if(D.status===200){let B=b.split(".").pop()||"png";B==="svg"&&(B="svg+xml");const H=`data:image/${B};base64,`,J=new Uint8Array(D.response),V=H+btoa(L(J));E(null,V)}else S()},C=new XMLHttpRequest;C.responseType=window.FileReader?"blob":"arraybuffer",C.open("GET",b,!0),C.addEventListener("error",S),C.addEventListener("load",()=>_(C)),C.send()}a.imageToDataUri=e;function n(b){let E=b.replace(/\s/g,"");E=decodeURIComponent(E);const S=E.indexOf(","),_=E.slice(0,S),C=_.split(":")[1].split(";")[0],D=E.slice(S+1);let L;_.indexOf("base64")>=0?L=atob(D):L=unescape(encodeURIComponent(D));const B=new Uint8Array(L.length);for(let H=0;H<L.length;H+=1)B[H]=L.charCodeAt(H);return new Blob([B],{type:C})}a.dataUriToBlob=n;function c(b,E){const S=window.navigator.msSaveBlob;if(S)S(b,E);else{const _=window.URL.createObjectURL(b),C=document.createElement("a");C.href=_,C.download=E,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(_)}}a.downloadBlob=c;function u(b,E){const S=n(b);c(S,E)}a.downloadDataUri=u;function f(b){const E=b.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return E&&E[2]?E[2].replace(/\s+/," ").split(" "):null}function d(b){const E=parseFloat(b);return Number.isNaN(E)?null:E}function v(b,E={}){let S=null;const _=V=>(S==null&&(S=f(b)),S!=null?d(S[V]):null),C=V=>{const ct=b.match(V);return ct&&ct[2]?d(ct[2]):null};let D=E.width;if(D==null&&(D=C(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),D==null&&(D=_(2)),D==null)throw new Error("Can not parse width from svg string");let L=E.height;if(L==null&&(L=C(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),L==null&&(L=_(3)),L==null)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(b).replace(/'/g,"%27").replace(/"/g,"%22")}`}a.svgToDataUrl=v})(Up||(Up={}));let Wa;const bs={px(a){return a},mm(a){return Wa*a},cm(a){return Wa*a*10},in(a){return Wa*a*25.4},pt(a){return Wa*(25.4*a/72)},pc(a){return Wa*(25.4*a/6)}};var ml;(function(a){function t(n,c,u){const f=document.createElement("div"),d=f.style;d.display="inline-block",d.position="absolute",d.left="-15000px",d.top="-15000px",d.width=n+(u||"px"),d.height=c+(u||"px"),document.body.appendChild(f);const v=f.getBoundingClientRect(),b={width:v.width||0,height:v.height||0};return document.body.removeChild(f),b}a.measure=t;function e(n,c){Wa==null&&(Wa=t("1","1","mm").width);const u=c?bs[c]:null;return u?u(n):n}a.toPx=e})(ml||(ml={}));const xs=/-(.)/g;function Xi(a){return a.replace(xs,(t,e)=>e.toUpperCase())}const Xa={},ws=["webkit","ms","moz","o"],vl=typeof document<"u"?document.createElement("div").style:{};function qf(a){for(let t=0;t<ws.length;t+=1){const e=ws[t]+a;if(e in vl)return e}return null}function Zi(a){const t=Xi(a);if(Xa[t]==null){const e=t.charAt(0).toUpperCase()+t.slice(1);Xa[t]=t in vl?t:qf(e)}return Xa[t]}function Za(a,t,e){const n=Zi(t);n!=null&&(a[n]=e),a[t]=e}function Ar(a,t){const e=a.ownerDocument&&a.ownerDocument.defaultView&&a.ownerDocument.defaultView.opener?a.ownerDocument.defaultView.getComputedStyle(a,null):window.getComputedStyle(a,null);return e&&t?e.getPropertyValue(t)||e[t]:e}function Ro(a){const t=Ar(a);return t!=null&&(t.overflow==="scroll"||t.overflow==="auto")}const Lo=function(){if(typeof document>"u")return function(){};const a=document;return a.selection?function(){a.selection.empty()}:window.getSelection?function(){const t=window.getSelection();t&&(t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges())}:function(){}}(),Yf={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function K0(a){return/^--/.test(a)}function yl(a,t,e){const n=window.getComputedStyle(a,null);return e?n.getPropertyValue(t)||void 0:n[t]||a.style[t]}function qa(a,t){return parseInt(yl(a,t),10)||0}function gx(a,t){return!Yf[a]&&typeof t=="number"?`${t}px`:t}function bl(a,t,e){if(typeof t=="string"){const n=K0(t);if(n||(t=Zi(t)),e===void 0)return yl(a,t,n);n||(e=gx(t,e));const c=a.style;n?c.setProperty(t,e):c[t]=e;return}for(const n in t)bl(a,n,t[n])}const Ku=new WeakMap;function Jf(a,t){const e=cl(t),n=Ku.get(a);if(n)return n[e]}function Q0(a,t,e){const n=cl(t),c=Ku.get(a);c?c[n]=e:Ku.set(a,{[n]:e})}function la(a,t,e){if(!t){const n={};return Object.keys(Ku).forEach(c=>{n[c]=Jf(a,c)}),n}if(typeof t=="string"){if(e===void 0)return Jf(a,t);Q0(a,t,e);return}for(const n in t)la(a,n,t[n])}const tv={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};function Qu(a,t,e){if(t){if(typeof t=="string"){if(t=tv[t]||t,arguments.length<3)return a[t];a[t]=e;return}for(const n in t)Qu(a,n,t[n])}}class sn{get[Symbol.toStringTag](){return sn.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(t){this.node.id=t}constructor(t,e,n){if(!t)throw new TypeError("Invalid element to create vector");let c;if(sn.isVector(t))c=t.node;else if(typeof t=="string")if(t.toLowerCase()==="svg")c=dl();else if(t[0]==="<"){const u=dl(t);c=document.importNode(u.firstChild,!0)}else c=document.createElementNS(Dr.svg,t);else c=t;this.node=c,e&&this.setAttributes(e),n&&this.append(n)}transform(t,e){return t==null?Es(this.node):(Es(this.node,t,e),this)}translate(t,e=0,n={}){return t==null?Xp(this.node):(Xp(this.node,t,e,n),this)}rotate(t,e,n,c={}){return t==null?rd(this.node):(rd(this.node,t,e,n,c),this)}scale(t,e){return t==null?id(this.node):(id(this.node,t,e),this)}getTransformToElement(t){const e=sn.toNode(t);return ha(this.node,e)}removeAttribute(t){return qt(this.node,t),this}getAttribute(t){return lx(this.node,t)}setAttribute(t,e){return Wf(this.node,t,e),this}setAttributes(t){return J0(this.node,t),this}attr(t,e){return t==null?Dn(this.node):typeof t=="string"&&e===void 0?Dn(this.node,t):(typeof t=="object"?Dn(this.node,t):Dn(this.node,t,e),this)}svg(){return this.node instanceof SVGSVGElement?this:sn.create(this.node.ownerSVGElement)}defs(){const t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?sn.create(e):sn.create("defs").appendTo(t)}text(t,e={}){return Qf(this.node,t,e),this}tagName(){return X0(this.node)}clone(){return sn.create(this.node.cloneNode(!0))}remove(){return Do(this.node),this}empty(){return gl(this.node),this}append(t){return pl(this.node,sn.toNodes(t)),this}appendTo(t){return Xr(this.node,sn.isVector(t)?t.node:t),this}prepend(t){return Z0(this.node,sn.toNodes(t)),this}before(t){return $f(this.node,sn.toNodes(t)),this}replace(t){return this.node.parentNode&&this.node.parentNode.replaceChild(sn.toNode(t),this.node),sn.create(t)}first(){return this.node.firstChild?sn.create(this.node.firstChild):null}last(){return this.node.lastChild?sn.create(this.node.lastChild):null}get(t){const e=this.node.childNodes[t];return e?sn.create(e):null}indexOf(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(sn.toNode(t))}find(t){const e=[],n=pe(this.node,t);if(n)for(let c=0,u=n.length;c<u;c+=1)e.push(sn.create(n[c]));return e}findOne(t){const e=Wi(this.node,t);return e?sn.create(e):null}findParentByClass(t,e){const n=Pi(this.node,t,e);return n?sn.create(n):null}matches(t){const e=this.node,n=this.node.matches,c=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return c&&c.call(e,t)}contains(t){return Gp(this.node,sn.isVector(t)?t.node:t)}wrap(t){const e=sn.create(t),n=this.node.parentNode;return n!=null&&n.insertBefore(e.node,this.node),e.append(this)}parent(t){let e=this;if(e.node.parentNode==null)return null;if(e=sn.create(e.node.parentNode),t==null)return e;do if(typeof t=="string"?e.matches(t):e instanceof t)return e;while(e=sn.create(e.node.parentNode));return e}children(){const t=this.node.childNodes,e=[];for(let n=0;n<t.length;n+=1)t[n].nodeType===1&&e.push(sn.create(t[n]));return e}eachChild(t,e){const n=this.children();for(let c=0,u=n.length;c<u;c+=1)t.call(n[c],n[c],c,n),e&&n[c].eachChild(t,e);return this}index(){return mo(this.node)}hasClass(t){return aa(this.node,t)}addClass(t){return xe(this.node,t),this}removeClass(t){return Mi(this.node,t),this}toggleClass(t,e){return ca(this.node,t,e),this}toLocalPoint(t,e){return tc(this.node,t,e)}sample(t=1){return this.node instanceof SVGPathElement?rv(this.node,t):[]}toPath(){return sn.create(cv(this.node))}toPathData(){return _l(this.node)}}(function(a){a.toStringTag=`X6.${a.name}`;function t(f){if(f==null)return!1;if(f instanceof a)return!0;const d=f[Symbol.toStringTag],v=f;return(d==null||d===a.toStringTag)&&v.node instanceof SVGElement&&typeof v.sample=="function"&&typeof v.toPath=="function"}a.isVector=t;function e(f,d,v){return new a(f,d,v)}a.create=e;function n(f){if(f[0]==="<"){const d=dl(f),v=[];for(let b=0,E=d.childNodes.length;b<E;b+=1){const S=d.childNodes[b];v.push(e(document.importNode(S,!0)))}return v}return[e(f)]}a.createVectors=n;function c(f){return t(f)?f.node:f}a.toNode=c;function u(f){return Array.isArray(f)?f.map(d=>c(d)):[c(f)]}a.toNodes=u})(sn||(sn={}));function xl(a,t){const e=sn.create(t),n=sn.create("textPath"),c=a.d;if(c&&a["xlink:href"]===void 0){const u=sn.create("path").attr("d",c).appendTo(e.defs());n.attr("xlink:href",`#${u.id}`)}return typeof a=="object"&&n.attr(a),n.node}function px(a,t,e){const n=e.eol,c=e.baseSize,u=e.lineHeight;let f=0,d;const v={},b=t.length-1;for(let E=0;E<=b;E+=1){let S=t[E],_=null;if(typeof S=="object"){const C=S.attrs,D=sn.create("tspan",C);d=D.node;let L=S.t;n&&E===b&&(L+=n),d.textContent=L;const B=C.class;B&&D.addClass(B),e.includeAnnotationIndices&&D.attr("annotations",S.annotations.join(",")),_=parseFloat(C["font-size"]),_===void 0&&(_=c),_&&_>f&&(f=_)}else n&&E===b&&(S+=n),d=document.createTextNode(S||" "),c&&c>f&&(f=c);a.appendChild(d)}return f&&(v.maxFontSize=f),u?v.lineHeight=u:f&&(v.lineHeight=f*1.2),v}const ev=/em$/;function Kf(a,t){const e=parseFloat(a);return ev.test(a)?e*t:e}function nv(a,t,e,n){if(!Array.isArray(t))return 0;const c=t.length;if(!c)return 0;let u=t[0];const f=Kf(u.maxFontSize,e)||e;let d=0;const v=Kf(n,e);for(let S=1;S<c;S+=1){u=t[S];const _=Kf(u.lineHeight,e)||v;d+=_}const b=Kf(u.maxFontSize,e)||e;let E;switch(a){case"middle":E=f/2-.15*b-d/2;break;case"bottom":E=-(.25*b)-d;break;case"top":default:E=.8*f;break}return E}function Qf(a,t,e={}){t=dx(t);const n=e.eol;let c=e.textPath;const u=e.textVerticalAnchor,f=u==="middle"||u==="bottom"||u==="top";let d=e.x;d===void 0&&(d=a.getAttribute("x")||0);const v=e.includeAnnotationIndices;let b=e.annotations;b&&!Array.isArray(b)&&(b=[b]);const E=e.lineHeight,S=E==="auto",_=S?"1.5em":E||"1em";let C=!0;const D=a.childNodes;if(D.length===1){const be=D[0];be&&be.tagName.toUpperCase()==="TITLE"&&(C=!1)}C&&gl(a),Dn(a,{"xml:space":"preserve",display:t||e.displayEmpty?null:"none"});const L=Dn(a,"font-size");let B=parseFloat(L);B||(B=16,(f||b)&&!L&&Dn(a,"font-size",`${B}`));let H;c?(typeof c=="string"&&(c={d:c}),H=xl(c,a)):H=document.createDocumentFragment();let J,V=0,ct;const dt=t.split(`
`),At=[],le=dt.length-1;for(let be=0;be<=le;be+=1){J=_;let Re="v-line";const Ae=Ni("tspan");let Fe,sr=dt[be];if(sr)if(b){const On=ux(sr,b,{offset:-V,includeAnnotationIndices:v});Fe=px(Ae,On,{eol:be!==le&&n,baseSize:B,lineHeight:S?null:_,includeAnnotationIndices:v});const Bt=Fe.lineHeight;Bt&&S&&be!==0&&(J=Bt),be===0&&(ct=Fe.maxFontSize*.8)}else n&&be!==le&&(sr+=n),Ae.textContent=sr;else{Ae.textContent="-",Re+=" v-empty-line";const On=Ae.style;On.fillOpacity=0,On.strokeOpacity=0,b&&(Fe={})}Fe&&At.push(Fe),be>0&&Ae.setAttribute("dy",J),(be>0||c)&&Ae.setAttribute("x",d),Ae.className.baseVal=Re,H.appendChild(Ae),V+=sr.length+1}if(f)if(b)J=nv(u,At,B,_);else if(u==="top")J="0.8em";else{let be;switch(le>0?(be=parseFloat(_)||1,be*=le,ev.test(_)||(be/=B)):be=0,u){case"middle":J=`${.3-be/2}em`;break;case"bottom":J=`${-be-.3}em`;break;default:break}}else u===0?J="0em":u?J=u:(J=0,a.getAttribute("y")==null&&a.setAttribute("y",`${ct||"0.8em"}`));H.firstChild.setAttribute("dy",J),a.appendChild(H)}function wl(a,t={}){const e=document.createElement("canvas").getContext("2d");if(!a)return{width:0};const n=[],c=t["font-size"]?`${parseFloat(t["font-size"])}px`:"14px";return n.push(t["font-style"]||"normal"),n.push(t["font-variant"]||"normal"),n.push(t["font-weight"]||400),n.push(c),n.push(t["font-family"]||"sans-serif"),e.font=n.join(" "),e.measureText(a)}function td(a,t,e,n={}){if(t>=e)return[a,""];const c=a.length,u={};let f=Math.round(t/e*c-1);for(f<0&&(f=0);f>=0&&f<c;){const d=a.slice(0,f),v=u[d]||wl(d,n).width,b=a.slice(0,f+1),E=u[b]||wl(b,n).width;if(u[d]=v,u[b]=E,v>t)f-=1;else if(E<=t)f+=1;else break}return[a.slice(0,f),a.slice(f)]}function El(a,t,e={},n={}){const c=t.width,u=t.height,f=n.eol||`
`,d=e.fontSize||14,v=e.lineHeight?parseFloat(e.lineHeight):Math.ceil(d*1.4),b=Math.floor(u/v);if(a.indexOf(f)>-1){const B=Yu(),H=[];return a.split(f).map(J=>{const V=El(J,Object.assign(Object.assign({},t),{height:Number.MAX_SAFE_INTEGER}),e,Object.assign(Object.assign({},n),{eol:B}));V&&H.push(...V.split(B))}),H.slice(0,b).join(f)}const{width:E}=wl(a,e);if(E<c)return a;const S=[];let _=a,C=E,D=n.ellipsis,L=0;D&&(typeof D!="string"&&(D="\u2026"),L=wl(D,e).width);for(let B=0;B<b;B+=1)if(C>c)if(B===b-1){const[J]=td(_,c-L,C,e);S.push(D?`${J}${D}`:J)}else{const[J,V]=td(_,c,C,e);S.push(J),_=V,C=wl(_,e).width}else{S.push(_);break}return S.join(f)}const ed=.551784;function Zr(a,t,e=NaN){const n=a.getAttribute(t);if(n==null)return e;const c=parseFloat(n);return Number.isNaN(c)?e:c}function rv(a,t=1){const e=a.getTotalLength(),n=[];let c=0,u;for(;c<e;)u=a.getPointAtLength(c),n.push({distance:c,x:u.x,y:u.y}),c+=t;return n}function iv(a){return["M",Zr(a,"x1"),Zr(a,"y1"),"L",Zr(a,"x2"),Zr(a,"y2")].join(" ")}function ov(a){const t=Ya(a);return t.length===0?null:`${nd(t)} Z`}function sv(a){const t=Ya(a);return t.length===0?null:nd(t)}function nd(a){return`M ${a.map(e=>`${e.x} ${e.y}`).join(" L")}`}function Ya(a){const t=[],e=a.points;if(e)for(let n=0,c=e.numberOfItems;n<c;n+=1)t.push(e.getItem(n));return t}function Vp(a){const t=Zr(a,"cx",0),e=Zr(a,"cy",0),n=Zr(a,"r"),c=n*ed;return["M",t,e-n,"C",t+c,e-n,t+n,e-c,t+n,e,"C",t+n,e+c,t+c,e+n,t,e+n,"C",t-c,e+n,t-n,e+c,t-n,e,"C",t-n,e-c,t-c,e-n,t,e-n,"Z"].join(" ")}function Ja(a){const t=Zr(a,"cx",0),e=Zr(a,"cy",0),n=Zr(a,"rx"),c=Zr(a,"ry")||n,u=n*ed,f=c*ed;return["M",t,e-c,"C",t+u,e-c,t+n,e-f,t+n,e,"C",t+n,e+f,t+u,e+c,t,e+c,"C",t-u,e+c,t-n,e+f,t-n,e,"C",t-n,e-f,t-u,e-c,t,e-c,"Z"].join(" ")}function av(a){return Hp({x:Zr(a,"x",0),y:Zr(a,"y",0),width:Zr(a,"width",0),height:Zr(a,"height",0),rx:Zr(a,"rx",0),ry:Zr(a,"ry",0)})}function Hp(a){let t;const e=a.x,n=a.y,c=a.width,u=a.height,f=Math.min(a.rx||a["top-rx"]||0,c/2),d=Math.min(a.rx||a["bottom-rx"]||0,c/2),v=Math.min(a.ry||a["top-ry"]||0,u/2),b=Math.min(a.ry||a["bottom-ry"]||0,u/2);return f||d||v||b?t=["M",e,n+v,"v",u-v-b,"a",d,b,0,0,0,d,b,"h",c-2*d,"a",d,b,0,0,0,d,-b,"v",-(u-b-v),"a",f,v,0,0,0,-f,-v,"h",-(c-2*f),"a",f,v,0,0,0,-f,v,"Z"]:t=["M",e,n,"H",e+c,"V",n+u,"H",e,"V",n,"Z"],t.join(" ")}function cv(a){const t=Ni("path");Dn(t,Dn(a));const e=_l(a);return e&&t.setAttribute("d",e),t}function _l(a){const t=a.tagName.toLowerCase();switch(t){case"path":return a.getAttribute("d");case"line":return iv(a);case"polygon":return ov(a);case"polyline":return sv(a);case"ellipse":return Ja(a);case"circle":return Vp(a);case"rect":return av(a);default:break}throw new Error(`"${t}" cannot be converted to svg path element.`)}function Sl(a,t,e,n){const c=2*Math.PI-1e-6,u=a,f=t;let d=e,v=n;if(v<d){const L=d;d=v,v=L}const b=v-d,E=b<Math.PI?"0":"1",S=Math.cos(d),_=Math.sin(d),C=Math.cos(v),D=Math.sin(v);return b>=c?u?`M0,${f}A${f},${f} 0 1,1 0,${-f}A${f},${f} 0 1,1 0,${f}M0,${u}A${u},${u} 0 1,0 0,${-u}A${u},${u} 0 1,0 0,${u}Z`:`M0,${f}A${f},${f} 0 1,1 0,${-f}A${f},${f} 0 1,1 0,${f}Z`:u?`M${f*S},${f*_}A${f},${f} 0 ${E},1 ${f*C},${f*D}L${u*C},${u*D}A${u},${u} 0 ${E},0 ${u*S},${u*_}Z`:`M${f*S},${f*_}A${f},${f} 0 ${E},1 ${f*C},${f*D}L0,0Z`}const mx=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,lv=/[ ,]+/,vx=/^(\w+)\((.*)\)/;function $p(a,t){const n=Ni("svg").createSVGPoint();return n.x=a,n.y=t,n}function Ur(a){const e=Ni("svg").createSVGMatrix();if(a!=null){const n=a,c=e;for(const u in n)c[u]=n[u]}return e}function Al(a){const t=Ni("svg");return a!=null?(a instanceof DOMMatrix||(a=Ur(a)),t.createSVGTransformFromMatrix(a)):t.createSVGTransform()}function th(a){let t=Ur();const e=a!=null&&a.match(mx);if(!e)return t;for(let n=0,c=e.length;n<c;n+=1){const f=e[n].match(vx);if(f){let d,v,b,E,S,_=Ur();const C=f[2].split(lv);switch(f[1].toLowerCase()){case"scale":d=parseFloat(C[0]),v=C[1]===void 0?d:parseFloat(C[1]),_=_.scaleNonUniform(d,v);break;case"translate":b=parseFloat(C[0]),E=parseFloat(C[1]),_=_.translate(b,E);break;case"rotate":S=parseFloat(C[0]),b=parseFloat(C[1])||0,E=parseFloat(C[2])||0,b!==0||E!==0?_=_.translate(b,E).rotate(S).translate(-b,-E):_=_.rotate(S);break;case"skewx":S=parseFloat(C[0]),_=_.skewX(S);break;case"skewy":S=parseFloat(C[0]),_=_.skewY(S);break;case"matrix":_.a=parseFloat(C[0]),_.b=parseFloat(C[1]),_.c=parseFloat(C[2]),_.d=parseFloat(C[3]),_.e=parseFloat(C[4]),_.f=parseFloat(C[5]);break;default:continue}t=t.multiply(_)}}return t}function Ka(a){const t=a||{},e=t.a!=null?t.a:1,n=t.b!=null?t.b:0,c=t.c!=null?t.c:0,u=t.d!=null?t.d:1,f=t.e!=null?t.e:0,d=t.f!=null?t.f:0;return`matrix(${e},${n},${c},${u},${f},${d})`}function ua(a){let t,e,n;if(a){const u=lv;if(a.trim().indexOf("matrix")>=0){const f=th(a),d=yx(f);t=[d.translateX,d.translateY],e=[d.rotation],n=[d.scaleX,d.scaleY];const v=[];(t[0]!==0||t[1]!==0)&&v.push(`translate(${t.join(",")})`),(n[0]!==1||n[1]!==1)&&v.push(`scale(${n.join(",")})`),e[0]!==0&&v.push(`rotate(${e[0]})`),a=v.join(" ")}else{const f=a.match(/translate\((.*?)\)/);f&&(t=f[1].split(u));const d=a.match(/rotate\((.*?)\)/);d&&(e=d[1].split(u));const v=a.match(/scale\((.*?)\)/);v&&(n=v[1].split(u))}}const c=n&&n[0]?parseFloat(n[0]):1;return{raw:a||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:e&&e[0]?parseInt(e[0],10):0,cx:e&&e[1]?parseInt(e[1],10):void 0,cy:e&&e[2]?parseInt(e[2],10):void 0},scale:{sx:c,sy:n&&n[1]?parseFloat(n[1]):c}}}function Wp(a,t){const e=t.x*a.a+t.y*a.c+0,n=t.x*a.b+t.y*a.d+0;return{x:e,y:n}}function yx(a){const t=Wp(a,{x:0,y:1}),e=Wp(a,{x:1,y:0}),n=180/Math.PI*Math.atan2(t.y,t.x)-90,c=180/Math.PI*Math.atan2(e.y,e.x);return{skewX:n,skewY:c,translateX:a.e,translateY:a.f,scaleX:Math.sqrt(a.a*a.a+a.b*a.b),scaleY:Math.sqrt(a.c*a.c+a.d*a.d),rotation:n}}function uv(a){let t,e,n,c;return a?(t=a.a==null?1:a.a,c=a.d==null?1:a.d,e=a.b,n=a.c):t=c=1,{sx:e?Math.sqrt(t*t+e*e):t,sy:n?Math.sqrt(n*n+c*c):c}}function bx(a){let t={x:0,y:1};a&&(t=Wp(a,t));const e=180*Math.atan2(t.y,t.x)/Math.PI%360-90;return{angle:e%360+(e<0?360:0)}}function hv(a){return{tx:a&&a.e||0,ty:a&&a.f||0}}function Es(a,t,e={}){if(t==null)return th(Dn(a,"transform"));if(e.absolute){a.setAttribute("transform",Ka(t));return}const n=a.transform,c=Al(t);n.baseVal.appendItem(c)}function Xp(a,t,e=0,n={}){let c=Dn(a,"transform");const u=ua(c);if(t==null)return u.translation;c=u.raw,c=c.replace(/translate\([^)]*\)/g,"").trim();const f=n.absolute?t:u.translation.tx+t,d=n.absolute?e:u.translation.ty+e,v=`translate(${f},${d})`;a.setAttribute("transform",`${v} ${c}`.trim())}function rd(a,t,e,n,c={}){let u=Dn(a,"transform");const f=ua(u);if(t==null)return f.rotation;u=f.raw,u=u.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;const d=c.absolute?t:f.rotation.angle+t,v=e!=null&&n!=null?`,${e},${n}`:"",b=`rotate(${d}${v})`;a.setAttribute("transform",`${u} ${b}`.trim())}function id(a,t,e){let n=Dn(a,"transform");const c=ua(n);if(t==null)return c.scale;e=e==null?t:e,n=c.raw,n=n.replace(/scale\([^)]*\)/g,"").trim();const u=`scale(${t},${e})`;a.setAttribute("transform",`${n} ${u}`.trim())}function ha(a,t){if(vs(t)&&vs(a)){const e=t.getScreenCTM(),n=a.getScreenCTM();if(e&&n)return e.inverse().multiply(n)}return Ur()}function Qa(a,t){let e=Ur();if(vs(t)&&vs(a)){let n=a;const c=[];for(;n&&n!==t;){const u=n.getAttribute("transform")||null,f=th(u);c.push(f),n=n.parentNode}c.reverse().forEach(u=>{e=e.multiply(u)})}return e}function tc(a,t,e){const n=a instanceof SVGSVGElement?a:a.ownerSVGElement,c=n.createSVGPoint();c.x=t,c.y=e;try{const u=n.getScreenCTM(),f=c.matrixTransform(u.inverse()),d=ha(a,n).inverse();return f.matrixTransform(d)}catch(u){return c}}var Di;(function(a){const t={};function e(u){return t[u]||{}}a.get=e;function n(u,f){t[u]=f}a.register=n;function c(u){delete t[u]}a.unregister=c})(Di||(Di={}));var ui;(function(a){const t=new WeakMap;function e(u){return t.has(u)||t.set(u,{events:Object.create(null)}),t.get(u)}a.ensure=e;function n(u){return t.get(u)}a.get=n;function c(u){return t.delete(u)}a.remove=c})(ui||(ui={}));var gn;(function(a){a.returnTrue=()=>!0,a.returnFalse=()=>!1;function t(c){c.stopPropagation()}a.stopPropagationCallback=t;function e(c,u,f){c.addEventListener!=null&&c.addEventListener(u,f)}a.addEventListener=e;function n(c,u,f){c.removeEventListener!=null&&c.removeEventListener(u,f)}a.removeEventListener=n})(gn||(gn={})),function(a){const t=/[^\x20\t\r\n\f]+/g,e=/^([^.]*)(?:\.(.+)|)/;function n(d){return(d||"").match(t)||[""]}a.splitType=n;function c(d){const v=e.exec(d)||[];return{originType:v[1]?v[1].trim():v[1],namespaces:v[2]?v[2].split(".").map(b=>b.trim()).sort():[]}}a.normalizeType=c;function u(d){return d.nodeType===1||d.nodeType===9||!+d.nodeType}a.isValidTarget=u;function f(d,v){if(v){const b=d;return b.querySelector!=null&&b.querySelector(v)!=null}return!0}a.isValidSelector=f}(gn||(gn={})),function(a){let t=0;const e=new WeakMap;function n(d){return e.has(d)||(e.set(d,t),t+=1),e.get(d)}a.ensureHandlerId=n;function c(d){return e.get(d)}a.getHandlerId=c;function u(d){return e.delete(d)}a.removeHandlerId=u;function f(d,v){return e.set(d,v)}a.setHandlerId=f}(gn||(gn={})),function(a){function t(e,n){const c=[],u=ui.get(e),f=u&&u.events&&u.events[n.type],d=f&&f.handlers||[],v=f?f.delegateCount:0;if(v>0&&!(n.type==="click"&&typeof n.button=="number"&&n.button>=1)){for(let b=n.target;b!==e;b=b.parentNode||e)if(b.nodeType===1&&!(n.type==="click"&&b.disabled===!0)){const E=[],S={};for(let _=0;_<v;_+=1){const C=d[_],D=C.selector;if(D!=null&&S[D]==null){const L=e,B=[];L.querySelectorAll(D).forEach(H=>{B.push(H)}),S[D]=B.includes(b)}S[D]&&E.push(C)}E.length&&c.push({elem:b,handlers:E})}}return v<d.length&&c.push({elem:e,handlers:d.slice(v)}),c}a.getHandlerQueue=t}(gn||(gn={})),function(a){function t(e){return e!=null&&e===e.window}a.isWindow=t}(gn||(gn={})),function(a){function t(e,n){const c=e.nodeType===9?e.documentElement:e,u=n&&n.parentNode;return e===u||!!(u&&u.nodeType===1&&(c.contains?c.contains(u):e.compareDocumentPosition&&e.compareDocumentPosition(u)&16))}a.contains=t}(gn||(gn={}));class qi{constructor(t,e){this.isDefaultPrevented=gn.returnFalse,this.isPropagationStopped=gn.returnFalse,this.isImmediatePropagationStopped=gn.returnFalse,this.isSimulated=!1,this.preventDefault=()=>{const n=this.originalEvent;this.isDefaultPrevented=gn.returnTrue,n&&!this.isSimulated&&n.preventDefault()},this.stopPropagation=()=>{const n=this.originalEvent;this.isPropagationStopped=gn.returnTrue,n&&!this.isSimulated&&n.stopPropagation()},this.stopImmediatePropagation=()=>{const n=this.originalEvent;this.isImmediatePropagationStopped=gn.returnTrue,n&&!this.isSimulated&&n.stopImmediatePropagation(),this.stopPropagation()},typeof t=="string"?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?gn.returnTrue:gn.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),e&&Object.assign(this,e),this.timeStamp||(this.timeStamp=Date.now())}}(function(a){function t(e){return e instanceof a?e:new a(e)}a.create=t})(qi||(qi={})),function(a){function t(e,n){Object.defineProperty(a.prototype,e,{enumerable:!0,configurable:!0,get:typeof n=="function"?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set(c){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:c})}})}a.addProperty=t}(qi||(qi={})),function(a){const t={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(t).forEach(e=>a.addProperty(e,t[e]))}(qi||(qi={}));var ec;(function(a){Di.register("load",{noBubble:!0})})(ec||(ec={})),function(a){Di.register("beforeunload",{postDispatch(t,e){e.result!==void 0&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}})}(ec||(ec={})),function(a){Di.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle(t,e){let n;const c=e.relatedTarget,u=e.handleObj;return(!c||c!==t&&!gn.contains(t,c))&&(e.type=u.originType,n=u.handler.call(t,e),e.type="mouseover"),n}}),Di.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle(t,e){let n;const c=e.relatedTarget,u=e.handleObj;return(!c||c!==t&&!gn.contains(t,c))&&(e.type=u.originType,n=u.handler.call(t,e),e.type="mouseout"),n}})}(ec||(ec={}));var od=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e},_s;(function(a){let t;function e(f,d,v,b,E){if(!gn.isValidTarget(f))return;let S;if(typeof v!="function"){const{handler:L,selector:B}=v,H=od(v,["handler","selector"]);v=L,E=B,S=H}const _=ui.ensure(f);let C=_.handler;C==null&&(C=_.handler=function(L,...B){return t!==L.type?c(f,L,...B):void 0});const D=gn.ensureHandlerId(v);gn.splitType(d).forEach(L=>{const{originType:B,namespaces:H}=gn.normalizeType(L);if(!B)return;let J=B,V=Di.get(J);J=(E?V.delegateType:V.bindType)||J,V=Di.get(J);const ct=Object.assign({type:J,originType:B,data:b,selector:E,guid:D,handler:v,namespace:H.join(".")},S),dt=_.events;let At=dt[J];At||(At=dt[J]={handlers:[],delegateCount:0},(!V.setup||V.setup(f,b,H,C)===!1)&&gn.addEventListener(f,J,C)),V.add&&(gn.removeHandlerId(ct.handler),V.add(f,ct),gn.setHandlerId(ct.handler,D)),E?(At.handlers.splice(At.delegateCount,0,ct),At.delegateCount+=1):At.handlers.push(ct)})}a.on=e;function n(f,d,v,b,E){const S=ui.get(f);if(!S)return;const _=S.events;_&&(gn.splitType(d).forEach(C=>{const{originType:D,namespaces:L}=gn.normalizeType(C);if(!D){Object.keys(_).forEach(dt=>{n(f,dt+C,v,b,!0)});return}let B=D;const H=Di.get(B);B=(b?H.delegateType:H.bindType)||B;const J=_[B];if(!J)return;const V=L.length>0?new RegExp(`(^|\\.)${L.join("\\.(?:.*\\.|)")}(\\.|$)`):null,ct=J.handlers.length;for(let dt=J.handlers.length-1;dt>=0;dt-=1){const At=J.handlers[dt];(E||D===At.originType)&&(!v||gn.getHandlerId(v)===At.guid)&&(V==null||At.namespace&&V.test(At.namespace))&&(b==null||b===At.selector||b==="**"&&At.selector)&&(J.handlers.splice(dt,1),At.selector&&(J.delegateCount-=1),H.remove&&H.remove(f,At))}ct&&J.handlers.length===0&&((!H.teardown||H.teardown(f,L,S.handler)===!1)&&gn.removeEventListener(f,B,S.handler),delete _[B])}),Object.keys(_).length===0&&ui.remove(f))}a.off=n;function c(f,d,...v){const b=qi.create(d);b.delegateTarget=f;const E=Di.get(b.type);if(E.preDispatch&&E.preDispatch(f,b)===!1)return;const S=gn.getHandlerQueue(f,b);for(let _=0,C=S.length;_<C&&!b.isPropagationStopped();_+=1){const D=S[_];b.currentTarget=D.elem;for(let L=0,B=D.handlers.length;L<B&&!b.isImmediatePropagationStopped();L+=1){const H=D.handlers[L];if(b.rnamespace==null||H.namespace&&b.rnamespace.test(H.namespace)){b.handleObj=H,b.data=H.data;const J=Di.get(H.originType).handle,V=J?J(D.elem,b,...v):H.handler.call(D.elem,b,...v);V!==void 0&&(b.result=V,V===!1&&(b.preventDefault(),b.stopPropagation()))}}}return E.postDispatch&&E.postDispatch(f,b),b.result}a.dispatch=c;function u(f,d,v,b){let E=f,S=typeof f=="string"?f:f.type,_=typeof f=="string"||E.namespace==null?[]:E.namespace.split(".");const C=v;if(C.nodeType===3||C.nodeType===8)return;S.indexOf(".")>-1&&(_=S.split("."),S=_.shift(),_.sort());const D=S.indexOf(":")<0&&`on${S}`;E=f instanceof qi?f:new qi(S,typeof f=="object"?f:null),E.namespace=_.join("."),E.rnamespace=E.namespace?new RegExp(`(^|\\.)${_.join("\\.(?:.*\\.|)")}(\\.|$)`):null,E.result=void 0,E.target||(E.target=C);const L=[E];Array.isArray(d)?L.push(...d):L.push(d);const B=Di.get(S);if(!b&&B.trigger&&B.trigger(C,E,d)===!1)return;let H;const J=[C];if(!b&&!B.noBubble&&!gn.isWindow(C)){H=B.delegateType||S;let ct=C,dt=C.parentNode;for(;dt!=null;)J.push(dt),ct=dt,dt=dt.parentNode;const At=C.ownerDocument||document;if(ct===At){const le=ct.defaultView||ct.parentWindow||window;J.push(le)}}let V=C;for(let ct=0,dt=J.length;ct<dt&&!E.isPropagationStopped();ct+=1){const At=J[ct];V=At,E.type=ct>1?H:B.bindType||S;const le=ui.get(At);le&&le.events[E.type]&&le.handler&&le.handler.call(At,...L);const ye=D&&At[D]||null;ye&&gn.isValidTarget(At)&&(E.result=ye.call(At,...L),E.result===!1&&E.preventDefault())}if(E.type=S,!b&&!E.isDefaultPrevented()){const ct=B.preventDefault;if((ct==null||ct(J.pop(),E,d)===!1)&&gn.isValidTarget(C)&&D&&typeof C[S]=="function"&&!gn.isWindow(C)){const dt=C[D];dt&&(C[D]=null),t=S,E.isPropagationStopped()&&V.addEventListener(S,gn.stopPropagationCallback),C[S](),E.isPropagationStopped()&&V.removeEventListener(S,gn.stopPropagationCallback),t=void 0,dt&&(C[D]=dt)}}return E.result}a.trigger=u})(_s||(_s={}));var Rr;(function(a){function t(u,f,d,v,b){return nc.on(u,f,d,v,b),u}a.on=t;function e(u,f,d,v,b){return nc.on(u,f,d,v,b,!0),u}a.once=e;function n(u,f,d,v){return nc.off(u,f,d,v),u}a.off=n;function c(u,f,d,v){return _s.trigger(f,d,u,v),u}a.trigger=c})(Rr||(Rr={}));var nc;(function(a){function t(n,c,u,f,d,v){if(typeof c=="object"){typeof u!="string"&&(f=f||u,u=void 0),Object.keys(c).forEach(b=>t(n,b,u,f,c[b],v));return}if(f==null&&d==null?(d=u,f=u=void 0):d==null&&(typeof u=="string"?(d=f,f=void 0):(d=f,f=u,u=void 0)),d===!1)d=gn.returnFalse;else if(!d)return;if(v){const b=d;d=function(E,...S){return a.off(n,E),b.call(this,E,...S)},gn.setHandlerId(d,gn.ensureHandlerId(b))}_s.on(n,c,d,f,u)}a.on=t;function e(n,c,u,f){const d=c;if(d&&d.preventDefault!=null&&d.handleObj!=null){const v=d.handleObj;e(d.delegateTarget,v.namespace?`${v.originType}.${v.namespace}`:v.originType,v.selector,v.handler);return}if(typeof c=="object"){const v=c;Object.keys(v).forEach(b=>e(n,b,u,v[b]));return}(u===!1||typeof u=="function")&&(f=u,u=void 0),f===!1&&(f=gn.returnFalse),_s.off(n,c,f,u)}a.off=e})(nc||(nc={}));class Zp{constructor(t,e,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=ms.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=e,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}disable(){this.target.removeEventListener(this.eventName,this.onWheel)}onWheel(t){if(this.onWheelGuard!=null&&!this.onWheelGuard(t))return;this.deltaX+=t.deltaX,this.deltaY+=t.deltaY,t.preventDefault();let e;(this.deltaX!==0||this.deltaY!==0)&&(t.stopPropagation(),e=!0),e===!0&&this.animationFrameId===0&&(this.animationFrameId=requestAnimationFrame(()=>{this.didWheel(t)}))}didWheel(t){this.animationFrameId=0,this.onWheelCallback(t,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function qp(a){const t=a.getBoundingClientRect(),e=a.ownerDocument.defaultView;return{top:t.top+e.pageYOffset,left:t.left+e.pageXOffset}}function sd(a){return a.getBoundingClientRect().width}function xx(a){return a.getBoundingClientRect().height}function wx(a){const t=yl(a,"position")==="fixed";let e;if(t){const n=a.getBoundingClientRect();e={left:n.left,top:n.top}}else e=qp(a);if(!t){const n=a.ownerDocument;let c=a.offsetParent||n.documentElement;for(;(c===n.body||c===n.documentElement)&&yl(c,"position")==="static";)c=c.parentNode;if(c!==a&&cx(c)){const u=qp(c);e.top-=u.top+qa(c,"borderTopWidth"),e.left-=u.left+qa(c,"borderLeftWidth")}}return{top:e.top-qa(a,"marginTop"),left:e.left-qa(a,"marginLeft")}}function ad(a,t=60){let e=null;return(...n)=>{e&&clearTimeout(e),e=window.setTimeout(()=>{a.apply(this,n)},t)}}function fv(a){let t=null,e=[];const n=()=>{if(getComputedStyle(a).position==="static"){const b=a.style;b.position="relative"}const v=document.createElement("object");return v.onload=()=>{v.contentDocument.defaultView.addEventListener("resize",c),c()},v.style.display="block",v.style.position="absolute",v.style.top="0",v.style.left="0",v.style.height="100%",v.style.width="100%",v.style.overflow="hidden",v.style.pointerEvents="none",v.style.zIndex="-1",v.style.opacity="0",v.setAttribute("tabindex","-1"),v.type="text/html",a.appendChild(v),v.data="about:blank",v},c=ad(()=>{e.forEach(v=>v(a))}),u=v=>{t||(t=n()),e.indexOf(v)===-1&&e.push(v)},f=()=>{t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",c),t.parentNode.removeChild(t),t=null,e=[])};return{element:a,bind:u,destroy:f,unbind:v=>{const b=e.indexOf(v);b!==-1&&e.splice(b,1),e.length===0&&t&&f()}}}function Ex(a){let t=null,e=[];const n=ad(()=>{e.forEach(v=>{v(a)})}),c=()=>{const v=new ResizeObserver(n);return v.observe(a),n(),v},u=v=>{t||(t=c()),e.indexOf(v)===-1&&e.push(v)},f=()=>{t&&(t.disconnect(),e=[],t=null)};return{element:a,bind:u,destroy:f,unbind:v=>{const b=e.indexOf(v);b!==-1&&e.splice(b,1),e.length===0&&t&&f()}}}const _x=typeof ResizeObserver<"u"?Ex:fv;var eh;(function(a){const t=new WeakMap;function e(c){let u=t.get(c);return u||(u=_x(c),t.set(c,u),u)}function n(c){c.destroy(),t.delete(c.element)}a.bind=(c,u)=>{const f=e(c);return f.bind(u),()=>f.unbind(u)},a.clear=c=>{const u=e(c);n(u)}})(eh||(eh={}));class Tl{constructor(t={}){this.comparator=t.comparator||Tl.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}isEmpty(){return this.data.length===0}insert(t,e,n){const c={priority:t,value:e},u=this.data.length;return n&&(c.id=n,this.index[n]=u),this.data.push(c),this.bubbleUp(u),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(t,e){const n=this.index[t];if(typeof n>"u")throw new Error(`Node with id '${t}' was not found in the heap.`);const c=this.data,u=c[n].priority,f=this.comparator(e,u);f<0?(c[n].priority=e,this.bubbleUp(n)):f>0&&(c[n].priority=e,this.bubbleDown(n))}remove(){const t=this.data,e=t[0],n=t.pop();return e.id&&delete this.index[e.id],t.length>0&&(t[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),e?e.value:null}heapify(){for(let t=0;t<this.data.length;t+=1)this.bubbleUp(t)}bubbleUp(t){const e=this.data;let n,c,u=t;for(;u>0&&(c=u-1>>>1,this.comparator(e[u].priority,e[c].priority)<0);){n=e[c],e[c]=e[u];let f=e[u].id;f!=null&&(this.index[f]=c),e[u]=n,f=e[u].id,f!=null&&(this.index[f]=u),u=c}}bubbleDown(t){const e=this.data,n=e.length-1;let c=t;for(;;){const u=(c<<1)+1,f=u+1;let d=c;if(u<=n&&this.comparator(e[u].priority,e[d].priority)<0&&(d=u),f<=n&&this.comparator(e[f].priority,e[d].priority)<0&&(d=f),d!==c){const v=e[d];e[d]=e[c];let b=e[c].id;b!=null&&(this.index[b]=d),e[c]=v,b=e[c].id,b!=null&&(this.index[b]=c),c=d}else break}}}(function(a){a.defaultComparator=(t,e)=>t-e})(Tl||(Tl={}));var Yp;(function(a){function t(e,n,c=(u,f)=>1){const u={},f={},d={},v=new Tl;for(u[n]=0,Object.keys(e).forEach(b=>{b!==n&&(u[b]=1/0),v.insert(u[b],b,b)});!v.isEmpty();){const b=v.remove();d[b]=!0;const E=e[b]||[];for(let S=0;S<E.length;S+=1){const _=E[S];if(!d[_]){const C=u[b]+c(b,_);C<u[_]&&(u[_]=C,f[_]=b,v.updatePriority(_,C))}}}return f}a.run=t})(Yp||(Yp={}));class Ss{constructor(t,e,n,c){if(t==null)return this.set(255,255,255,1);if(typeof t=="number")return this.set(t,e,n,c);if(typeof t=="string")return Ss.fromString(t)||this;if(Array.isArray(t))return this.set(t);this.set(t.r,t.g,t.b,t.a==null?1:t.a)}blend(t,e,n){this.set(t.r+(e.r-t.r)*n,t.g+(e.g-t.g)*n,t.b+(e.b-t.b)*n,t.a+(e.a-t.a)*n)}lighten(t){const e=Ss.lighten(this.toArray(),t);this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3]}darken(t){this.lighten(-t)}set(t,e,n,c){const u=Array.isArray(t)?t[0]:t,f=Array.isArray(t)?t[1]:e,d=Array.isArray(t)?t[2]:n,v=Array.isArray(t)?t[3]:c;return this.r=Math.round(hr(u,0,255)),this.g=Math.round(hr(f,0,255)),this.b=Math.round(hr(d,0,255)),this.a=v==null?1:hr(v,0,1),this}toHex(){return`#${["r","g","b"].map(e=>{const n=this[e].toString(16);return n.length<2?`0${n}`:n}).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return Ss.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(t){const e=`${this.r},${this.g},${this.b},`;return t?`rgb(${e})`:`rgba(${e},${this.a})`}toGrey(){return Ss.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}(function(a){function t(V){return new a(V)}a.fromArray=t;function e(V){return new a([...D(V),1])}a.fromHex=e;function n(V){const ct=V.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(ct){const dt=ct[1].split(/\s*,\s*/).map(At=>parseInt(At,10));return new a(dt)}return null}a.fromRGBA=n;function c(V,ct,dt){dt<0&&++dt,dt>1&&--dt;const At=6*dt;return At<1?V+(ct-V)*At:2*dt<1?ct:3*dt<2?V+(ct-V)*(2/3-dt)*6:V}function u(V){const ct=V.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(ct){const dt=ct[2].split(/\s*,\s*/),At=(parseFloat(dt[0])%360+360)%360/360,le=parseFloat(dt[1])/100,ye=parseFloat(dt[2])/100,be=dt[3]==null?1:parseInt(dt[3],10);return new a(b(At,le,ye,be))}return null}a.fromHSLA=u;function f(V){if(V.startsWith("#"))return e(V);if(V.startsWith("rgb"))return n(V);const ct=a.named[V];return ct?e(ct):u(V)}a.fromString=f;function d(V,ct){return a.fromArray([V,V,V,ct])}a.makeGrey=d;function v(V,ct,dt,At){const le=Array.isArray(V)?V[0]:V,ye=Array.isArray(V)?V[1]:ct,be=Array.isArray(V)?V[2]:dt,Re=Array.isArray(V)?V[3]:At,Ae=Math.max(le,ye,be),Fe=Math.min(le,ye,be),sr=(Ae+Fe)/2;let On=0,Bt=0;if(Fe!==Ae){const he=Ae-Fe;switch(Bt=sr>.5?he/(2-Ae-Fe):he/(Ae+Fe),Ae){case le:On=(ye-be)/he+(ye<be?6:0);break;case ye:On=(be-le)/he+2;break;case be:On=(le-ye)/he+4;break;default:break}On/=6}return[On,Bt,sr,Re==null?1:Re]}a.rgba2hsla=v;function b(V,ct,dt,At){const le=Array.isArray(V)?V[0]:V,ye=Array.isArray(V)?V[1]:ct,be=Array.isArray(V)?V[2]:dt,Re=Array.isArray(V)?V[3]:At,Ae=be<=.5?be*(ye+1):be+ye-be*ye,Fe=2*be-Ae;return[c(Fe,Ae,le+1/3)*256,c(Fe,Ae,le)*256,c(Fe,Ae,le-1/3)*256,Re==null?1:Re]}a.hsla2rgba=b;function E(V){return new a(Math.round(Math.random()*256),Math.round(Math.random()*256),Math.round(Math.random()*256),V?void 0:parseFloat(Math.random().toFixed(2)))}a.random=E;function S(){const V="0123456789ABCDEF";let ct="#";for(let dt=0;dt<6;dt+=1)ct+=V[Math.floor(Math.random()*16)];return ct}a.randomHex=S;function _(V){return E(V).toString()}a.randomRGBA=_;function C(V,ct){if(typeof V=="string"){const be=V[0]==="#",[Re,Ae,Fe]=D(V);return ct?Re*.299+Ae*.587+Fe*.114>186?"#000000":"#ffffff":`${be?"#":""}${L(255-Re,255-Ae,255-Fe)}`}const dt=V[0],At=V[1],le=V[2],ye=V[3];return ct?dt*.299+At*.587+le*.114>186?[0,0,0,ye]:[255,255,255,ye]:[255-dt,255-At,255-le,ye]}a.invert=C;function D(V){const ct=V.indexOf("#")===0?V:`#${V}`;let dt=+`0x${ct.substr(1)}`;if(!(ct.length===4||ct.length===7)||Number.isNaN(dt))throw new Error("Invalid hex color.");const At=ct.length===4?4:8,le=(1<<At)-1,ye=["b","g","r"].map(()=>{const be=dt&le;return dt>>=At,At===4?17*be:be});return[ye[2],ye[1],ye[0]]}function L(V,ct,dt){const At=le=>le.length<2?`0${le}`:le;return`${At(V.toString(16))}${At(ct.toString(16))}${At(dt.toString(16))}`}function B(V,ct){return J(V,ct)}a.lighten=B;function H(V,ct){return J(V,-ct)}a.darken=H;function J(V,ct){if(typeof V=="string"){const le=V[0]==="#",ye=parseInt(le?V.substr(1):V,16),be=hr((ye>>16)+ct,0,255),Re=hr((ye>>8&255)+ct,0,255),Ae=hr((ye&255)+ct,0,255);return`${le?"#":""}${(Ae|Re<<8|be<<16).toString(16)}`}const dt=L(V[0],V[1],V[2]),At=D(J(dt,ct));return[At[0],At[1],At[2],V[3]]}})(Ss||(Ss={})),function(a){a.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Ss||(Ss={}));class cd{constructor(){this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(t){return this.map.has(t)}get(t){return this.map.get(t)}set(t,e){this.map.set(t,e),this.arr.push(t)}delete(t){const e=this.arr.indexOf(t);e>=0&&this.arr.splice(e,1);const n=this.map.get(t);return this.map.delete(t),n}each(t){this.arr.forEach(e=>{const n=this.map.get(e);t(n,e)})}dispose(){this.clear()}}var rc;(function(a){function t(c){const u=[],f=[];return Array.isArray(c)?u.push(...c):c.split("|").forEach(d=>{d.indexOf("&")===-1?u.push(d):f.push(...d.split("&"))}),{or:u,and:f}}a.parse=t;function e(c,u){if(c!=null&&u!=null){const f=t(c),d=t(u),v=f.or.sort(),b=d.or.sort(),E=f.and.sort(),S=d.and.sort(),_=(C,D)=>C.length===D.length&&(C.length===0||C.every((L,B)=>L===D[B]));return _(v,b)&&_(E,S)}return c==null&&u==null}a.equals=e;function n(c,u,f){if(u==null||Array.isArray(u)&&u.length===0)return f?c.altKey!==!0&&c.ctrlKey!==!0&&c.metaKey!==!0&&c.shiftKey!==!0:!0;const{or:d,and:v}=t(u),b=E=>{const S=`${E.toLowerCase()}Key`;return c[S]===!0};return d.some(E=>b(E))&&v.every(E=>b(E))}a.isMatch=n})(rc||(rc={}));var ic;(function(a){a.linear=t=>t,a.quad=t=>t*t,a.cubic=t=>t*t*t,a.inout=t=>{if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},a.exponential=t=>Math.pow(2,10*(t-1)),a.bounce=t=>{for(let e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11){const c=(11-6*e-11*t)/4;return-c*c+n*n}}})(ic||(ic={})),function(a){a.decorators={reverse(t){return e=>1-t(1-e)},reflect(t){return e=>.5*(e<.5?t(2*e):2-t(2-2*e))},clamp(t,e=0,n=1){return c=>{const u=t(c);return u<e?e:u>n?n:u}},back(t=1.70158){return e=>e*e*((t+1)*e-t)},elastic(t=1.5){return e=>Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}}(ic||(ic={})),function(a){function t(Bt){return-1*Math.cos(Bt*(Math.PI/2))+1}a.easeInSine=t;function e(Bt){return Math.sin(Bt*(Math.PI/2))}a.easeOutSine=e;function n(Bt){return-.5*(Math.cos(Math.PI*Bt)-1)}a.easeInOutSine=n;function c(Bt){return Bt*Bt}a.easeInQuad=c;function u(Bt){return Bt*(2-Bt)}a.easeOutQuad=u;function f(Bt){return Bt<.5?2*Bt*Bt:-1+(4-2*Bt)*Bt}a.easeInOutQuad=f;function d(Bt){return Bt*Bt*Bt}a.easeInCubic=d;function v(Bt){const he=Bt-1;return he*he*he+1}a.easeOutCubic=v;function b(Bt){return Bt<.5?4*Bt*Bt*Bt:(Bt-1)*(2*Bt-2)*(2*Bt-2)+1}a.easeInOutCubic=b;function E(Bt){return Bt*Bt*Bt*Bt}a.easeInQuart=E;function S(Bt){const he=Bt-1;return 1-he*he*he*he}a.easeOutQuart=S;function _(Bt){const he=Bt-1;return Bt<.5?8*Bt*Bt*Bt*Bt:1-8*he*he*he*he}a.easeInOutQuart=_;function C(Bt){return Bt*Bt*Bt*Bt*Bt}a.easeInQuint=C;function D(Bt){const he=Bt-1;return 1+he*he*he*he*he}a.easeOutQuint=D;function L(Bt){const he=Bt-1;return Bt<.5?16*Bt*Bt*Bt*Bt*Bt:1+16*he*he*he*he*he}a.easeInOutQuint=L;function B(Bt){return Bt===0?0:Math.pow(2,10*(Bt-1))}a.easeInExpo=B;function H(Bt){return Bt===1?1:-Math.pow(2,-10*Bt)+1}a.easeOutExpo=H;function J(Bt){if(Bt===0||Bt===1)return Bt;const he=Bt*2,pn=he-1;return he<1?.5*Math.pow(2,10*pn):.5*(-Math.pow(2,-10*pn)+2)}a.easeInOutExpo=J;function V(Bt){const he=Bt/1;return-1*(Math.sqrt(1-he*Bt)-1)}a.easeInCirc=V;function ct(Bt){const he=Bt-1;return Math.sqrt(1-he*he)}a.easeOutCirc=ct;function dt(Bt){const he=Bt*2,pn=he-2;return he<1?-.5*(Math.sqrt(1-he*he)-1):.5*(Math.sqrt(1-pn*pn)+1)}a.easeInOutCirc=dt;function At(Bt,he=1.70158){return Bt*Bt*((he+1)*Bt-he)}a.easeInBack=At;function le(Bt,he=1.70158){const pn=Bt/1-1;return pn*pn*((he+1)*pn+he)+1}a.easeOutBack=le;function ye(Bt,he=1.70158){const pn=Bt*2,vr=pn-2,yr=he*1.525;return pn<1?.5*pn*pn*((yr+1)*pn-yr):.5*(vr*vr*((yr+1)*vr+yr)+2)}a.easeInOutBack=ye;function be(Bt,he=.7){if(Bt===0||Bt===1)return Bt;const vr=Bt/1-1,yr=1-he,Yr=yr/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*vr)*Math.sin((vr-Yr)*(2*Math.PI)/yr))}a.easeInElastic=be;function Re(Bt,he=.7){const pn=1-he,vr=Bt*2;if(Bt===0||Bt===1)return Bt;const yr=pn/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*vr)*Math.sin((vr-yr)*(2*Math.PI)/pn)+1}a.easeOutElastic=Re;function Ae(Bt,he=.65){const pn=1-he;if(Bt===0||Bt===1)return Bt;const vr=Bt*2,yr=vr-1,Yr=pn/(2*Math.PI)*Math.asin(1);return vr<1?-.5*(Math.pow(2,10*yr)*Math.sin((yr-Yr)*(2*Math.PI)/pn)):Math.pow(2,-10*yr)*Math.sin((yr-Yr)*(2*Math.PI)/pn)*.5+1}a.easeInOutElastic=Ae;function Fe(Bt){const he=Bt/1;if(he<1/2.75)return 7.5625*he*he;if(he<2/2.75){const pn=he-.5454545454545454;return 7.5625*pn*pn+.75}if(he<2.5/2.75){const pn=he-.8181818181818182;return 7.5625*pn*pn+.9375}{const pn=he-.9545454545454546;return 7.5625*pn*pn+.984375}}a.easeOutBounce=Fe;function sr(Bt){return 1-Fe(1-Bt)}a.easeInBounce=sr;function On(Bt){return Bt<.5?sr(Bt*2)*.5:Fe(Bt*2-1)*.5+.5}a.easeInOutBounce=On}(ic||(ic={}));var oc;(function(a){a.number=(t,e)=>{const n=e-t;return c=>t+n*c},a.object=(t,e)=>{const n=Object.keys(t);return c=>{const u={};for(let f=n.length-1;f!==-1;f-=1){const d=n[f];u[d]=t[d]+(e[d]-t[d])*c}return u}},a.unit=(t,e)=>{const n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,c=n.exec(t),u=n.exec(e),f=u?u[1]:"",d=c?+c[1]:0,v=u?+u[1]:0,b=f.indexOf("."),E=b>0?f[1].length-b-1:0,S=v-d,_=c?c[2]:"";return C=>(d+S*C).toFixed(E)+_},a.color=(t,e)=>{const n=parseInt(t.slice(1),16),c=parseInt(e.slice(1),16),u=n&255,f=(c&255)-u,d=n&65280,v=(c&65280)-d,b=n&16711680,E=(c&16711680)-b;return S=>{const _=u+f*S&255,C=d+v*S&65280,D=b+E*S&16711680;return`#${(1<<24|_|C|D).toString(16).slice(1)}`}}})(oc||(oc={}));const nh=[];function dv(a,t){const e=nh.find(n=>n.name===a);if(!(e&&(e.loadTimes+=1,e.loadTimes>1))&&!ms.isApplyingHMR()){const n=document.createElement("style");n.setAttribute("type","text/css"),n.textContent=t;const c=document.querySelector("head");c&&c.insertBefore(n,c.firstChild),nh.push({name:a,loadTimes:1,styleElement:n})}}function Sx(a){const t=nh.findIndex(e=>e.name===a);if(t>-1){const e=nh[t];if(e.loadTimes-=1,e.loadTimes>0)return;let n=e.styleElement;n&&n.parentNode&&n.parentNode.removeChild(n),n=null,nh.splice(t,1)}}var Wn;(function(a){function t(n){return 180*n/Math.PI%360}a.toDeg=t,a.toRad=function(n,c=!1){return(c?n:n%360)*Math.PI/180};function e(n){return n%360+(n<0?360:0)}a.normalize=e})(Wn||(Wn={}));var i;(function(a){function t(d,v=0){return Number.isInteger(d)?d:+d.toFixed(v)}a.round=t;function e(d,v){let b,E;if(v==null?(E=d==null?1:d,b=0):(E=v,b=d==null?0:d),E<b){const S=b;b=E,E=S}return Math.floor(Math.random()*(E-b+1)+b)}a.random=e;function n(d,v,b){return Number.isNaN(d)?NaN:Number.isNaN(v)||Number.isNaN(b)?0:v<b?d<v?v:d>b?b:d:d<b?b:d>v?v:d}a.clamp=n;function c(d,v){return v*Math.round(d/v)}a.snapToGrid=c;function u(d,v){return v!=null&&d!=null&&v.x>=d.x&&v.x<=d.x+d.width&&v.y>=d.y&&v.y<=d.y+d.height}a.containsPoint=u;function f(d,v){const b=d.x-v.x,E=d.y-v.y;return b*b+E*E}a.squaredLength=f})(i||(i={}));class r{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class o extends r{constructor(t,e){super(),this.x=t==null?0:t,this.y=e==null?0:e}round(t=0){return this.x=i.round(this.x,t),this.y=i.round(this.y,t),this}add(t,e){const n=o.create(t,e);return this.x+=n.x,this.y+=n.y,this}update(t,e){const n=o.create(t,e);return this.x=n.x,this.y=n.y,this}translate(t,e){const n=o.create(t,e);return this.x+=n.x,this.y+=n.y,this}rotate(t,e){const n=o.rotate(this,t,e);return this.x=n.x,this.y=n.y,this}scale(t,e,n=new o){const c=o.create(n);return this.x=c.x+t*(this.x-c.x),this.y=c.y+e*(this.y-c.y),this}closest(t){if(t.length===1)return o.create(t[0]);let e=null,n=1/0;return t.forEach(c=>{const u=this.squaredDistance(c);u<n&&(e=c,n=u)}),e?o.create(e):null}distance(t){return Math.sqrt(this.squaredDistance(t))}squaredDistance(t){const e=o.create(t),n=this.x-e.x,c=this.y-e.y;return n*n+c*c}manhattanDistance(t){const e=o.create(t);return Math.abs(e.x-this.x)+Math.abs(e.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(t=new o){const e=o.create(t),n=-(e.y-this.y),c=e.x-this.x;let u=Math.atan2(n,c);return u<0&&(u=2*Math.PI+u),180*u/Math.PI}angleBetween(t,e){if(this.equals(t)||this.equals(e))return NaN;let n=this.theta(e)-this.theta(t);return n<0&&(n+=360),n}vectorAngle(t){return new o(0,0).angleBetween(this,t)}toPolar(t){return this.update(o.toPolar(this,t)),this}changeInAngle(t,e,n=new o){return this.clone().translate(-t,-e).theta(n)-this.theta(n)}adhereToRect(t){return i.containsPoint(t,this)||(this.x=Math.min(Math.max(this.x,t.x),t.x+t.width),this.y=Math.min(Math.max(this.y,t.y),t.y+t.height)),this}bearing(t){const e=o.create(t),n=Wn.toRad(this.y),c=Wn.toRad(e.y),u=this.x,f=e.x,d=Wn.toRad(f-u),v=Math.sin(d)*Math.cos(c),b=Math.cos(n)*Math.sin(c)-Math.sin(n)*Math.cos(c)*Math.cos(d),E=Wn.toDeg(Math.atan2(v,b)),S=["NE","E","SE","S","SW","W","NW","N"];let _=E-22.5;return _<0&&(_+=360),_=parseInt(_/45,10),S[_]}cross(t,e){if(t!=null&&e!=null){const n=o.create(t),c=o.create(e);return(c.x-this.x)*(n.y-this.y)-(c.y-this.y)*(n.x-this.x)}return NaN}dot(t){const e=o.create(t);return this.x*e.x+this.y*e.y}diff(t,e){if(typeof t=="number")return new o(this.x-t,this.y-e);const n=o.create(t);return new o(this.x-n.x,this.y-n.y)}lerp(t,e){const n=o.create(t);return new o((1-e)*this.x+e*n.x,(1-e)*this.y+e*n.y)}normalize(t=1){const e=t/this.magnitude();return this.scale(e,e)}move(t,e){const n=o.create(t),c=Wn.toRad(n.theta(this));return this.translate(Math.cos(c)*e,-Math.sin(c)*e)}reflection(t){return o.create(t).move(this,this.distance(t))}snapToGrid(t,e){return this.x=i.snapToGrid(this.x,t),this.y=i.snapToGrid(this.y,e==null?t:e),this}equals(t){const e=o.create(t);return e!=null&&e.x===this.x&&e.y===this.y}clone(){return o.clone(this)}toJSON(){return o.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}(function(a){function t(e){return e!=null&&e instanceof a}a.isPoint=t})(o||(o={})),function(a){function t(n){return n!=null&&typeof n=="object"&&typeof n.x=="number"&&typeof n.y=="number"}a.isPointLike=t;function e(n){return n!=null&&Array.isArray(n)&&n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"}a.isPointData=e}(o||(o={})),function(a){function t(S,_){return S==null||typeof S=="number"?new a(S,_):e(S)}a.create=t;function e(S){return a.isPoint(S)?new a(S.x,S.y):Array.isArray(S)?new a(S[0],S[1]):new a(S.x,S.y)}a.clone=e;function n(S){return a.isPoint(S)?{x:S.x,y:S.y}:Array.isArray(S)?{x:S[0],y:S[1]}:{x:S.x,y:S.y}}a.toJSON=n;function c(S,_,C=new a){let D=Math.abs(S*Math.cos(_)),L=Math.abs(S*Math.sin(_));const B=e(C),H=Wn.normalize(Wn.toDeg(_));return H<90?L=-L:H<180?(D=-D,L=-L):H<270&&(D=-D),new a(B.x+D,B.y+L)}a.fromPolar=c;function u(S,_=new a){const C=e(S),D=e(_),L=C.x-D.x,B=C.y-D.y;return new a(Math.sqrt(L*L+B*B),Wn.toRad(D.theta(C)))}a.toPolar=u;function f(S,_){return S===_?!0:S!=null&&_!=null?S.x===_.x&&S.y===_.y:!1}a.equals=f;function d(S,_){if(S==null&&_!=null||S!=null&&_==null||S!=null&&_!=null&&S.length!==_.length)return!1;if(S!=null&&_!=null){for(let C=0,D=S.length;C<D;C+=1)if(!f(S[C],_[C]))return!1}return!0}a.equalPoints=d;function v(S,_,C,D){return new a(i.random(S,_),i.random(C,D))}a.random=v;function b(S,_,C){const D=Wn.toRad(Wn.normalize(-_)),L=Math.sin(D),B=Math.cos(D);return E(S,B,L,C)}a.rotate=b;function E(S,_,C,D=new a){const L=e(S),B=e(D),H=L.x-B.x,J=L.y-B.y,V=H*_-J*C,ct=J*_+H*C;return new a(V+B.x,ct+B.y)}a.rotateEx=E}(o||(o={}));class s extends r{get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new o(this.x,this.y)}get topLeft(){return new o(this.x,this.y)}get topCenter(){return new o(this.x+this.width/2,this.y)}get topRight(){return new o(this.x+this.width,this.y)}get center(){return new o(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new o(this.x,this.y+this.height)}get bottomCenter(){return new o(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new o(this.x+this.width,this.y+this.height)}get corner(){return new o(this.x+this.width,this.y+this.height)}get rightMiddle(){return new o(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new o(this.x,this.y+this.height/2)}get topLine(){return new l(this.topLeft,this.topRight)}get rightLine(){return new l(this.topRight,this.bottomRight)}get bottomLine(){return new l(this.bottomLeft,this.bottomRight)}get leftLine(){return new l(this.topLeft,this.bottomLeft)}constructor(t,e,n,c){super(),this.x=t==null?0:t,this.y=e==null?0:e,this.width=n==null?0:n,this.height=c==null?0:c}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(t){if(!t)return this.clone();const e=Wn.toRad(t),n=Math.abs(Math.sin(e)),c=Math.abs(Math.cos(e)),u=this.width*c+this.height*n,f=this.width*n+this.height*c;return new s(this.x+(this.width-u)/2,this.y+(this.height-f)/2,u,f)}round(t=0){return this.x=i.round(this.x,t),this.y=i.round(this.y,t),this.width=i.round(this.width,t),this.height=i.round(this.height,t),this}add(t,e,n,c){const u=s.create(t,e,n,c),f=Math.min(this.x,u.x),d=Math.min(this.y,u.y),v=Math.max(this.x+this.width,u.x+u.width),b=Math.max(this.y+this.height,u.y+u.height);return this.x=f,this.y=d,this.width=v-f,this.height=b-d,this}update(t,e,n,c){const u=s.create(t,e,n,c);return this.x=u.x,this.y=u.y,this.width=u.width,this.height=u.height,this}inflate(t,e){const n=t,c=e!=null?e:t;return this.x-=n,this.y-=c,this.width+=2*n,this.height+=2*c,this}snapToGrid(t,e){const n=this.origin.snapToGrid(t,e),c=this.corner.snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=c.x-n.x,this.height=c.y-n.y,this}translate(t,e){const n=o.create(t,e);return this.x+=n.x,this.y+=n.y,this}scale(t,e,n=new o){const c=this.origin.scale(t,e,n);return this.x=c.x,this.y=c.y,this.width*=t,this.height*=e,this}rotate(t,e=this.getCenter()){if(t!==0){const n=Wn.toRad(t),c=Math.cos(n),u=Math.sin(n);let f=this.getOrigin(),d=this.getTopRight(),v=this.getBottomRight(),b=this.getBottomLeft();f=o.rotateEx(f,c,u,e),d=o.rotateEx(d,c,u,e),v=o.rotateEx(v,c,u,e),b=o.rotateEx(b,c,u,e);const E=new s(f.x,f.y,0,0);E.add(d.x,d.y,0,0),E.add(v.x,v.y,0,0),E.add(b.x,b.y,0,0),this.update(E)}return this}rotate90(){const t=(this.width-this.height)/2;this.x+=t,this.y-=t;const e=this.width;return this.width=this.height,this.height=e,this}moveAndExpand(t){const e=s.clone(t);return this.x+=e.x||0,this.y+=e.y||0,this.width+=e.width||0,this.height+=e.height||0,this}getMaxScaleToFit(t,e=this.center){const n=s.clone(t),c=e.x,u=e.y;let f=1/0,d=1/0,v=1/0,b=1/0,E=1/0,S=1/0,_=1/0,C=1/0;const D=n.topLeft;D.x<c&&(f=(this.x-c)/(D.x-c)),D.y<u&&(E=(this.y-u)/(D.y-u));const L=n.bottomRight;L.x>c&&(d=(this.x+this.width-c)/(L.x-c)),L.y>u&&(S=(this.y+this.height-u)/(L.y-u));const B=n.topRight;B.x>c&&(v=(this.x+this.width-c)/(B.x-c)),B.y<u&&(_=(this.y-u)/(B.y-u));const H=n.bottomLeft;return H.x<c&&(b=(this.x-c)/(H.x-c)),H.y>u&&(C=(this.y+this.height-u)/(H.y-u)),{sx:Math.min(f,d,v,b),sy:Math.min(E,S,_,C)}}getMaxUniformScaleToFit(t,e=this.center){const n=this.getMaxScaleToFit(t,e);return Math.min(n.sx,n.sy)}containsPoint(t,e){return i.containsPoint(this,o.create(t,e))}containsRect(t,e,n,c){const u=s.create(t,e,n,c),f=this.x,d=this.y,v=this.width,b=this.height,E=u.x,S=u.y,_=u.width,C=u.height;return v===0||b===0||_===0||C===0?!1:E>=f&&S>=d&&E+_<=f+v&&S+C<=d+b}intersectsWithLine(t){const e=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],c=[];return e.forEach(u=>{const f=t.intersectsWithLine(u);f!==null&&c.indexOf(f.toString())<0&&(n.push(f),c.push(f.toString()))}),n.length>0?n:null}intersectsWithLineFromCenterToPoint(t,e){const n=o.clone(t),c=this.center;let u=null;e!=null&&e!==0&&n.rotate(e,c);const f=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],d=new l(c,n);for(let v=f.length-1;v>=0;v-=1){const b=f[v].intersectsWithLine(d);if(b!==null){u=b;break}}return u&&e!=null&&e!==0&&u.rotate(-e,c),u}intersectsWithRect(t,e,n,c){const u=s.create(t,e,n,c);if(!this.isIntersectWithRect(u))return null;const f=this.origin,d=this.corner,v=u.origin,b=u.corner,E=Math.max(f.x,v.x),S=Math.max(f.y,v.y);return new s(E,S,Math.min(d.x,b.x)-E,Math.min(d.y,b.y)-S)}isIntersectWithRect(t,e,n,c){const u=s.create(t,e,n,c),f=this.origin,d=this.corner,v=u.origin,b=u.corner;return!(b.x<=f.x||b.y<=f.y||v.x>=d.x||v.y>=d.y)}normalize(){let t=this.x,e=this.y,n=this.width,c=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,c=-this.height),this.x=t,this.y=e,this.width=n,this.height=c,this}union(t){const e=s.clone(t),n=this.origin,c=this.corner,u=e.origin,f=e.corner,d=Math.min(n.x,u.x),v=Math.min(n.y,u.y),b=Math.max(c.x,f.x),E=Math.max(c.y,f.y);return new s(d,v,b-d,E-v)}getNearestSideToPoint(t){const e=o.clone(t),n=e.x-this.x,c=this.x+this.width-e.x,u=e.y-this.y,f=this.y+this.height-e.y;let d=n,v="left";return c<d&&(d=c,v="right"),u<d&&(d=u,v="top"),f<d&&(v="bottom"),v}getNearestPointToPoint(t){const e=o.clone(t);if(this.containsPoint(e)){const n=this.getNearestSideToPoint(e);if(n==="left")return new o(this.x,e.y);if(n==="top")return new o(e.x,this.y);if(n==="right")return new o(this.x+this.width,e.y);if(n==="bottom")return new o(e.x,this.y+this.height)}return e.adhereToRect(this)}equals(t){return t!=null&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height}clone(){return new s(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}(function(a){function t(e){return e!=null&&e instanceof a}a.isRectangle=t})(s||(s={})),function(a){function t(e){return e!=null&&typeof e=="object"&&typeof e.x=="number"&&typeof e.y=="number"&&typeof e.width=="number"&&typeof e.height=="number"}a.isRectangleLike=t}(s||(s={})),function(a){function t(f,d,v,b){return f==null||typeof f=="number"?new a(f,d,v,b):e(f)}a.create=t;function e(f){return a.isRectangle(f)?f.clone():Array.isArray(f)?new a(f[0],f[1],f[2],f[3]):new a(f.x,f.y,f.width,f.height)}a.clone=e;function n(f){return new a(f.x-f.a,f.y-f.b,2*f.a,2*f.b)}a.fromEllipse=n;function c(f){return new a(0,0,f.width,f.height)}a.fromSize=c;function u(f,d){return new a(f.x,f.y,d.width,d.height)}a.fromPositionAndSize=u}(s||(s={}));class l extends r{get center(){return new o((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}constructor(t,e,n,c){super(),typeof t=="number"&&typeof e=="number"?(this.start=new o(t,e),this.end=new o(n,c)):(this.start=o.create(t),this.end=o.create(e))}getCenter(){return this.center}round(t=0){return this.start.round(t),this.end.round(t),this}translate(t,e){return typeof t=="number"?(this.start.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.end.translate(t)),this}rotate(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this}scale(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.start.x-this.end.x,e=this.start.y-this.end.y;return t*t+e*e}setLength(t){const e=this.length();if(!e)return this;const n=t/e;return this.scale(n,n,this.start)}parallel(t){const e=this.clone();if(!e.isDifferentiable())return e;const{start:n,end:c}=e,u=n.clone().rotate(270,c),f=c.clone().rotate(90,n);return n.move(f,t),c.move(u,t),e}vector(){return new o(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const t=new o(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)}bbox(){const t=Math.min(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),c=Math.max(this.start.y,this.end.y);return new s(t,e,n-t,c-e)}bearing(){return this.start.bearing(this.end)}closestPoint(t){return this.pointAt(this.closestPointNormalizedLength(t))}closestPointLength(t){return this.closestPointNormalizedLength(t)*this.length()}closestPointTangent(t){return this.tangentAt(this.closestPointNormalizedLength(t))}closestPointNormalizedLength(t){const e=this.vector().dot(new l(this.start,t).vector()),n=Math.min(1,Math.max(0,e/this.squaredLength()));return Number.isNaN(n)?0:n}pointAt(t){const e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)}pointAtLength(t){const e=this.start,n=this.end;let c=!0;t<0&&(c=!1,t=-t);const u=this.length();if(t>=u)return c?n.clone():e.clone();const f=(c?t:u-t)/u;return this.pointAt(f)}divideAt(t){const e=this.pointAt(t);return[new l(this.start,e),new l(e,this.end)]}divideAtLength(t){const e=this.pointAtLength(t);return[new l(this.start,e),new l(e,this.end)]}containsPoint(t){const e=this.start,n=this.end;if(e.cross(t,n)!==0)return!1;const c=this.length();return!(new l(e,t).length()>c||new l(t,n).length()>c)}intersect(t,e){const n=t.intersectsWithLine(this,e);return n?Array.isArray(n)?n:[n]:null}intersectsWithLine(t){const e=new o(this.end.x-this.start.x,this.end.y-this.start.y),n=new o(t.end.x-t.start.x,t.end.y-t.start.y),c=e.x*n.y-e.y*n.x,u=new o(t.start.x-this.start.x,t.start.y-this.start.y),f=u.x*n.y-u.y*n.x,d=u.x*e.y-u.y*e.x;if(c===0||f*c<0||d*c<0)return null;if(c>0){if(f>c||d>c)return null}else if(f<c||d<c)return null;return new o(this.start.x+f*e.x/c,this.start.y+f*e.y/c)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(t){const e=o.clone(t),n=this.start,c=this.end;return((c.x-n.x)*(e.y-n.y)-(c.y-n.y)*(e.x-n.x))/this.length()}pointSquaredDistance(t,e){const n=o.create(t,e);return this.closestPoint(n).squaredDistance(n)}pointDistance(t,e){const n=o.create(t,e);return this.closestPoint(n).distance(n)}tangentAt(t){if(!this.isDifferentiable())return null;const e=this.start,n=this.end,c=this.pointAt(t),u=new l(e,n);return u.translate(c.x-e.x,c.y-e.y),u}tangentAtLength(t){if(!this.isDifferentiable())return null;const e=this.start,n=this.end,c=this.pointAtLength(t),u=new l(e,n);return u.translate(c.x-e.x,c.y-e.y),u}relativeCcw(t,e){const n=o.create(t,e);let c=n.x-this.start.x,u=n.y-this.start.y;const f=this.end.x-this.start.x,d=this.end.y-this.start.y;let v=c*d-u*f;return v===0&&(v=c*f+u*d,v>0&&(c-=f,u-=d,v=c*f+u*d,v<0&&(v=0))),v<0?-1:v>0?1:0}equals(t){return t!=null&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y}clone(){return new l(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}(function(a){function t(e){return e!=null&&e instanceof a}a.isLine=t})(l||(l={}));class h extends r{get center(){return new o(this.x,this.y)}constructor(t,e,n,c){super(),this.x=t==null?0:t,this.y=e==null?0:e,this.a=n==null?0:n,this.b=c==null?0:c}bbox(){return s.fromEllipse(this)}getCenter(){return this.center}inflate(t,e){const n=t,c=e!=null?e:t;return this.a+=2*n,this.b+=2*c,this}normalizedDistance(t,e){const n=o.create(t,e),c=n.x-this.x,u=n.y-this.y,f=this.a,d=this.b;return c*c/(f*f)+u*u/(d*d)}containsPoint(t,e){return this.normalizedDistance(t,e)<=1}intersectsWithLine(t){const e=[],n=this.a,c=this.b,u=t.start,f=t.end,d=t.vector(),v=u.diff(new o(this.x,this.y)),b=new o(d.x/(n*n),d.y/(c*c)),E=new o(v.x/(n*n),v.y/(c*c)),S=d.dot(b),_=d.dot(E),C=v.dot(E)-1,D=_*_-S*C;if(D<0)return null;if(D>0){const L=Math.sqrt(D),B=(-_-L)/S,H=(-_+L)/S;if((B<0||B>1)&&(H<0||H>1))return null;B>=0&&B<=1&&e.push(u.lerp(f,B)),H>=0&&H<=1&&e.push(u.lerp(f,H))}else{const L=-_/S;if(L>=0&&L<=1)e.push(u.lerp(f,L));else return null}return e}intersectsWithLineFromCenterToPoint(t,e=0){const n=o.clone(t);e&&n.rotate(e,this.getCenter());const c=n.x-this.x,u=n.y-this.y;let f;if(c===0)return f=this.bbox().getNearestPointToPoint(n),e?f.rotate(-e,this.getCenter()):f;const d=u/c,v=d*d,b=this.a*this.a,E=this.b*this.b;let S=Math.sqrt(1/(1/b+v/E));S=c<0?-S:S;const _=d*S;return f=new o(this.x+S,this.y+_),e?f.rotate(-e,this.getCenter()):f}tangentTheta(t){const e=o.clone(t),n=e.x,c=e.y,u=this.a,f=this.b,d=this.bbox().center,v=d.x,b=d.y,E=30,S=n>d.x+u/2,_=n<d.x-u/2;let C,D;return S||_?(D=n>d.x?c-E:c+E,C=u*u/(n-v)-u*u*(c-b)*(D-b)/(f*f*(n-v))+v):(C=c>d.y?n+E:n-E,D=f*f/(c-b)-f*f*(n-v)*(C-v)/(u*u*(c-b))+b),new o(C,D).theta(e)}scale(t,e){return this.a*=t,this.b*=e,this}rotate(t,e){const n=s.fromEllipse(this);n.rotate(t,e);const c=h.fromRect(n);return this.a=c.a,this.b=c.b,this.x=c.x,this.y=c.y,this}translate(t,e){const n=o.create(t,e);return this.x+=n.x,this.y+=n.y,this}equals(t){return t!=null&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b}clone(){return new h(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}(function(a){function t(e){return e!=null&&e instanceof a}a.isEllipse=t})(h||(h={})),function(a){function t(c,u,f,d){return c==null||typeof c=="number"?new a(c,u,f,d):e(c)}a.create=t;function e(c){return a.isEllipse(c)?c.clone():Array.isArray(c)?new a(c[0],c[1],c[2],c[3]):new a(c.x,c.y,c.a,c.b)}a.parse=e;function n(c){const u=c.center;return new a(u.x,u.y,c.width/2,c.height/2)}a.fromRect=n}(h||(h={}));const g=new RegExp("^[\\s\\dLMCZz,.]*$");function p(a){return typeof a!="string"?!1:g.test(a)}function m(a,t){return(a%t+t)%t}function y(a,t,e,n,c){const u=[],f=a[a.length-1],d=t!=null&&t>0,v=t||0;if(n&&d){a=a.slice();const S=a[0],_=new o(f.x+(S.x-f.x)/2,f.y+(S.y-f.y)/2);a.splice(0,0,_)}let b=a[0],E=1;for(e?u.push("M",b.x,b.y):u.push("L",b.x,b.y);E<(n?a.length:a.length-1);){let S=a[m(E,a.length)],_=b.x-S.x,C=b.y-S.y;if(d&&(_!==0||C!==0)&&(c==null||c.indexOf(E-1)<0)){let D=Math.sqrt(_*_+C*C);const L=_*Math.min(v,D/2)/D,B=C*Math.min(v,D/2)/D,H=S.x+L,J=S.y+B;u.push("L",H,J);let V=a[m(E+1,a.length)];for(;E<a.length-2&&Math.round(V.x-S.x)===0&&Math.round(V.y-S.y)===0;)V=a[m(E+2,a.length)],E+=1;_=V.x-S.x,C=V.y-S.y,D=Math.max(1,Math.sqrt(_*_+C*C));const ct=_*Math.min(v,D/2)/D,dt=C*Math.min(v,D/2)/D,At=S.x+ct,le=S.y+dt;u.push("Q",S.x,S.y,At,le),S=new o(At,le)}else u.push("L",S.x,S.y);b=S,E+=1}return n?u.push("Z"):u.push("L",f.x,f.y),u.map(S=>typeof S=="string"?S:+S.toFixed(3)).join(" ")}function x(a,t={}){const e=[];return a&&a.length&&a.forEach(n=>{Array.isArray(n)?e.push({x:n[0],y:n[1]}):e.push({x:n.x,y:n.y})}),y(e,t.round,t.initialMove==null||t.initialMove,t.close,t.exclude)}function w(a,t,e,n,c=0,u=0,f=0,d,v){if(e===0||n===0)return[];d-=a,v-=t,e=Math.abs(e),n=Math.abs(n);const b=-d/2,E=-v/2,S=Math.cos(c*Math.PI/180),_=Math.sin(c*Math.PI/180),C=S*b+_*E,D=-1*_*b+S*E,L=C*C,B=D*D,H=e*e,J=n*n,V=L/H+B/J;let ct;if(V>1)e=Math.sqrt(V)*e,n=Math.sqrt(V)*n,ct=0;else{let hc=1;u===f&&(hc=-1),ct=hc*Math.sqrt((H*J-H*B-J*L)/(H*B+J*L))}const dt=ct*e*D/n,At=-1*ct*n*C/e,le=S*dt-_*At+d/2,ye=_*dt+S*At+v/2;let be=Math.atan2((D-At)/n,(C-dt)/e)-Math.atan2(0,1),Re=be>=0?be:2*Math.PI+be;be=Math.atan2((-D-At)/n,(-C-dt)/e)-Math.atan2((D-At)/n,(C-dt)/e);let Ae=be>=0?be:2*Math.PI+be;f===0&&Ae>0?Ae-=2*Math.PI:f!==0&&Ae<0&&(Ae+=2*Math.PI);const Fe=Ae*2/Math.PI,sr=Math.ceil(Fe<0?-1*Fe:Fe),On=Ae/sr,Bt=8/3*Math.sin(On/4)*Math.sin(On/4)/Math.sin(On/2),he=S*e,pn=S*n,vr=_*e,yr=_*n;let Yr=Math.cos(Re),bi=Math.sin(Re),Lv=-Bt*(he*bi+yr*Yr),kv=-Bt*(vr*bi-pn*Yr),kl=0,cm=0;const uc=[];for(let hc=0;hc<sr;hc+=1){Re+=On,Yr=Math.cos(Re),bi=Math.sin(Re),kl=he*Yr-yr*bi+le,cm=vr*Yr+pn*bi+ye;const Yw=-Bt*(he*bi+yr*Yr),Jw=-Bt*(vr*bi-pn*Yr),Ed=hc*6;uc[Ed]=Number(Lv+a),uc[Ed+1]=Number(kv+t),uc[Ed+2]=Number(kl-Yw+a),uc[Ed+3]=Number(cm-Jw+t),uc[Ed+4]=Number(kl+a),uc[Ed+5]=Number(cm+t),Lv=kl+Yw,kv=cm+Jw}return uc.map(hc=>+hc.toFixed(2))}function A(a,t,e,n,c=0,u=0,f=0,d,v){const b=[],E=w(a,t,e,n,c,u,f,d,v);if(E!=null)for(let S=0,_=E.length;S<_;S+=6)b.push("C",E[S],E[S+1],E[S+2],E[S+3],E[S+4],E[S+5]);return b.join(" ")}class T extends r{get start(){return this.points[0]||null}get end(){return this.points[this.points.length-1]||null}constructor(t){if(super(),t!=null){if(typeof t=="string")return T.parse(t);this.points=t.map(e=>o.create(e))}else this.points=[]}scale(t,e,n=new o){return this.points.forEach(c=>c.scale(t,e,n)),this}rotate(t,e){return this.points.forEach(n=>n.rotate(t,e)),this}translate(t,e){const n=o.create(t,e);return this.points.forEach(c=>c.translate(n.x,n.y)),this}round(t=0){return this.points.forEach(e=>e.round(t)),this}bbox(){if(this.points.length===0)return new s;let t=1/0,e=-1/0,n=1/0,c=-1/0;const u=this.points;for(let f=0,d=u.length;f<d;f+=1){const v=u[f],b=v.x,E=v.y;b<t&&(t=b),b>e&&(e=b),E<n&&(n=E),E>c&&(c=E)}return new s(t,n,e-t,c-n)}closestPoint(t){const e=this.closestPointLength(t);return this.pointAtLength(e)}closestPointLength(t){const e=this.points,n=e.length;if(n===0||n===1)return 0;let c=0,u=0,f=1/0;for(let d=0,v=n-1;d<v;d+=1){const b=new l(e[d],e[d+1]),E=b.length(),S=b.closestPointNormalizedLength(t),C=b.pointAt(S).squaredDistance(t);C<f&&(f=C,u=c+S*E),c+=E}return u}closestPointNormalizedLength(t){const e=this.length();return e===0?0:this.closestPointLength(t)/e}closestPointTangent(t){const e=this.closestPointLength(t);return this.tangentAtLength(e)}containsPoint(t){if(this.points.length===0)return!1;const e=o.clone(t),n=e.x,c=e.y,u=this.points,f=u.length;let d=f-1,v=0;for(let b=0;b<f;b+=1){const E=u[d],S=u[b];if(e.equals(E))return!0;const _=new l(E,S);if(_.containsPoint(t))return!0;if(c<=E.y&&c>S.y||c>E.y&&c<=S.y){const C=E.x-n>S.x-n?E.x-n:S.x-n;if(C>=0){const D=new o(n+C,c),L=new l(t,D);_.intersectsWithLine(L)&&(v+=1)}}d=b}return v%2===1}intersectsWithLine(t){const e=[];for(let n=0,c=this.points.length-1;n<c;n+=1){const u=this.points[n],f=this.points[n+1],d=t.intersectsWithLine(new l(u,f));d&&e.push(d)}return e.length>0?e:null}isDifferentiable(){for(let t=0,e=this.points.length-1;t<e;t+=1){const n=this.points[t],c=this.points[t+1];if(new l(n,c).isDifferentiable())return!0}return!1}length(){let t=0;for(let e=0,n=this.points.length-1;e<n;e+=1){const c=this.points[e],u=this.points[e+1];t+=c.distance(u)}return t}pointAt(t){const e=this.points,n=e.length;if(n===0)return null;if(n===1||t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();const u=this.length()*t;return this.pointAtLength(u)}pointAtLength(t){const e=this.points,n=e.length;if(n===0)return null;if(n===1)return e[0].clone();let c=!0;t<0&&(c=!1,t=-t);let u=0;for(let d=0,v=n-1;d<v;d+=1){const b=c?d:v-1-d,E=e[b],S=e[b+1],_=new l(E,S),C=E.distance(S);if(t<=u+C)return _.pointAtLength((c?1:-1)*(t-u));u+=C}return(c?e[n-1]:e[0]).clone()}tangentAt(t){const n=this.points.length;if(n===0||n===1)return null;t<0&&(t=0),t>1&&(t=1);const u=this.length()*t;return this.tangentAtLength(u)}tangentAtLength(t){const e=this.points,n=e.length;if(n===0||n===1)return null;let c=!0;t<0&&(c=!1,t=-t);let u,f=0;for(let d=0,v=n-1;d<v;d+=1){const b=c?d:v-1-d,E=e[b],S=e[b+1],_=new l(E,S),C=E.distance(S);if(_.isDifferentiable()){if(t<=f+C)return _.tangentAtLength((c?1:-1)*(t-f));u=_}f+=C}if(u){const d=c?1:0;return u.tangentAt(d)}return null}simplify(t={}){const e=this.points;if(e.length<3)return this;const n=t.threshold||0;let c=0;for(;e[c+2];){const u=c,f=c+1,d=c+2,v=e[u],b=e[f],E=e[d];new l(v,E).closestPoint(b).distance(b)<=n?e.splice(f,1):c+=1}return this}toHull(){const t=this.points,e=t.length;if(e===0)return new T;let n=t[0];for(let _=1;_<e;_+=1)(t[_].y<n.y||t[_].y===n.y&&t[_].x>n.x)&&(n=t[_]);const c=[];for(let _=0;_<e;_+=1){let C=n.theta(t[_]);C===0&&(C=360),c.push([t[_],_,C])}if(c.sort((_,C)=>{let D=_[2]-C[2];return D===0&&(D=C[1]-_[1]),D}),c.length>2){const _=c[c.length-1];c.unshift(_)}const u={},f=[],d=_=>`${_[0].toString()}@${_[1]}`;for(;c.length!==0;){const _=c.pop(),C=_[0];if(u[d(_)])continue;let D=!1;for(;!D;)if(f.length<2)f.push(_),D=!0;else{const L=f.pop(),B=L[0],H=f.pop(),J=H[0],V=J.cross(B,C);if(V<0)f.push(H),f.push(L),f.push(_),D=!0;else if(V===0){const dt=B.angleBetween(J,C);Math.abs(dt-180)<1e-10||B.equals(C)||J.equals(B)?(u[d(L)]=B,f.push(H)):Math.abs((dt+1)%360-1)<1e-10&&(f.push(H),c.push(L))}else u[d(L)]=B,f.push(H)}}f.length>2&&f.pop();let v,b=-1;for(let _=0,C=f.length;_<C;_+=1){const D=f[_][1];(v===void 0||D<v)&&(v=D,b=_)}let E=[];if(b>0){const _=f.slice(b),C=f.slice(0,b);E=_.concat(C)}else E=f;const S=[];for(let _=0,C=E.length;_<C;_+=1)S.push(E[_][0]);return new T(S)}equals(t){return t==null||t.points.length!==this.points.length?!1:t.points.every((e,n)=>e.equals(this.points[n]))}clone(){return new T(this.points.map(t=>t.clone()))}toJSON(){return this.points.map(t=>t.toJSON())}serialize(){return this.points.map(t=>`${t.serialize()}`).join(" ")}}(function(a){function t(e){return e!=null&&e instanceof a}a.isPolyline=t})(T||(T={})),function(a){function t(e){const n=e.trim();if(n==="")return new a;const c=[],u=n.split(/\s*,\s*|\s+/);for(let f=0,d=u.length;f<d;f+=2)c.push({x:+u[f],y:+u[f+1]});return new a(c)}a.parse=t}(T||(T={}));class O extends r{constructor(t,e,n,c){super(),this.PRECISION=3,this.start=o.create(t),this.controlPoint1=o.create(e),this.controlPoint2=o.create(n),this.end=o.create(c)}bbox(){const t=this.start,e=this.controlPoint1,n=this.controlPoint2,c=this.end,u=t.x,f=t.y,d=e.x,v=e.y,b=n.x,E=n.y,S=c.x,_=c.y,C=[],D=[],L=[[],[]];let B,H,J,V,ct,dt,At,le;for(let pn=0;pn<2;pn+=1){if(pn===0?(H=6*u-12*d+6*b,B=-3*u+9*d-9*b+3*S,J=3*d-3*u):(H=6*f-12*v+6*E,B=-3*f+9*v-9*E+3*_,J=3*v-3*f),Math.abs(B)<1e-12){if(Math.abs(H)<1e-12)continue;V=-J/H,V>0&&V<1&&D.push(V);continue}At=H*H-4*J*B,le=Math.sqrt(At),!(At<0)&&(ct=(-H+le)/(2*B),ct>0&&ct<1&&D.push(ct),dt=(-H-le)/(2*B),dt>0&&dt<1&&D.push(dt))}let ye,be,Re,Ae=D.length;const Fe=Ae;for(;Ae;)Ae-=1,V=D[Ae],Re=1-V,ye=Re*Re*Re*u+3*Re*Re*V*d+3*Re*V*V*b+V*V*V*S,L[0][Ae]=ye,be=Re*Re*Re*f+3*Re*Re*V*v+3*Re*V*V*E+V*V*V*_,L[1][Ae]=be,C[Ae]={X:ye,Y:be};D[Fe]=0,D[Fe+1]=1,C[Fe]={X:u,Y:f},C[Fe+1]={X:S,Y:_},L[0][Fe]=u,L[1][Fe]=f,L[0][Fe+1]=S,L[1][Fe+1]=_,D.length=Fe+2,L[0].length=Fe+2,L[1].length=Fe+2,C.length=Fe+2;const sr=Math.min.apply(null,L[0]),On=Math.min.apply(null,L[1]),Bt=Math.max.apply(null,L[0]),he=Math.max.apply(null,L[1]);return new s(sr,On,Bt-sr,he-On)}closestPoint(t,e={}){return this.pointAtT(this.closestPointT(t,e))}closestPointLength(t,e={}){const n=this.getOptions(e);return this.lengthAtT(this.closestPointT(t,n),n)}closestPointNormalizedLength(t,e={}){const n=this.getOptions(e),c=this.closestPointLength(t,n);if(!c)return 0;const u=this.length(n);return u===0?0:c/u}closestPointT(t,e={}){const n=this.getPrecision(e),c=this.getDivisions(e),u=Math.pow(10,-n);let f=null,d=0,v=0,b=0,E=0,S=0,_=null;const C=c.length;let D=C>0?1/C:0;for(c.forEach((L,B)=>{const H=L.start.distance(t),J=L.end.distance(t),V=H+J;(_==null||V<_)&&(f=L,d=B*D,v=(B+1)*D,b=H,E=J,_=V,S=L.endpointDistance())});;){const L=b?Math.abs(b-E)/b:0,B=E!=null?Math.abs(b-E)/E:0,H=L<u||B<u,J=b?b<S*u:!0,V=E?E<S*u:!0;if(H||(J||V))return b<=E?d:v;const dt=f.divide(.5);D/=2;const At=dt[0].start.distance(t),le=dt[0].end.distance(t),ye=At+le,be=dt[1].start.distance(t),Re=dt[1].end.distance(t),Ae=be+Re;ye<=Ae?(f=dt[0],v-=D,b=At,E=le):(f=dt[1],d+=D,b=be,E=Re)}}closestPointTangent(t,e={}){return this.tangentAtT(this.closestPointT(t,e))}containsPoint(t,e={}){return this.toPolyline(e).containsPoint(t)}divideAt(t,e={}){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);const n=this.tAt(t,e);return this.divideAtT(n)}divideAtLength(t,e={}){const n=this.tAtLength(t,e);return this.divideAtT(n)}divide(t){return this.divideAtT(t)}divideAtT(t){const e=this.start,n=this.controlPoint1,c=this.controlPoint2,u=this.end;if(t<=0)return[new O(e,e,e,e),new O(e,n,c,u)];if(t>=1)return[new O(e,n,c,u),new O(u,u,u,u)];const f=this.getSkeletonPoints(t),d=f.startControlPoint1,v=f.startControlPoint2,b=f.divider,E=f.dividerControlPoint1,S=f.dividerControlPoint2;return[new O(e,d,v,b),new O(b,E,S,u)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(t){const e=this.start,n=this.controlPoint1,c=this.controlPoint2,u=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:c.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:c.clone(),divider:u.clone(),dividerControlPoint1:u.clone(),dividerControlPoint2:u.clone()};const f=new l(e,n).pointAt(t),d=new l(n,c).pointAt(t),v=new l(c,u).pointAt(t),b=new l(f,d).pointAt(t),E=new l(d,v).pointAt(t),S=new l(b,E).pointAt(t);return{startControlPoint1:f,startControlPoint2:b,divider:S,dividerControlPoint1:E,dividerControlPoint2:v}}getSubdivisions(t={}){const e=this.getPrecision(t);let n=[new O(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(e===0)return n;let c=this.endpointDistance();const u=Math.pow(10,-e);let f=0;for(;;){f+=1;const d=[];n.forEach(E=>{const S=E.divide(.5);d.push(S[0],S[1])});const v=d.reduce((E,S)=>E+S.endpointDistance(),0),b=v!==0?(v-c)/v:0;if(f>1&&b<u)return d;n=d,c=v}}length(t={}){return this.getDivisions(t).reduce((n,c)=>n+c.endpointDistance(),0)}lengthAtT(t,e={}){if(t<=0)return 0;const n=e.precision===void 0?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:n})}pointAt(t,e={}){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const n=this.tAt(t,e);return this.pointAtT(n)}pointAtLength(t,e={}){const n=this.tAtLength(t,e);return this.pointAtT(n)}pointAtT(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider}isDifferentiable(){const t=this.start,e=this.controlPoint1,n=this.controlPoint2,c=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(c))}tangentAt(t,e={}){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);const n=this.tAt(t,e);return this.tangentAtT(n)}tangentAtLength(t,e={}){if(!this.isDifferentiable())return null;const n=this.tAtLength(t,e);return this.tangentAtT(n)}tangentAtT(t){if(!this.isDifferentiable())return null;t<0&&(t=0),t>1&&(t=1);const e=this.getSkeletonPoints(t),n=e.startControlPoint2,c=e.dividerControlPoint1,u=e.divider,f=new l(n,c);return f.translate(u.x-n.x,u.y-n.y),f}getPrecision(t={}){return t.precision==null?this.PRECISION:t.precision}getDivisions(t={}){if(t.subdivisions!=null)return t.subdivisions;const e=this.getPrecision(t);return this.getSubdivisions({precision:e})}getOptions(t={}){const e=this.getPrecision(t),n=this.getDivisions(t);return{precision:e,subdivisions:n}}tAt(t,e={}){if(t<=0)return 0;if(t>=1)return 1;const n=this.getOptions(e),u=this.length(n)*t;return this.tAtLength(u,n)}tAtLength(t,e={}){let n=!0;t<0&&(n=!1,t=-t);const c=this.getPrecision(e),u=this.getDivisions(e),f={precision:c,subdivisions:u};let d=null,v,b,E=0,S=0,_=0;const C=u.length;let D=C>0?1/C:0;for(let H=0;H<C;H+=1){const J=n?H:C-1-H,V=u[H],ct=V.endpointDistance();if(t<=_+ct){d=V,v=J*D,b=(J+1)*D,E=n?t-_:ct+_-t,S=n?ct+_-t:t-_;break}_+=ct}if(d==null)return n?1:0;const L=this.length(f),B=Math.pow(10,-c);for(;;){let H;if(H=L!==0?E/L:0,H<B)return v;if(H=L!==0?S/L:0,H<B)return b;let J,V;const ct=d.divide(.5);D/=2;const dt=ct[0].endpointDistance(),At=ct[1].endpointDistance();E<=dt?(d=ct[0],b-=D,J=E,V=dt-J):(d=ct[1],v+=D,J=E-dt,V=At-J),E=J,S=V}}toPoints(t={}){const e=this.getDivisions(t),n=[e[0].start.clone()];return e.forEach(c=>n.push(c.end.clone())),n}toPolyline(t={}){return new T(this.toPoints(t))}scale(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.start.rotate(t,e),this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?(this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return t!=null&&this.start.equals(t.start)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)&&this.end.equals(t.end)}clone(){return new O(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}(function(a){function t(e){return e!=null&&e instanceof a}a.isCurve=t})(O||(O={})),function(a){function t(c){const u=c.length,f=[],d=[];let v=2;f[0]=c[0]/v;for(let b=1;b<u;b+=1)d[b]=1/v,v=(b<u-1?4:3.5)-d[b],f[b]=(c[b]-f[b-1])/v;for(let b=1;b<u;b+=1)f[u-b-1]-=d[u-b]*f[u-b];return f}function e(c){const u=c.map(_=>o.clone(_)),f=[],d=[],v=u.length-1;if(v===1)return f[0]=new o((2*u[0].x+u[1].x)/3,(2*u[0].y+u[1].y)/3),d[0]=new o(2*f[0].x-u[0].x,2*f[0].y-u[0].y),[f,d];const b=[];for(let _=1;_<v-1;_+=1)b[_]=4*u[_].x+2*u[_+1].x;b[0]=u[0].x+2*u[1].x,b[v-1]=(8*u[v-1].x+u[v].x)/2;const E=t(b);for(let _=1;_<v-1;_+=1)b[_]=4*u[_].y+2*u[_+1].y;b[0]=u[0].y+2*u[1].y,b[v-1]=(8*u[v-1].y+u[v].y)/2;const S=t(b);for(let _=0;_<v;_+=1)f.push(new o(E[_],S[_])),_<v-1?d.push(new o(2*u[_+1].x-E[_+1],2*u[_+1].y-S[_+1])):d.push(new o((u[v].x+E[v-1])/2,(u[v].y+S[v-1])/2));return[f,d]}function n(c){if(c==null||Array.isArray(c)&&c.length<2)throw new Error("At least 2 points are required");const u=e(c),f=[];for(let d=0,v=u[0].length;d<v;d+=1){const b=new o(u[0][d].x,u[0][d].y),E=new o(u[1][d].x,u[1][d].y);f.push(new a(c[d],b,E,c[d+1]))}return f}a.throughPoints=n}(O||(O={}));class I extends r{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(this.previousSegment==null)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(t,e){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(t,e){if(t<=0)return 0;const n=this.length();return t>=1?n:n*t}divideAtT(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class N extends I{constructor(t,e){super(),l.isLine(t)?this.endPoint=t.end.clone().round(2):this.endPoint=o.create(t,e).round(2)}get type(){return"L"}get line(){return new l(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[new N(e[0]),new N(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[new N(e[0]),new N(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return this.previousSegment==null?!1:!this.start.equals(this.end)}clone(){return new N(this.end)}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?this.end.translate(t,e):this.end.translate(t),this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}(function(a){function t(...e){const n=e.length,c=e[0];if(l.isLine(c))return new a(c);if(o.isPointLike(c))return n===1?new a(c):e.map(f=>new a(f));if(n===2)return new a(+e[0],+e[1]);const u=[];for(let f=0;f<n;f+=2){const d=+e[f],v=+e[f+1];u.push(new a(d,v))}return u}a.create=t})(N||(N={}));class P extends I{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new l(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[e[1].isDifferentiable()?new N(e[0]):this.clone(),new N(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[e[1].isDifferentiable()?new N(e[0]):this.clone(),new N(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}clone(){return new P}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}(function(a){function t(){return new a}a.create=t})(P||(P={}));class R extends I{constructor(t,e){super(),this.isVisible=!1,this.isSubpathStart=!0,l.isLine(t)||O.isCurve(t)?this.endPoint=t.end.clone().round(2):this.endPoint=o.create(t,e).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?this.end.translate(t,e):this.end.translate(t),this}clone(){return new R(this.end)}equals(t){return this.type===t.type&&this.end.equals(t.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}(function(a){function t(...e){const n=e.length,c=e[0];if(l.isLine(c))return new a(c);if(O.isCurve(c))return new a(c);if(o.isPointLike(c)){if(n===1)return new a(c);const f=[];for(let d=0;d<n;d+=1)d===0?f.push(new a(e[d])):f.push(new N(e[d]));return f}if(n===2)return new a(+e[0],+e[1]);const u=[];for(let f=0;f<n;f+=2){const d=+e[f],v=+e[f+1];f===0?u.push(new a(d,v)):u.push(new N(d,v))}return u}a.create=t})(R||(R={}));class k extends I{constructor(t,e,n,c,u,f){super(),O.isCurve(t)?(this.controlPoint1=t.controlPoint1.clone().round(2),this.controlPoint2=t.controlPoint2.clone().round(2),this.endPoint=t.end.clone().round(2)):typeof t=="number"?(this.controlPoint1=new o(t,e).round(2),this.controlPoint2=new o(n,c).round(2),this.endPoint=new o(u,f).round(2)):(this.controlPoint1=o.create(t).round(2),this.controlPoint2=o.create(e).round(2),this.endPoint=o.create(n).round(2))}get type(){return"C"}get curve(){return new O(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(t){return this.curve.closestPoint(t)}closestPointLength(t){return this.curve.closestPointLength(t)}closestPointNormalizedLength(t){return this.curve.closestPointNormalizedLength(t)}closestPointTangent(t){return this.curve.closestPointTangent(t)}length(){return this.curve.length()}divideAt(t,e={}){const n=this.curve.divideAt(t,e);return[new k(n[0]),new k(n[1])]}divideAtLength(t,e={}){const n=this.curve.divideAtLength(t,e);return[new k(n[0]),new k(n[1])]}divideAtT(t){const e=this.curve.divideAtT(t);return[new k(e[0]),new k(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.curve.pointAt(t)}pointAtLength(t){return this.curve.pointAtLength(t)}tangentAt(t){return this.curve.tangentAt(t)}tangentAtLength(t){return this.curve.tangentAtLength(t)}isDifferentiable(){if(!this.previousSegment)return!1;const t=this.start,e=this.controlPoint1,n=this.controlPoint2,c=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(c))}scale(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?(this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return this.start.equals(t.start)&&this.end.equals(t.end)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)}clone(){return new k(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.controlPoint1,e=this.controlPoint2,n=this.end;return[this.type,t.x,t.y,e.x,e.y,n.x,n.y].join(" ")}}(function(a){function t(...e){const n=e.length,c=e[0];if(O.isCurve(c))return new a(c);if(o.isPointLike(c)){if(n===3)return new a(e[0],e[1],e[2]);const f=[];for(let d=0;d<n;d+=3)f.push(new a(e[d],e[d+1],e[d+2]));return f}if(n===6)return new a(e[0],e[1],e[2],e[3],e[4],e[5]);const u=[];for(let f=0;f<n;f+=6)u.push(new a(e[f],e[f+1],e[f+2],e[f+3],e[f+4],e[f+5]));return u}a.create=t})(k||(k={}));function U(a,t,e){return{x:a*Math.cos(e)-t*Math.sin(e),y:a*Math.sin(e)+t*Math.cos(e)}}function K(a,t,e,n,c,u){const f=.3333333333333333,d=2/3;return[f*a+d*e,f*t+d*n,f*c+d*e,f*u+d*n,c,u]}function pt(a,t,e,n,c,u,f,d,v,b){const E=Math.PI*120/180,S=Math.PI/180*(+c||0);let _=[],C,D,L,B,H;if(b)D=b[0],L=b[1],B=b[2],H=b[3];else{C=U(a,t,-S),a=C.x,t=C.y,C=U(d,v,-S),d=C.x,v=C.y;const On=(a-d)/2,Bt=(t-v)/2;let he=On*On/(e*e)+Bt*Bt/(n*n);he>1&&(he=Math.sqrt(he),e=he*e,n=he*n);const pn=e*e,vr=n*n,yr=(u===f?-1:1)*Math.sqrt(Math.abs((pn*vr-pn*Bt*Bt-vr*On*On)/(pn*Bt*Bt+vr*On*On)));B=yr*e*Bt/n+(a+d)/2,H=yr*-n*On/e+(t+v)/2,D=Math.asin((t-H)/n),L=Math.asin((v-H)/n),D=a<B?Math.PI-D:D,L=d<B?Math.PI-L:L,D<0&&(D=Math.PI*2+D),L<0&&(L=Math.PI*2+L),f&&D>L&&(D-=Math.PI*2),!f&&L>D&&(L-=Math.PI*2)}let J=L-D;if(Math.abs(J)>E){const On=L,Bt=d,he=v;L=D+E*(f&&L>D?1:-1),d=B+e*Math.cos(L),v=H+n*Math.sin(L),_=pt(d,v,e,n,c,0,f,Bt,he,[L,On,B,H])}J=L-D;const V=Math.cos(D),ct=Math.sin(D),dt=Math.cos(L),At=Math.sin(L),le=Math.tan(J/4),ye=4/3*(e*le),be=4/3*(n*le),Re=[a,t],Ae=[a+ye*ct,t-be*V],Fe=[d+ye*At,v-be*dt],sr=[d,v];if(Ae[0]=2*Re[0]-Ae[0],Ae[1]=2*Re[1]-Ae[1],b)return[Ae,Fe,sr].concat(_);{_=[Ae,Fe,sr].concat(_).join().split(",");const On=[],Bt=_.length;for(let he=0;he<Bt;he+=1)On[he]=he%2?U(+_[he-1],+_[he],S).y:U(+_[he],+_[he+1],S).x;return On}}function Ot(a){if(!a)return null;const t=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,e=new RegExp(`([a-z])[${t},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${t}]*,?[${t}]*)+)`,"ig"),n=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${t}]*,?[${t}]*`,"ig"),c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},u=[];return a.replace(e,(f,d,v)=>{const b=[];let E=d.toLowerCase();v.replace(n,(_,C)=>(C&&b.push(+C),_)),E==="m"&&b.length>2&&(u.push([d,...b.splice(0,2)]),E="l",d=d==="m"?"l":"L");const S=c[E];for(;b.length>=S&&(u.push([d,...b.splice(0,S)]),!!S););return f}),u}function It(a){const t=Ot(a);if(!t||!t.length)return[["M",0,0]];let e=0,n=0,c=0,u=0;const f=[];for(let d=0,v=t.length;d<v;d+=1){const b=[];f.push(b);const E=t[d],S=E[0];if(S!==S.toUpperCase())switch(b[0]=S.toUpperCase(),b[0]){case"A":b[1]=E[1],b[2]=E[2],b[3]=E[3],b[4]=E[4],b[5]=E[5],b[6]=+E[6]+e,b[7]=+E[7]+n;break;case"V":b[1]=+E[1]+n;break;case"H":b[1]=+E[1]+e;break;case"M":c=+E[1]+e,u=+E[2]+n;for(let _=1,C=E.length;_<C;_+=1)b[_]=+E[_]+(_%2?e:n);break;default:for(let _=1,C=E.length;_<C;_+=1)b[_]=+E[_]+(_%2?e:n);break}else for(let _=0,C=E.length;_<C;_+=1)b[_]=E[_];switch(b[0]){case"Z":e=+c,n=+u;break;case"H":e=b[1];break;case"V":n=b[1];break;case"M":c=b[b.length-2],u=b[b.length-1],e=b[b.length-2],n=b[b.length-1];break;default:e=b[b.length-2],n=b[b.length-1];break}}return f}function Ct(a){const t=It(a),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function n(v,b,E){let S,_;if(!v)return["C",b.x,b.y,b.x,b.y,b.x,b.y];switch(v[0]in{T:1,Q:1}||(b.qx=null,b.qy=null),v[0]){case"M":b.X=v[1],b.Y=v[2];break;case"A":return parseFloat(v[1])===0||parseFloat(v[2])===0?["L",v[6],v[7]]:["C"].concat(pt.apply(0,[b.x,b.y].concat(v.slice(1))));case"S":return E==="C"||E==="S"?(S=b.x*2-b.bx,_=b.y*2-b.by):(S=b.x,_=b.y),["C",S,_].concat(v.slice(1));case"T":return E==="Q"||E==="T"?(b.qx=b.x*2-b.qx,b.qy=b.y*2-b.qy):(b.qx=b.x,b.qy=b.y),["C"].concat(K(b.x,b.y,b.qx,b.qy,v[1],v[2]));case"Q":return b.qx=v[1],b.qy=v[2],["C"].concat(K(b.x,b.y,v[1],v[2],v[3],v[4]));case"H":return["L"].concat(v[1],b.y);case"V":return["L"].concat(b.x,v[1]);case"L":break;case"Z":break;default:break}return v}function c(v,b){if(v[b].length>7){v[b].shift();const E=v[b];for(;E.length;)u[b]="A",b+=1,v.splice(b,0,["C"].concat(E.splice(0,6)));v.splice(b,1),d=t.length}}const u=[];let f="",d=t.length;for(let v=0;v<d;v+=1){let b="";t[v]&&(b=t[v][0]),b!=="C"&&(u[v]=b,v>0&&(f=u[v-1])),t[v]=n(t[v],e,f),u[v]!=="A"&&b==="C"&&(u[v]="C"),c(t,v);const E=t[v],S=E.length;e.x=E[S-2],e.y=E[S-1],e.bx=parseFloat(E[S-4])||e.x,e.by=parseFloat(E[S-3])||e.y}return(!t[0][0]||t[0][0]!=="M")&&t.unshift(["M",0,0]),t}function _t(a){return Ct(a).map(t=>t.map(e=>typeof e=="string"?e:i.round(e,2))).join(",").split(",").join(" ")}class F extends r{constructor(t){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(t))if(l.isLine(t[0])||O.isCurve(t[0])){let e=null;t.forEach((c,u)=>{u===0&&this.appendSegment(F.createSegment("M",c.start)),e!=null&&!e.end.equals(c.start)&&this.appendSegment(F.createSegment("M",c.start)),l.isLine(c)?this.appendSegment(F.createSegment("L",c.end)):O.isCurve(c)&&this.appendSegment(F.createSegment("C",c.controlPoint1,c.controlPoint2,c.end)),e=c})}else t.forEach(n=>{n.isSegment&&this.appendSegment(n)});else t!=null&&(l.isLine(t)?(this.appendSegment(F.createSegment("M",t.start)),this.appendSegment(F.createSegment("L",t.end))):O.isCurve(t)?(this.appendSegment(F.createSegment("M",t.start)),this.appendSegment(F.createSegment("C",t.controlPoint1,t.controlPoint2,t.end))):T.isPolyline(t)?t.points&&t.points.length&&t.points.forEach((e,n)=>{const c=n===0?F.createSegment("M",e):F.createSegment("L",e);this.appendSegment(c)}):t.isSegment&&this.appendSegment(t))}get start(){const t=this.segments,e=t.length;if(e===0)return null;for(let n=0;n<e;n+=1){const c=t[n];if(c.isVisible)return c.start}return t[e-1].end}get end(){const t=this.segments,e=t.length;if(e===0)return null;for(let n=e-1;n>=0;n-=1){const c=t[n];if(c.isVisible)return c.end}return t[e-1].end}moveTo(...t){return this.appendSegment(R.create.call(null,...t))}lineTo(...t){return this.appendSegment(N.create.call(null,...t))}curveTo(...t){return this.appendSegment(k.create.call(null,...t))}arcTo(t,e,n,c,u,f,d){const v=this.end||new o,b=typeof f=="number"?w(v.x,v.y,t,e,n,c,u,f,d):w(v.x,v.y,t,e,n,c,u,f.x,f.y);if(b!=null)for(let E=0,S=b.length;E<S;E+=6)this.curveTo(b[E],b[E+1],b[E+2],b[E+3],b[E+4],b[E+5]);return this}quadTo(t,e,n,c){const u=this.end||new o,f=["M",u.x,u.y];if(typeof t=="number")f.push("Q",t,e,n,c);else{const v=e;f.push("Q",t.x,t.y,v.x,v.y)}const d=F.parse(f.join(" "));return this.appendSegment(d.segments.slice(1)),this}close(){return this.appendSegment(P.create())}drawPoints(t,e={}){const n=x(t,e),c=F.parse(n);c&&c.segments&&this.appendSegment(c.segments)}bbox(){const t=this.segments,e=t.length;if(e===0)return null;let n;for(let u=0;u<e;u+=1){const f=t[u];if(f.isVisible){const d=f.bbox();d!=null&&(n=n?n.union(d):d)}}if(n!=null)return n;const c=t[e-1];return new s(c.end.x,c.end.y,0,0)}appendSegment(t){const e=this.segments.length;let n=e!==0?this.segments[e-1]:null,c;const u=null;if(Array.isArray(t))for(let f=0,d=t.length;f<d;f+=1){const v=t[f];c=this.prepareSegment(v,n,u),this.segments.push(c),n=c}else t!=null&&t.isSegment&&(c=this.prepareSegment(t,n,u),this.segments.push(c));return this}insertSegment(t,e){const n=this.segments.length;if(t<0&&(t=n+t+1),t>n||t<0)throw new Error("Index out of range.");let c,u=null,f=null;if(n!==0&&(t>=1?(u=this.segments[t-1],f=u.nextSegment):(u=null,f=this.segments[0])),!Array.isArray(e))c=this.prepareSegment(e,u,f),this.segments.splice(t,0,c);else for(let d=0,v=e.length;d<v;d+=1){const b=e[d];c=this.prepareSegment(b,u,f),this.segments.splice(t+d,0,c),u=c}return this}removeSegment(t){const e=this.fixIndex(t),n=this.segments.splice(e,1)[0],c=n.previousSegment,u=n.nextSegment;return c&&(c.nextSegment=u),u&&(u.previousSegment=c),n.isSubpathStart&&u&&this.updateSubpathStartSegment(u),n}replaceSegment(t,e){const n=this.fixIndex(t);let c;const u=this.segments[n];let f=u.previousSegment;const d=u.nextSegment;let v=u.isSubpathStart;if(!Array.isArray(e))c=this.prepareSegment(e,f,d),this.segments.splice(n,1,c),v&&c.isSubpathStart&&(v=!1);else{this.segments.splice(t,1);for(let b=0,E=e.length;b<E;b+=1){const S=e[b];c=this.prepareSegment(S,f,d),this.segments.splice(t+b,0,c),f=c,v&&c.isSubpathStart&&(v=!1)}}v&&d&&this.updateSubpathStartSegment(d)}getSegment(t){const e=this.fixIndex(t);return this.segments[e]}fixIndex(t){const e=this.segments.length;if(e===0)throw new Error("Path has no segments.");let n=t;for(;n<0;)n=e+n;if(n>=e||n<0)throw new Error("Index out of range.");return n}segmentAt(t,e={}){const n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null}segmentAtLength(t,e={}){const n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null}segmentIndexAt(t,e={}){if(this.segments.length===0)return null;const n=i.clamp(t,0,1),c=this.getOptions(e),f=this.length(c)*n;return this.segmentIndexAtLength(f,c)}segmentIndexAtLength(t,e={}){const n=this.segments.length;if(n===0)return null;let c=!0;t<0&&(c=!1,t=-t);const u=this.getPrecision(e),f=this.getSubdivisions(e);let d=0,v=null;for(let b=0;b<n;b+=1){const E=c?b:n-1-b,S=this.segments[E],_=f[E],C=S.length({precision:u,subdivisions:_});if(S.isVisible){if(t<=d+C)return E;v=E}d+=C}return v}getSegmentSubdivisions(t={}){const e=this.getPrecision(t),n=[];for(let c=0,u=this.segments.length;c<u;c+=1){const d=this.segments[c].getSubdivisions({precision:e});n.push(d)}return n}updateSubpathStartSegment(t){let e=t.previousSegment,n=t;for(;n&&!n.isSubpathStart;)e!=null?n.subpathStartSegment=e.subpathStartSegment:n.subpathStartSegment=null,e=n,n=n.nextSegment}prepareSegment(t,e,n){t.previousSegment=e,t.nextSegment=n,e!=null&&(e.nextSegment=t),n!=null&&(n.previousSegment=t);let c=t;return t.isSubpathStart&&(t.subpathStartSegment=t,c=n),c!=null&&this.updateSubpathStartSegment(c),t}closestPoint(t,e={}){const n=this.closestPointT(t,e);return n?this.pointAtT(n):null}closestPointLength(t,e={}){const n=this.getOptions(e),c=this.closestPointT(t,n);return c?this.lengthAtT(c,n):0}closestPointNormalizedLength(t,e={}){const n=this.getOptions(e),c=this.closestPointLength(t,n);if(c===0)return 0;const u=this.length(n);return u===0?0:c/u}closestPointT(t,e={}){if(this.segments.length===0)return null;const n=this.getPrecision(e),c=this.getSubdivisions(e);let u,f=1/0;for(let d=0,v=this.segments.length;d<v;d+=1){const b=this.segments[d],E=c[d];if(b.isVisible){const S=b.closestPointT(t,{precision:n,subdivisions:E}),_=b.pointAtT(S),C=i.squaredLength(_,t);C<f&&(u={segmentIndex:d,value:S},f=C)}}return u||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(t,e={}){if(this.segments.length===0)return null;const n=this.getPrecision(e),c=this.getSubdivisions(e);let u,f=1/0;for(let d=0,v=this.segments.length;d<v;d+=1){const b=this.segments[d],E=c[d];if(b.isDifferentiable()){const S=b.closestPointT(t,{precision:n,subdivisions:E}),_=b.pointAtT(S),C=i.squaredLength(_,t);C<f&&(u=b.tangentAtT(S),f=C)}}return u||null}containsPoint(t,e={}){const n=this.toPolylines(e);if(!n)return!1;let c=0;for(let u=0,f=n.length;u<f;u+=1)n[u].containsPoint(t)&&(c+=1);return c%2===1}pointAt(t,e={}){if(this.segments.length===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const n=this.getOptions(e),u=this.length(n)*t;return this.pointAtLength(u,n)}pointAtLength(t,e={}){if(this.segments.length===0)return null;if(t===0)return this.start.clone();let n=!0;t<0&&(n=!1,t=-t);const c=this.getPrecision(e),u=this.getSubdivisions(e);let f,d=0;for(let b=0,E=this.segments.length;b<E;b+=1){const S=n?b:E-1-b,_=this.segments[S],C=u[S],D=_.length({precision:c,subdivisions:C});if(_.isVisible){if(t<=d+D)return _.pointAtLength((n?1:-1)*(t-d),{precision:c,subdivisions:C});f=_}d+=D}return f?n?f.end:f.start:this.segments[this.segments.length-1].end.clone()}pointAtT(t){const e=this.segments,n=e.length;if(n===0)return null;const c=t.segmentIndex;if(c<0)return e[0].pointAtT(0);if(c>=n)return e[n-1].pointAtT(1);const u=i.clamp(t.value,0,1);return e[c].pointAtT(u)}divideAt(t,e={}){if(this.segments.length===0)return null;const n=i.clamp(t,0,1),c=this.getOptions(e),f=this.length(c)*n;return this.divideAtLength(f,c)}divideAtLength(t,e={}){if(this.segments.length===0)return null;let n=!0;t<0&&(n=!1,t=-t);const c=this.getPrecision(e),u=this.getSubdivisions(e);let f=0,d,v,b,E,S;for(let dt=0,At=this.segments.length;dt<At;dt+=1){const le=n?dt:At-1-dt,ye=this.getSegment(le),be=u[le],Re={precision:c,subdivisions:be},Ae=ye.length(Re);if(ye.isDifferentiable()&&(b=ye,E=le,t<=f+Ae)){v=le,d=ye.divideAtLength((n?1:-1)*(t-f),Re);break}f+=Ae}if(!b)return null;d||(v=E,S=n?1:0,d=b.divideAtT(S));const _=this.clone(),C=v;_.replaceSegment(C,d);const D=C;let L=C+1,B=C+2;d[0].isDifferentiable()||(_.removeSegment(D),L-=1,B-=1);const H=_.getSegment(L).start;_.insertSegment(L,F.createSegment("M",H)),B+=1,d[1].isDifferentiable()||(_.removeSegment(B-1),B-=1);const J=B-D-1;for(let dt=B,At=_.segments.length;dt<At;dt+=1){const le=this.getSegment(dt-J),ye=_.getSegment(dt);if(ye.type==="Z"&&!le.subpathStartSegment.end.equals(ye.subpathStartSegment.end)){const be=F.createSegment("L",le.end);_.replaceSegment(dt,be)}}const V=new F(_.segments.slice(0,L)),ct=new F(_.segments.slice(L));return[V,ct]}intersectsWithLine(t,e={}){const n=this.toPolylines(e);if(n==null)return null;let c=null;for(let u=0,f=n.length;u<f;u+=1){const d=n[u],v=t.intersect(d);v&&(c==null&&(c=[]),Array.isArray(v)?c.push(...v):c.push(v))}return c}isDifferentiable(){for(let t=0,e=this.segments.length;t<e;t+=1)if(this.segments[t].isDifferentiable())return!0;return!1}isValid(){const t=this.segments;return t.length===0||t[0].type==="M"}length(t={}){if(this.segments.length===0)return 0;const e=this.getSubdivisions(t);let n=0;for(let c=0,u=this.segments.length;c<u;c+=1){const f=this.segments[c],d=e[c];n+=f.length({subdivisions:d})}return n}lengthAtT(t,e={}){const n=this.segments.length;if(n===0)return 0;let c=t.segmentIndex;if(c<0)return 0;let u=i.clamp(t.value,0,1);c>=n&&(c=n-1,u=1);const f=this.getPrecision(e),d=this.getSubdivisions(e);let v=0;for(let S=0;S<c;S+=1){const _=this.segments[S],C=d[S];v+=_.length({precision:f,subdivisions:C})}const b=this.segments[c],E=d[c];return v+=b.lengthAtT(u,{precision:f,subdivisions:E}),v}tangentAt(t,e={}){if(this.segments.length===0)return null;const n=i.clamp(t,0,1),c=this.getOptions(e),f=this.length(c)*n;return this.tangentAtLength(f,c)}tangentAtLength(t,e={}){if(this.segments.length===0)return null;let n=!0;t<0&&(n=!1,t=-t);const c=this.getPrecision(e),u=this.getSubdivisions(e);let f,d=0;for(let v=0,b=this.segments.length;v<b;v+=1){const E=n?v:b-1-v,S=this.segments[E],_=u[E],C=S.length({precision:c,subdivisions:_});if(S.isDifferentiable()){if(t<=d+C)return S.tangentAtLength((n?1:-1)*(t-d),{precision:c,subdivisions:_});f=S}d+=C}if(f){const v=n?1:0;return f.tangentAtT(v)}return null}tangentAtT(t){const e=this.segments.length;if(e===0)return null;const n=t.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=e)return this.segments[e-1].tangentAtT(1);const c=i.clamp(t.value,0,1);return this.segments[n].tangentAtT(c)}getPrecision(t={}){return t.precision==null?this.PRECISION:t.precision}getSubdivisions(t={}){if(t.segmentSubdivisions==null){const e=this.getPrecision(t);return this.getSegmentSubdivisions({precision:e})}return t.segmentSubdivisions}getOptions(t={}){const e=this.getPrecision(t),n=this.getSubdivisions(t);return{precision:e,segmentSubdivisions:n}}toPoints(t={}){const e=this.segments,n=e.length;if(n===0)return null;const c=this.getSubdivisions(t),u=[];let f=[];for(let d=0;d<n;d+=1){const v=e[d];if(v.isVisible){const b=c[d];b.length>0?b.forEach(E=>f.push(E.start)):f.push(v.start)}else f.length>0&&(f.push(e[d-1].end),u.push(f),f=[])}return f.length>0&&(f.push(this.end),u.push(f)),u}toPolylines(t={}){const e=this.toPoints(t);return e?e.map(n=>new T(n)):null}scale(t,e,n){return this.segments.forEach(c=>c.scale(t,e,n)),this}rotate(t,e){return this.segments.forEach(n=>n.rotate(t,e)),this}translate(t,e){return typeof t=="number"?this.segments.forEach(n=>n.translate(t,e)):this.segments.forEach(n=>n.translate(t)),this}clone(){const t=new F;return this.segments.forEach(e=>t.appendSegment(e.clone())),t}equals(t){if(t==null)return!1;const e=this.segments,n=t.segments,c=e.length;if(n.length!==c)return!1;for(let u=0;u<c;u+=1){const f=e[u],d=n[u];if(f.type!==d.type||!f.equals(d))return!1}return!0}toJSON(){return this.segments.map(t=>t.toJSON())}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map(t=>t.serialize()).join(" ")}toString(){return this.serialize()}}(function(a){function t(e){return e!=null&&e instanceof a}a.isPath=t})(F||(F={})),function(a){function t(n){if(!n)return new a;const c=new a,u=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,f=a.normalize(n).match(u);if(f!=null)for(let d=0,v=f.length;d<v;d+=1){const b=f[d],E=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,S=b.match(E);if(S!=null){const _=S[0],C=S.slice(1).map(L=>+L),D=e.call(null,_,...C);c.appendSegment(D)}}return c}a.parse=t;function e(n,...c){if(n==="M")return R.create.call(null,...c);if(n==="L")return N.create.call(null,...c);if(n==="C")return k.create.call(null,...c);if(n==="z"||n==="Z")return P.create();throw new Error(`Invalid path segment type "${n}"`)}a.createSegment=e}(F||(F={})),function(a){a.normalize=_t,a.isValid=p,a.drawArc=A,a.drawPoints=x,a.arcToCurves=w}(F||(F={}));class Z{constructor(t){this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(t,e,n=!1){if(typeof t=="object"){Object.entries(t).forEach(([f,d])=>{this.register(f,d,e)});return}this.exist(t)&&!n&&!ms.isApplyingHMR()&&this.onDuplicated(t);const c=this.options.process,u=c?Ke(c,this,t,e):e;return this.data[t]=u,u}unregister(t){const e=t?this.data[t]:null;return delete this.data[t],e}get(t){return t?this.data[t]:null}exist(t){return t?this.data[t]!=null:!1}onDuplicated(t){try{throw this.options.onConflict&&Ke(this.options.onConflict,this,t),new Error(`${qu(this.options.type)} with name '${t}' already registered.`)}catch(e){throw e}}onNotFound(t,e){throw new Error(this.getSpellingSuggestion(t,e))}getSpellingSuggestion(t,e){const n=this.getSpellingSuggestionForName(t),c=e?`${e} ${nx(this.options.type)}`:this.options.type;return`${qu(c)} with name '${t}' does not exist.${n?` Did you mean '${n}'?`:""}`}getSpellingSuggestionForName(t){return zf(t,Object.keys(this.data),e=>e)}}(function(a){function t(e){return new a(e)}a.create=t})(Z||(Z={}));const yt={color:"#aaaaaa",thickness:1,markup:"rect",update(a,t){const e=t.thickness*t.sx,n=t.thickness*t.sy;Dn(a,{width:e,height:n,rx:e,ry:n,fill:t.color})}},bt={color:"#aaaaaa",thickness:1,markup:"rect",update(a,t){const e=t.sx<=1?t.thickness*t.sx:t.thickness;Dn(a,{width:e,height:e,rx:e,ry:e,fill:t.color})}},de={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(a,t){let e;const n=t.width,c=t.height,u=t.thickness;n-u>=0&&c-u>=0?e=["M",n,0,"H0 M0 0 V0",c].join(" "):e="M 0 0 0 0",Dn(a,{d:e,stroke:t.color,"stroke-width":t.thickness})}},Ne=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(a,t){let e;const n=t.width,c=t.height,u=t.thickness;n-u>=0&&c-u>=0?e=["M",n,0,"H0 M0 0 V0",c].join(" "):e="M 0 0 0 0",Dn(a,{d:e,stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(a,t){let e;const n=t.factor||1,c=t.width*n,u=t.height*n,f=t.thickness;c-f>=0&&u-f>=0?e=["M",c,0,"H0 M0 0 V0",u].join(" "):e="M 0 0 0 0",t.width=c,t.height=u,Dn(a,{d:e,stroke:t.color,"stroke-width":t.thickness})}}];class Ee{constructor(){this.patterns={},this.root=sn.create(dl(),{width:"100%",height:"100%"},[Ni("defs")]).node}add(t,e){const n=this.root.childNodes[0];n&&n.appendChild(e),this.patterns[t]=e,sn.create("rect",{width:"100%",height:"100%",fill:`url(#${t})`}).appendTo(this.root)}get(t){return this.patterns[t]}has(t){return this.patterns[t]!=null}}(function(a){a.presets=Jt,a.registry=Z.create({type:"grid"}),a.registry.register(a.presets,!0)})(Ee||(Ee={}));const Ie=function(a){const t=document.createElement("canvas"),e=a.width,n=a.height;t.width=e*2,t.height=n;const c=t.getContext("2d");return c.drawImage(a,0,0,e,n),c.translate(2*e,0),c.scale(-1,1),c.drawImage(a,0,0,e,n),t},Ge=function(a){const t=document.createElement("canvas"),e=a.width,n=a.height;t.width=e,t.height=n*2;const c=t.getContext("2d");return c.drawImage(a,0,0,e,n),c.translate(0,2*n),c.scale(1,-1),c.drawImage(a,0,0,e,n),t},Qe=function(a){const t=document.createElement("canvas"),e=a.width,n=a.height;t.width=2*e,t.height=2*n;const c=t.getContext("2d");return c.drawImage(a,0,0,e,n),c.setTransform(-1,0,0,-1,t.width,t.height),c.drawImage(a,0,0,e,n),c.setTransform(-1,0,0,1,t.width,0),c.drawImage(a,0,0,e,n),c.setTransform(1,0,0,-1,0,t.height),c.drawImage(a,0,0,e,n),t},Xn=function(a,t){const e=a.width,n=a.height,c=document.createElement("canvas");c.width=e*3,c.height=n*3;const u=c.getContext("2d"),f=t.angle!=null?-t.angle:-20,d=Wn.toRad(f),v=c.width/4,b=c.height/4;for(let E=0;E<4;E+=1)for(let S=0;S<4;S+=1)(E+S)%2>0&&(u.setTransform(1,0,0,1,(2*E-1)*v,(2*S-1)*b),u.rotate(d),u.drawImage(a,-e/2,-n/2,e,n));return c};var Mn;(function(a){a.presets=Object.assign({},kt),a.presets["flip-x"]=Ie,a.presets["flip-y"]=Ge,a.presets["flip-xy"]=Qe,a.registry=Z.create({type:"background pattern"}),a.registry.register(a.presets,!0)})(Mn||(Mn={}));function Un(a,t){return a!=null?a:t}function Ut(a,t){return a!=null&&Number.isFinite(a)?a:t}function un(a={}){const t=Un(a.color,"blue"),e=Ut(a.width,1),n=Ut(a.margin,2),c=Ut(a.opacity,1),u=n,f=n+e;return`
    <filter>
      <feFlood flood-color="${t}" flood-opacity="${c}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${f}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${u}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim()}function Nn(a={}){const t=Un(a.color,"red"),e=Ut(a.blur,0),n=Ut(a.width,1),c=Ut(a.opacity,1);return`
      <filter>
        <feFlood flood-color="${t}" flood-opacity="${c}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${n}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${e}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim()}function En(a={}){const t=Ut(a.x,2);return`
    <filter>
      <feGaussianBlur stdDeviation="${a.y!=null&&Number.isFinite(a.y)?[t,a.y]:t}"/>
    </filter>
  `.trim()}function xn(a={}){const t=Ut(a.dx,0),e=Ut(a.dy,0),n=Un(a.color,"black"),c=Ut(a.blur,4),u=Ut(a.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${c}" dx="${t}" dy="${e}" flood-color="${n}" flood-opacity="${u}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${c}" />
         <feOffset dx="${t}" dy="${e}" result="offsetblur" />
         <feFlood flood-color="${n}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${u}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim()}function We(a={}){const t=Ut(a.amount,1),e=.2126+.7874*(1-t),n=.7152-.7152*(1-t),c=.0722-.0722*(1-t),u=.2126-.2126*(1-t),f=.7152+.2848*(1-t),d=.0722-.0722*(1-t),v=.2126-.2126*(1-t),b=.0722+.9278*(1-t);return`
    <filter>
      <feColorMatrix type="matrix" values="${e} ${n} ${c} 0 0 ${u} ${f} ${d} 0 0 ${v} ${n} ${b} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim()}function Xe(a={}){const t=Ut(a.amount,1),e=.393+.607*(1-t),n=.769-.769*(1-t),c=.189-.189*(1-t),u=.349-.349*(1-t),f=.686+.314*(1-t),d=.168-.168*(1-t),v=.272-.272*(1-t),b=.534-.534*(1-t),E=.131+.869*(1-t);return`
      <filter>
        <feColorMatrix type="matrix" values="${e} ${n} ${c} 0 0 ${u} ${f} ${d} 0 0 ${v} ${b} ${E} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim()}function rr(a={}){return`
      <filter>
        <feColorMatrix type="saturate" values="${1-Ut(a.amount,1)}"/>
      </filter>
    `.trim()}function Lr(a={}){return`
      <filter>
        <feColorMatrix type="hueRotate" values="${Ut(a.angle,0)}"/>
      </filter>
    `.trim()}function Tr(a={}){const t=Ut(a.amount,1),e=1-t;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${t} ${e}"/>
          <feFuncG type="table" tableValues="${t} ${e}"/>
          <feFuncB type="table" tableValues="${t} ${e}"/>
        </feComponentTransfer>
      </filter>
    `.trim()}function kn(a={}){const t=Ut(a.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${t}"/>
        <feFuncG type="linear" slope="${t}"/>
        <feFuncB type="linear" slope="${t}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}function fr(a={}){const t=Ut(a.amount,1),e=.5-t/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${t}" intercept="${e}"/>
        <feFuncG type="linear" slope="${t}" intercept="${e}"/>
        <feFuncB type="linear" slope="${t}" intercept="${e}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}var Vr;(function(a){a.presets=te,a.registry=Z.create({type:"filter"}),a.registry.register(a.presets,!0)})(Vr||(Vr={}));const yi={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},Ri={},gv={position:vv("x","width","origin")},Jp={position:vv("y","height","origin")},Ax={position:vv("x","width","corner")},pv={position:vv("y","height","corner")},mv={set:Cl("width","width")},Kp={set:Cl("height","height")},Kw={set:Cl("rx","width")},Qw={set:Cl("ry","height")},Zx={set:(a=>{const t=Cl(a,"width"),e=Cl(a,"height");return function(n,c){const u=c.refBBox,f=u.height>u.width?t:e;return Ke(f,this,n,c)}})("r")},tE={set(a,{refBBox:t}){let e=parseFloat(a);const n=Po(a);n&&(e/=100);const c=Math.sqrt(t.height*t.height+t.width*t.width);let u;return Number.isFinite(e)&&(n||e>=0&&e<=1?u=e*c:u=Math.max(e+c,0)),{r:u}}},eE={set:Cl("cx","width")},nE={set:Cl("cy","height")},qx={set:Kx({resetOffset:!0})},rE={set:Kx({resetOffset:!1})},Yx={set:Qx({resetOffset:!0})},iE={set:Qx({resetOffset:!1})},oE=Zx,sE=qx,aE=Yx,cE=gv,lE=Jp,uE=mv,hE=Kp;function vv(a,t,e){return(n,{refBBox:c})=>{if(n==null)return null;let u=parseFloat(n);const f=Po(n);f&&(u/=100);let d;if(Number.isFinite(u)){const b=c[e];f||u>0&&u<1?d=b[a]+c[t]*u:d=b[a]+u}const v=new o;return v[a]=d||0,v}}function Cl(a,t){return function(e,{refBBox:n}){let c=parseFloat(e);const u=Po(e);u&&(c/=100);const f={};if(Number.isFinite(c)){const d=u||c>=0&&c<=1?c*n[t]:Math.max(c+n[t],0);f[a]=d}return f}}function Jx(a,t){const e="x6-shape",n=t&&t.resetOffset;return function(c,{elem:u,refBBox:f}){let d=la(u,e);if(!d||d.value!==c){const L=a(c);d={value:c,shape:L,shapeBBox:L.bbox()},la(u,e,d)}const v=d.shape.clone(),b=d.shapeBBox.clone(),E=b.getOrigin(),S=f.getOrigin();b.x=S.x,b.y=S.y;const _=f.getMaxScaleToFit(b,S),C=b.width===0||f.width===0?1:_.sx,D=b.height===0||f.height===0?1:_.sy;return v.scale(C,D,E),n&&v.translate(-E.x,-E.y),v}}function Kx(a){function t(n){return F.parse(n)}const e=Jx(t,a);return(n,c)=>({d:e(n,c).serialize()})}function Qx(a){const t=Jx(e=>new T(e),a);return(e,n)=>({points:t(e,n).serialize()})}const fE={qualify:fi.Z,set(a,{view:t}){return`url(#${t.graph.defineGradient(a)})`}},dE={qualify:fi.Z,set(a,{view:t}){const e=t.cell,n=Object.assign({},a);if(e.isEdge()&&n.type==="linearGradient"){const c=t,u=c.sourcePoint,f=c.targetPoint;n.id=`gradient-${n.type}-${e.id}`,n.attrs=Object.assign(Object.assign({},n.attrs),{x1:u.x,y1:u.y,x2:f.x,y2:f.y,gradientUnits:"userSpaceOnUse"}),t.graph.defs.remove(n.id)}return`url(#${t.graph.defineGradient(n)})`}},tw={qualify(a,{attrs:t}){return t.textWrap==null||!fi.Z(t.textWrap)},set(a,{view:t,elem:e,attrs:n}){const c="x6-text",u=la(e,c),f=E=>{try{return JSON.parse(E)}catch(S){return E}},d={x:n.x,eol:n.eol,annotations:f(n.annotations),textPath:f(n["text-path"]||n.textPath),textVerticalAnchor:n["text-vertical-anchor"]||n.textVerticalAnchor,displayEmpty:(n["display-empty"]||n.displayEmpty)==="true",lineHeight:n["line-height"]||n.lineHeight},v=n["font-size"]||n.fontSize,b=JSON.stringify([a,d]);if(v&&e.setAttribute("font-size",v),u==null||u!==b){const E=d.textPath;if(E!=null&&typeof E=="object"){const S=E.selector;if(typeof S=="string"){const _=t.find(S)[0];_ instanceof SVGPathElement&&(Uf(_),d.textPath=Object.assign({"xlink:href":`#${_.id}`},E))}}Qf(e,`${a}`,d),la(e,c,b)}}},gE={qualify:fi.Z,set(a,{view:t,elem:e,attrs:n,refBBox:c}){const u=a,f=u.width||0;Po(f)?c.width*=parseFloat(f)/100:f<=0?c.width+=f:c.width=f;const d=u.height||0;Po(d)?c.height*=parseFloat(d)/100:d<=0?c.height+=d:c.height=d;let v,b=u.text;b==null&&(b=n.text||(e==null?void 0:e.textContent)),b!=null?v=El(`${b}`,c,{"font-weight":n["font-weight"]||n.fontWeight,"font-size":n["font-size"]||n.fontSize,"font-family":n["font-family"]||n.fontFamily,lineHeight:n.lineHeight},{ellipsis:u.ellipsis}):v="",Ke(tw.set,this,v,{view:t,elem:e,attrs:n,refBBox:c,cell:t.cell})}},ld=(a,{attrs:t})=>t.text!==void 0,pE={qualify:ld},mE={qualify:ld},vE={qualify:ld},yE={qualify:ld},bE={qualify:ld},xE={qualify:ld},wE={qualify(a,{elem:t}){return t instanceof SVGElement},set(a,{elem:t}){const e="x6-title",n=`${a}`,c=la(t,e);if(c==null||c!==n){la(t,e,n);const u=t.firstChild;if(u&&u.tagName.toUpperCase()==="TITLE"){const f=u;f.textContent=n}else{const f=document.createElementNS(t.namespaceURI,"title");f.textContent=n,t.insertBefore(f,u)}}}},EE={offset:ew("x","width","right")},_E={offset:ew("y","height","bottom")},SE={offset(a,{refBBox:t}){return a?{x:-t.x,y:-t.y}:{x:0,y:0}}};function ew(a,t,e){return(n,{refBBox:c})=>{const u=new o;let f;return n==="middle"?f=c[t]/2:n===e?f=c[t]:typeof n=="number"&&Number.isFinite(n)?f=n>-1&&n<1?-c[t]*n:-n:Po(n)?f=c[t]*parseFloat(n)/100:f=0,u[a]=-(c[a]+f),u}}const AE={qualify:fi.Z,set(a,{elem:t}){bl(t,a)}},TE={set(a,{elem:t}){t.innerHTML=`${a}`}},CE={qualify:fi.Z,set(a,{view:t}){return`url(#${t.graph.defineFilter(a)})`}},OE={set(a){return a!=null&&typeof a=="object"&&a.id?a.id:a}};function Ol(a,t,e){let n,c;typeof t=="object"?(n=t.x,c=t.y):(n=t,c=e);const u=F.parse(a),f=u.bbox();if(f){let d=-f.height/2-f.y,v=-f.width/2-f.x;typeof n=="number"&&(v-=n),typeof c=="number"&&(d-=c),u.translate(v,d)}return u.serialize()}var nw=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const IE=a=>{var{size:t,width:e,height:n,offset:c,open:u}=a,f=nw(a,["size","width","height","offset","open"]);return rw({size:t,width:e,height:n,offset:c},u===!0,!0,void 0,f)},ME=a=>{var{size:t,width:e,height:n,offset:c,factor:u}=a,f=nw(a,["size","width","height","offset","factor"]);return rw({size:t,width:e,height:n,offset:c},!1,!1,u,f)};function rw(a,t,e,n=3/4,c={}){const u=a.size||10,f=a.width||u,d=a.height||u,v=new F,b={};if(t)v.moveTo(f,0).lineTo(0,d/2).lineTo(f,d),b.fill="none";else{if(v.moveTo(0,d/2),v.lineTo(f,0),!e){const E=hr(n,0,1);v.lineTo(f*E,d/2)}v.lineTo(f,d),v.close()}return Object.assign(Object.assign(Object.assign({},b),c),{tagName:"path",d:Ol(v.serialize(),{x:a.offset!=null?a.offset:-f/2})})}var NE=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const PE=a=>{var{size:t,width:e,height:n,offset:c}=a,u=NE(a,["size","width","height","offset"]);const f=t||10,d=e||f,v=n||f,b=new F;return b.moveTo(0,v/2).lineTo(d/2,0).lineTo(d,v/2).lineTo(d/2,v).close(),Object.assign(Object.assign({},u),{tagName:"path",d:Ol(b.serialize(),c==null?-d/2:c)})};var DE=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const RE=a=>{var{d:t,offsetX:e,offsetY:n}=a,c=DE(a,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},c),{tagName:"path",d:Ol(t,e,n)})};var LE=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const kE=a=>{var{size:t,width:e,height:n,offset:c}=a,u=LE(a,["size","width","height","offset"]);const f=t||10,d=e||f,v=n||f,b=new F;return b.moveTo(0,0).lineTo(d,v).moveTo(0,v).lineTo(d,0),Object.assign(Object.assign({},u),{tagName:"path",fill:"none",d:Ol(b.serialize(),c||-d/2)})};var BE=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const jE=a=>{var{width:t,height:e,offset:n,open:c,flip:u}=a,f=BE(a,["width","height","offset","open","flip"]);let d=e||6;const v=t||10,b=c===!0,E=u===!0,S=Object.assign(Object.assign({},f),{tagName:"path"});E&&(d=-d);const _=new F;return _.moveTo(0,d).lineTo(v,0),b?S.fill="none":(_.lineTo(v,d),_.close()),S.d=Ol(_.serialize(),{x:n||-v/2,y:d/2}),S};var iw=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const ow=a=>{var{r:t}=a,e=iw(a,["r"]);const n=t||5;return Object.assign(Object.assign({cx:n},e),{tagName:"circle",r:n})},FE=a=>{var{r:t}=a,e=iw(a,["r"]);const n=t||5,c=new F;return c.moveTo(n,0).lineTo(n,n*2),c.moveTo(0,n).lineTo(n*2,n),{children:[Object.assign(Object.assign({},ow({r:n})),{fill:"none"}),Object.assign(Object.assign({},e),{tagName:"path",d:Ol(c.serialize(),-n)})]}};var GE=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const zE=a=>{var{rx:t,ry:e}=a,n=GE(a,["rx","ry"]);const c=t||5,u=e||5;return Object.assign(Object.assign({cx:c},n),{tagName:"ellipse",rx:c,ry:u})};var Il;(function(a){a.presets=Y,a.registry=Z.create({type:"marker"}),a.registry.register(a.presets,!0)})(Il||(Il={})),function(a){a.normalize=Ol}(Il||(Il={}));var UE=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};function Tx(a){return typeof a=="string"||fi.Z(a)}const VE={qualify:Tx,set(a,{view:t,attrs:e}){return Cx("marker-start",a,t,e)}},HE={qualify:Tx,set(a,{view:t,attrs:e}){return Cx("marker-end",a,t,e,{transform:"rotate(180)"})}},$E={qualify:Tx,set(a,{view:t,attrs:e}){return Cx("marker-mid",a,t,e)}};function Cx(a,t,e,n,c={}){const u=typeof t=="string"?{name:t}:t,{name:f,args:d}=u,v=UE(u,["name","args"]);let b=v;if(f&&typeof f=="string"){const S=Il.registry.get(f);if(S)b=S(Object.assign(Object.assign({},v),d));else return Il.registry.onNotFound(f)}const E=Object.assign(Object.assign(Object.assign({},WE(n,a)),c),b);return{[a]:`url(#${e.graph.defineMarker(E)})`}}function WE(a,t){const e={},n=a.stroke;typeof n=="string"&&(e.stroke=n,e.fill=n);let c=a.strokeOpacity;if(c==null&&(c=a["stroke-opacity"]),c==null&&(c=a.opacity),c!=null&&(e["stroke-opacity"]=c,e["fill-opacity"]=c),t!=="marker-mid"){const u=parseFloat(a.strokeWidth||a["stroke-width"]);if(Number.isFinite(u)&&u>1){const f=Math.ceil(u/2);e.refX=t==="marker-start"?f:-f}}return e}const Qp=(a,{view:t})=>t.cell.isEdge(),XE={qualify:Qp,set(a,t){var e,n,c,u;const f=t.view,d=a.reverse||!1,v=a.stubs||0;let b;if(Number.isFinite(v)&&v!==0)if(d){let E,S;const _=f.getConnectionLength()||0;v<0?(E=(_+v)/2,S=-v):(E=v,S=_-v*2);const C=f.getConnection();b=(u=(c=(n=(e=C==null?void 0:C.divideAtLength(E))===null||e===void 0?void 0:e[1])===null||n===void 0?void 0:n.divideAtLength(S))===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.serialize()}else{let E;v<0?E=((f.getConnectionLength()||0)+v)/2:E=v;const S=f.getConnection();if(S){const _=S.divideAtLength(E),C=S.divideAtLength(-E);_&&C&&(b=`${_[0].serialize()} ${C[1].serialize()}`)}}return{d:b||f.getConnectionPathData()}}},sw={qualify:Qp,set:yv("getTangentAtLength",{rotate:!0})},ZE={qualify:Qp,set:yv("getTangentAtLength",{rotate:!1})},aw={qualify:Qp,set:yv("getTangentAtRatio",{rotate:!0})},qE={qualify:Qp,set:yv("getTangentAtRatio",{rotate:!1})},YE=sw,JE=aw;function yv(a,t){const e={x:1,y:0};return(n,c)=>{let u,f;const d=c.view,v=d[a](Number(n));return v?(f=t.rotate?v.vector().vectorAngle(e):0,u=v.start):(u=d.path.start,f=0),f===0?{transform:`translate(${u.x},${u.y}')`}:{transform:`translate(${u.x},${u.y}') rotate(${f})`}}}var fa;(function(a){function t(e,n,c){return!!(e!=null&&(typeof e=="string"||typeof e.qualify!="function"||Ke(e.qualify,this,n,c)))}a.isValidDefinition=t})(fa||(fa={})),function(a){a.presets=Object.assign(Object.assign({},yi),Q),a.registry=Z.create({type:"attribute definition"}),a.registry.register(a.presets,!0)}(fa||(fa={}));const ri={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix(a){return`${ri.prefixCls}-${a}`}},cw=ri.prefix("highlighted"),KE={highlight(a,t,e){const n=e&&e.className||cw;xe(t,n)},unhighlight(a,t,e){const n=e&&e.className||cw;Mi(t,n)}},lw=ri.prefix("highlight-opacity"),QE={highlight(a,t){xe(t,lw)},unhighlight(a,t){Mi(t,lw)}};var Fn;(function(a){a.normalizeMarker=Ol;function t(_,C){const D=$p(_.x,_.y).matrixTransform(C);return new o(D.x,D.y)}a.transformPoint=t;function e(_,C){return new l(t(_.start,C),t(_.end,C))}a.transformLine=e;function n(_,C){let D=_ instanceof T?_.points:_;return Array.isArray(D)||(D=[]),new T(D.map(L=>t(L,C)))}a.transformPolyline=n;function c(_,C){const L=Ni("svg").createSVGPoint();L.x=_.x,L.y=_.y;const B=L.matrixTransform(C);L.x=_.x+_.width,L.y=_.y;const H=L.matrixTransform(C);L.x=_.x+_.width,L.y=_.y+_.height;const J=L.matrixTransform(C);L.x=_.x,L.y=_.y+_.height;const V=L.matrixTransform(C),ct=Math.min(B.x,H.x,J.x,V.x),dt=Math.max(B.x,H.x,J.x,V.x),At=Math.min(B.y,H.y,J.y,V.y),le=Math.max(B.y,H.y,J.y,V.y);return new s(ct,At,dt-ct,le-At)}a.transformRectangle=c;function u(_,C,D){let L;const B=_.ownerSVGElement;if(!B)return new s(0,0,0,0);try{L=_.getBBox()}catch(J){L={x:_.clientLeft,y:_.clientTop,width:_.clientWidth,height:_.clientHeight}}if(C)return s.create(L);const H=ha(_,D||B);return c(L,H)}a.bbox=u;function f(_,C={}){let D;if(!_.ownerSVGElement||!vs(_)){if(zp(_)){const{left:J,top:V,width:ct,height:dt}=d(_);return new s(J,V,ct,dt)}return new s(0,0,0,0)}let B=C.target;if(!C.recursive){try{D=_.getBBox()}catch(V){D={x:_.clientLeft,y:_.clientTop,width:_.clientWidth,height:_.clientHeight}}if(!B)return s.create(D);const J=ha(_,B);return c(D,J)}{const J=_.childNodes,V=J.length;if(V===0)return f(_,{target:B});B||(B=_);for(let ct=0;ct<V;ct+=1){const dt=J[ct];let At;dt.childNodes.length===0?At=f(dt,{target:B}):At=f(dt,{target:B,recursive:!0}),D?D=D.union(At):D=At}return D}}a.getBBox=f;function d(_){let C=0,D=0,L=0,B=0;if(_){let H=_;for(;H;)C+=H.offsetLeft,D+=H.offsetTop,H=H.offsetParent,H&&(C+=parseInt(Ar(H,"borderLeft"),10),D+=parseInt(Ar(H,"borderTop"),10));L=_.offsetWidth,B=_.offsetHeight}return{left:C,top:D,width:L,height:B}}a.getBoundingOffsetRect=d;function v(_){const C=D=>{const L=_.getAttribute(D),B=L?parseFloat(L):0;return Number.isNaN(B)?0:B};switch(_ instanceof SVGElement&&_.nodeName.toLowerCase()){case"rect":return new s(C("x"),C("y"),C("width"),C("height"));case"circle":return new h(C("cx"),C("cy"),C("r"),C("r"));case"ellipse":return new h(C("cx"),C("cy"),C("rx"),C("ry"));case"polyline":{const D=Ya(_);return new T(D)}case"polygon":{const D=Ya(_);return D.length>1&&D.push(D[0]),new T(D)}case"path":{let D=_.getAttribute("d");return F.isValid(D)||(D=F.normalize(D)),F.parse(D)}case"line":return new l(C("x1"),C("y1"),C("x2"),C("y2"));default:break}return f(_)}a.toGeometryShape=v;function b(_,C,D,L){const B=o.create(C),H=o.create(D);L||(L=_ instanceof SVGSVGElement?_:_.ownerSVGElement);const J=id(_);_.setAttribute("transform","");const V=f(_,{target:L}).scale(J.sx,J.sy),ct=Al();ct.setTranslate(-V.x-V.width/2,-V.y-V.height/2);const dt=Al(),At=B.angleBetween(H,B.clone().translate(1,0));At&&dt.setRotate(At,0,0);const le=Al(),ye=B.clone().move(H,V.width/2);le.setTranslate(2*B.x-ye.x,2*B.y-ye.y);const be=ha(_,L),Re=Al();Re.setMatrix(le.matrix.multiply(dt.matrix.multiply(ct.matrix.multiply(be.scale(J.sx,J.sy))))),_.setAttribute("transform",Ka(Re.matrix))}a.translateAndAutoOrient=b;function E(_){if(_==null)return null;let C=_;do{let D=C.tagName;if(typeof D!="string")return null;if(D=D.toUpperCase(),aa(C,"x6-port"))C=C.nextElementSibling;else if(D==="G")C=C.firstElementChild;else if(D==="TITLE")C=C.nextElementSibling;else break}while(C);return C}a.findShapeNode=E;function S(_){const C=E(_);if(!vs(C)){if(zp(_)){const{left:B,top:H,width:J,height:V}=d(_);return new s(B,H,J,V)}return new s(0,0,0,0)}return v(C).bbox()||s.create()}a.getBBoxV2=S})(Fn||(Fn={}));const t1={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},e1={highlight(a,t,e){const n=Ml.getHighlighterId(t,e);if(Ml.hasCache(n))return;e=Qg({},e,t1);const c=sn.create(t);let u,f;try{u=c.toPathData()}catch(E){f=Fn.bbox(c.node,!0),u=Hp(Object.assign(Object.assign({},e),f))}const d=Ni("path");if(Dn(d,Object.assign({d:u,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},e.attrs?vo(e.attrs):null)),a.isEdgeElement(t))Dn(d,"d",a.getConnectionPathData());else{let E=c.getTransformToElement(a.container);const S=e.padding;if(S){f==null&&(f=Fn.bbox(c.node,!0));const _=f.x+f.width/2,C=f.y+f.height/2;f=Fn.transformRectangle(f,E);const D=Math.max(f.width,1),L=Math.max(f.height,1),B=(D+S)/D,H=(L+S)/L,J=Ur({a:B,b:0,c:0,d:H,e:_-B*_,f:C-H*C});E=E.multiply(J)}Es(d,E)}xe(d,ri.prefix("highlight-stroke"));const v=a.cell,b=()=>Ml.removeHighlighter(n);v.on("removed",b),v.model&&v.model.on("reseted",b),a.container.appendChild(d),Ml.setCache(n,d)},unhighlight(a,t,e){Ml.removeHighlighter(Ml.getHighlighterId(t,e))}};var Ml;(function(a){function t(f,d){return Uf(f),f.id+JSON.stringify(d)}a.getHighlighterId=t;const e={};function n(f,d){e[f]=d}a.setCache=n;function c(f){return e[f]!=null}a.hasCache=c;function u(f){const d=e[f];d&&(Do(d),delete e[f])}a.removeHighlighter=u})(Ml||(Ml={}));var sc;(function(a){function t(e,n){if(typeof n.highlight!="function")throw new Error(`Highlighter '${e}' is missing required \`highlight()\` method`);if(typeof n.unhighlight!="function")throw new Error(`Highlighter '${e}' is missing required \`unhighlight()\` method`)}a.check=t})(sc||(sc={})),function(a){a.presets=st,a.registry=Z.create({type:"highlighter"}),a.registry.register(a.presets,!0)}(sc||(sc={}));function Ox(a,t={}){return new o($i(t.x,a.width),$i(t.y,a.height))}function Ix(a,t,e){return Object.assign({angle:t,position:a.toJSON()},e)}const n1=(a,t)=>a.map(({x:e,y:n,angle:c})=>Ix(Ox(t,{x:e,y:n}),c||0)),r1=(a,t,e)=>{const n=e.start||0,c=e.step||20;return uw(a,t,n,(u,f)=>(u+.5-f/2)*c)},i1=(a,t,e)=>{const n=e.start||0,c=e.step||360/a.length;return uw(a,t,n,u=>u*c)};function uw(a,t,e,n){const c=t.getCenter(),u=t.getTopCenter(),f=t.width/t.height,d=h.fromRect(t),v=a.length;return a.map((b,E)=>{const S=e+n(E,v),_=u.clone().rotate(-S,c).scale(f,1,c),C=b.compensateRotate?-d.tangentTheta(_):0;return(b.dx||b.dy)&&_.translate(b.dx||0,b.dy||0),b.dr&&_.move(c,b.dr),Ix(_.round(),C,b)})}var o1=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const s1=(a,t,e)=>{const n=Ox(t,e.start||t.getOrigin()),c=Ox(t,e.end||t.getCorner());return tm(a,n,c,e)},a1=(a,t,e)=>tm(a,t.getTopLeft(),t.getBottomLeft(),e),c1=(a,t,e)=>tm(a,t.getTopRight(),t.getBottomRight(),e),l1=(a,t,e)=>tm(a,t.getTopLeft(),t.getTopRight(),e),u1=(a,t,e)=>tm(a,t.getBottomLeft(),t.getBottomRight(),e);function tm(a,t,e,n){const c=new l(t,e),u=a.length;return a.map((f,d)=>{var{strict:v}=f,b=o1(f,["strict"]);const E=v||n.strict?(d+1)/(u+1):(d+.5)/u,S=c.pointAt(E);return(b.dx||b.dy)&&S.translate(b.dx||0,b.dy||0),Ix(S.round(),0,b)})}var rh;(function(a){a.presets=at,a.registry=Z.create({type:"port layout"}),a.registry.register(a.presets,!0)})(rh||(rh={}));const h1={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function Nl(a,t){const{x:e,y:n,angle:c,attrs:u}=t||{};return Qg({},{angle:c,attrs:u,position:{x:e,y:n}},a,h1)}const f1=(a,t,e)=>Nl({position:t.getTopLeft()},e),d1=(a,t,e)=>Nl({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},e),g1=(a,t,e)=>Nl({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},e),p1=(a,t,e)=>Nl({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},e),m1=(a,t,e)=>Nl({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},e),v1=(a,t,e)=>hw(a,t,!1,e),y1=(a,t,e)=>hw(a,t,!0,e),b1=(a,t,e)=>fw(a,t,!1,e),x1=(a,t,e)=>fw(a,t,!0,e);function hw(a,t,e,n){const c=n.offset!=null?n.offset:15,u=t.getCenter().theta(a),f=dw(t);let d,v,b,E,S=0;return u<f[1]||u>f[2]?(d=".3em",v=c,b=0,E="start"):u<f[0]?(d="0",v=0,b=-c,e?(S=-90,E="start"):E="middle"):u<f[3]?(d=".3em",v=-c,b=0,E="end"):(d=".6em",v=0,b=c,e?(S=90,E="start"):E="middle"),Nl({position:{x:Math.round(v),y:Math.round(b)},angle:S,attrs:{".":{y:d,"text-anchor":E}}},n)}function fw(a,t,e,n){const c=n.offset!=null?n.offset:15,u=t.getCenter().theta(a),f=dw(t);let d,v,b,E,S=0;return u<f[1]||u>f[2]?(d=".3em",v=-c,b=0,E="end"):u<f[0]?(d=".6em",v=0,b=c,e?(S=90,E="start"):E="middle"):u<f[3]?(d=".3em",v=c,b=0,E="start"):(d="0em",v=0,b=-c,e?(S=-90,E="start"):E="middle"),Nl({position:{x:Math.round(v),y:Math.round(b)},angle:S,attrs:{".":{y:d,"text-anchor":E}}},n)}function dw(a){const t=a.getCenter(),e=t.theta(a.getTopLeft()),n=t.theta(a.getBottomLeft()),c=t.theta(a.getBottomRight()),u=t.theta(a.getTopRight());return[e,u,c,n]}const w1=(a,t,e)=>gw(a.diff(t.getCenter()),!1,e),E1=(a,t,e)=>gw(a.diff(t.getCenter()),!0,e);function gw(a,t,e){const n=e.offset!=null?e.offset:20,c=new o(0,0),u=-a.theta(c),f=a.clone().move(c,n).diff(a).round();let d=".3em",v,b=u;return(u+90)%180===0?(v=t?"end":"middle",!t&&u===-270&&(d="0em")):u>-270&&u<-90?(v="start",b=u-180):v="end",Nl({position:f.round().toJSON(),angle:t?b:0,attrs:{".":{y:d,"text-anchor":v}}},e)}var ud;(function(a){a.presets=jt,a.registry=Z.create({type:"port label layout"}),a.registry.register(a.presets,!0)})(ud||(ud={}));var _1=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class ir extends vi{get priority(){return 2}get disposeContainer(){return!0}constructor(){super(),this.cid=Mx.uniqueId(),ir.views[this.cid]=this}confirmUpdate(t,e){return 0}empty(t=this.container){return gl(t),this}unmount(t=this.container){return Do(t),this}remove(t=this.container){return t===this.container?(this.removeEventListeners(document),this.onRemove(),delete ir.views[this.cid],this.disposeContainer&&this.unmount(t)):this.unmount(t),this}onRemove(){}setClass(t,e=this.container){e.classList.value=Array.isArray(t)?t.join(" "):t}addClass(t,e=this.container){return xe(e,Array.isArray(t)?t.join(" "):t),this}removeClass(t,e=this.container){return Mi(e,Array.isArray(t)?t.join(" "):t),this}setStyle(t,e=this.container){return bl(e,t),this}setAttrs(t,e=this.container){return t!=null&&e!=null&&Dn(e,t),this}findAttr(t,e=this.container){let n=e;for(;n&&n.nodeType===1;){const c=n.getAttribute(t);if(c!=null)return c;if(n===this.container)return null;n=n.parentNode}return null}find(t,e=this.container,n=this.selectors){return ir.find(t,e,n).elems}findOne(t,e=this.container,n=this.selectors){const c=this.find(t,e,n);return c.length>0?c[0]:null}findByAttr(t,e=this.container){let n=e;for(;n&&n.getAttribute;){const c=n.getAttribute(t);if((c!=null||n===this.container)&&c!=="false")return n;n=n.parentNode}return null}getSelector(t,e){let n;if(t===this.container)return typeof e=="string"&&(n=`> ${e}`),n;if(t){const c=mo(t)+1;n=`${t.tagName.toLowerCase()}:nth-child(${c})`,e&&(n+=` > ${e}`),n=this.getSelector(t.parentNode,n)}return n}prefixClassName(t){return ri.prefix(t)}delegateEvents(t,e){if(t==null)return this;e||this.undelegateEvents();const n=/^(\S+)\s*(.*)$/;return Object.keys(t).forEach(c=>{const u=c.match(n);if(u==null)return;const f=this.getEventHandler(t[c]);typeof f=="function"&&this.delegateEvent(u[1],u[2],f)}),this}undelegateEvents(){return Rr.off(this.container,this.getEventNamespace()),this}delegateDocumentEvents(t,e){return this.addEventListeners(document,t,e),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(t,e,n){return Rr.on(this.container,t+this.getEventNamespace(),e,n),this}undelegateEvent(t,e,n){const c=t+this.getEventNamespace();return e==null?Rr.off(this.container,c):typeof e=="string"?Rr.off(this.container,c,e,n):Rr.off(this.container,c,e),this}addEventListeners(t,e,n){if(e==null)return this;const c=this.getEventNamespace();return Object.keys(e).forEach(u=>{const f=this.getEventHandler(e[u]);typeof f=="function"&&Rr.on(t,u+c,n,f)}),this}removeEventListeners(t){return t!=null&&Rr.off(t,this.getEventNamespace()),this}getEventNamespace(){return`.${ri.prefixCls}-event-${this.cid}`}getEventHandler(t){let e;if(typeof t=="string"){const n=this[t];typeof n=="function"&&(e=(...c)=>n.call(this,...c))}else e=(...n)=>t.call(this,...n);return e}getEventTarget(t,e={}){const{target:n,type:c,clientX:u=0,clientY:f=0}=t;return e.fromPoint||c==="touchmove"||c==="touchend"?document.elementFromPoint(u,f):n}stopPropagation(t){return this.setEventData(t,{propagationStopped:!0}),this}isPropagationStopped(t){return this.getEventData(t).propagationStopped===!0}getEventData(t){return this.eventData(t)}setEventData(t,e){return this.eventData(t,e)}eventData(t,e){if(t==null)throw new TypeError("Event object required");let n=t.data;const c=`__${this.cid}__`;return e==null?n==null?{}:n[c]||{}:(n==null&&(n=t.data={}),n[c]==null?n[c]=Object.assign({},e):n[c]=Object.assign(Object.assign({},n[c]),e),n[c])}normalizeEvent(t){return ir.normalizeEvent(t)}dispose(){this.remove()}}_1([ir.dispose()],ir.prototype,"dispose",null),function(a){function t(c,u){return u?Ni(c||"g"):Hf(c||"div")}a.createElement=t;function e(c,u,f){if(!c||c===".")return{elems:[u]};if(f){const d=f[c];if(d)return{elems:Array.isArray(d)?d:[d]}}if(ri.useCSSSelector){const d=c.includes(">")?`:scope ${c}`:c;return{isCSSSelector:!0,elems:Array.prototype.slice.call(u.querySelectorAll(d))}}return{elems:[]}}a.find=e;function n(c){let u=c;const f=c.originalEvent,d=f&&f.changedTouches&&f.changedTouches[0];if(d){for(const v in c)d[v]===void 0&&(d[v]=c[v]);u=d}return u}a.normalizeEvent=n}(ir||(ir={})),function(a){a.views={};function t(e){return a.views[e]||null}a.getView=t}(ir||(ir={}));var Mx;(function(a){let t=0;function e(){const n=`v${t}`;return t+=1,n}a.uniqueId=e})(Mx||(Mx={}));class S1{constructor(t){this.view=t,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new cd,this.pathCache={}}get(t){return this.elemCache.has(t)||this.elemCache.set(t,{}),this.elemCache.get(t)}getData(t){const e=this.get(t);return e.data||(e.data={}),e.data}getMatrix(t){const e=this.get(t);if(e.matrix==null){const n=this.view.container;e.matrix=Qa(t,n)}return Ur(e.matrix)}getShape(t){const e=this.get(t);return e.shape==null&&(e.shape=Fn.toGeometryShape(t)),e.shape.clone()}getBoundingRect(t){const e=this.get(t);return e.boundingRect==null&&(e.boundingRect=Fn.getBBoxV2(t)),e.boundingRect.clone()}}var or;(function(a){function t(b){return b!=null&&!e(b)}a.isJSONMarkup=t;function e(b){return b!=null&&typeof b=="string"}a.isStringMarkup=e;function n(b){return b==null||e(b)?b:ur(b)}a.clone=n;function c(b){return`${b}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}a.sanitize=c;function u(b,E={ns:Dr.svg}){const S=document.createDocumentFragment(),_={},C={},D=[{markup:Array.isArray(b)?b:[b],parent:S,ns:E.ns}];for(;D.length>0;){const L=D.pop();let B=L.ns||Dr.svg;const H=L.markup,J=L.parent;H.forEach(V=>{const ct=V.tagName;if(!ct)throw new TypeError("Invalid tagName");V.ns&&(B=V.ns);const dt=B?Hf(ct,B):Vf(ct),At=V.attrs;At&&Dn(dt,vo(At));const le=V.style;le&&bl(dt,le);const ye=V.className;ye!=null&&dt.setAttribute("class",Array.isArray(ye)?ye.join(" "):ye),V.textContent&&(dt.textContent=V.textContent);const be=V.selector;if(be!=null){if(C[be])throw new TypeError("Selector must be unique");C[be]=dt}if(V.groupSelector){let Ae=V.groupSelector;Array.isArray(Ae)||(Ae=[Ae]),Ae.forEach(Fe=>{_[Fe]||(_[Fe]=[]),_[Fe].push(dt)})}J.appendChild(dt);const Re=V.children;Array.isArray(Re)&&D.push({ns:B,markup:Re,parent:dt})})}return Object.keys(_).forEach(L=>{if(C[L])throw new Error("Ambiguous group selector");C[L]=_[L]}),{fragment:S,selectors:C,groups:_}}a.parseJSONMarkup=u;function f(b){return b instanceof SVGElement?Ni("g"):Vf("div")}function d(b){if(e(b)){const C=sn.createVectors(b),D=C.length;if(D===1)return{elem:C[0].node};if(D>1){const L=f(C[0].node);return C.forEach(B=>{L.appendChild(B.node)}),{elem:L}}return{}}const E=u(b),S=E.fragment;let _=null;return S.childNodes.length>1?(_=f(S.firstChild),_.appendChild(S)):_=S.firstChild,{elem:_,selectors:E.selectors}}a.renderMarkup=d;function v(b){const E=sn.createVectors(b),S=document.createDocumentFragment();for(let _=0,C=E.length;_<C;_+=1){const D=E[_].node;S.appendChild(D)}return{fragment:S,selectors:{}}}a.parseLabelStringMarkup=v})(or||(or={})),function(a){function t(e,n,c){if(e!=null){let u;const f=e.tagName.toLowerCase();if(e===n)return typeof c=="string"?u=`> ${f} > ${c}`:u=`> ${f}`,u;const d=e.parentNode;if(d&&d.childNodes.length>1){const v=mo(e)+1;u=`${f}:nth-child(${v})`}else u=f;return c&&(u+=` > ${c}`),t(e.parentNode,n,u)}return c}a.getSelector=t}(or||(or={})),function(a){function t(){return"g"}a.getPortContainerMarkup=t;function e(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}}a.getPortMarkup=e;function n(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}a.getPortLabelMarkup=n}(or||(or={})),function(a){function t(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}a.getEdgeMarkup=t}(or||(or={})),function(a){function t(e=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:Dr.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:Dr.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}a.getForeignObjectMarkup=t}(or||(or={}));class pw{constructor(t){this.view=t}get cell(){return this.view.cell}getDefinition(t){return this.cell.getAttrDefinition(t)}processAttrs(t,e){let n,c,u,f;const d=[];return Object.keys(e).forEach(v=>{const b=e[v],E=this.getDefinition(v),S=Ke(fa.isValidDefinition,this.view,E,b,{elem:t,attrs:e,cell:this.cell,view:this.view});if(E&&S)typeof E=="string"?(n==null&&(n={}),n[E]=b):b!==null&&d.push({name:v,definition:E});else{n==null&&(n={});const _=Y0.includes(v)?v:Pp(v);n[_]=b}}),d.forEach(({name:v,definition:b})=>{const E=e[v];typeof b.set=="function"&&(c==null&&(c={}),c[v]=E),typeof b.offset=="function"&&(u==null&&(u={}),u[v]=E),typeof b.position=="function"&&(f==null&&(f={}),f[v]=E)}),{raw:e,normal:n,set:c,offset:u,position:f}}mergeProcessedAttrs(t,e){t.set=Object.assign(Object.assign({},t.set),e.set),t.position=Object.assign(Object.assign({},t.position),e.position),t.offset=Object.assign(Object.assign({},t.offset),e.offset);const n=t.normal&&t.normal.transform;n!=null&&e.normal&&(e.normal.transform=n),t.normal=e.normal}findAttrs(t,e,n,c){const u=[],f=new cd;return Object.keys(t).forEach(d=>{const v=t[d];if(!fi.Z(v))return;const{isCSSSelector:b,elems:E}=ir.find(d,e,c);n[d]=E;for(let S=0,_=E.length;S<_;S+=1){const C=E[S],D=c&&c[d]===C,L=f.get(C);if(L){L.array||(u.push(C),L.array=!0,L.attrs=[L.attrs],L.priority=[L.priority]);const B=L.attrs,H=L.priority;if(D)B.unshift(v),H.unshift(-1);else{const J=cy(H,b?-1:_);B.splice(J,0,v),H.splice(J,0,_)}}else f.set(C,{elem:C,attrs:v,priority:D?-1:_,array:!1})}}),u.forEach(d=>{const v=f.get(d),b=v.attrs;v.attrs=b.reduceRight((E,S)=>Yn(E,S),{})}),f}updateRelativeAttrs(t,e,n){const c=e.raw||{};let u=e.normal||{};const f=e.set,d=e.position,v=e.offset,b=()=>({elem:t,cell:this.cell,view:this.view,attrs:c,refBBox:n.clone()});if(f!=null&&Object.keys(f).forEach(B=>{const H=f[B],J=this.getDefinition(B);if(J!=null){const V=Ke(J.set,this.view,H,b());typeof V=="object"?u=Object.assign(Object.assign({},u),V):V!=null&&(u[B]=V)}}),t instanceof HTMLElement){this.view.setAttrs(u,t);return}const E=u.transform,S=E?`${E}`:null,_=th(S),C=new o(_.e,_.f);E&&(delete u.transform,_.e=0,_.f=0);let D=!1;d!=null&&Object.keys(d).forEach(B=>{const H=d[B],J=this.getDefinition(B);if(J!=null){const V=Ke(J.position,this.view,H,b());V!=null&&(D=!0,C.translate(o.create(V)))}}),this.view.setAttrs(u,t);let L=!1;if(v!=null){const B=this.view.getBoundingRectOfElement(t);if(B.width>0&&B.height>0){const H=Fn.transformRectangle(B,_);Object.keys(v).forEach(J=>{const V=v[J],ct=this.getDefinition(J);if(ct!=null){const dt=Ke(ct.offset,this.view,V,{elem:t,cell:this.cell,view:this.view,attrs:c,refBBox:H});dt!=null&&(L=!0,C.translate(o.create(dt)))}})}}(E!=null||D||L)&&(C.round(1),_.e=C.x,_.f=C.y,t.setAttribute("transform",Ka(_)))}update(t,e,n){const c={},u=this.findAttrs(n.attrs||e,t,c,n.selectors),f=n.attrs?this.findAttrs(e,t,c,n.selectors):u,d=[];u.each(E=>{const S=E.elem,_=E.attrs,C=this.processAttrs(S,_);if(C.set==null&&C.position==null&&C.offset==null)this.view.setAttrs(C.normal,S);else{const D=f.get(S),L=D?D.attrs:null,B=L&&_.ref==null?L.ref:_.ref;let H;if(B){if(H=(c[B]||this.view.find(B,t,n.selectors))[0],!H)throw new Error(`"${B}" reference does not exist.`)}else H=null;const J={node:S,refNode:H,attributes:L,processedAttributes:C},V=d.findIndex(ct=>ct.refNode===S);V>-1?d.splice(V,0,J):d.push(J)}});const v=new cd;let b;d.forEach(E=>{const S=E.node,_=E.refNode;let C;const D=_!=null&&n.rotatableNode!=null&&Gp(n.rotatableNode,_);if(_&&(C=v.get(_)),!C){const H=D?n.rotatableNode:t;C=_?Fn.getBBox(_,{target:H}):n.rootBBox,_&&v.set(_,C)}let L;n.attrs&&E.attributes?(L=this.processAttrs(S,E.attributes),this.mergeProcessedAttrs(L,E.processedAttributes)):L=E.processedAttributes;let B=C;D&&n.rotatableNode!=null&&!n.rotatableNode.contains(S)&&(b||(b=th(Dn(n.rotatableNode,"transform"))),B=Fn.transformRectangle(C,b)),this.updateRelativeAttrs(S,L,B)})}}class mw{get cell(){return this.view.cell}constructor(t,e,n=[]){this.view=t;const c={},u={};let f=0;Object.keys(e).forEach(v=>{let b=e[v];Array.isArray(b)||(b=[b]),b.forEach(E=>{let S=c[E];S||(f+=1,S=c[E]=1<<f),u[v]|=S})});let d=n;if(Array.isArray(d)||(d=[d]),d.forEach(v=>{c[v]||(f+=1,c[v]=1<<f)}),f>25)throw new Error("Maximum number of flags exceeded.");this.flags=c,this.attrs=u,this.bootstrap=n}getFlag(t){const e=this.flags;return e==null?0:Array.isArray(t)?t.reduce((n,c)=>n|e[c],0):e[t]|0}hasAction(t,e){return t&this.getFlag(e)}removeAction(t,e){return t^t&this.getFlag(e)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let t=0;return this.attrs&&Object.keys(this.attrs).forEach(e=>{this.cell.hasChanged(e)&&(t|=this.attrs[e])}),t}}var A1=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u},T1=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class kr extends ir{static getDefaults(){return this.defaults}static config(t){this.defaults=this.getOptions(t)}static getOptions(t){const e=(b,E)=>E!=null?Wu([...Array.isArray(b)?b:[b],...Array.isArray(E)?E:[E]]):Array.isArray(b)?[...b]:[b],n=ur(this.getDefaults()),{bootstrap:c,actions:u,events:f,documentEvents:d}=t,v=T1(t,["bootstrap","actions","events","documentEvents"]);return c&&(n.bootstrap=e(n.bootstrap,c)),u&&Object.entries(u).forEach(([b,E])=>{const S=n.actions[b];E&&S?n.actions[b]=e(S,E):E&&(n.actions[b]=e(E))}),f&&(n.events=Object.assign(Object.assign({},n.events),f)),t.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),d)),Yn(n,v)}get[Symbol.toStringTag](){return kr.toStringTag}constructor(t,e={}){super(),this.cell=t,this.options=this.ensureOptions(e),this.graph=this.options.graph,this.attr=new pw(this),this.flag=new mw(this,this.options.actions,this.options.bootstrap),this.cache=new S1(this),this.setContainer(this.ensureContainer()),this.setup(),this.init()}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(t){return this.getConstructor().getOptions(t)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return ir.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(t){if(this.container!==t){this.undelegateEvents(),this.container=t,this.options.events!=null&&this.delegateEvents(this.options.events);const e=this.getContainerAttrs();e!=null&&this.setAttrs(e,t);const n=this.getContainerStyle();n!=null&&this.setStyle(n,t);const c=this.getContainerClassName();c!=null&&this.addClass(c,t)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(t,e={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(t){return this.flag.getFlag(t)}hasAction(t,e){return this.flag.hasAction(t,e)}removeAction(t,e){return this.flag.removeAction(t,e)}handleAction(t,e,n,c){if(this.hasAction(t,e)){n();const u=[e];return c&&(typeof c=="string"?u.push(c):u.push(...c)),this.removeAction(t,u)}return t}setup(){this.cell.on("changed",this.onCellChanged,this)}onCellChanged({options:t}){this.onAttrsChange(t)}onAttrsChange(t){let e=this.flag.getChangedFlag();t.updated||!e||(t.dirty&&this.hasAction(e,"update")&&(e|=this.getFlag("render")),t.toolId&&(t.async=!1),this.graph!=null&&this.graph.renderer.requestViewUpdate(this,e,t))}parseJSONMarkup(t,e){const n=or.parseJSONMarkup(t),c=n.selectors,u=this.rootSelector;if(e&&u){if(c[u])throw new Error("Invalid root selector");c[u]=e}return n}can(t){let e=this.graph.options.interacting;if(typeof e=="function"&&(e=Ke(e,this.graph,this)),typeof e=="object"){let n=e[t];return typeof n=="function"&&(n=Ke(n,this.graph,this)),n!==!1}return typeof e=="boolean"?e:!1}cleanCache(){return this.cache.clean(),this}getCache(t){return this.cache.get(t)}getDataOfElement(t){return this.cache.getData(t)}getMatrixOfElement(t){return this.cache.getMatrix(t)}getShapeOfElement(t){return this.cache.getShape(t)}getBoundingRectOfElement(t){return this.cache.getBoundingRect(t)}getBBoxOfElement(t){const e=this.getBoundingRectOfElement(t),n=this.getMatrixOfElement(t),c=this.getRootRotatedMatrix(),u=this.getRootTranslatedMatrix();return Fn.transformRectangle(e,u.multiply(c).multiply(n))}getUnrotatedBBoxOfElement(t){const e=this.getBoundingRectOfElement(t),n=this.getMatrixOfElement(t),c=this.getRootTranslatedMatrix();return Fn.transformRectangle(e,c.multiply(n))}getBBox(t={}){let e;if(t.useCellGeometry){const n=this.cell,c=n.isNode()?n.getAngle():0;e=n.getBBox().bbox(c)}else e=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(e)}getRootTranslatedMatrix(){const t=this.cell,e=t.isNode()?t.getPosition():{x:0,y:0};return Ur().translate(e.x,e.y)}getRootRotatedMatrix(){let t=Ur();const e=this.cell,n=e.isNode()?e.getAngle():0;if(n){const c=e.getBBox(),u=c.width/2,f=c.height/2;t=t.translate(u,f).rotate(n).translate(-u,-f)}return t}findMagnet(t=this.container){return this.findByAttr("magnet",t)}updateAttrs(t,e,n={}){n.rootBBox==null&&(n.rootBBox=new s),n.selectors==null&&(n.selectors=this.selectors),this.attr.update(t,e,n)}isEdgeElement(t){return this.cell.isEdge()&&(t==null||t===this.container)}prepareHighlight(t,e={}){const n=t||this.container;return e.partial=n===this.container,n}highlight(t,e={}){const n=this.prepareHighlight(t,e);return this.notify("cell:highlight",{magnet:n,options:e,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:e,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:e,view:this,node:this.cell,cell:this.cell}),this}unhighlight(t,e={}){const n=this.prepareHighlight(t,e);return this.notify("cell:unhighlight",{magnet:n,options:e,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:e,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:e,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(t,e){}getEdgeTerminal(t,e,n,c,u){const f=this.cell,d=this.findAttr("port",t),v=t.getAttribute("data-selector"),b={cell:f.id};return v!=null&&(b.magnet=v),d!=null?(b.port=d,f.isNode()&&!f.hasPort(d)&&v==null&&(b.selector=this.getSelector(t))):v==null&&this.container!==t&&(b.selector=this.getSelector(t)),b}getMagnetFromEdgeTerminal(t){const e=this.cell,n=this.container,c=t.port;let u=t.magnet,f;return c!=null&&e.isNode()&&e.hasPort(c)?f=this.findPortElem(c,u)||n:(u||(u=t.selector),!u&&c!=null&&(u=`[port="${c}"]`),f=this.findOne(u,n,this.selectors)),f}hasTools(t){const e=this.tools;return e==null?!1:t==null?!0:e.name===t}addTools(t){if(this.removeTools(),t){if(!this.can("toolsAddable"))return this;const e=Hr.isToolsView(t)?t:new Hr(t);this.tools=e,e.config({view:this}),e.mount()}return this}updateTools(t={}){return this.tools&&this.tools.update(t),this}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const t=this.cell.getTools();return this.addTools(t),this}notify(t,e){return this.trigger(t,e),this.graph.trigger(t,e),this}getEventArgs(t,e,n){const c=this,u=c.cell;return e==null||n==null?{e:t,view:c,cell:u}:{e:t,x:e,y:n,view:c,cell:u}}onClick(t,e,n){this.notify("cell:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){this.notify("cell:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){this.notify("cell:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(t,e,n))}onMouseUp(t,e,n){this.notify("cell:mouseup",this.getEventArgs(t,e,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(t,e,n){this.notify("cell:mousemove",this.getEventArgs(t,e,n))}onMouseOver(t){this.notify("cell:mouseover",this.getEventArgs(t))}onMouseOut(t){this.notify("cell:mouseout",this.getEventArgs(t))}onMouseEnter(t){this.notify("cell:mouseenter",this.getEventArgs(t))}onMouseLeave(t){this.notify("cell:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,c){this.notify("cell:mousewheel",Object.assign({delta:c},this.getEventArgs(t,e,n)))}onCustomEvent(t,e,n,c){this.notify("cell:customevent",Object.assign({name:e},this.getEventArgs(t,n,c))),this.notify(e,Object.assign({},this.getEventArgs(t,n,c)))}onMagnetMouseDown(t,e,n,c){}onMagnetDblClick(t,e,n,c){}onMagnetContextMenu(t,e,n,c){}onLabelMouseDown(t,e,n){}checkMouseleave(t){const e=this.getEventTarget(t,{fromPoint:!0}),n=this.graph.findViewByElem(e);n!==this&&(this.onMouseLeave(t),n&&n.onMouseEnter(t))}dispose(){this.cell.off("changed",this.onCellChanged,this)}}kr.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},A1([kr.dispose()],kr.prototype,"dispose",null),function(a){a.Flag=mw,a.Attr=pw}(kr||(kr={})),function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.isNodeView=="function"&&typeof c.isEdgeView=="function"&&typeof c.confirmUpdate=="function"}a.isCellView=t}(kr||(kr={})),function(a){function t(n){return function(c){c.config({priority:n})}}a.priority=t;function e(n){return function(c){c.config({bootstrap:n})}}a.bootstrap=e}(kr||(kr={})),function(a){a.registry=Z.create({type:"view"})}(kr||(kr={}));class Hr extends ir{get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return Hr.toStringTag}constructor(t={}){super(),this.svgContainer=this.createContainer(!0,t),this.htmlContainer=this.createContainer(!1,t),this.config(t)}createContainer(t,e){const n=t?ir.createElement("g",!0):ir.createElement("div",!1);return xe(n,this.prefixClassName("cell-tools")),e.className&&xe(n,e.className),n}config(t){if(this.options=Object.assign(Object.assign({},this.options),t),!kr.isCellView(t.view)||t.view===this.cellView)return this;this.cellView=t.view,this.cell.isEdge()?(xe(this.svgContainer,this.prefixClassName("edge-tools")),xe(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(xe(this.svgContainer,this.prefixClassName("node-tools")),xe(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const e=this.options.items;if(!Array.isArray(e))return this;this.tools=[];const n=[];e.forEach(c=>{Hr.ToolItem.isToolItem(c)?c.name==="vertices"?n.unshift(c):n.push(c):(typeof c=="object"?c.name:c)==="vertices"?n.unshift(c):n.push(c)});for(let c=0;c<n.length;c+=1){const u=n[c];let f;if(Hr.ToolItem.isToolItem(u))f=u;else{const d=typeof u=="object"?u.name:u,v=typeof u=="object"?u.args||{}:{};if(d){if(this.cell.isNode()){const b=fd.registry.get(d);if(b)f=new b(v);else return fd.registry.onNotFound(d)}else if(this.cell.isEdge()){const b=dd.registry.get(d);if(b)f=new b(v);else return dd.registry.onNotFound(d)}}}f&&(f.config(this.cellView,this),f.render(),(f.options.isSVGElement!==!1?this.svgContainer:this.htmlContainer).appendChild(f.container),this.tools.push(f))}return this}update(t={}){const e=this.tools;return e&&e.forEach(n=>{t.toolId!==n.cid&&n.isVisible()&&n.update()}),this}focus(t){const e=this.tools;return e&&e.forEach(n=>{t===n?n.show():n.hide()}),this}blur(t){const e=this.tools;return e&&e.forEach(n=>{n!==t&&!n.isVisible()&&(n.show(),n.update())}),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const t=this.tools;return t&&(t.forEach(e=>e.remove()),this.tools=null),Do(this.svgContainer),Do(this.htmlContainer),super.remove()}mount(){const t=this.tools,e=this.cellView;if(e&&t){const n=t.some(u=>u.options.isSVGElement!==!1),c=t.some(u=>u.options.isSVGElement===!1);n&&(this.options.local?e.container:e.graph.view.decorator).appendChild(this.svgContainer),c&&this.graph.container.appendChild(this.htmlContainer)}return this}}(function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&c.graph!=null&&c.cell!=null&&typeof c.config=="function"&&typeof c.update=="function"&&typeof c.focus=="function"&&typeof c.blur=="function"&&typeof c.show=="function"&&typeof c.hide=="function"}a.isToolsView=t})(Hr||(Hr={})),function(a){class t extends ir{static getDefaults(){return this.defaults}static config(n){this.defaults=this.getOptions(n)}static getOptions(n){return Yn(ur(this.getDefaults()),n)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return t.toStringTag}constructor(n={}){super(),this.visible=!0,this.options=this.getOptions(n),this.container=ir.createElement(this.options.tagName||"g",this.options.isSVGElement!==!1),xe(this.container,this.prefixClassName("cell-tool")),typeof this.options.className=="string"&&xe(this.container,this.options.className),this.init()}init(){}getOptions(n){return this.constructor.getOptions(n)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(n,c){return this.cellView=n,this.parent=c,this.stamp(this.container),this.cell.isEdge()?xe(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&xe(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const n=this.options.markup;if(n){const c=or.parseJSONMarkup(n);this.container.appendChild(c.fragment),this.childNodes=c.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(n){n&&n.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){const n=this.options.focusOpacity;return n!=null&&Number.isFinite(n)&&(this.container.style.opacity=`${n}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(n){return this.graph==null||this.cellView==null?!0:this.graph.view.guard(n,this.cellView)}}t.defaults={isSVGElement:!0,tagName:"g"},a.ToolItem=t,function(e){let n=0;function c(f){return f?Gf(f):(n+=1,`CustomTool${n}`)}function u(f){const d=al(c(f.name),this);return d.config(f),d}e.define=u}(t=a.ToolItem||(a.ToolItem={})),function(e){e.toStringTag=`X6.${e.name}`;function n(c){if(c==null)return!1;if(c instanceof e)return!0;const u=c[Symbol.toStringTag],f=c;return(u==null||u===e.toStringTag)&&f.graph!=null&&f.cell!=null&&typeof f.config=="function"&&typeof f.update=="function"&&typeof f.focus=="function"&&typeof f.blur=="function"&&typeof f.show=="function"&&typeof f.hide=="function"&&typeof f.isVisible=="function"}e.isToolItem=n}(t=a.ToolItem||(a.ToolItem={}))}(Hr||(Hr={}));const C1=a=>a;function vw(a,t){return t===0?"0%":`${Math.round(a/t*100)}%`}function yw(a){return(e,n,c,u)=>n.isEdgeElement(c)?I1(a,e,n,c,u):O1(a,e,n,c,u)}function O1(a,t,e,n,c){const u=e.cell,f=u.getAngle(),d=e.getUnrotatedBBoxOfElement(n),v=u.getBBox().getCenter(),b=o.create(c).rotate(f,v);let E=b.x-d.x,S=b.y-d.y;return a&&(E=vw(E,d.width),S=vw(S,d.height)),t.anchor={name:"topLeft",args:{dx:E,dy:S,rotate:!0}},t}function I1(a,t,e,n,c){const u=e.getConnection();if(!u)return t;const f=u.closestPointLength(c);if(a){const d=u.length();t.anchor={name:"ratio",args:{ratio:f/d}}}else t.anchor={name:"length",args:{length:f}};return t}const M1=yw(!0),N1=yw(!1);var Nx;(function(a){a.presets=Ht,a.registry=Z.create({type:"connection strategy"}),a.registry.register(a.presets,!0)})(Nx||(Nx={}));function bw(a,t,e,n){return Ke(Nx.presets.pinRelative,this.graph,{},t,e,a,this.cell,n,{}).anchor}function xw(a,t){return t?a.cell.getBBox():a.cell.isEdge()?a.getConnection().bbox():a.getUnrotatedBBoxOfElement(a.container)}class Pl extends Hr.ToolItem{onRender(){xe(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Es(this.container,e,{absolute:!0})}getNodeMatrix(){const t=this.cellView,e=this.options;let{x:n=0,y:c=0}=e;const{offset:u,useCellGeometry:f,rotate:d}=e;let v=xw(t,f);const b=t.cell.getAngle();d||(v=v.bbox(b));let E=0,S=0;typeof u=="number"?(E=u,S=u):typeof u=="object"&&(E=u.x,S=u.y),n=$i(n,v.width),c=$i(c,v.height);let _=Ur().translate(v.x+v.width/2,v.y+v.height/2);return d&&(_=_.rotate(b)),_=_.translate(n+E-v.width/2,c+S-v.height/2),_}getEdgeMatrix(){const t=this.cellView,e=this.options,{offset:n=0,distance:c=0,rotate:u}=e;let f,d,v;const b=$i(c,1);b>=0&&b<=1?f=t.getTangentAtRatio(b):f=t.getTangentAtLength(b),f?(d=f.start,v=f.vector().vectorAngle(new o(1,0))||0):(d=t.getConnection().start,v=0);let E=Ur().translate(d.x,d.y).rotate(v);return typeof n=="object"?E=E.translate(n.x||0,n.y||0):E=E.translate(0,n),u||(E=E.rotate(-v)),E}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.options.onClick;typeof e=="function"&&Ke(e,this.cellView,{e:t,view:this.cellView,cell:this.cellView.cell,btn:this})}}(function(a){a.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})})(Pl||(Pl={})),function(a){a.Remove=a.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view:t,btn:e}){e.parent.remove(),t.cell.remove({ui:!0,toolId:e.cid})}})}(Pl||(Pl={}));var P1=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class bv extends Hr.ToolItem{onRender(){if(xe(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const t=this.options.attrs,{class:e}=t,n=P1(t,["class"]);Dn(this.container,vo(n)),e&&xe(this.container,e)}this.update()}update(){const t=this.cellView,e=this.options,{useCellGeometry:n,rotate:c}=e,u=ps(e.padding);let f=xw(t,n).moveAndExpand({x:-u.left,y:-u.top,width:u.left+u.right,height:u.top+u.bottom});const d=t.cell;if(d.isNode()){const v=d.getAngle();if(v)if(c){const b=d.getBBox().getCenter();rd(this.container,v,b.x,b.y,{absolute:!0})}else f=f.bbox(v)}return Dn(this.container,f.toJSON()),this}}(function(a){a.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})})(bv||(bv={}));class em extends Hr.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach(e=>{this.stopHandleListening(e),e.remove()})}renderHandles(){const t=this.vertices;for(let e=0,n=t.length;e<n;e+=1){const c=t[e],u=this.options.createHandle,f=this.options.processHandle,d=u({index:e,graph:this.graph,guard:v=>this.guard(v),attrs:this.options.attrs||{}});f&&f(d),d.updatePosition(c.x,c.y),this.stamp(d.container),this.container.appendChild(d.container),this.handles.push(d),this.startHandleListening(d)}}updateHandles(){const t=this.vertices;for(let e=0,n=t.length;e<n;e+=1){const c=t[e],u=this.handles[e];u&&u.updatePosition(c.x,c.y)}}updatePath(){const t=this.childNodes.connection;t&&t.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(t){const e=this.cellView;e.can("vertexMovable")&&(t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.on("remove",this.onHandleRemove,this)}stopHandleListening(t){const e=this.cellView;e.can("vertexMovable")&&(t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.off("remove",this.onHandleRemove,this)}getNeighborPoints(t){const e=this.cellView,n=this.vertices,c=t>0?n[t-1]:e.sourceAnchor,u=t<n.length-1?n[t+1]:e.targetAnchor;return{prev:o.create(c),next:o.create(u)}}getMouseEventArgs(t){const e=this.normalizeEvent(t),{x:n,y:c}=this.graph.snapToGrid(e.clientX,e.clientY);return{e,x:n,y:c}}onHandleChange({e:t}){this.focus();const e=this.cellView;if(e.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:n,x:c,y:u}=this.getMouseEventArgs(t);this.eventData(n,{start:{x:c,y:u}}),e.notifyMouseDown(n,c,u)}}onHandleChanging({handle:t,e}){const n=this.cellView,c=t.options.index,{e:u,x:f,y:d}=this.getMouseEventArgs(e),v={x:f,y:d};this.snapVertex(v,c),n.cell.setVertexAt(c,v,{ui:!0,toolId:this.cid}),t.updatePosition(v.x,v.y),this.options.stopPropagation||n.notifyMouseMove(u,f,d)}stopBatch(t){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),t&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}onHandleChanged({e:t}){const e=this.options,n=this.cellView;if(e.addable&&this.updatePath(),!e.removeRedundancies){this.stopBatch(this.eventData(t).vertexAdded);return}n.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(t).vertexAdded);const{e:u,x:f,y:d}=this.getMouseEventArgs(t);if(!this.options.stopPropagation){n.notifyMouseUp(u,f,d);const{start:v}=this.eventData(u);if(v){const{x:b,y:E}=v;b===f&&E===d&&n.onClick(u,f,d)}}n.checkMouseleave(u),e.onChanged&&e.onChanged({edge:n.cell,edgeView:n})}snapVertex(t,e){const n=this.options.snapRadius||0;if(n>0){const c=this.getNeighborPoints(e),u=c.prev,f=c.next;Math.abs(t.x-u.x)<n?t.x=u.x:Math.abs(t.x-f.x)<n&&(t.x=f.x),Math.abs(t.y-u.y)<n?t.y=c.prev.y:Math.abs(t.y-f.y)<n&&(t.y=f.y)}}onHandleRemove({handle:t,e}){if(this.options.removable){const n=t.options.index,c=this.cellView;c.cell.removeVertexAt(n,{ui:!0}),this.options.addable&&this.updatePath(),c.checkMouseleave(this.normalizeEvent(e))}}allowAddVertex(t){const e=this.guard(t),n=this.options.addable&&this.cellView.can("vertexAddable"),c=this.options.modifiers?rc.isMatch(t,this.options.modifiers):!0;return!e&&n&&c}onPathMouseDown(t){const e=this.cellView;if(!this.allowAddVertex(t))return;t.stopPropagation(),t.preventDefault();const n=this.normalizeEvent(t),c=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();e.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const u=e.getVertexIndex(c.x,c.y);this.snapVertex(c,u),e.cell.insertVertex(c,u,{ui:!0,toolId:this.cid}),this.render();const f=this.handles[u];this.eventData(n,{vertexAdded:!0}),f.onMouseDown(n)}onRemove(){this.resetHandles()}}(function(a){class t extends ir{get graph(){return this.options.graph}constructor(n){super(),this.options=n,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}render(){this.container=ir.createElement("circle",!0);const n=this.options.attrs;if(typeof n=="function"){const c=a.getDefaults();this.setAttrs(Object.assign(Object.assign({},c.attrs),n(this)))}else this.setAttrs(n);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(n,c){this.setAttrs({cx:n,cy:c})}onMouseDown(n){this.options.guard(n)||(n.stopPropagation(),n.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},n.data),this.emit("change",{e:n,handle:this}))}onMouseMove(n){this.emit("changing",{e:n,handle:this})}onMouseUp(n){this.emit("changed",{e:n,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(n){this.emit("remove",{e:n,handle:this})}}a.Handle=t})(em||(em={})),function(a){const t=ri.prefix("edge-tool-vertex-path");a.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:e=>new a.Handle(e),markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${t}`]:"onPathMouseDown",[`touchstart .${t}`]:"onPathMouseDown"}})}(em||(em={}));class nm extends Hr.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){xe(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const t=this.cellView,e=[...this.vertices];e.unshift(t.sourcePoint),e.push(t.targetPoint);for(let n=0,c=e.length;n<c-1;n+=1){const u=e[n],f=e[n+1],d=this.renderHandle(u,f,n);this.stamp(d.container),this.handles.push(d)}return this}renderHandle(t,e,n){const c=this.options.createHandle({index:n,graph:this.graph,guard:u=>this.guard(u),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(c),this.updateHandle(c,t,e),this.container.appendChild(c.container),this.startHandleListening(c),c}startHandleListening(t){t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)}stopHandleListening(t){t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach(e=>{this.stopHandleListening(e),e.remove()})}shiftHandleIndexes(t){const e=this.handles;for(let n=0,c=e.length;n<c;n+=1)e[n].options.index+=t}resetAnchor(t,e){const n=this.cellView.cell,c={ui:!0,toolId:this.cid};e?n.prop([t,"anchor"],e,c):n.removeProp([t,"anchor"],c)}snapHandle(t,e,n){const c=t.options.axis,u=t.options.index,v=this.cellView.cell.getVertices(),b=v[u-2]||n.sourceAnchor,E=v[u+1]||n.targetAnchor,S=this.options.snapRadius;return Math.abs(e[c]-b[c])<S?e[c]=b[c]:Math.abs(e[c]-E[c])<S&&(e[c]=E[c]),e}onHandleChanging({handle:t,e}){const n=this.graph,c=this.options,u=this.cellView,f=c.anchor,d=t.options.axis,v=t.options.index-1,b=this.getEventData(e),E=this.normalizeEvent(e),S=n.snapToGrid(E.clientX,E.clientY),_=this.snapHandle(t,S.clone(),b),C=ur(this.vertices);let D=C[v],L=C[v+1];const B=u.sourceView,H=u.sourceBBox;let J=!1,V=!1;if(D?v===0?H.containsPoint(D)?(C.shift(),this.shiftHandleIndexes(-1),J=!0):(D[d]=_[d],V=!0):D[d]=_[d]:(D=u.sourceAnchor.toJSON(),D[d]=_[d],H.containsPoint(D)?J=!0:(C.unshift(D),this.shiftHandleIndexes(1),V=!0)),typeof f=="function"&&B){if(J){const ye=b.sourceAnchor.clone();ye[d]=_[d];const be=Ke(f,u,ye,B,u.sourceMagnet||B.container,"source",u,this);this.resetAnchor("source",be)}V&&this.resetAnchor("source",b.sourceAnchorDef)}const ct=u.targetView,dt=u.targetBBox;let At=!1,le=!1;if(L?v===C.length-2?dt.containsPoint(L)?(C.pop(),At=!0):(L[d]=_[d],le=!0):L[d]=_[d]:(L=u.targetAnchor.toJSON(),L[d]=_[d],dt.containsPoint(L)?At=!0:(C.push(L),le=!0)),typeof f=="function"&&ct){if(At){const ye=b.targetAnchor.clone();ye[d]=_[d];const be=Ke(f,u,ye,ct,u.targetMagnet||ct.container,"target",u,this);this.resetAnchor("target",be)}le&&this.resetAnchor("target",b.targetAnchorDef)}o.equalPoints(C,this.vertices)||this.cellView.cell.setVertices(C,{ui:!0,toolId:this.cid}),this.updateHandle(t,D,L,0),c.stopPropagation||u.notifyMouseMove(E,S.x,S.y)}onHandleChange({handle:t,e}){const n=this.options,c=this.handles,u=this.cellView,f=t.options.index;if(Array.isArray(c)){for(let d=0,v=c.length;d<v;d+=1)d!==f&&c[d].hide();if(this.focus(),this.setEventData(e,{sourceAnchor:u.sourceAnchor.clone(),targetAnchor:u.targetAnchor.clone(),sourceAnchorDef:ur(this.cell.prop(["source","anchor"])),targetAnchorDef:ur(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!n.stopPropagation){const d=this.normalizeEvent(e),v=this.graph.snapToGrid(d.clientX,d.clientY);u.notifyMouseDown(d,v.x,v.y)}}}onHandleChanged({e:t}){const e=this.options,n=this.cellView;e.removeRedundancies&&n.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const c=this.normalizeEvent(t),u=this.graph.snapToGrid(c.clientX,c.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),e.stopPropagation||n.notifyMouseUp(c,u.x,u.y),n.checkMouseleave(c),e.onChanged&&e.onChanged({edge:n.cell,edgeView:n})}updateHandle(t,e,n,c=0){const u=this.options.precision||0,f=Math.abs(e.x-n.x)<u,d=Math.abs(e.y-n.y)<u;if(f||d){const v=new l(e,n);if(v.length()<this.options.threshold)t.hide();else{const E=v.getCenter(),S=f?"x":"y";E[S]+=c||0;const _=v.vector().vectorAngle(new o(1,0));t.updatePosition(E.x,E.y,_,this.cellView),t.show(),t.options.axis=S}}else t.hide()}onRemove(){this.resetHandles()}}(function(a){class t extends ir{constructor(n){super(),this.options=n,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=ir.createElement("rect",!0);const n=this.options.attrs;if(typeof n=="function"){const c=a.getDefaults();this.setAttrs(Object.assign(Object.assign({},c.attrs),n(this)))}else this.setAttrs(n);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(n,c,u,f){const d=f.getClosestPoint(new o(n,c))||new o(n,c);let v=Ur().translate(d.x,d.y);if(d.equals({x:n,y:c}))v=v.rotate(u);else{let E=new l(n,c,d.x,d.y).vector().vectorAngle(new o(1,0));E!==0&&(E+=90),v=v.rotate(E)}this.setAttrs({transform:Ka(v),cursor:u%180===0?"row-resize":"col-resize"})}onMouseDown(n){this.options.guard(n)||(this.trigger("change",{e:n,handle:this}),n.stopPropagation(),n.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},n.data))}onMouseMove(n){this.emit("changing",{e:n,handle:this})}onMouseUp(n){this.emit("changed",{e:n,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}a.Handle=t})(nm||(nm={})),function(a){a.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:t=>new a.Handle(t),anchor:bw})}(nm||(nm={}));class xv extends Hr.ToolItem{get type(){return this.options.type}onRender(){xe(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const t=this.type;return this.cellView.getTerminalView(t)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const t=this.childNodes;if(!t)return;const e=t.anchor;if(!e)return;const n=this.type,c=this.cellView,u=this.options,f=c.getTerminalAnchor(n),d=c.cell.prop([n,"anchor"]);e.setAttribute("transform",`translate(${f.x}, ${f.y})`);const v=d?u.customAnchorAttrs:u.defaultAnchorAttrs;v&&Object.keys(v).forEach(b=>{e.setAttribute(b,v[b])})}updateArea(){const t=this.childNodes;if(!t)return;const e=t.area;if(!e)return;const n=this.type,c=this.cellView,u=c.getTerminalView(n);if(u){const f=u.cell,d=c.getTerminalMagnet(n);let v=this.options.areaPadding||0;Number.isFinite(v)||(v=0);let b,E,S;u.isEdgeElement(d)?(b=u.getBBox(),E=0,S=b.getCenter()):(b=u.getUnrotatedBBoxOfElement(d),E=f.getAngle(),S=b.getCenter(),E&&S.rotate(-E,f.getBBox().getCenter())),b.inflate(v),Dn(e,{x:-b.width/2,y:-b.height/2,width:b.width,height:b.height,transform:`translate(${S.x}, ${S.y}) rotate(${E})`})}}toggleArea(t){if(this.childNodes){const e=this.childNodes.area;e&&(e.style.display=t?"":"none")}}onMouseDown(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(t){const e=this.type,n=this.cell;t?n.prop([e,"anchor"],t,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([e,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(t){const e=this.type,n=this.cellView,c=n.getTerminalView(e);if(c==null)return;const u=this.normalizeEvent(t),f=c.cell,d=n.getTerminalMagnet(e);let v=this.graph.coord.clientToLocalPoint(u.clientX,u.clientY);const b=this.options.snap;if(typeof b=="function"){const _=Ke(b,n,v,c,d,e,n,this);v=o.create(_)}if(this.options.restrictArea)if(c.isEdgeElement(d)){const _=c.getClosestPoint(v);_&&(v=_)}else{const _=c.getUnrotatedBBoxOfElement(d),C=f.getAngle(),D=f.getBBox().getCenter(),L=v.clone().rotate(C,D);_.containsPoint(L)||(v=_.getNearestPointToPoint(L).rotate(-C,D))}let E;const S=this.options.anchor;typeof S=="function"&&(E=Ke(S,n,v,c,d,e,n,this)),this.resetAnchor(E),this.update()}onMouseUp(t){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const e=this.cellView;this.options.removeRedundancies&&e.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const t=this.options.resetAnchor;t&&this.resetAnchor(t===!0?void 0:t),this.update()}}(function(a){a.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:bw,snap(t,e,n,c,u,f){const d=f.options.snapRadius||0,v=c==="source",b=v?0:-1,E=this.cell.getVertexAt(b)||this.getTerminalAnchor(v?"target":"source");return E&&(Math.abs(E.x-t.x)<d&&(t.x=E.x),Math.abs(E.y-t.y)<d&&(t.y=E.y)),t}})})(xv||(xv={}));const D1=xv.define({name:"source-anchor",type:"source"}),R1=xv.define({name:"target-anchor",type:"target"});var L1=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class wv extends Hr.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const t=this.options.attrs,{class:e}=t,n=L1(t,["class"]);this.setAttrs(n,this.container),e&&xe(this.container,e)}}onRender(){xe(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const t=this.ratio,e=this.cellView,n=e.getTangentAtRatio(t),c=n?n.start:e.getPointAtRatio(t),u=n&&n.vector().vectorAngle(new o(1,0))||0;if(!c)return this;const f=Ur().translate(c.x,c.y).rotate(u);return Es(this.container,f,{absolute:!0}),this}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.cellView;if(e.can("arrowheadMovable")){e.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const n=this.graph.snapToGrid(t.clientX,t.clientY),c=e.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(t,c),this.delegateDocumentEvents(this.options.documentEvents,t.data),e.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(t){const e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY);this.cellView.onMouseMove(e,n.x,n.y),this.update()}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),n=this.cellView,c=this.graph.snapToGrid(e.clientX,e.clientY);n.onMouseUp(e,c.x,c.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(function(a){a.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})})(wv||(wv={}));const k1=wv.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),B1=wv.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class hd extends Hr.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this)}onRender(){const t=this.cellView;t&&t.on("cell:dblclick",this.dblClick)}createElement(){const t=[this.prefixClassName(`${this.cell.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=Hr.createElement("div",!1),this.addClass(t,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}updateEditor(){const{cell:t,editor:e}=this;if(!e)return;const{style:n}=e;t.isNode()?this.updateNodeEditorTransform():t.isEdge()&&this.updateEdgeEditorTransform();const{attrs:c}=this.options;n.fontSize=`${c.fontSize}px`,n.fontFamily=c.fontFamily,n.color=c.color,n.backgroundColor=c.backgroundColor;const u=this.getCellText()||"";return e.innerText=u,this.setCellText(""),this}updateNodeEditorTransform(){const{graph:t,cell:e,editor:n}=this;if(!n)return;let c=o.create(),u=20,f="",{x:d,y:v}=this.options;const{width:b,height:E}=this.options;if(typeof d<"u"&&typeof v<"u"){const C=e.getBBox();d=$i(d,C.width),v=$i(v,C.height),c=C.topLeft.translate(d,v),u=C.width-d*2}else{const C=e.getBBox();c=C.center,u=C.width-4,f="translate(-50%, -50%)"}const S=t.scale(),{style:_}=n;c=t.localToGraph(c),_.left=`${c.x}px`,_.top=`${c.y}px`,_.transform=`scale(${S.sx}, ${S.sy}) ${f}`,_.minWidth=`${u}px`,typeof b=="number"&&(_.width=`${b}px`),typeof E=="number"&&(_.height=`${E}px`)}updateEdgeEditorTransform(){if(!this.event)return;const{graph:t,editor:e}=this;if(!e)return;let n=o.create(),c=20;const{style:u}=e,f=this.event.target,d=f.parentElement;if(d&&aa(d,this.prefixClassName("edge-label"))){const E=d.getAttribute("data-index")||"0";this.labelIndex=parseInt(E,10);const S=d.getAttribute("transform"),{translation:_}=ua(S);n=new o(_.tx,_.ty),c=Fn.getBBox(f).width}else{if(!this.options.labelAddable)return this;n=t.clientToLocal(o.create(this.event.clientX,this.event.clientY));const S=this.cellView.path.closestPointLength(n);this.distance=S,this.labelIndex=-1}n=t.localToGraph(n);const b=t.scale();u.left=`${n.x}px`,u.top=`${n.y}px`,u.minWidth=`${c}px`,u.transform=`scale(${b.sx}, ${b.sy}) translate(-50%, -50%)`}onDocumentMouseUp(t){if(this.editor&&t.target!==this.editor){const e=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(e!==""?e:null),this.removeElement()}}onCellDblClick({e:t}){this.editor||(t.stopPropagation(),this.removeElement(),this.event=t,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}onMouseDown(t){t.stopPropagation()}autoFocus(){setTimeout(()=>{this.editor&&(this.editor.focus(),this.selectText())})}selectText(){if(window.getSelection&&this.editor){const t=document.createRange(),e=window.getSelection();t.selectNodeContents(this.editor),e.removeAllRanges(),e.addRange(t)}}getCellText(){const{getText:t}=this.options;if(typeof t=="function")return Ke(t,this.cellView,{cell:this.cell,index:this.labelIndex});if(typeof t=="string"){if(this.cell.isNode())return this.cell.attr(t);if(this.cell.isEdge()&&this.labelIndex!==-1)return this.cell.prop(`labels/${this.labelIndex}/attrs/${t}`)}}setCellText(t){const e=this.options.setText;if(typeof e=="function"){Ke(e,this.cellView,{cell:this.cell,value:t,index:this.labelIndex,distance:this.distance});return}if(typeof e=="string"){if(this.cell.isNode()){t!==null&&this.cell.attr(e,t);return}if(this.cell.isEdge()){const n=this.cell;if(this.labelIndex===-1){if(t){const c={position:{distance:this.distance},attrs:{}};ia(c,`attrs/${e}`,t),n.appendLabel(c)}}else t!==null?n.prop(`labels/${this.labelIndex}/attrs/${e}`,t):typeof this.labelIndex=="number"&&n.removeLabelAt(this.labelIndex)}}}onRemove(){const t=this.cellView;t&&t.off("cell:dblclick",this.dblClick),this.removeElement()}}(function(a){a.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})})(hd||(hd={})),function(a){a.NodeEditor=a.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),a.EdgeEditor=a.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(hd||(hd={}));var ww=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e},fd;(function(a){a.presets={boundary:bv,button:Pl,"button-remove":Pl.Remove,"node-editor":hd.NodeEditor},a.registry=Z.create({type:"node tool",process(t,e){if(typeof e=="function")return e;let n=Hr.ToolItem;const{inherit:c}=e,u=ww(e,["inherit"]);if(c){const f=this.get(c);f==null?this.onNotFound(c,"inherited"):n=f}return u.name==null&&(u.name=t),n.define.call(n,u)}}),a.registry.register(a.presets,!0)})(fd||(fd={}));var dd;(function(a){a.presets={boundary:bv,vertices:em,segments:nm,button:Pl,"button-remove":Pl.Remove,"source-anchor":D1,"target-anchor":R1,"source-arrowhead":k1,"target-arrowhead":B1,"edge-editor":hd.EdgeEditor},a.registry=Z.create({type:"edge tool",process(t,e){if(typeof e=="function")return e;let n=Hr.ToolItem;const{inherit:c}=e,u=ww(e,["inherit"]);if(c){const f=this.get(c);f==null?this.onNotFound(c,"inherited"):n=f}return u.name==null&&(u.name=t),n.define.call(n,u)}}),a.registry.register(a.presets,!0)})(dd||(dd={}));const j1=ac("center"),F1=ac("topCenter"),G1=ac("bottomCenter"),z1=ac("leftMiddle"),U1=ac("rightMiddle"),V1=ac("topLeft"),H1=ac("topRight"),$1=ac("bottomLeft"),W1=ac("bottomRight");function ac(a){return function(t,e,n,c={}){const u=c.rotate?t.getUnrotatedBBoxOfElement(e):t.getBBoxOfElement(e),f=u[a];f.x+=$i(c.dx,u.width),f.y+=$i(c.dy,u.height);const d=t.cell;return c.rotate?f.rotate(-d.getAngle(),d.getBBox().getCenter()):f}}function Ev(a){return function(t,e,n,c){if(n instanceof Element){const u=this.graph.findViewByElem(n);let f;if(u)if(u.isEdgeElement(n)){const d=c.fixedAt!=null?c.fixedAt:"50%";f=Ew(u,d)}else f=u.getBBoxOfElement(n).getCenter();else f=new o;return a.call(this,t,e,f,c)}return a.apply(this,arguments)}}function Ew(a,t){const e=Po(t),n=typeof t=="string"?parseFloat(t):t;return e?a.getPointAtRatio(n/100):a.getPointAtLength(n)}const X1=Ev(function(a,t,e,n){const c=Wn.normalize(a.cell.getAngle()),u=a.getBBoxOfElement(t),f=u.getCenter(),d=u.getTopLeft(),v=u.getBottomRight();let b=n.padding;if(Number.isFinite(b)||(b=0),d.y+b<=e.y&&e.y<=v.y-b){const E=e.y-f.y;f.x+=c===0||c===180?0:E*1/Math.tan(Wn.toRad(c)),f.y+=E}else if(d.x+b<=e.x&&e.x<=v.x-b){const E=e.x-f.x;f.y+=c===90||c===270?0:E*Math.tan(Wn.toRad(c)),f.x+=E}return f}),Z1=function(a,t,e,n,c){const u=a.cell.getConnectionPoint(this.cell,c);return(n.dx||n.dy)&&u.translate(n.dx||0,n.dy||0),u},q1=Ev(function(a,t,e,n){let c,u=0,f;const d=a.cell;n.rotate?(c=a.getUnrotatedBBoxOfElement(t),f=d.getBBox().getCenter(),u=d.getAngle()):c=a.getBBoxOfElement(t);const v=n.padding;v!=null&&Number.isFinite(v)&&c.inflate(v),n.rotate&&e.rotate(u,f);const b=c.getNearestSideToPoint(e);let E;switch(b){case"left":E=c.getLeftMiddle();break;case"right":E=c.getRightMiddle();break;case"top":E=c.getTopCenter();break;case"bottom":E=c.getBottomCenter();break;default:break}const S=n.direction;return S==="H"?(b==="top"||b==="bottom")&&(e.x<=c.x+c.width?E=c.getLeftMiddle():E=c.getRightMiddle()):S==="V"&&(e.y<=c.y+c.height?E=c.getTopCenter():E=c.getBottomCenter()),n.rotate?E.rotate(-u,f):E});var gd;(function(a){a.presets=Xt,a.registry=Z.create({type:"node endpoint"}),a.registry.register(a.presets,!0)})(gd||(gd={}));const Y1=function(a,t,e,n){let c=n.ratio!=null?n.ratio:.5;return c>1&&(c/=100),a.getPointAtRatio(c)},J1=function(a,t,e,n){const c=n.length!=null?n.length:20;return a.getPointAtLength(c)},_w=function(a,t,e,n){const c=a.getClosestPoint(e);return c!=null?c:new o},K1=Ev(_w),Q1=Ev(function(a,t,e,n){const u=a.getConnection(),f=a.getConnectionSubdivisions(),d=new l(e.clone().translate(0,1e6),e.clone().translate(0,-1e6)),v=new l(e.clone().translate(1e6,0),e.clone().translate(-1e6,0)),b=d.intersect(u,{segmentSubdivisions:f}),E=v.intersect(u,{segmentSubdivisions:f}),S=[];return b&&S.push(...b),E&&S.push(...E),S.length>0?e.closest(S):n.fallbackAt!=null?Ew(a,n.fallbackAt):Ke(_w,this,a,t,e,n)});var pd;(function(a){a.presets=De,a.registry=Z.create({type:"edge endpoint"}),a.registry.register(a.presets,!0)})(pd||(pd={}));function _v(a,t,e){let n;if(typeof e=="object"){if(Number.isFinite(e.y)){const u=new l(t,a),{start:f,end:d}=u.parallel(e.y);t=f,a=d}n=e.x}else n=e;if(n==null||!Number.isFinite(n))return a;const c=a.distance(t);return n===0&&c>0?a:a.move(t,-Math.min(n,c-1))}function Sv(a){const t=a.getAttribute("stroke-width");return t===null?0:parseFloat(t)||0}function t_(a){if(a==null)return null;let t=a;do{let e=t.tagName;if(typeof e!="string")return null;if(e=e.toUpperCase(),e==="G")t=t.firstElementChild;else if(e==="TITLE")t=t.nextElementSibling;else break}while(t);return t}const Sw=function(a,t,e,n){const c=t.getBBoxOfElement(e);n.stroked&&c.inflate(Sv(e)/2);const u=a.intersect(c),f=u&&u.length?a.start.closest(u):a.end;return _v(f,a.start,n.offset)},e_=function(a,t,e,n,c){const u=t.cell,f=u.isNode()?u.getAngle():0;if(f===0)return Ke(Sw,this,a,t,e,n,c);const d=t.getUnrotatedBBoxOfElement(e);n.stroked&&d.inflate(Sv(e)/2);const v=d.getCenter(),b=a.clone().rotate(f,v),E=b.setLength(1e6).intersect(d),S=E&&E.length?b.start.closest(E).rotate(-f,v):a.end;return _v(S,a.start,n.offset)},n_=function(a,t,e,n){let c,u;const f=a.end,d=n.selector;if(typeof d=="string"?c=t.findOne(d):Array.isArray(d)?c=Sf(e,d):c=t_(e),!vs(c)){if(c===e||!vs(e))return f;c=e}const v=t.getShapeOfElement(c),b=t.getMatrixOfElement(c),E=t.getRootTranslatedMatrix(),S=t.getRootRotatedMatrix(),_=E.multiply(S).multiply(b),C=_.inverse(),D=Fn.transformLine(a,C),L=D.start.clone(),B=t.getDataOfElement(c);if(n.insideout===!1){B.shapeBBox==null&&(B.shapeBBox=v.bbox());const ct=B.shapeBBox;if(ct!=null&&ct.containsPoint(L))return f}n.extrapolate===!0&&D.setLength(1e6);let H;if(F.isPath(v)){const ct=n.precision||2;B.segmentSubdivisions==null&&(B.segmentSubdivisions=v.getSegmentSubdivisions({precision:ct})),H={precision:ct,segmentSubdivisions:B.segmentSubdivisions},u=D.intersect(v,H)}else u=D.intersect(v);u?Array.isArray(u)&&(u=L.closest(u)):n.sticky===!0&&(s.isRectangle(v)?u=v.getNearestPointToPoint(L):h.isEllipse(v)?u=v.intersectsWithLineFromCenterToPoint(L):u=v.closestPoint(L,H));const J=u?Fn.transformPoint(u,_):f;let V=n.offset||0;return n.stroked!==!1&&(typeof V=="object"?(V=Object.assign({},V),V.x==null&&(V.x=0),V.x+=Sv(c)/2):V+=Sv(c)/2),_v(J,a.start,V)};function r_(a,t,e=0){const{start:n,end:c}=a;let u,f,d,v;switch(t){case"left":v="x",u=c,f=n,d=-1;break;case"right":v="x",u=n,f=c,d=1;break;case"top":v="y",u=c,f=n,d=-1;break;case"bottom":v="y",u=n,f=c,d=1;break;default:return}n[v]<c[v]?u[v]=f[v]:f[v]=u[v],Number.isFinite(e)&&(u[v]+=d*e,f[v]+=d*e)}const i_=function(a,t,e,n){const{alignOffset:c,align:u}=n;return u&&r_(a,u,c),_v(a.end,a.start,n.offset)};var md;(function(a){a.presets=Ze,a.registry=Z.create({type:"connection point"}),a.registry.register(a.presets,!0)})(md||(md={}));const o_=function(a){return[...a]},s_=function(a,t,e){const n=t.side||"bottom",c=ps(t.padding||40),u=e.sourceBBox,f=e.targetBBox,d=u.getCenter(),v=f.getCenter();let b,E,S;switch(n){case"top":S=-1,b="y",E="height";break;case"left":S=-1,b="x",E="width";break;case"right":S=1,b="x",E="width";break;case"bottom":default:S=1,b="y",E="height";break}return d[b]+=S*(u[E]/2+c[n]),v[b]+=S*(f[E]/2+c[n]),S*(d[b]-v[b])>0?v[b]=d[b]:d[b]=v[b],[d.toJSON(),...a,v.toJSON()]};function Av(a){return new s(a.x,a.y,0,0)}function Tv(a={}){const t=ps(a.padding||20);return{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}function Aw(a,t={}){return a.sourceBBox.clone().moveAndExpand(Tv(t))}function Tw(a,t={}){return a.targetBBox.clone().moveAndExpand(Tv(t))}function a_(a,t={}){return a.sourceAnchor?a.sourceAnchor:Aw(a,t).getCenter()}function c_(a,t={}){return a.targetAnchor?a.targetAnchor:Tw(a,t).getCenter()}const Cw=function(a,t,e){let n=Aw(e,t),c=Tw(e,t);const u=a_(e,t),f=c_(e,t);n=n.union(Av(u)),c=c.union(Av(f));const d=a.map(E=>o.create(E));d.unshift(u),d.push(f);let v=null;const b=[];for(let E=0,S=d.length-1;E<S;E+=1){let _=null;const C=d[E],D=d[E+1],L=ko.getBearing(C,D)!=null;if(E===0)E+1===S?n.intersectsWithRect(c.clone().inflate(1))?_=ko.insideNode(C,D,n,c):L||(_=ko.nodeToNode(C,D,n,c)):n.containsPoint(D)?_=ko.insideNode(C,D,n,Av(D).moveAndExpand(Tv(t))):L||(_=ko.nodeToVertex(C,D,n));else if(E+1===S){const B=L&&ko.getBearing(D,C)===v;c.containsPoint(C)||B?_=ko.insideNode(C,D,Av(C).moveAndExpand(Tv(t)),c,v):L||(_=ko.vertexToNode(C,D,c,v))}else L||(_=ko.vertexToVertex(C,D,v));_?(b.push(..._.points),v=_.direction):v=ko.getBearing(C,D),E+1<S&&b.push(D)}return b};var ko;(function(a){const t={N:"S",S:"N",E:"W",W:"E"},e={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function n(S,_,C){let D=new o(S.x,_.y);return C.containsPoint(D)&&(D=new o(_.x,S.y)),D}function c(S,_){return S[_==="W"||_==="E"?"width":"height"]}a.getBBoxSize=c;function u(S,_){return S.x===_.x?S.y>_.y?"N":"S":S.y===_.y?S.x>_.x?"W":"E":null}a.getBearing=u;function f(S,_,C){const D=new o(S.x,_.y),L=new o(_.x,S.y),B=u(S,D),H=u(S,L),J=C?t[C]:null,V=B===C||B!==J&&(H===J||H!==C)?D:L;return{points:[V],direction:u(V,_)}}a.vertexToVertex=f;function d(S,_,C){const D=n(S,_,C);return{points:[D],direction:u(D,_)}}a.nodeToVertex=d;function v(S,_,C,D){const L=[new o(S.x,_.y),new o(_.x,S.y)],B=L.filter(V=>!C.containsPoint(V)),H=B.filter(V=>u(V,S)!==D);let J;if(H.length>0)return J=H.filter(V=>u(S,V)===D).pop(),J=J||H[0],{points:[J],direction:u(J,_)};{J=Wy(L,B)[0];const V=o.create(_).move(J,-c(C,D)/2);return{points:[n(V,S,C),V],direction:u(V,_)}}}a.vertexToNode=v;function b(S,_,C,D){let L=d(_,S,D);const B=L.points[0];if(C.containsPoint(B)){L=d(S,_,C);const H=L.points[0];if(D.containsPoint(H)){const J=o.create(S).move(H,-c(C,u(S,H))/2),V=o.create(_).move(B,-c(D,u(_,B))/2),ct=new l(J,V).getCenter(),dt=d(S,ct,C),At=f(ct,_,dt.direction);L.points=[dt.points[0],At.points[0]],L.direction=At.direction}}return L}a.nodeToNode=b;function E(S,_,C,D,L){const B=C.union(D).inflate(1),H=B.getCenter(),J=H.distance(_)>H.distance(S),V=J?_:S,ct=J?S:_;let dt,At,le;L?(dt=o.fromPolar(B.width+B.height,e[L],V),dt=B.getNearestPointToPoint(dt).move(dt,-1)):dt=B.getNearestPointToPoint(V).move(V,1),At=n(dt,ct,B);let ye;dt.round().equals(At.round())?(At=o.fromPolar(B.width+B.height,Wn.toRad(dt.theta(V))+Math.PI/2,ct),At=B.getNearestPointToPoint(At).move(ct,1).round(),le=n(dt,At,B),ye=J?[At,le,dt]:[dt,le,At]):ye=J?[At,dt]:[dt,At];const be=u(J?dt:At,_);return{points:ye,direction:be}}a.insideNode=E})(ko||(ko={}));const l_={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return Dl(this.step,this)},directions(){const a=Dl(this.step,this),t=Dl(this.cost,this);return[{cost:t,offsetX:a,offsetY:0},{cost:t,offsetX:-a,offsetY:0},{cost:t,offsetX:0,offsetY:a},{cost:t,offsetX:0,offsetY:-a}]},penalties(){const a=Dl(this.step,this);return{0:0,45:a/2,90:a/2}},paddingBox(){const a=Dl(this.step,this);return{x:-a,y:-a,width:2*a,height:2*a}},fallbackRouter:Cw,draggingRouter:null,snapToGrid:!0};function Dl(a,t){return typeof a=="function"?a.call(t):a}function u_(a){const t=Object.keys(a).reduce((e,n)=>{const c=e;return n==="fallbackRouter"||n==="draggingRouter"||n==="fallbackRoute"?c[n]=a[n]:c[n]=Dl(a[n],a),e},{});if(t.padding){const e=ps(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}return t.directions.forEach(e=>{const n=new o(0,0),c=new o(e.offsetX,e.offsetY);e.angle=Wn.normalize(n.theta(c))}),t}const Ow=1,Iw=2;class h_{constructor(){this.items=[],this.hash={},this.values={}}add(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=Ow,this.values[t]=e;const n=Ey(this.items,t,c=>this.values[c]);this.items.splice(n,0,t)}pop(){const t=this.items.shift();return t&&(this.hash[t]=Iw),t}isOpen(t){return this.hash[t]===Ow}isClose(t){return this.hash[t]===Iw}isEmpty(){return this.items.length===0}}class f_{constructor(t){this.options=t,this.mapGridSize=100,this.map={}}build(t,e){const n=this.options,c=n.excludeTerminals.reduce((b,E)=>{const S=e[E];if(S){const _=t.getCell(S.cell);_&&b.push(_)}return b},[]);let u=[];const f=t.getCell(e.getSourceCellId());f&&(u=_e(u,f.getAncestors().map(b=>b.id)));const d=t.getCell(e.getTargetCellId());d&&(u=_e(u,d.getAncestors().map(b=>b.id)));const v=this.mapGridSize;return t.getNodes().reduce((b,E)=>{const S=c.some(B=>B.id===E.id),_=E.shape?n.excludeShapes.includes(E.shape):!1,C=n.excludeNodes.some(B=>typeof B=="string"?E.id===B:B===E),D=u.includes(E.id),L=_||S||C||D;if(E.isVisible()&&!L){const B=E.getBBox().moveAndExpand(n.paddingBox),H=B.getOrigin().snapToGrid(v),J=B.getCorner().snapToGrid(v);for(let V=H.x;V<=J.x;V+=v)for(let ct=H.y;ct<=J.y;ct+=v){const dt=new o(V,ct).toString();b[dt]==null&&(b[dt]=[]),b[dt].push(B)}}return b},this.map),this}isAccessible(t){const e=t.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[e];return n?n.every(c=>!c.containsPoint(t)):!0}}function Mw(a,t){const e=a.sourceBBox.clone();return t&&t.paddingBox?e.moveAndExpand(t.paddingBox):e}function Nw(a,t){const e=a.targetBBox.clone();return t&&t.paddingBox?e.moveAndExpand(t.paddingBox):e}function Pw(a,t){return a.sourceAnchor?a.sourceAnchor:Mw(a,t).getCenter()}function d_(a,t){return a.targetAnchor?a.targetAnchor:Nw(a,t).getCenter()}function Px(a,t,e,n,c){const u=360/e,f=a.theta(g_(a,t,n,c)),d=Wn.normalize(f+u/2);return u*Math.floor(d/u)}function g_(a,t,e,n){const c=n.step,u=t.x-a.x,f=t.y-a.y,d=u/e.x,v=f/e.y,b=d*c,E=v*c;return new o(a.x+b,a.y+E)}function Dw(a,t){const e=Math.abs(a-t);return e>180?360-e:e}function p_(a,t){const e=t.step;return t.directions.forEach(n=>{n.gridOffsetX=n.offsetX/e*a.x,n.gridOffsetY=n.offsetY/e*a.y}),t.directions}function m_(a,t,e){return{source:t.clone(),x:Rw(e.x-t.x,a),y:Rw(e.y-t.y,a)}}function Rw(a,t){if(!a)return t;const e=Math.abs(a),n=Math.round(e/t);if(!n)return e;const c=n*t,f=(e-c)/n;return t+f}function v_(a,t){const e=t.source,n=i.snapToGrid(a.x-e.x,t.x)+e.x,c=i.snapToGrid(a.y-e.y,t.y)+e.y;return new o(n,c)}function rm(a,t){return a.round(t)}function Cv(a,t,e){return rm(v_(a.clone(),t),e)}function im(a){return a.toString()}function Dx(a){return new o(a.x===0?0:Math.abs(a.x)/a.x,a.y===0?0:Math.abs(a.y)/a.y)}function Lw(a,t){let e=1/0;for(let n=0,c=t.length;n<c;n+=1){const u=a.manhattanDistance(t[n]);u<e&&(e=u)}return e}function kw(a,t,e,n,c){const u=c.precision,f=c.directionMap,d=a.diff(t.getCenter()),v=Object.keys(f).reduce((b,E)=>{if(e.includes(E)){const S=f[E],_=new o(a.x+S.x*(Math.abs(d.x)+t.width),a.y+S.y*(Math.abs(d.y)+t.height)),D=new l(a,_).intersect(t)||[];let L,B=null;for(let H=0;H<D.length;H+=1){const J=D[H],V=a.squaredDistance(J);(L==null||V>L)&&(L=V,B=J)}if(B){let H=Cv(B,n,u);t.containsPoint(H)&&(H=Cv(H.translate(S.x*n.x,S.y*n.y),n,u)),b.push(H)}}return b},[]);return t.containsPoint(a)||v.push(Cv(a,n,u)),v}function y_(a,t,e,n,c){const u=[];let f=Dx(c.diff(e)),d=im(e),v=a[d],b;for(;v;){b=t[d];const _=Dx(b.diff(v));_.equals(f)||(u.unshift(b),f=_),d=im(v),v=a[d]}const E=t[d];return Dx(E.diff(n)).equals(f)||u.unshift(E),u}function b_(a,t,e,n,c){const u=c.precision;let f,d;s.isRectangle(t)?f=rm(Pw(a,c).clone(),u):f=rm(t.clone(),u),s.isRectangle(e)?d=rm(d_(a,c).clone(),u):d=rm(e.clone(),u);const v=m_(c.step,f,d),b=f,E=d;let S,_;if(s.isRectangle(t)?S=kw(b,t,c.startDirections,v,c):S=[b],s.isRectangle(e)?_=kw(d,e,c.endDirections,v,c):_=[E],S=S.filter(C=>n.isAccessible(C)),_=_.filter(C=>n.isAccessible(C)),S.length>0&&_.length>0){const C=new h_,D={},L={},B={};for(let Re=0,Ae=S.length;Re<Ae;Re+=1){const Fe=S[Re],sr=im(Fe);C.add(sr,Lw(Fe,_)),D[sr]=Fe,B[sr]=0}const H=c.previousDirectionAngle,J=H===void 0;let V,ct;const dt=p_(v,c),At=dt.length,le=_.reduce((Re,Ae)=>{const Fe=im(Ae);return Re.push(Fe),Re},[]),ye=o.equalPoints(S,_);let be=c.maxLoopCount;for(;!C.isEmpty()&&be>0;){const Re=C.pop(),Ae=D[Re],Fe=L[Re],sr=B[Re],On=Ae.equals(b),Bt=Fe==null;let he;if(Bt?J?On?he=null:he=Px(b,Ae,At,v,c):he=H:he=Px(Fe,Ae,At,v,c),!(Bt&&ye)&&le.indexOf(Re)>=0)return c.previousDirectionAngle=he,y_(L,D,Ae,b,E);for(let vr=0;vr<At;vr+=1){V=dt[vr];const yr=V.angle;if(ct=Dw(he,yr),!(J&&On)&&ct>c.maxDirectionChange)continue;const Yr=Cv(Ae.clone().translate(V.gridOffsetX||0,V.gridOffsetY||0),v,u),bi=im(Yr);if(C.isClose(bi)||!n.isAccessible(Yr))continue;if(le.indexOf(bi)>=0&&!Yr.equals(E)){const uc=Px(Yr,E,At,v,c);if(Dw(yr,uc)>c.maxDirectionChange)continue}const Lv=V.cost,kv=On?0:c.penalties[ct],kl=sr+Lv+kv;(!C.isOpen(bi)||kl<B[bi])&&(D[bi]=Yr,L[bi]=Ae,B[bi]=kl,C.add(bi,kl+Lw(Yr,_)))}be-=1}}return c.fallbackRoute?Ke(c.fallbackRoute,this,b,E,c):null}function x_(a,t=10){if(a.length<=1)return a;for(let e=0,n=a.length;e<n-1;e+=1){const c=a[e],u=a[e+1];if(c.x===u.x){const f=t*Math.round(c.x/t);c.x!==f&&(c.x=f,u.x=f)}else if(c.y===u.y){const f=t*Math.round(c.y/t);c.y!==f&&(c.y=f,u.y=f)}}return a}const w_=function(a,t,e){const n=u_(t),c=Mw(e,n),u=Nw(e,n),f=Pw(e,n),d=new f_(n).build(e.graph.model,e.cell),v=a.map(C=>o.create(C)),b=[];let E=f,S,_;for(let C=0,D=v.length;C<=D;C+=1){let L=null;if(S=_||c,_=v[C],_==null){_=u;const H=e.cell;if((H.getSourceCellId()==null||H.getTargetCellId()==null)&&typeof n.draggingRouter=="function"){const V=S===c?f:S,ct=_.getOrigin();L=Ke(n.draggingRouter,e,V,ct,n)}}if(L==null&&(L=b_(e,S,_,d,n)),L===null)return console.warn("Unable to execute manhattan algorithm, use orth instead"),Ke(n.fallbackRouter,this,a,n,e);const B=L[0];B&&B.equals(E)&&L.shift(),E=L[L.length-1]||E,b.push(...L)}return n.snapToGrid?x_(b,e.graph.grid.getGridSize()):b},Bw=function(a,t,e){return Ke(w_,this,a,Object.assign(Object.assign({},l_),t),e)},E_={maxDirectionChange:45,directions(){const a=Dl(this.step,this),t=Dl(this.cost,this),e=Math.ceil(Math.sqrt(a*a<<1));return[{cost:t,offsetX:a,offsetY:0},{cost:e,offsetX:a,offsetY:a},{cost:t,offsetX:0,offsetY:a},{cost:e,offsetX:-a,offsetY:a},{cost:t,offsetX:-a,offsetY:0},{cost:e,offsetX:-a,offsetY:-a},{cost:t,offsetX:0,offsetY:-a},{cost:e,offsetX:a,offsetY:-a}]},fallbackRoute(a,t,e){const n=a.theta(t),c=[];let u={x:t.x,y:a.y},f={x:a.x,y:t.y};if(n%180>90){const V=u;u=f,f=V}const d=n%90<45?u:f,v=new l(a,d),b=90*Math.ceil(n/90),E=o.fromPolar(v.squaredLength(),Wn.toRad(b+135),d),S=new l(t,E),_=v.intersectsWithLine(S),C=_||t,D=_?C:a,L=360/e.directions.length,B=D.theta(t),H=Wn.normalize(B+L/2),J=L*Math.floor(H/L);return e.previousDirectionAngle=J,C&&c.push(C.round()),c.push(t),c}},__=function(a,t,e){return Ke(Bw,this,a,Object.assign(Object.assign({},E_),t),e)},S_=function(a,t,e){const n=t.offset||32,c=t.min==null?16:t.min;let u=0,f=t.direction;const d=e.sourceBBox,v=e.targetBBox,b=d.getCenter(),E=v.getCenter();if(typeof n=="number"&&(u=n),f==null){let H=v.left-d.right,J=v.top-d.bottom;H>=0&&J>=0?f=H>=J?"L":"T":H<=0&&J>=0?(H=d.left-v.right,H>=0?f=H>=J?"R":"T":f="T"):H>=0&&J<=0?(J=d.top-v.bottom,J>=0?f=H>=J?"L":"B":f="L"):(H=d.left-v.right,J=d.top-v.bottom,H>=0&&J>=0?f=H>=J?"R":"B":H<=0&&J>=0?f="B":H>=0&&J<=0?f="R":f=Math.abs(H)>Math.abs(J)?"R":"B")}f==="H"?f=E.x-b.x>=0?"L":"R":f==="V"&&(f=E.y-b.y>=0?"T":"B"),n==="center"&&(f==="L"?u=(v.left-d.right)/2:f==="R"?u=(d.left-v.right)/2:f==="T"?u=(v.top-d.bottom)/2:f==="B"&&(u=(d.top-v.bottom)/2));let S,_,C;const D=f==="L"||f==="R";if(D){if(E.y===b.y)return[...a];C=f==="L"?1:-1,S="x",_="width"}else{if(E.x===b.x)return[...a];C=f==="T"?1:-1,S="y",_="height"}const L=b.clone(),B=E.clone();if(L[S]+=C*(d[_]/2+u),B[S]-=C*(v[_]/2+u),D){const H=L.x,J=B.x,V=d.width/2+c,ct=v.width/2+c;E.x>b.x?J<=H&&(L.x=Math.max(J,b.x+V),B.x=Math.min(H,E.x-ct)):J>=H&&(L.x=Math.min(J,b.x-V),B.x=Math.max(H,E.x+ct))}else{const H=L.y,J=B.y,V=d.height/2+c,ct=v.height/2+c;E.y>b.y?J<=H&&(L.y=Math.max(J,b.y+V),B.y=Math.min(H,E.y-ct)):J>=H&&(L.y=Math.min(J,b.y-V),B.y=Math.max(H,E.y+ct))}return[L.toJSON(),...a,B.toJSON()]};function vd(a,t){if(t!=null&&t!==!1){const e=typeof t=="boolean"?0:t;if(e>0){const n=o.create(a[1]).move(a[2],e),c=o.create(a[1]).move(a[0],e);return[n.toJSON(),...a,c.toJSON()]}{const n=a[1];return[Object.assign({},n),...a,Object.assign({},n)]}}return a}const A_=function(a,t,e){const n=t.width||50,u=(t.height||80)/2,f=t.angle||"auto",d=e.sourceAnchor,v=e.targetAnchor,b=e.sourceBBox,E=e.targetBBox;if(d.equals(v)){const S=H=>{const J=Wn.toRad(H),V=Math.sin(J),ct=Math.cos(J),dt=new o(d.x+ct*n,d.y+V*n),At=new o(dt.x-ct*u,dt.y-V*u),le=At.clone().rotate(-90,dt),ye=At.clone().rotate(90,dt);return[le.toJSON(),dt.toJSON(),ye.toJSON()]},_=H=>{const J=d.clone().move(H,-1),V=new l(J,H);return!b.containsPoint(H)&&!b.intersectsWithLine(V)},C=[0,90,180,270,45,135,225,315];if(typeof f=="number")return vd(S(f),t.merge);const D=b.getCenter();if(D.equals(d))return vd(S(0),t.merge);const L=D.angleBetween(d,D.clone().translate(1,0));let B=S(L);if(_(B[1]))return vd(B,t.merge);for(let H=1,J=C.length;H<J;H+=1)if(B=S(L+C[H]),_(B[1]))return vd(B,t.merge);return vd(B,t.merge)}{const S=new l(d,v);let _=S.parallel(-n),C=_.getCenter(),D=_.start.clone().move(_.end,u),L=_.end.clone().move(_.start,u);const B=S.parallel(-1),H=new l(B.start,C),J=new l(B.end,C);if((b.containsPoint(C)||E.containsPoint(C)||b.intersectsWithLine(H)||b.intersectsWithLine(J)||E.intersectsWithLine(H)||E.intersectsWithLine(J))&&(_=S.parallel(n),C=_.getCenter(),D=_.start.clone().move(_.end,u),L=_.end.clone().move(_.start,u)),t.merge){const V=new l(d,v),ct=new l(C,V.center).setLength(Number.MAX_SAFE_INTEGER),dt=b.intersectsWithLine(ct),At=E.intersectsWithLine(ct),le=dt?Array.isArray(dt)?dt:[dt]:[];At&&(Array.isArray(At)?le.push(...At):le.push(At));const ye=V.center.closest(le);ye?(e.sourceAnchor=ye.clone(),e.targetAnchor=ye.clone()):(e.sourceAnchor=V.center.clone(),e.targetAnchor=V.center.clone())}return vd([D.toJSON(),C.toJSON(),L.toJSON()],t.merge)}};var Rl;(function(a){a.presets=hn,a.registry=Z.create({type:"router"}),a.registry.register(a.presets,!0)})(Rl||(Rl={}));const T_=function(a,t,e,n={}){const c=[a,...e,t],u=new T(c),f=new F(u);return n.raw?f:f.serialize()},C_=function(a,t,e,n={}){const c=e.length===3?0:1,u=o.create(e[0+c]),f=o.create(e[2+c]),d=o.create(e[1+c]);if(!o.equals(a,t)){const b=new o((a.x+t.x)/2,(a.y+t.y)/2),E=b.angleBetween(o.create(a).rotate(90,b),d);E>1&&(u.rotate(180-E,b),f.rotate(180-E,b),d.rotate(180-E,b))}const v=`
     M ${a.x} ${a.y}
     Q ${u.x} ${u.y} ${d.x} ${d.y}
     Q ${f.x} ${f.y} ${t.x} ${t.y}
  `;return n.raw?F.parse(v):v},O_=function(a,t,e,n={}){const c=new F;c.appendSegment(F.createSegment("M",a));const u=1/3,f=2/3,d=n.radius||10;let v,b;for(let E=0,S=e.length;E<S;E+=1){const _=o.create(e[E]),C=e[E-1]||a,D=e[E+1]||t;v=b||_.distance(C)/2,b=_.distance(D)/2;const L=-Math.min(d,v),B=-Math.min(d,b),H=_.clone().move(C,L).round(),J=_.clone().move(D,B).round(),V=new o(u*H.x+f*_.x,f*_.y+u*H.y),ct=new o(u*J.x+f*_.x,f*_.y+u*J.y);c.appendSegment(F.createSegment("L",H)),c.appendSegment(F.createSegment("C",V,ct,J))}return c.appendSegment(F.createSegment("L",t)),n.raw?c:c.serialize()},I_=function(a,t,e,n={}){let c,u=n.direction;if(e&&e.length!==0){const f=[a,...e,t],d=O.throughPoints(f);c=new F(d)}else if(c=new F,c.appendSegment(F.createSegment("M",a)),u||(u=Math.abs(a.x-t.x)>=Math.abs(a.y-t.y)?"H":"V"),u==="H"){const f=(a.x+t.x)/2;c.appendSegment(F.createSegment("C",f,a.y,f,t.y,t.x,t.y))}else{const f=(a.y+t.y)/2;c.appendSegment(F.createSegment("C",a.x,f,t.x,f,t.x,t.y))}return n.raw?c:c.serialize()},jw=1,Ov=1/3,Iv=2/3;function M_(a){let t=a.graph._jumpOverUpdateList;if(t==null&&(t=a.graph._jumpOverUpdateList=[],a.graph.on("cell:mouseup",()=>{const e=a.graph._jumpOverUpdateList;setTimeout(()=>{for(let n=0;n<e.length;n+=1)e[n].update()})}),a.graph.on("model:reseted",()=>{t=a.graph._jumpOverUpdateList=[]})),t.indexOf(a)<0){t.push(a);const e=()=>t.splice(t.indexOf(a),1);a.cell.once("change:connector",e),a.cell.once("removed",e)}}function Rx(a,t,e=[]){const n=[a,...e,t],c=[];return n.forEach((u,f)=>{const d=n[f+1];d!=null&&c.push(new l(u,d))}),c}function N_(a,t){const e=[];return t.forEach(n=>{const c=a.intersectsWithLine(n);c&&e.push(c)}),e}function Fw(a,t){return new l(a,t).squaredLength()}function P_(a,t,e){return t.reduce((n,c,u)=>{if(Mv.includes(c))return n;const f=n.pop()||a,d=o.create(c).move(f.start,-e);let v=o.create(c).move(f.start,+e);const b=t[u+1];if(b!=null){const _=v.distance(b);_<=e&&(v=b.move(f.start,_),Mv.push(b))}else if(d.distance(f.end)<e*2+jw)return n.push(f),n;if(v.distance(f.start)<e*2+jw)return n.push(f),n;const S=new l(d,v);return om.push(S),n.push(new l(f.start,d),S,new l(v,f.end)),n},[])}function Gw(a,t,e,n){const c=new F;let u;return u=F.createSegment("M",a[0].start),c.appendSegment(u),a.forEach((f,d)=>{if(om.includes(f)){let v,b,E,S;if(e==="arc"){v=-90,b=f.start.diff(f.end),(b.x<0||b.x===0&&b.y<0)&&(v+=180);const C=f.getCenter(),D=new l(C,f.end).rotate(v,C);let L;L=new l(f.start,C),E=L.pointAt(2/3).rotate(v,f.start),S=D.pointAt(1/3).rotate(-v,D.end),u=F.createSegment("C",E,S,D.end),c.appendSegment(u),L=new l(C,f.end),E=D.pointAt(1/3).rotate(v,D.end),S=L.pointAt(1/3).rotate(-v,f.end),u=F.createSegment("C",E,S,f.end),c.appendSegment(u)}else if(e==="gap")u=F.createSegment("M",f.end),c.appendSegment(u);else if(e==="cubic"){v=f.start.theta(f.end);const _=t*.6;let C=t*1.35;b=f.start.diff(f.end),(b.x<0||b.x===0&&b.y<0)&&(C*=-1),E=new o(f.start.x+_,f.start.y+C).rotate(v,f.start),S=new o(f.end.x-_,f.end.y+C).rotate(v,f.end),u=F.createSegment("C",E,S,f.end),c.appendSegment(u)}}else{const v=a[d+1];n===0||!v||om.includes(v)?(u=F.createSegment("L",f.end),c.appendSegment(u)):D_(n,c,f.end,f.start,v.end)}}),c}function D_(a,t,e,n,c){const u=e.distance(n)/2,f=e.distance(c)/2,d=-Math.min(a,u),v=-Math.min(a,f),b=e.clone().move(n,d).round(),E=e.clone().move(c,v).round(),S=new o(Ov*b.x+Iv*e.x,Iv*e.y+Ov*b.y),_=new o(Ov*E.x+Iv*e.x,Iv*e.y+Ov*E.y);let C;C=F.createSegment("L",b),t.appendSegment(C),C=F.createSegment("C",S,_,E),t.appendSegment(C)}let om,Mv;const R_=function(a,t,e,n={}){om=[],Mv=[],M_(this);const c=n.size||5,u=n.type||"arc",f=n.radius||0,d=n.ignoreConnectors||["smooth"],v=this.graph,E=v.model.getEdges();if(E.length===1)return Gw(Rx(a,t,e),c,u,f);const S=this.cell,_=E.indexOf(S),C=v.options.connecting.connector||{},D=E.filter((ct,dt)=>{const At=ct.getConnector()||C;return d.includes(At.name)?!1:dt>_?At.name!=="jumpover":!0}),L=D.map(ct=>v.findViewByCell(ct)),B=Rx(a,t,e),H=L.map(ct=>ct==null?[]:ct===this?B:Rx(ct.sourcePoint,ct.targetPoint,ct.routePoints)),J=[];B.forEach(ct=>{const dt=D.reduce((At,le,ye)=>{if(le!==S){const be=N_(ct,H[ye]);At.push(...be)}return At},[]).sort((At,le)=>Fw(ct.start,At)-Fw(ct.start,le));dt.length>0?J.push(...P_(ct,dt,c)):J.push(ct)});const V=Gw(J,c,u,f);return om=[],Mv=[],n.raw?V:V.serialize()};var ih;(function(a){a.presets=Ce,a.registry=Z.create({type:"connector"}),a.registry.register(a.presets,!0)})(ih||(ih={}));var L_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class zw extends vi{constructor(t={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(ur(t)),this.changed={}}mutate(t,e={}){const n=e.unset===!0,c=e.silent===!0,u=[],f=this.changing;this.changing=!0,f||(this.previous=ur(this.data),this.changed={});const d=this.data,v=this.previous,b=this.changed;if(Object.keys(t).forEach(E=>{const S=E,_=t[S];mi(d[S],_)||u.push(S),mi(v[S],_)?delete b[S]:b[S]=_,n?delete d[S]:d[S]=_}),!c&&u.length>0&&(this.pending=!0,this.pendingOptions=e,u.forEach(E=>{this.emit("change:*",{key:E,options:e,store:this,current:d[E],previous:v[E]})})),f)return this;if(!c)for(;this.pending;)this.pending=!1,this.emit("changed",{current:d,previous:v,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(t,e){if(t==null)return this.data;const n=this.data[t];return n==null?e:n}getPrevious(t){if(this.previous){const e=this.previous[t];return e==null?void 0:e}}set(t,e,n){return t!=null&&(typeof t=="object"?this.mutate(t,e):this.mutate({[t]:e},n)),this}remove(t,e){const c={};let u;if(typeof t=="string")c[t]=void 0,u=e;else if(Array.isArray(t))t.forEach(f=>c[f]=void 0),u=e;else{for(const f in this.data)c[f]=void 0;u=t}return this.mutate(c,Object.assign(Object.assign({},u),{unset:!0})),this}getByPath(t){return Sf(this.data,t,"/")}setByPath(t,e,n={}){const c="/",u=Array.isArray(t)?[...t]:t.split(c),f=Array.isArray(t)?t.join(c):t,d=u[0],v=u.length;if(n.propertyPath=f,n.propertyValue=e,n.propertyPathArray=u,v===1)this.set(d,e,n);else{const b={};let E=b,S=d;for(let D=1;D<v;D+=1){const L=u[D],B=Number.isFinite(Number(L));E=E[S]=B?[]:{},S=L}ia(b,u,e,c);const _=ur(this.data);n.rewrite&&rp(_,t,c);const C=Yn(_,b);this.set(d,C[d],n)}return this}removeByPath(t,e){const n=Array.isArray(t)?t:t.split("/"),c=n[0];if(n.length===1)this.remove(c,e);else{const u=n.slice(1),f=ur(this.get(c));f&&rp(f,u),this.set(c,f,e)}return this}hasChanged(t){return t==null?Object.keys(this.changed).length>0:t in this.changed}getChanges(t){if(t==null)return this.hasChanged()?ur(this.changed):null;const e=this.changing?this.previous:this.data,n={};let c;for(const u in t){const f=t[u];mi(e[u],f)||(n[u]=f,c=!0)}return c?ur(n):null}toJSON(){return ur(this.data)}clone(){const t=this.constructor;return new t(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}L_([vi.dispose()],zw.prototype,"dispose",null);class sm{constructor(t){this.cell=t,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(t,e,n={},c="/"){const u=this.cell.getPropByPath(t),f=Jg(n,sm.defaultOptions),d=this.getTiming(f.timing),v=this.getInterp(f.interp,u,e);let b=0;const E=Array.isArray(t)?t.join(c):t,S=Array.isArray(t)?t:t.split(c),_=()=>{const C=new Date().getTime();b===0&&(b=C);let L=(C-b)/f.duration;L<1?this.ids[E]=requestAnimationFrame(_):L=1;const B=v(d(L));this.cell.setPropByPath(S,B),n.progress&&n.progress(Object.assign({progress:L,currentValue:B},this.getArgs(E))),L===1&&(this.cell.notify("transition:complete",this.getArgs(E)),n.complete&&n.complete(this.getArgs(E)),this.cell.notify("transition:finish",this.getArgs(E)),n.finish&&n.finish(this.getArgs(E)),this.clean(E))};return setTimeout(()=>{this.stop(t,void 0,c),this.cache[E]={startValue:u,targetValue:e,options:f},this.ids[E]=requestAnimationFrame(_),this.cell.notify("transition:start",this.getArgs(E)),n.start&&n.start(this.getArgs(E))},n.delay),this.stop.bind(this,t,c,n)}stop(t,e={},n="/"){const c=Array.isArray(t)?t:t.split(n);return Object.keys(this.ids).filter(u=>mi(c,u.split(n).slice(0,c.length))).forEach(u=>{cancelAnimationFrame(this.ids[u]);const f=this.cache[u],d=this.getArgs(u),v=Object.assign(Object.assign({},f.options),e),b=v.jumpedToEnd;b&&f.targetValue!=null&&(this.cell.setPropByPath(u,f.targetValue),this.cell.notify("transition:end",Object.assign({},d)),this.cell.notify("transition:complete",Object.assign({},d)),v.complete&&v.complete(Object.assign({},d)));const E=Object.assign({jumpedToEnd:b},d);this.cell.notify("transition:stop",Object.assign({},E)),v.stop&&v.stop(Object.assign({},E)),this.cell.notify("transition:finish",Object.assign({},d)),v.finish&&v.finish(Object.assign({},d)),this.clean(u)}),this}clean(t){delete this.ids[t],delete this.cache[t]}getTiming(t){return typeof t=="string"?ic[t]:t}getInterp(t,e,n){return t?t(e,n):typeof n=="number"?oc.number(e,n):typeof n=="string"?n[0]==="#"?oc.color(e,n):oc.unit(e,n):oc.object(e,n)}getArgs(t){const e=this.cache[t];return{path:t,startValue:e.startValue,targetValue:e.targetValue,cell:this.cell}}}(function(a){a.defaultOptions={delay:10,duration:100,timing:"linear"}})(sm||(sm={}));var k_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u},Uw=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class Cn extends vi{static config(t){const{markup:e,propHooks:n,attrHooks:c}=t,u=Uw(t,["markup","propHooks","attrHooks"]);e!=null&&(this.markup=e),n&&(this.propHooks=this.propHooks.slice(),Array.isArray(n)?this.propHooks.push(...n):typeof n=="function"?this.propHooks.push(n):Object.values(n).forEach(f=>{typeof f=="function"&&this.propHooks.push(f)})),c&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),c)),this.defaults=Yn({},this.defaults,u)}static getMarkup(){return this.markup}static getDefaults(t){return t?this.defaults:ur(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(t,e){return this.propHooks.reduce((n,c)=>c?Ke(c,t,n):n,e)}get[Symbol.toStringTag](){return Cn.toStringTag}constructor(t={}){super();const n=this.constructor.getDefaults(!0),c=Yn({},this.preprocess(n),this.preprocess(t));this.id=c.id||Yu(),this.store=new zw(c),this.animation=new sm(this),this.setup(),this.init(),this.postprocess(t)}init(){}get model(){return this._model}set model(t){this._model!==t&&(this._model=t)}preprocess(t,e){const n=t.id,u=this.constructor.applyPropHooks(this,t);return n==null&&e!==!0&&(u.id=Yu()),u}postprocess(t){}setup(){this.store.on("change:*",t=>{const{key:e,current:n,previous:c,options:u}=t;this.notify("change:*",{key:e,options:u,current:n,previous:c,cell:this}),this.notify(`change:${e}`,{options:u,current:n,previous:c,cell:this});const f=e;(f==="source"||f==="target")&&this.notify("change:terminal",{type:f,current:n,previous:c,options:u,cell:this})}),this.store.on("changed",({options:t})=>this.notify("changed",{options:t,cell:this}))}notify(t,e){this.trigger(t,e);const n=this.model;return n&&(n.notify(`cell:${t}`,e),this.isNode()?n.notify(`node:${t}`,Object.assign(Object.assign({},e),{node:this})):this.isEdge()&&n.notify(`edge:${t}`,Object.assign(Object.assign({},e),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(t){return this.store===t.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(t,e){return t==null?this.store.get():this.store.get(t,e)}setProp(t,e,n){if(typeof t=="string")this.store.set(t,e,n);else{const c=this.preprocess(t,!0);this.store.set(Yn({},this.getProp(),c),e),this.postprocess(t)}return this}removeProp(t,e){return typeof t=="string"||Array.isArray(t)?this.store.removeByPath(t,e):this.store.remove(e),this}hasChanged(t){return t==null?this.store.hasChanged():this.store.hasChanged(t)}getPropByPath(t){return this.store.getByPath(t)}setPropByPath(t,e,n={}){return this.model&&(t==="children"?this._children=e?e.map(c=>this.model.getCell(c)).filter(c=>c!=null):null:t==="parent"&&(this._parent=e?this.model.getCell(e):null)),this.store.setByPath(t,e,n),this}removePropByPath(t,e={}){const n=Array.isArray(t)?t:t.split("/");return n[0]==="attrs"&&(e.dirty=!0),this.store.removeByPath(n,e),this}prop(t,e,n){return t==null?this.getProp():typeof t=="string"||Array.isArray(t)?arguments.length===1?this.getPropByPath(t):e==null?this.removePropByPath(t,n||{}):this.setPropByPath(t,e,n||{}):this.setProp(t,e||{})}previous(t){return this.store.getPrevious(t)}get zIndex(){return this.getZIndex()}set zIndex(t){t==null?this.removeZIndex():this.setZIndex(t)}getZIndex(){return this.store.get("zIndex")}setZIndex(t,e={}){return this.store.set("zIndex",t,e),this}removeZIndex(t={}){return this.store.remove("zIndex",t),this}toFront(t={}){const e=this.model;if(e){let n=e.getMaxZIndex(),c;t.deep?(c=this.getDescendants({deep:!0,breadthFirst:!0}),c.unshift(this)):c=[this],n=n-c.length+1;const u=e.total();let f=e.indexOf(this)!==u-c.length;f||(f=c.some((d,v)=>d.getZIndex()!==n+v)),f&&this.batchUpdate("to-front",()=>{n+=c.length,c.forEach((d,v)=>{d.setZIndex(n+v,t)})})}return this}toBack(t={}){const e=this.model;if(e){let n=e.getMinZIndex(),c;t.deep?(c=this.getDescendants({deep:!0,breadthFirst:!0}),c.unshift(this)):c=[this];let u=e.indexOf(this)!==0;u||(u=c.some((f,d)=>f.getZIndex()!==n+d)),u&&this.batchUpdate("to-back",()=>{n-=c.length,c.forEach((f,d)=>{f.setZIndex(n+d,t)})})}return this}get markup(){return this.getMarkup()}set markup(t){t==null?this.removeMarkup():this.setMarkup(t)}getMarkup(){let t=this.store.get("markup");return t==null&&(t=this.constructor.getMarkup()),t}setMarkup(t,e={}){return this.store.set("markup",t,e),this}removeMarkup(t={}){return this.store.remove("markup",t),this}get attrs(){return this.getAttrs()}set attrs(t){t==null?this.removeAttrs():this.setAttrs(t)}getAttrs(){const t=this.store.get("attrs");return t?Object.assign({},t):{}}setAttrs(t,e={}){if(t==null)this.removeAttrs(e);else{const n=c=>this.store.set("attrs",c,e);if(e.overwrite===!0)n(t);else{const c=this.getAttrs();e.deep===!1?n(Object.assign(Object.assign({},c),t)):n(Yn({},c,t))}}return this}replaceAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{deep:!1}))}removeAttrs(t={}){return this.store.remove("attrs",t),this}getAttrDefinition(t){if(!t)return null;const n=this.constructor.getAttrHooks()||{};let c=n[t]||fa.registry.get(t);if(!c){const u=cl(t);c=n[u]||fa.registry.get(u)}return c||null}getAttrByPath(t){return t==null||t===""?this.getAttrs():this.getPropByPath(this.prefixAttrPath(t))}setAttrByPath(t,e,n={}){return this.setPropByPath(this.prefixAttrPath(t),e,n),this}removeAttrByPath(t,e={}){return this.removePropByPath(this.prefixAttrPath(t),e),this}prefixAttrPath(t){return Array.isArray(t)?["attrs"].concat(t):`attrs/${t}`}attr(t,e,n){return t==null?this.getAttrByPath():typeof t=="string"||Array.isArray(t)?arguments.length===1?this.getAttrByPath(t):e==null?this.removeAttrByPath(t,n||{}):this.setAttrByPath(t,e,n||{}):this.setAttrs(t,e||{})}get visible(){return this.isVisible()}set visible(t){this.setVisible(t)}setVisible(t,e={}){return this.store.set("visible",t,e),this}isVisible(){return this.store.get("visible")!==!1}show(t={}){return this.isVisible()||this.setVisible(!0,t),this}hide(t={}){return this.isVisible()&&this.setVisible(!1,t),this}toggleVisible(t,e={}){const n=typeof t=="boolean"?t:!this.isVisible(),c=typeof t=="boolean"?e:t;return n?this.show(c):this.hide(c),this}get data(){return this.getData()}set data(t){this.setData(t)}getData(){return this.store.get("data")}setData(t,e={}){if(t==null)this.removeData(e);else{const n=c=>this.store.set("data",c,e);if(e.overwrite===!0)n(t);else{const c=this.getData();e.deep===!1?n(typeof t=="object"?Object.assign(Object.assign({},c),t):t):n(Yn({},c,t))}}return this}replaceData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{deep:!1}))}removeData(t={}){return this.store.remove("data",t),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const t=this.getParentId();if(t&&this.model){const e=this.model.getCell(t);return this._parent=e,e}return null}getChildren(){const t=this.store.get("children");if(t&&t.length&&this.model){const e=t.map(n=>{var c;return(c=this.model)===null||c===void 0?void 0:c.getCell(n)}).filter(n=>n!=null);return this._children=e,[...e]}return null}hasParent(){return this.parent!=null}isParentOf(t){return t!=null&&t.getParent()===this}isChildOf(t){return t!=null&&this.getParent()===t}eachChild(t,e){return this.children&&this.children.forEach(t,e),this}filterChild(t,e){return this.children?this.children.filter(t,e):[]}getChildCount(){return this.children==null?0:this.children.length}getChildIndex(t){return this.children==null?-1:this.children.indexOf(t)}getChildAt(t){return this.children!=null&&t>=0?this.children[t]:null}getAncestors(t={}){const e=[];let n=this.getParent();for(;n;)e.push(n),n=t.deep!==!1?n.getParent():null;return e}getDescendants(t={}){if(t.deep!==!1){if(t.breadthFirst){const e=[],n=this.getChildren()||[];for(;n.length>0;){const c=n.shift(),u=c.getChildren();e.push(c),u&&n.push(...u)}return e}{const e=this.getChildren()||[];return e.forEach(n=>{e.push(...n.getDescendants(t))}),e}}return this.getChildren()||[]}isDescendantOf(t,e={}){if(t==null)return!1;if(e.deep!==!1){let n=this.getParent();for(;n;){if(n===t)return!0;n=n.getParent()}return!1}return this.isChildOf(t)}isAncestorOf(t,e={}){return t==null?!1:t.isDescendantOf(this,e)}contains(t){return this.isAncestorOf(t)}getCommonAncestor(...t){return Cn.getCommonAncestor(this,...t)}setParent(t,e={}){return this._parent=t,t?this.store.set("parent",t.id,e):this.store.remove("parent",e),this}setChildren(t,e={}){return this._children=t,t!=null?this.store.set("children",t.map(n=>n.id),e):this.store.remove("children",e),this}unembed(t,e={}){const n=this.children;if(n!=null&&t!=null){const c=this.getChildIndex(t);c!==-1&&(n.splice(c,1),t.setParent(null,e),this.setChildren(n,e))}return this}embed(t,e={}){return t.addTo(this,e),this}addTo(t,e={}){return Cn.isCell(t)?t.addChild(this,e):t.addCell(this,e),this}insertTo(t,e,n={}){return t.insertChild(this,e,n),this}addChild(t,e={}){return this.insertChild(t,void 0,e)}insertChild(t,e,n={}){if(t!=null&&t!==this){const c=t.getParent(),u=this!==c;let f=e;if(f==null&&(f=this.getChildCount(),u||(f-=1)),c){const v=c.getChildren();if(v){const b=v.indexOf(t);b>=0&&(t.setParent(null,n),v.splice(b,1),c.setChildren(v,n))}}let d=this.children;if(d==null?(d=[],d.push(t)):d.splice(f,0,t),t.setParent(this,n),this.setChildren(d,n),u&&this.model){const v=this.model.getIncomingEdges(this),b=this.model.getOutgoingEdges(this);v&&v.forEach(E=>E.updateParent(n)),b&&b.forEach(E=>E.updateParent(n))}this.model&&this.model.addCell(t,n)}return this}removeFromParent(t={}){const e=this.getParent();if(e!=null){const n=e.getChildIndex(this);e.removeChildAt(n,t)}return this}removeChild(t,e={}){const n=this.getChildIndex(t);return this.removeChildAt(n,e)}removeChildAt(t,e={}){const n=this.getChildAt(t);return this.children!=null&&n!=null&&(this.unembed(n,e),n.remove(e)),n}remove(t={}){return this.batchUpdate("remove",()=>{const e=this.getParent();e&&e.removeChild(this,t),t.deep!==!1&&this.eachChild(n=>n.remove(t)),this.model&&this.model.removeCell(this,t)}),this}transition(t,e,n={},c="/"){return this.animation.start(t,e,n,c)}stopTransition(t,e,n="/"){return this.animation.stop(t,e,n),this}getTransitions(){return this.animation.get()}translate(t,e,n){return this}scale(t,e,n,c){return this}addTools(t,e,n){const c=Array.isArray(t)?t:[t],u=typeof e=="string"?e:null,f=typeof e=="object"?e:typeof n=="object"?n:{};if(f.reset)return this.setTools({name:u,items:c,local:f.local},f);let d=ur(this.getTools());if(d==null||u==null||d.name===u)return d==null&&(d={}),d.items||(d.items=[]),d.name=u,d.items=[...d.items,...c],this.setTools(Object.assign({},d),f)}setTools(t,e={}){return t==null?this.removeTools():this.store.set("tools",Cn.normalizeTools(t),e),this}getTools(){return this.store.get("tools")}removeTools(t={}){return this.store.remove("tools",t),this}hasTools(t){const e=this.getTools();return e==null?!1:t==null?!0:e.name===t}hasTool(t){const e=this.getTools();return e==null?!1:e.items.some(n=>typeof n=="string"?n===t:n.name===t)}removeTool(t,e={}){const n=ur(this.getTools());if(n){let c=!1;const u=n.items.slice(),f=d=>{u.splice(d,1),c=!0};if(typeof t=="number")f(t);else for(let d=u.length-1;d>=0;d-=1){const v=u[d];(typeof v=="string"?v===t:v.name===t)&&f(d)}c&&(n.items=u,this.setTools(n,e))}return this}getBBox(t){return new s}getConnectionPoint(t,e){return new o}toJSON(t={}){const e=Object.assign({},this.store.get()),n=Object.prototype.toString,c=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!e.shape){const D=this.constructor;throw new Error(`Unable to serialize ${c} missing "shape" prop, check the ${c} "${D.name||n.call(D)}"`)}const u=this.constructor,f=t.diff===!0,d=e.attrs||{},v=u.getDefaults(!0),b=f?this.preprocess(v,!0):v,E=b.attrs||{},S={};Object.entries(e).forEach(([D,L])=>{if(L!=null&&!Array.isArray(L)&&typeof L=="object"&&!fi.Z(L))throw new Error(`Can only serialize ${c} with plain-object props, but got a "${n.call(L)}" type of key "${D}" on ${c} "${this.id}"`);if(D!=="attrs"&&D!=="shape"&&f){const B=b[D];mi(L,B)&&delete e[D]}}),Object.keys(d).forEach(D=>{const L=d[D],B=E[D];Object.keys(L).forEach(H=>{const J=L[H],V=B?B[H]:null;J!=null&&typeof J=="object"&&!Array.isArray(J)?Object.keys(J).forEach(ct=>{const dt=J[ct];if(B==null||V==null||!Ue(V)||!mi(V[ct],dt)){S[D]==null&&(S[D]={}),S[D][H]==null&&(S[D][H]={});const At=S[D][H];At[ct]=dt}}):(B==null||!mi(V,J))&&(S[D]==null&&(S[D]={}),S[D][H]=J)})});const _=Object.assign(Object.assign({},e),{attrs:M(S)?void 0:S});_.attrs==null&&delete _.attrs;const C=_;return C.angle===0&&delete C.angle,ur(C)}clone(t={}){if(!t.deep){const n=Object.assign({},this.store.get());t.keepId||delete n.id,delete n.parent,delete n.children;const c=this.constructor;return new c(n)}return Cn.deepClone(this)[this.id]}findView(t){return t.findViewByCell(this)}startBatch(t,e={},n=this.model){return this.notify("batch:start",{name:t,data:e,cell:this}),n&&n.startBatch(t,Object.assign(Object.assign({},e),{cell:this})),this}stopBatch(t,e={},n=this.model){return n&&n.stopBatch(t,Object.assign(Object.assign({},e),{cell:this})),this.notify("batch:stop",{name:t,data:e,cell:this}),this}batchUpdate(t,e,n){const c=this.model;this.startBatch(t,n,c);const u=e();return this.stopBatch(t,n,c),u}dispose(){this.removeFromParent(),this.store.dispose()}}Cn.defaults={},Cn.attrHooks={},Cn.propHooks=[],k_([vi.dispose()],Cn.prototype,"dispose",null),function(a){function t(e){return typeof e=="string"?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]}}a.normalizeTools=t}(Cn||(Cn={})),function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.isNode=="function"&&typeof c.isEdge=="function"&&typeof c.prop=="function"&&typeof c.attr=="function"}a.isCell=t}(Cn||(Cn={})),function(a){function t(...u){const f=u.filter(v=>v!=null).map(v=>v.getAncestors()).sort((v,b)=>v.length-b.length);return f.shift().find(v=>f.every(b=>b.includes(v)))||null}a.getCommonAncestor=t;function e(u,f={}){let d=null;for(let v=0,b=u.length;v<b;v+=1){const E=u[v];let S=E.getBBox(f);if(S){if(E.isNode()){const _=E.getAngle();_!=null&&_!==0&&(S=S.bbox(_))}d=d==null?S:d.union(S)}}return d}a.getCellsBBox=e;function n(u){const f=[u,...u.getDescendants({deep:!0})];return a.cloneCells(f)}a.deepClone=n;function c(u){const f=Wu(u),d=f.reduce((v,b)=>(v[b.id]=b.clone(),v),{});return f.forEach(v=>{const b=d[v.id];if(b.isEdge()){const _=b.getSourceCellId(),C=b.getTargetCellId();_&&d[_]&&b.setSource(Object.assign(Object.assign({},b.getSource()),{cell:d[_].id})),C&&d[C]&&b.setTarget(Object.assign(Object.assign({},b.getTarget()),{cell:d[C].id}))}const E=v.getParent();E&&d[E.id]&&b.setParent(d[E.id]);const S=v.getChildren();if(S&&S.length){const _=S.reduce((C,D)=>(d[D.id]&&C.push(d[D.id]),C),[]);_.length>0&&b.setChildren(_)}}),d}a.cloneCells=c}(Cn||(Cn={})),function(a){a.config({propHooks(t){var{tools:e}=t,n=Uw(t,["tools"]);return e&&(n.tools=a.normalizeTools(e)),n}})}(Cn||(Cn={}));var yd;(function(a){let t,e;function n(f,d){return d?t!=null&&t.exist(f):e!=null&&e.exist(f)}a.exist=n;function c(f){t=f}a.setEdgeRegistry=c;function u(f){e=f}a.setNodeRegistry=u})(yd||(yd={}));class B_{constructor(t){this.ports=[],this.groups={},this.init(ur(t))}getPorts(){return this.ports}getGroup(t){return t!=null?this.groups[t]:null}getPortsByGroup(t){return this.ports.filter(e=>e.group===t||e.group==null&&t==null)}getPortsLayoutByGroup(t,e){const n=this.getPortsByGroup(t),c=t?this.getGroup(t):null,u=c?c.position:null,f=u?u.name:null;let d;if(f!=null){const S=rh.registry.get(f);if(S==null)return rh.registry.onNotFound(f);d=S}else d=rh.presets.left;const v=n.map(S=>S&&S.position&&S.position.args||{}),b=u&&u.args||{};return d(v,e,b).map((S,_)=>{const C=n[_];return{portLayout:S,portId:C.id,portSize:C.size,portAttrs:C.attrs,labelSize:C.label.size,labelLayout:this.getPortLabelLayout(C,o.create(S.position),e)}})}init(t){const{groups:e,items:n}=t;e!=null&&Object.keys(e).forEach(c=>{this.groups[c]=this.parseGroup(e[c])}),Array.isArray(n)&&n.forEach(c=>{this.ports.push(this.parsePort(c))})}parseGroup(t){return Object.assign(Object.assign({},t),{label:this.getLabel(t,!0),position:this.getPortPosition(t.position,!0)})}parsePort(t){const e=Object.assign({},t),n=this.getGroup(t.group)||{};return e.markup=e.markup||n.markup,e.attrs=Yn({},n.attrs,e.attrs),e.position=this.createPosition(n,e),e.label=Yn({},n.label,this.getLabel(e)),e.zIndex=this.getZIndex(n,e),e.size=Object.assign(Object.assign({},n.size),e.size),e}getZIndex(t,e){return typeof e.zIndex=="number"?e.zIndex:typeof t.zIndex=="number"||t.zIndex==="auto"?t.zIndex:"auto"}createPosition(t,e){return Yn({name:"left",args:{}},t.position,{args:e.args})}getPortPosition(t,e=!1){if(t==null){if(e)return{name:"left",args:{}}}else{if(typeof t=="string")return{name:t,args:{}};if(Array.isArray(t))return{name:"absolute",args:{x:t[0],y:t[1]}};if(typeof t=="object")return t}return{args:{}}}getPortLabelPosition(t,e=!1){if(t==null){if(e)return{name:"left",args:{}}}else{if(typeof t=="string")return{name:t,args:{}};if(typeof t=="object")return t}return{args:{}}}getLabel(t,e=!1){const n=t.label||{};return n.position=this.getPortLabelPosition(n.position,e),n}getPortLabelLayout(t,e,n){const c=t.label.position.name||"left",u=t.label.position.args||{},f=ud.registry.get(c)||ud.presets.left;return f?f(e,n,u):null}}var Nv=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class Cr extends Cn{get[Symbol.toStringTag](){return Cr.toStringTag}constructor(t={}){super(t),this.initPorts()}preprocess(t,e){const{x:n,y:c,width:u,height:f}=t,d=Nv(t,["x","y","width","height"]);if(n!=null||c!=null){const v=d.position;d.position=Object.assign(Object.assign({},v),{x:n!=null?n:v?v.x:0,y:c!=null?c:v?v.y:0})}if(u!=null||f!=null){const v=d.size;d.size=Object.assign(Object.assign({},v),{width:u!=null?u:v?v.width:0,height:f!=null?f:v?v.height:0})}return super.preprocess(d,e)}isNode(){return!0}size(t,e,n){return t===void 0?this.getSize():typeof t=="number"?this.setSize(t,e,n):this.setSize(t,e)}getSize(){const t=this.store.get("size");return t?Object.assign({},t):{width:1,height:1}}setSize(t,e,n){return typeof t=="object"?this.resize(t.width,t.height,e):this.resize(t,e,n),this}resize(t,e,n={}){this.startBatch("resize",n);const c=n.direction;if(c){const u=this.getSize();switch(c){case"left":case"right":e=u.height;break;case"top":case"bottom":t=u.width;break;default:break}let d={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[c];const v=Wn.normalize(this.getAngle()||0);n.absolute&&(d+=Math.floor((v+45)/90),d%=4);const b=this.getBBox();let E;d===0?E=b.getBottomLeft():d===1?E=b.getCorner():d===2?E=b.getTopRight():E=b.getOrigin();const S=E.clone().rotate(-v,b.getCenter()),_=Math.sqrt(t*t+e*e)/2;let C=d*Math.PI/2;C+=Math.atan(d%2===0?e/t:t/e),C-=Wn.toRad(v);const L=o.fromPolar(_,C,S).clone().translate(t/-2,e/-2);this.store.set("size",{width:t,height:e},n),this.setPosition(L.x,L.y,n)}else this.store.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this}scale(t,e,n,c={}){const u=this.getBBox().scale(t,e,n==null?void 0:n);return this.startBatch("scale",c),this.setPosition(u.x,u.y,c),this.resize(u.width,u.height,c),this.stopBatch("scale"),this}position(t,e,n){return typeof t=="number"?this.setPosition(t,e,n):this.getPosition(t)}getPosition(t={}){if(t.relative){const n=this.getParent();if(n!=null&&n.isNode()){const c=this.getPosition(),u=n.getPosition();return{x:c.x-u.x,y:c.y-u.y}}}const e=this.store.get("position");return e?Object.assign({},e):{x:0,y:0}}setPosition(t,e,n={}){let c,u,f;if(typeof t=="object"?(c=t.x,u=t.y,f=e||{}):(c=t,u=e,f=n||{}),f.relative){const d=this.getParent();if(d!=null&&d.isNode()){const v=d.getPosition();c+=v.x,u+=v.y}}if(f.deep){const d=this.getPosition();this.translate(c-d.x,u-d.y,f)}else this.store.set("position",{x:c,y:u},f);return this}translate(t=0,e=0,n={}){if(t===0&&e===0)return this;n.translateBy=n.translateBy||this.id;const c=this.getPosition();if(n.restrict!=null&&n.translateBy===this.id){const f=this.getBBox({deep:!0}),d=n.restrict,v=c.x-f.x,b=c.y-f.y,E=Math.max(d.x+v,Math.min(d.x+d.width+v-f.width,c.x+t)),S=Math.max(d.y+b,Math.min(d.y+d.height+b-f.height,c.y+e));t=E-c.x,e=S-c.y}const u={x:c.x+t,y:c.y+e};return n.tx=t,n.ty=e,n.transition?(typeof n.transition!="object"&&(n.transition={}),this.transition("position",u,Object.assign(Object.assign({},n.transition),{interp:oc.object})),this.eachChild(f=>{var d;((d=n.exclude)===null||d===void 0?void 0:d.includes(f))||f.translate(t,e,n)})):(this.startBatch("translate",n),this.store.set("position",u,n),this.eachChild(f=>{var d;((d=n.exclude)===null||d===void 0?void 0:d.includes(f))||f.translate(t,e,n)}),this.stopBatch("translate",n)),this}angle(t,e){return t==null?this.getAngle():this.rotate(t,e)}getAngle(){return this.store.get("angle",0)}rotate(t,e={}){const n=this.getAngle();if(e.center){const c=this.getSize(),u=this.getPosition(),f=this.getBBox().getCenter();f.rotate(n-t,e.center);const d=f.x-c.width/2-u.x,v=f.y-c.height/2-u.y;this.startBatch("rotate",{angle:t,options:e}),this.setPosition(u.x+d,u.y+v,e),this.rotate(t,Object.assign(Object.assign({},e),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",e.absolute?t:(n+t)%360,e);return this}getBBox(t={}){if(t.deep){const e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),Cn.getCellsBBox(e)}return s.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(t,e){const n=this.getBBox(),c=n.getCenter(),u=t.getTerminal(e);if(u==null)return c;const f=u.port;if(!f||!this.hasPort(f))return c;const d=this.getPort(f);if(!d||!d.group)return c;const b=this.getPortsPosition(d.group)[f].position,E=o.create(b).translate(n.getOrigin()),S=this.getAngle();return S&&E.rotate(-S,c),E}fit(t={}){const n=(this.getChildren()||[]).filter(b=>b.isNode());if(n.length===0)return this;this.startBatch("fit-embeds",t),t.deep&&n.forEach(b=>b.fit(t));let{x:c,y:u,width:f,height:d}=Cn.getCellsBBox(n);const v=ps(t.padding);return c-=v.left,u-=v.top,f+=v.left+v.right,d+=v.bottom+v.top,this.store.set({position:{x:c,y:u},size:{width:f,height:d}},t),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(t){this.setPortContainerMarkup(t)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||or.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(t,e={}){return this.store.set("portContainerMarkup",or.clone(t),e),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(t){this.setPortMarkup(t)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||or.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(t,e={}){return this.store.set("portMarkup",or.clone(t),e),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(t){this.setPortLabelMarkup(t)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||or.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(t,e={}){return this.store.set("portLabelMarkup",or.clone(t),e),this}get ports(){const t=this.store.get("ports",{items:[]});return t.items==null&&(t.items=[]),t}getPorts(){return ur(this.ports.items)}getPortsByGroup(t){return this.getPorts().filter(e=>e.group===t)}getPort(t){return ur(this.ports.items.find(e=>e.id&&e.id===t))}getPortAt(t){return this.ports.items[t]||null}hasPorts(){return this.ports.items.length>0}hasPort(t){return this.getPortIndex(t)!==-1}getPortIndex(t){const e=typeof t=="string"?t:t.id;return e!=null?this.ports.items.findIndex(n=>n.id===e):-1}getPortsPosition(t){const e=this.getSize();return this.port.getPortsLayoutByGroup(t,new s(0,0,e.width,e.height)).reduce((c,u)=>{const f=u.portLayout;return c[u.portId]={position:Object.assign({},f.position),angle:f.angle||0},c},{})}getPortProp(t,e){return this.getPropByPath(this.prefixPortPath(t,e))}setPortProp(t,e,n,c){if(typeof e=="string"||Array.isArray(e)){const d=this.prefixPortPath(t,e),v=n;return this.setPropByPath(d,v,c)}const u=this.prefixPortPath(t),f=e;return this.setPropByPath(u,f,n)}removePortProp(t,e,n){return typeof e=="string"||Array.isArray(e)?this.removePropByPath(this.prefixPortPath(t,e),n):this.removePropByPath(this.prefixPortPath(t),e)}portProp(t,e,n,c){return e==null?this.getPortProp(t):typeof e=="string"||Array.isArray(e)?arguments.length===2?this.getPortProp(t,e):n==null?this.removePortProp(t,e,c):this.setPortProp(t,e,n,c):this.setPortProp(t,e,n)}prefixPortPath(t,e){const n=this.getPortIndex(t);if(n===-1)throw new Error(`Unable to find port with id: "${t}"`);return e==null||e===""?["ports","items",`${n}`]:Array.isArray(e)?["ports","items",`${n}`,...e]:`ports/items/${n}/${e}`}addPort(t,e){const n=[...this.ports.items];return n.push(t),this.setPropByPath("ports/items",n,e),this}addPorts(t,e){return this.setPropByPath("ports/items",[...this.ports.items,...t],e),this}insertPort(t,e,n){const c=[...this.ports.items];return c.splice(t,0,e),this.setPropByPath("ports/items",c,n),this}removePort(t,e={}){return this.removePortAt(this.getPortIndex(t),e)}removePortAt(t,e={}){if(t>=0){const n=[...this.ports.items];n.splice(t,1),e.rewrite=!0,this.setPropByPath("ports/items",n,e)}return this}removePorts(t,e){let n;if(Array.isArray(t)){if(n=e||{},t.length){n.rewrite=!0;const u=[...this.ports.items].filter(f=>!t.some(d=>{const v=typeof d=="string"?d:d.id;return f.id===v}));this.setPropByPath("ports/items",u,n)}}else n=t||{},n.rewrite=!0,this.setPropByPath("ports/items",[],n);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(t,e){return this.port.getPortsLayoutByGroup(t,e)}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData()})}processRemovedPort(){const t=this.ports,e={};t.items.forEach(f=>{f.id&&(e[f.id]=!0)});const n={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(f=>{f.id&&!e[f.id]&&(n[f.id]=!0)});const u=this.model;u&&!M(n)&&(u.getConnectedEdges(this,{incoming:!0}).forEach(v=>{const b=v.getTargetPortId();b&&n[b]&&v.remove()}),u.getConnectedEdges(this,{outgoing:!0}).forEach(v=>{const b=v.getSourcePortId();b&&n[b]&&v.remove()}))}validatePorts(){const t={},e=[];return this.ports.items.forEach(n=>{typeof n!="object"&&e.push(`Invalid port ${n}.`),n.id==null&&(n.id=this.generatePortId()),t[n.id]&&e.push("Duplicitied port id."),t[n.id]=!0}),e}generatePortId(){return Yu()}updatePortData(){const t=this.validatePorts();if(t.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(t.join(" "));const e=this.port?this.port.getPorts():null;this.port=new B_(this.ports);const n=this.port.getPorts(),c=e?n.filter(f=>e.find(d=>d.id===f.id)?null:f):[...n],u=e?e.filter(f=>n.find(d=>d.id===f.id)?null:f):[];c.length>0&&this.notify("ports:added",{added:c,cell:this,node:this}),u.length>0&&this.notify("ports:removed",{removed:u,cell:this,node:this})}}Cr.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.isNode=="function"&&typeof c.isEdge=="function"&&typeof c.prop=="function"&&typeof c.attr=="function"&&typeof c.size=="function"&&typeof c.position=="function"}a.isNode=t}(Cr||(Cr={})),function(a){a.config({propHooks(t){var{ports:e}=t,n=Nv(t,["ports"]);return e&&(n.ports=Array.isArray(e)?{items:e}:e),n}})}(Cr||(Cr={})),function(a){a.registry=Z.create({type:"node",process(t,e){if(yd.exist(t,!0))throw new Error(`Node with name '${t}' was registered by anthor Edge`);if(typeof e=="function")return e.config({shape:t}),e;let n=a;const{inherit:c}=e,u=Nv(e,["inherit"]);if(c)if(typeof c=="string"){const d=this.get(c);d==null?this.onNotFound(c,"inherited"):n=d}else n=c;u.constructorName==null&&(u.constructorName=t);const f=n.define.call(n,u);return f.config({shape:t}),f}}),yd.setNodeRegistry(a.registry)}(Cr||(Cr={})),function(a){let t=0;function e(u){return u?Gf(u):(t+=1,`CustomNode${t}`)}function n(u){const{constructorName:f,overwrite:d}=u,v=Nv(u,["constructorName","overwrite"]),b=al(e(f||v.shape),this);return b.config(v),v.shape&&a.registry.register(v.shape,b,d),b}a.define=n;function c(u){const f=u.shape||"rect",d=a.registry.get(f);return d?new d(u):a.registry.onNotFound(f)}a.create=c}(Cr||(Cr={}));var Pv=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class mr extends Cn{get[Symbol.toStringTag](){return mr.toStringTag}constructor(t={}){super(t)}preprocess(t,e){const{source:n,sourceCell:c,sourcePort:u,sourcePoint:f,target:d,targetCell:v,targetPort:b,targetPoint:E}=t,_=Pv(t,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),C=D=>typeof D=="string"||typeof D=="number";if(n!=null)if(Cn.isCell(n))_.source={cell:n.id};else if(C(n))_.source={cell:n};else if(o.isPoint(n))_.source=n.toJSON();else if(Array.isArray(n))_.source={x:n[0],y:n[1]};else{const D=n.cell;Cn.isCell(D)?_.source=Object.assign(Object.assign({},n),{cell:D.id}):_.source=n}if(c!=null||u!=null){let D=_.source;if(c!=null){const L=C(c)?c:c.id;D?D.cell=L:D=_.source={cell:L}}u!=null&&D&&(D.port=u)}else f!=null&&(_.source=o.create(f).toJSON());if(d!=null)if(Cn.isCell(d))_.target={cell:d.id};else if(C(d))_.target={cell:d};else if(o.isPoint(d))_.target=d.toJSON();else if(Array.isArray(d))_.target={x:d[0],y:d[1]};else{const D=d.cell;Cn.isCell(D)?_.target=Object.assign(Object.assign({},d),{cell:D.id}):_.target=d}if(v!=null||b!=null){let D=_.target;if(v!=null){const L=C(v)?v:v.id;D?D.cell=L:D=_.target={cell:L}}b!=null&&D&&(D.port=b)}else E!=null&&(_.target=o.create(E).toJSON());return super.preprocess(_,e)}setup(){super.setup(),this.on("change:labels",t=>this.onLabelsChanged(t)),this.on("change:vertices",t=>this.onVertexsChanged(t))}isEdge(){return!0}disconnect(t={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},t),this}get source(){return this.getSource()}set source(t){this.setSource(t)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(t,e,n={}){return this.setTerminal("source",t,e,n)}get target(){return this.getTarget()}set target(t){this.setTarget(t)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(t,e,n={}){return this.setTerminal("target",t,e,n)}getTerminal(t){return Object.assign({},this.store.get(t))}setTerminal(t,e,n,c={}){if(Cn.isCell(e))return this.store.set(t,Yn({},n,{cell:e.id}),c),this;const u=e;return o.isPoint(e)||u.x!=null&&u.y!=null?(this.store.set(t,Yn({},n,{x:u.x,y:u.y}),c),this):(this.store.set(t,ur(e),c),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(t){const e=this[t];if(o.isPointLike(e))return o.create(e);const n=this.getTerminalCell(t);return n?n.getConnectionPoint(this,t):new o}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(t){if(this.model){const e=t==="source"?this.getSourceCellId():this.getTargetCellId();if(e)return this.model.getCell(e)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(t){let e=this;const n={};for(;e&&e.isEdge();){if(n[e.id])return null;n[e.id]=!0,e=e.getTerminalCell(t)}return e&&e.isNode()?e:null}get router(){return this.getRouter()}set router(t){t==null?this.removeRouter():this.setRouter(t)}getRouter(){return this.store.get("router")}setRouter(t,e,n){return typeof t=="object"?this.store.set("router",t,e):this.store.set("router",{name:t,args:e},n),this}removeRouter(t={}){return this.store.remove("router",t),this}get connector(){return this.getConnector()}set connector(t){t==null?this.removeConnector():this.setConnector(t)}getConnector(){return this.store.get("connector")}setConnector(t,e,n){return typeof t=="object"?this.store.set("connector",t,e):this.store.set("connector",{name:t,args:e},n),this}removeConnector(t={}){return this.store.remove("connector",t)}getDefaultLabel(){const t=this.constructor,e=this.store.get("defaultLabel")||t.defaultLabel||{};return ur(e)}get labels(){return this.getLabels()}set labels(t){this.setLabels(t)}getLabels(){return[...this.store.get("labels",[])].map(t=>this.parseLabel(t))}setLabels(t,e={}){return this.store.set("labels",Array.isArray(t)?t:[t],e),this}insertLabel(t,e,n={}){const c=this.getLabels(),u=c.length;let f=e!=null&&Number.isFinite(e)?e:u;return f<0&&(f=u+f+1),c.splice(f,0,this.parseLabel(t)),this.setLabels(c,n)}appendLabel(t,e={}){return this.insertLabel(t,-1,e)}getLabelAt(t){const e=this.getLabels();return t!=null&&Number.isFinite(t)?this.parseLabel(e[t]):null}setLabelAt(t,e,n={}){if(t!=null&&Number.isFinite(t)){const c=this.getLabels();c[t]=this.parseLabel(e),this.setLabels(c,n)}return this}removeLabelAt(t,e={}){const n=this.getLabels(),c=t!=null&&Number.isFinite(t)?t:-1,u=n.splice(c,1);return this.setLabels(n,e),u.length?u[0]:null}parseLabel(t){return typeof t=="string"?this.constructor.parseStringLabel(t):t}onLabelsChanged({previous:t,current:e}){const n=t&&e?e.filter(u=>t.find(f=>u===f||mi(u,f))?null:u):e?[...e]:[],c=t&&e?t.filter(u=>e.find(f=>u===f||mi(u,f))?null:u):t?[...t]:[];n.length>0&&this.notify("labels:added",{added:n,cell:this,edge:this}),c.length>0&&this.notify("labels:removed",{removed:c,cell:this,edge:this})}get vertices(){return this.getVertices()}set vertices(t){this.setVertices(t)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(t,e={}){const n=Array.isArray(t)?t:[t];return this.store.set("vertices",n.map(c=>o.toJSON(c)),e),this}insertVertex(t,e,n={}){const c=this.getVertices(),u=c.length;let f=e!=null&&Number.isFinite(e)?e:u;return f<0&&(f=u+f+1),c.splice(f,0,o.toJSON(t)),this.setVertices(c,n)}appendVertex(t,e={}){return this.insertVertex(t,-1,e)}getVertexAt(t){return t!=null&&Number.isFinite(t)?this.getVertices()[t]:null}setVertexAt(t,e,n={}){if(t!=null&&Number.isFinite(t)){const c=this.getVertices();c[t]=e,this.setVertices(c,n)}return this}removeVertexAt(t,e={}){const n=this.getVertices(),c=t!=null&&Number.isFinite(t)?t:-1;return n.splice(c,1),this.setVertices(n,e)}onVertexsChanged({previous:t,current:e}){const n=t&&e?e.filter(u=>t.find(f=>o.equals(u,f))?null:u):e?[...e]:[],c=t&&e?t.filter(u=>e.find(f=>o.equals(u,f))?null:u):t?[...t]:[];n.length>0&&this.notify("vertexs:added",{added:n,cell:this,edge:this}),c.length>0&&this.notify("vertexs:removed",{removed:c,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||or.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}translate(t,e,n={}){return n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints(c=>({x:(c.x||0)+t,y:(c.y||0)+e}),n)}scale(t,e,n,c={}){return this.applyToPoints(u=>o.create(u).scale(t,e,n).toJSON(),c)}applyToPoints(t,e={}){const n={},c=this.getSource(),u=this.getTarget();o.isPointLike(c)&&(n.source=t(c)),o.isPointLike(u)&&(n.target=t(u));const f=this.getVertices();return f.length>0&&(n.vertices=f.map(t)),this.store.set(n,e),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const t=[this.getSourcePoint(),...this.getVertices().map(e=>o.create(e)),this.getTargetPoint()];return new T(t)}updateParent(t){let e=null;const n=this.getSourceCell(),c=this.getTargetCell(),u=this.getParent();return n&&c&&(n===c||n.isDescendantOf(c)?e=c:c.isDescendantOf(n)?e=n:e=Cn.getCommonAncestor(n,c)),u&&e&&e.id!==u.id&&u.unembed(this,t),e&&(!u||u.id!==e.id)&&e.embed(this,t),e}hasLoop(t={}){const e=this.getSource(),n=this.getTarget(),c=e.cell,u=n.cell;if(!c||!u)return!1;let f=c===u;if(!f&&t.deep&&this._model){const d=this.getSourceCell(),v=this.getTargetCell();d&&v&&(f=d.isAncestorOf(v,t)||v.isAncestorOf(d,t))}return f}getFragmentAncestor(){const t=[this,this.getSourceNode(),this.getTargetNode()].filter(e=>e!=null);return this.getCommonAncestor(...t)}isFragmentDescendantOf(t){const e=this.getFragmentAncestor();return!!e&&(e.id===t.id||e.isDescendantOf(t))}}mr.defaults={},function(a){function t(e,n){const c=e,u=n;return c.cell===u.cell?c.port===u.port||c.port==null&&u.port==null:!1}a.equalTerminals=t}(mr||(mr={})),function(a){a.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}};function t(e){return{attrs:{label:{text:e}}}}a.parseStringLabel=t}(mr||(mr={})),function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.isNode=="function"&&typeof c.isEdge=="function"&&typeof c.prop=="function"&&typeof c.attr=="function"&&typeof c.disconnect=="function"&&typeof c.getSource=="function"&&typeof c.getTarget=="function"}a.isEdge=t}(mr||(mr={})),function(a){a.registry=Z.create({type:"edge",process(t,e){if(yd.exist(t,!1))throw new Error(`Edge with name '${t}' was registered by anthor Node`);if(typeof e=="function")return e.config({shape:t}),e;let n=a;const{inherit:c="edge"}=e,u=Pv(e,["inherit"]);if(typeof c=="string"){const d=this.get(c||"edge");d==null&&c?this.onNotFound(c,"inherited"):n=d}else n=c;u.constructorName==null&&(u.constructorName=t);const f=n.define.call(n,u);return f.config({shape:t}),f}}),yd.setEdgeRegistry(a.registry)}(mr||(mr={})),function(a){let t=0;function e(u){return u?Gf(u):(t+=1,`CustomEdge${t}`)}function n(u){const{constructorName:f,overwrite:d}=u,v=Pv(u,["constructorName","overwrite"]),b=al(e(f||v.shape),this);return b.config(v),v.shape&&a.registry.register(v.shape,b,d),b}a.define=n;function c(u){const f=u.shape||"edge",d=a.registry.get(f);return d?new d(u):a.registry.onNotFound(f)}a.create=c}(mr||(mr={})),function(a){const t="basic.edge";a.config({shape:t,propHooks(e){const{label:n,vertices:c}=e,u=Pv(e,["label","vertices"]);if(n){u.labels==null&&(u.labels=[]);const f=typeof n=="string"?a.parseStringLabel(n):n;u.labels.push(f)}return c&&Array.isArray(c)&&(u.vertices=c.map(f=>o.create(f).toJSON())),u}}),a.registry.register(t,a)}(mr||(mr={}));var j_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Lx extends vi{constructor(t,e={}){super(),this.length=0,this.comparator=e.comparator||"zIndex",this.clean(),t&&this.reset(t,{silent:!0})}toJSON(){return this.cells.map(t=>t.toJSON())}add(t,e,n){let c,u;typeof e=="number"?(c=e,u=Object.assign({merge:!1},n)):(c=this.length,u=Object.assign({merge:!1},e)),c>this.length&&(c=this.length),c<0&&(c+=this.length+1);const f=Array.isArray(t)?t:[t],d=this.comparator&&typeof e!="number"&&u.sort!==!1,v=this.comparator||null;let b=!1;const E=[],S=[];return f.forEach(_=>{const C=this.get(_);C?u.merge&&!_.isSameStore(C)&&(C.setProp(_.getProp(),n),S.push(C),d&&!b&&(v==null||typeof v=="function"?b=C.hasChanged():typeof v=="string"?b=C.hasChanged(v):b=v.some(D=>C.hasChanged(D)))):(E.push(_),this.reference(_))}),E.length&&(d&&(b=!0),this.cells.splice(c,0,...E),this.length=this.cells.length),b&&this.sort({silent:!0}),u.silent||(E.forEach((_,C)=>{const D={cell:_,index:c+C,options:u};this.trigger("added",D),u.dryrun||_.notify("added",Object.assign({},D))}),b&&this.trigger("sorted"),(E.length||S.length)&&this.trigger("updated",{added:E,merged:S,removed:[],options:u})),this}remove(t,e={}){const n=Array.isArray(t)?t:[t],c=this.removeCells(n,e);return!e.silent&&c.length>0&&this.trigger("updated",{options:e,removed:c,added:[],merged:[]}),Array.isArray(t)?c:c[0]}removeCells(t,e){const n=[];for(let c=0;c<t.length;c+=1){const u=this.get(t[c]);if(u==null)continue;const f=this.cells.indexOf(u);this.cells.splice(f,1),this.length-=1,delete this.map[u.id],n.push(u),this.unreference(u),e.dryrun||u.remove(),e.silent||(this.trigger("removed",{cell:u,index:f,options:e}),e.dryrun||u.notify("removed",{cell:u,index:f,options:e}))}return n}reset(t,e={}){const n=this.cells.slice();if(n.forEach(c=>this.unreference(c)),this.clean(),this.add(t,Object.assign({silent:!0},e)),!e.silent){const c=this.cells.slice();this.trigger("reseted",{options:e,previous:n,current:c});const u=[],f=[];c.forEach(d=>{n.some(b=>b.id===d.id)||u.push(d)}),n.forEach(d=>{c.some(b=>b.id===d.id)||f.push(d)}),this.trigger("updated",{options:e,added:u,removed:f,merged:[]})}return this}push(t,e){return this.add(t,this.length,e)}pop(t){const e=this.at(this.length-1);return this.remove(e,t)}unshift(t,e){return this.add(t,0,e)}shift(t){const e=this.at(0);return this.remove(e,t)}get(t){if(t==null)return null;const e=typeof t=="string"||typeof t=="number"?t:t.id;return this.map[e]||null}has(t){return this.get(t)!=null}at(t){return t<0&&(t+=this.length),this.cells[t]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(t){return this.cells.indexOf(t)}toArray(){return this.cells.slice()}sort(t={}){return this.comparator!=null&&(this.cells=Ry(this.cells,this.comparator),t.silent||this.trigger("sorted")),this}clone(){const t=this.constructor;return new t(this.cells.slice(),{comparator:this.comparator})}reference(t){this.map[t.id]=t,t.on("*",this.notifyCellEvent,this)}unreference(t){t.off("*",this.notifyCellEvent,this),delete this.map[t.id]}notifyCellEvent(t,e){const n=e.cell;this.trigger(`cell:${t}`,e),n&&(n.isNode()?this.trigger(`node:${t}`,Object.assign(Object.assign({},e),{node:n})):n.isEdge()&&this.trigger(`edge:${t}`,Object.assign(Object.assign({},e),{edge:n})))}clean(){this.length=0,this.cells=[],this.map={}}dispose(){this.reset([])}}j_([Lx.dispose()],Lx.prototype,"dispose",null);var F_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class As extends vi{get[Symbol.toStringTag](){return As.toStringTag}constructor(t=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new Lx(t),this.setup()}notify(t,e){this.trigger(t,e);const n=this.graph;return n&&(t==="sorted"||t==="reseted"||t==="updated"?n.trigger(`model:${t}`,e):n.trigger(t,e)),this}setup(){const t=this.collection;t.on("sorted",()=>this.notify("sorted",null)),t.on("updated",e=>this.notify("updated",e)),t.on("cell:change:zIndex",()=>this.sortOnChangeZ()),t.on("added",({cell:e})=>{this.onCellAdded(e)}),t.on("removed",e=>{const n=e.cell;this.onCellRemoved(n,e.options),this.notify("cell:removed",e),n.isNode()?this.notify("node:removed",Object.assign(Object.assign({},e),{node:n})):n.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},e),{edge:n}))}),t.on("reseted",e=>{this.onReset(e.current),this.notify("reseted",e)}),t.on("edge:change:source",({edge:e})=>this.onEdgeTerminalChanged(e,"source")),t.on("edge:change:target",({edge:e})=>{this.onEdgeTerminalChanged(e,"target")})}sortOnChangeZ(){this.collection.sort()}onCellAdded(t){const e=t.id;t.isEdge()?(t.updateParent(),this.edges[e]=!0,this.onEdgeTerminalChanged(t,"source"),this.onEdgeTerminalChanged(t,"target")):this.nodes[e]=!0}onCellRemoved(t,e){const n=t.id;if(t.isEdge()){delete this.edges[n];const c=t.getSource(),u=t.getTarget();if(c&&c.cell){const f=this.outgoings[c.cell],d=f?f.indexOf(n):-1;d>=0&&(f.splice(d,1),f.length===0&&delete this.outgoings[c.cell])}if(u&&u.cell){const f=this.incomings[u.cell],d=f?f.indexOf(n):-1;d>=0&&(f.splice(d,1),f.length===0&&delete this.incomings[u.cell])}}else delete this.nodes[n];e.clear||(e.disconnectEdges?this.disconnectConnectedEdges(t,e):this.removeConnectedEdges(t,e)),t.model===this&&(t.model=null)}onReset(t){this.nodes={},this.edges={},this.outgoings={},this.incomings={},t.forEach(e=>this.onCellAdded(e))}onEdgeTerminalChanged(t,e){const n=e==="source"?this.outgoings:this.incomings,c=t.previous(e);if(c&&c.cell){const f=Cn.isCell(c.cell)?c.cell.id:c.cell,d=n[f],v=d?d.indexOf(t.id):-1;v>=0&&(d.splice(v,1),d.length===0&&delete n[f])}const u=t.getTerminal(e);if(u&&u.cell){const f=Cn.isCell(u.cell)?u.cell.id:u.cell,d=n[f]||[];d.indexOf(t.id)===-1&&d.push(t.id),n[f]=d}}prepareCell(t,e){return!t.model&&(!e||!e.dryrun)&&(t.model=this),t.zIndex==null&&t.setZIndex(this.getMaxZIndex()+1,{silent:!0}),t}resetCells(t,e={}){return t.map(n=>this.prepareCell(n,Object.assign(Object.assign({},e),{dryrun:!0}))),this.collection.reset(t,e),t.map(n=>this.prepareCell(n,{options:e})),this}clear(t={}){const e=this.getCells();if(e.length===0)return this;const n=Object.assign(Object.assign({},t),{clear:!0});return this.batchUpdate("clear",()=>{const c=e.sort((u,f)=>{const d=u.isEdge()?1:2,v=f.isEdge()?1:2;return d-v});for(;c.length>0;){const u=c.shift();u&&u.remove(n)}},n),this}addNode(t,e={}){const n=Cr.isNode(t)?t:this.createNode(t);return this.addCell(n,e),n}updateNode(t,e={}){const n=this.createNode(t),c=n.getProp();return n.dispose(),this.updateCell(c,e)}createNode(t){return Cr.create(t)}addEdge(t,e={}){const n=mr.isEdge(t)?t:this.createEdge(t);return this.addCell(n,e),n}createEdge(t){return mr.create(t)}updateEdge(t,e={}){const n=this.createEdge(t),c=n.getProp();return n.dispose(),this.updateCell(c,e)}addCell(t,e={}){return Array.isArray(t)?this.addCells(t,e):(!this.collection.has(t)&&!this.addings.has(t)&&(this.addings.set(t,!0),this.collection.add(this.prepareCell(t,e),e),t.eachChild(n=>this.addCell(n,e)),this.addings.delete(t)),this)}addCells(t,e={}){const n=t.length;if(n===0)return this;const c=Object.assign(Object.assign({},e),{position:n-1,maxPosition:n-1});return this.startBatch("add",Object.assign(Object.assign({},c),{cells:t})),t.forEach(u=>{this.addCell(u,c),c.position-=1}),this.stopBatch("add",Object.assign(Object.assign({},c),{cells:t})),this}updateCell(t,e={}){const n=t.id&&this.getCell(t.id);return n?this.batchUpdate("update",()=>(Object.entries(t).forEach(([c,u])=>n.setProp(c,u,e)),!0),t):!1}removeCell(t,e={}){const n=typeof t=="string"?this.getCell(t):t;return n&&this.has(n)?this.collection.remove(n,e):null}updateCellId(t,e){if(t.id===e)return;this.startBatch("update",{id:e}),t.prop("id",e);const n=t.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(t).forEach(u=>{const f=u.getSourceCell(),d=u.getTargetCell();f===t&&u.setSource(Object.assign(Object.assign({},u.getSource()),{cell:e})),d===t&&u.setTarget(Object.assign(Object.assign({},u.getTarget()),{cell:e}))}),this.removeCell(t),this.stopBatch("update",{id:e}),n}removeCells(t,e={}){return t.length?this.batchUpdate("remove",()=>t.map(n=>this.removeCell(n,e))):[]}removeConnectedEdges(t,e={}){const n=this.getConnectedEdges(t);return n.forEach(c=>{c.remove(e)}),n}disconnectConnectedEdges(t,e={}){const n=typeof t=="string"?t:t.id;this.getConnectedEdges(t).forEach(c=>{const u=c.getSourceCellId(),f=c.getTargetCellId();u===n&&c.setSource({x:0,y:0},e),f===n&&c.setTarget({x:0,y:0},e)})}has(t){return this.collection.has(t)}total(){return this.collection.length}indexOf(t){return this.collection.indexOf(t)}getCell(t){return this.collection.get(t)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const t=this.collection.first();return t&&t.getZIndex()||0}getMaxZIndex(){const t=this.collection.last();return t&&t.getZIndex()||0}getCellsFromCache(t){return t?Object.keys(t).map(e=>this.getCell(e)).filter(e=>e!=null):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(t){const e=typeof t=="string"?t:t.id,n=this.outgoings[e];return n?n.map(c=>this.getCell(c)).filter(c=>c&&c.isEdge()):null}getIncomingEdges(t){const e=typeof t=="string"?t:t.id,n=this.incomings[e];return n?n.map(c=>this.getCell(c)).filter(c=>c&&c.isEdge()):null}getConnectedEdges(t,e={}){const n=[],c=typeof t=="string"?this.getCell(t):t;if(c==null)return n;const u={},f=e.indirect;let d=e.incoming,v=e.outgoing;d==null&&v==null&&(d=v=!0);const b=(E,S)=>{const _=S?this.getOutgoingEdges(E):this.getIncomingEdges(E);if(_!=null&&_.forEach(C=>{u[C.id]||(n.push(C),u[C.id]=!0,f&&(d&&b(C,!1),v&&b(C,!0)))}),f&&E.isEdge()){const C=S?E.getTargetCell():E.getSourceCell();C&&C.isEdge()&&(u[C.id]||(n.push(C),b(C,S)))}};if(v&&b(c,!0),d&&b(c,!1),e.deep){const E=c.getDescendants({deep:!0}),S={};E.forEach(C=>{C.isNode()&&(S[C.id]=!0)});const _=(C,D)=>{const L=D?this.getOutgoingEdges(C.id):this.getIncomingEdges(C.id);L!=null&&L.forEach(B=>{if(!u[B.id]){const H=B.getSourceCell(),J=B.getTargetCell();if(!e.enclosed&&H&&S[H.id]&&J&&S[J.id])return;n.push(B),u[B.id]=!0}})};E.forEach(C=>{C.isEdge()||(v&&_(C,!0),d&&_(C,!1))})}return n}isBoundary(t,e){const n=typeof t=="string"?this.getCell(t):t,c=e?this.getIncomingEdges(n):this.getOutgoingEdges(n);return c==null||c.length===0}getBoundaryNodes(t){const e=[];return Object.keys(this.nodes).forEach(n=>{if(this.isBoundary(n,t)){const c=this.getCell(n);c&&e.push(c)}}),e}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(t){return this.isBoundary(t,!0)}isLeaf(t){return this.isBoundary(t,!1)}getNeighbors(t,e={}){let n=e.incoming,c=e.outgoing;n==null&&c==null&&(n=c=!0);const f=this.getConnectedEdges(t,e).reduce((d,v)=>{const b=v.hasLoop(e),E=v.getSourceCell(),S=v.getTargetCell();return n&&E&&E.isNode()&&!d[E.id]&&(b||E!==t&&(!e.deep||!E.isDescendantOf(t)))&&(d[E.id]=E),c&&S&&S.isNode()&&!d[S.id]&&(b||S!==t&&(!e.deep||!S.isDescendantOf(t)))&&(d[S.id]=S),d},{});if(t.isEdge()){if(n){const d=t.getSourceCell();d&&d.isNode()&&!f[d.id]&&(f[d.id]=d)}if(c){const d=t.getTargetCell();d&&d.isNode()&&!f[d.id]&&(f[d.id]=d)}}return Object.keys(f).map(d=>f[d])}isNeighbor(t,e,n={}){let c=n.incoming,u=n.outgoing;return c==null&&u==null&&(c=u=!0),this.getConnectedEdges(t,n).some(f=>{const d=f.getSourceCell(),v=f.getTargetCell();return!!(c&&d&&d.id===e.id||u&&v&&v.id===e.id)})}getSuccessors(t,e={}){const n=[];return this.search(t,(c,u)=>{c!==t&&this.matchDistance(u,e.distance)&&n.push(c)},Object.assign(Object.assign({},e),{outgoing:!0})),n}isSuccessor(t,e,n={}){let c=!1;return this.search(t,(u,f)=>{if(u===e&&u!==t&&this.matchDistance(f,n.distance))return c=!0,!1},Object.assign(Object.assign({},n),{outgoing:!0})),c}getPredecessors(t,e={}){const n=[];return this.search(t,(c,u)=>{c!==t&&this.matchDistance(u,e.distance)&&n.push(c)},Object.assign(Object.assign({},e),{incoming:!0})),n}isPredecessor(t,e,n={}){let c=!1;return this.search(t,(u,f)=>{if(u===e&&u!==t&&this.matchDistance(f,n.distance))return c=!0,!1},Object.assign(Object.assign({},n),{incoming:!0})),c}matchDistance(t,e){return e==null?!0:typeof e=="function"?e(t):Array.isArray(e)&&e.includes(t)?!0:t===e}getCommonAncestor(...t){const e=[];return t.forEach(n=>{n&&(Array.isArray(n)?e.push(...n):e.push(n))}),Cn.getCommonAncestor(...e)}getSubGraph(t,e={}){const n=[],c={},u=[],f=[],d=v=>{c[v.id]||(n.push(v),c[v.id]=v,v.isEdge()&&f.push(v),v.isNode()&&u.push(v))};return t.forEach(v=>{d(v),e.deep&&v.getDescendants({deep:!0}).forEach(E=>d(E))}),f.forEach(v=>{const b=v.getSourceCell(),E=v.getTargetCell();b&&!c[b.id]&&(n.push(b),c[b.id]=b,b.isNode()&&u.push(b)),E&&!c[E.id]&&(n.push(E),c[E.id]=E,E.isNode()&&u.push(E))}),u.forEach(v=>{this.getConnectedEdges(v,e).forEach(E=>{const S=E.getSourceCell(),_=E.getTargetCell();!c[E.id]&&S&&c[S.id]&&_&&c[_.id]&&(n.push(E),c[E.id]=E)})}),n}cloneSubGraph(t,e={}){const n=this.getSubGraph(t,e);return this.cloneCells(n)}cloneCells(t){return Cn.cloneCells(t)}getNodesFromPoint(t,e){const n=typeof t=="number"?{x:t,y:e||0}:t;return this.getNodes().filter(c=>c.getBBox().containsPoint(n))}getNodesInArea(t,e,n,c,u){const f=typeof t=="number"?new s(t,e,n,c):s.create(t),d=typeof t=="number"?u:e,v=d&&d.strict;return this.getNodes().filter(b=>{const E=b.getBBox();return v?f.containsRect(E):f.isIntersectWithRect(E)})}getEdgesInArea(t,e,n,c,u){const f=typeof t=="number"?new s(t,e,n,c):s.create(t),d=typeof t=="number"?u:e,v=d&&d.strict;return this.getEdges().filter(b=>{const E=b.getBBox();return E.width===0?E.inflate(1,0):E.height===0&&E.inflate(0,1),v?f.containsRect(E):f.isIntersectWithRect(E)})}getNodesUnderNode(t,e={}){const n=t.getBBox();return(e.by==null||e.by==="bbox"?this.getNodesInArea(n):this.getNodesFromPoint(n[e.by])).filter(u=>t.id!==u.id&&!u.isDescendantOf(t))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(t,e={}){return Cn.getCellsBBox(t,e)}search(t,e,n={}){n.breadthFirst?this.breadthFirstSearch(t,e,n):this.depthFirstSearch(t,e,n)}breadthFirstSearch(t,e,n={}){const c=[],u={},f={};for(c.push(t),f[t.id]=0;c.length>0;){const d=c.shift();if(d==null||u[d.id]||(u[d.id]=!0,Ke(e,this,d,f[d.id])===!1))continue;this.getNeighbors(d,n).forEach(b=>{f[b.id]=f[d.id]+1,c.push(b)})}}depthFirstSearch(t,e,n={}){const c=[],u={},f={};for(c.push(t),f[t.id]=0;c.length>0;){const d=c.pop();if(d==null||u[d.id]||(u[d.id]=!0,Ke(e,this,d,f[d.id])===!1))continue;const v=this.getNeighbors(d,n),b=c.length;v.forEach(E=>{f[E.id]=f[d.id]+1,c.splice(b,0,E)})}}getShortestPath(t,e,n={}){const c={};this.getEdges().forEach(b=>{const E=b.getSourceCellId(),S=b.getTargetCellId();E&&S&&(c[E]||(c[E]=[]),c[S]||(c[S]=[]),c[E].push(S),n.directed||c[S].push(E))});const u=typeof t=="string"?t:t.id,f=Yp.run(c,u,n.weight),d=[];let v=typeof e=="string"?e:e.id;for(f[v]&&d.push(v);v=f[v];)d.unshift(v);return d}translate(t,e,n){return this.getCells().filter(c=>!c.hasParent()).forEach(c=>c.translate(t,e,n)),this}resize(t,e,n){return this.resizeCells(t,e,this.getCells(),n)}resizeCells(t,e,n,c={}){const u=this.getCellsBBox(n);if(u){const f=Math.max(t/u.width,0),d=Math.max(e/u.height,0),v=u.getOrigin();n.forEach(b=>b.scale(f,d,v,c))}return this}toJSON(t={}){return As.toJSON(this.getCells(),t)}parseJSON(t){return As.fromJSON(t)}fromJSON(t,e={}){const n=this.parseJSON(t);return this.resetCells(n,e),this}startBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)+1,this.notify("batch:start",{name:t,data:e}),this}stopBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)-1,this.notify("batch:stop",{name:t,data:e}),this}batchUpdate(t,e,n={}){this.startBatch(t,n);const c=e();return this.stopBatch(t,n),c}hasActiveBatch(t=Object.keys(this.batches)){return(Array.isArray(t)?t:[t]).some(n=>this.batches[n]>0)}dispose(){this.collection.dispose()}}F_([As.dispose()],As.prototype,"dispose",null),function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.addNode=="function"&&typeof c.addEdge=="function"&&c.collection!=null}a.isModel=t}(As||(As={})),function(a){function t(n,c={}){return{cells:n.map(u=>u.toJSON(c))}}a.toJSON=t;function e(n){const c=[];return Array.isArray(n)?c.push(...n):(n.cells&&c.push(...n.cells),n.nodes&&n.nodes.forEach(u=>{u.shape==null&&(u.shape="rect"),c.push(u)}),n.edges&&n.edges.forEach(u=>{u.shape==null&&(u.shape="edge"),c.push(u)})),c.map(u=>{const f=u.shape;if(f){if(Cr.registry.exist(f))return Cr.create(u);if(mr.registry.exist(f))return mr.create(u)}throw new Error("The `shape` should be specified when creating a node/edge instance")})}a.fromJSON=e}(As||(As={}));var G_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class Ll extends Cr{get label(){return this.getLabel()}set label(t){this.setLabel(t)}getLabel(){return this.getAttrByPath("text/text")}setLabel(t,e){return t==null?this.removeLabel():this.setAttrByPath("text/text",t,e),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}(function(a){a.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},a.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},a.config({attrs:{text:Object.assign({},a.labelAttr)},propHooks(t){const{label:e}=t,n=G_(t,["label"]);return e&&ia(n,"attrs/text/text",e),n},visible:!0})})(Ll||(Ll={}));var z_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};function U_(a,t="body"){return[{tagName:a,selector:t},{tagName:"text",selector:"label"}]}function V_(a="xlink:href"){return e=>{const{imageUrl:n,imageWidth:c,imageHeight:u}=e,f=z_(e,["imageUrl","imageWidth","imageHeight"]);if(n!=null||c!=null||u!=null){const d=()=>{if(f.attrs){const v=f.attrs.image;n!=null&&(v[a]=n),c!=null&&(v.width=c),u!=null&&(v.height=u),f.attrs.image=v}};f.attrs?(f.attrs.image==null&&(f.attrs.image={}),d()):(f.attrs={image:{}},d())}return f}}function bd(a,t,e={}){const n={constructorName:a,markup:U_(a,e.selector),attrs:{[a]:Object.assign({},Ll.bodyAttr)}};return(e.parent||Ll).define(Yn(n,t,{shape:a}))}const pS=bd("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}}),Vw=mr.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}}),mS=bd("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var H_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class xd extends Ll{get points(){return this.getPoints()}set points(t){this.setPoints(t)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(t,e){return t==null?this.removePoints():this.setAttrByPath("body/refPoints",xd.pointsToString(t),e),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}(function(a){function t(e){return typeof e=="string"?e:e.map(n=>Array.isArray(n)?n.join(","):o.isPointLike(n)?`${n.x}, ${n.y}`:"").join(" ")}a.pointsToString=t,a.config({propHooks(e){const{points:n}=e,c=H_(e,["points"]);if(n){const u=t(n);u&&ia(c,"attrs/body/refPoints",u)}return c}})})(xd||(xd={}));const vS=bd("polygon",{},{parent:xd}),yS=bd("polyline",{},{parent:xd});var $_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const bS=Ll.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(a){const{path:t}=a,e=$_(a,["path"]);return t&&ia(e,"attrs/body/refD",t),e}});var W_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};const xS=Ll.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},ms.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:Dr.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Ll.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(a){const{text:t}=a,e=W_(a,["text"]);return t&&ia(e,"attrs/label/text",t),e},attrHooks:{text:{set(a,{cell:t,view:e,refBBox:n,elem:c,attrs:u}){if(c instanceof HTMLElement)c.textContent=a;else{const f=u.style||{},d={text:a,width:-5,height:"100%"},v=Object.assign({textVerticalAnchor:"middle"},f),b=fa.presets.textWrap;return Ke(b.set,this,d,{cell:t,view:e,elem:c,refBBox:n,attrs:v}),{fill:f.color||null}}},position(a,{refBBox:t,elem:e}){if(e instanceof SVGElement)return t.getCenter()}}}}),wS=bd("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:V_()},{selector:"image"}),ES=bd("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});class Bo extends kr{constructor(){super(...arguments),this.portsCache={}}get[Symbol.toStringTag](){return Bo.toStringTag}getContainerClassName(){const t=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||t.push(this.prefixClassName("node-immovable")),t.join(" ")}updateClassName(t){const e=t.target;if(e.hasAttribute("magnet")){const n=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?Mi(e,n):xe(e,n)}else{const n=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(n):this.addClass(n)}}isNodeView(){return!0}confirmUpdate(t,e={}){let n=t;return this.hasAction(n,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","resize","translate","rotate","ports","tools"])):(n=this.handleAction(n,"resize",()=>this.resize(),"update"),n=this.handleAction(n,"update",()=>this.update(),ri.useCSSSelector?"ports":null),n=this.handleAction(n,"translate",()=>this.translate()),n=this.handleAction(n,"rotate",()=>this.rotate()),n=this.handleAction(n,"ports",()=>this.renderPorts()),n=this.handleAction(n,"tools",()=>{this.getFlag("tools")===t?this.renderTools():this.updateTools(e)})),n}update(t){this.cleanCache(),ri.useCSSSelector&&this.removePorts();const e=this.cell,n=e.getSize(),c=e.getAttrs();this.updateAttrs(this.container,c,{attrs:t===c?null:t,rootBBox:new s(0,0,n.width,n.height),selectors:this.selectors}),ri.useCSSSelector&&this.renderPorts()}renderMarkup(){const t=this.cell.markup;if(t){if(typeof t=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(t)}throw new TypeError("Invalid node markup.")}renderJSONMarkup(t){const e=this.parseJSONMarkup(t,this.container);this.selectors=e.selectors,this.container.appendChild(e.fragment)}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),ri.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(){this.cell.getAngle()&&this.rotate(),this.update()}translate(){this.updateTransform()}rotate(){this.updateTransform()}getTranslationString(){const t=this.cell.getPosition();return`translate(${t.x},${t.y})`}getRotationString(){const t=this.cell.getAngle();if(t){const e=this.cell.getSize();return`rotate(${t},${e.width/2},${e.height/2})`}}updateTransform(){let t=this.getTranslationString();const e=this.getRotationString();e&&(t+=` ${e}`),this.container.setAttribute("transform",t)}findPortElem(t,e){const n=t?this.portsCache[t]:null;if(!n)return null;const c=n.portContentElement,u=n.portContentSelectors||{};return this.findOne(e,c,u)}cleanPortsCache(){this.portsCache={}}removePorts(){Object.values(this.portsCache).forEach(t=>{Do(t.portElement)})}renderPorts(){const t=this.container,e=[];t.childNodes.forEach(f=>{e.push(f)});const n=this.cell.getParsedPorts(),c=Xm(n,"zIndex"),u="auto";c[u]&&c[u].forEach(f=>{const d=this.getPortElement(f);t.append(d),e.push(d)}),Object.keys(c).forEach(f=>{if(f!==u){const d=parseInt(f,10);this.appendPorts(c[f],d,e)}}),this.updatePorts()}appendPorts(t,e,n){const c=t.map(u=>this.getPortElement(u));n[e]||e<0?$f(n[Math.max(e,0)],c):pl(this.container,c)}getPortElement(t){const e=this.portsCache[t.id];return e?e.portElement:this.createPortElement(t)}createPortElement(t){let e=or.renderMarkup(this.cell.getPortContainerMarkup());const n=e.elem;if(n==null)throw new Error("Invalid port container markup.");e=or.renderMarkup(this.getPortMarkup(t));const c=e.elem,u=e.selectors;if(c==null)throw new Error("Invalid port markup.");this.setAttrs({port:t.id,"port-group":t.group},c);let f="x6-port";t.group&&(f+=` x6-port-${t.group}`),xe(n,f),xe(n,"x6-port"),xe(c,"x6-port-body"),n.appendChild(c);let d=u,v,b;if(this.existPortLabel(t)){if(e=or.renderMarkup(this.getPortLabelMarkup(t.label)),v=e.elem,b=e.selectors,v==null)throw new Error("Invalid port label markup.");if(u&&b){for(const S in b)if(u[S]&&S!==this.rootSelector)throw new Error("Selectors within port must be unique.");d=Object.assign(Object.assign({},u),b)}xe(v,"x6-port-label"),n.appendChild(v)}return this.portsCache[t.id]={portElement:n,portSelectors:d,portLabelElement:v,portLabelSelectors:b,portContentElement:c,portContentSelectors:u},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:t,node:this.cell,container:n,selectors:d,labelContainer:v,labelSelectors:b,contentContainer:c,contentSelectors:u}),n}updatePorts(){const t=this.cell.getParsedGroups(),e=Object.keys(t);e.length===0?this.updatePortGroup():e.forEach(n=>this.updatePortGroup(n))}updatePortGroup(t){const e=s.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(t,e);for(let c=0,u=n.length;c<u;c+=1){const f=n[c],d=f.portId,v=this.portsCache[d]||{},b=f.portLayout;if(this.applyPortTransform(v.portElement,b),f.portAttrs!=null){const S={selectors:v.portSelectors||{}};f.portSize&&(S.rootBBox=s.fromSize(f.portSize)),this.updateAttrs(v.portElement,f.portAttrs,S)}const E=f.labelLayout;if(E&&v.portLabelElement&&(this.applyPortTransform(v.portLabelElement,E,-(b.angle||0)),E.attrs)){const S={selectors:v.portLabelSelectors||{}};f.labelSize&&(S.rootBBox=s.fromSize(f.labelSize)),this.updateAttrs(v.portLabelElement,E.attrs,S)}}}applyPortTransform(t,e,n=0){const c=e.angle,u=e.position,f=Ur().rotate(n).translate(u.x||0,u.y||0).rotate(c||0);Es(t,f,{absolute:!0})}getPortMarkup(t){return t.markup||this.cell.portMarkup}getPortLabelMarkup(t){return t.markup||this.cell.portLabelMarkup}existPortLabel(t){return t.attrs&&t.attrs.text}getEventArgs(t,e,n){const c=this,u=c.cell,f=u;return e==null||n==null?{e:t,view:c,node:u,cell:f}:{e:t,x:e,y:n,view:c,node:u,cell:f}}getPortEventArgs(t,e,n){const c=this,u=c.cell,f=u;return n?{e:t,x:n.x,y:n.y,view:c,node:u,cell:f,port:e}:{e:t,view:c,node:u,cell:f,port:e}}notifyMouseDown(t,e,n){super.onMouseDown(t,e,n),this.notify("node:mousedown",this.getEventArgs(t,e,n))}notifyMouseMove(t,e,n){super.onMouseMove(t,e,n),this.notify("node:mousemove",this.getEventArgs(t,e,n))}notifyMouseUp(t,e,n){super.onMouseUp(t,e,n),this.notify("node:mouseup",this.getEventArgs(t,e,n))}notifyPortEvent(t,e,n){const c=this.findAttr("port",e.target);if(c){const u=e.type;t==="node:port:mouseenter"?e.type="mouseenter":t==="node:port:mouseleave"&&(e.type="mouseleave"),this.notify(t,this.getPortEventArgs(e,c,n)),e.type=u}}onClick(t,e,n){super.onClick(t,e,n),this.notify("node:click",this.getEventArgs(t,e,n)),this.notifyPortEvent("node:port:click",t,{x:e,y:n})}onDblClick(t,e,n){super.onDblClick(t,e,n),this.notify("node:dblclick",this.getEventArgs(t,e,n)),this.notifyPortEvent("node:port:dblclick",t,{x:e,y:n})}onContextMenu(t,e,n){super.onContextMenu(t,e,n),this.notify("node:contextmenu",this.getEventArgs(t,e,n)),this.notifyPortEvent("node:port:contextmenu",t,{x:e,y:n})}onMouseDown(t,e,n){this.isPropagationStopped(t)||(this.notifyMouseDown(t,e,n),this.notifyPortEvent("node:port:mousedown",t,{x:e,y:n}),this.startNodeDragging(t,e,n))}onMouseMove(t,e,n){const c=this.getEventData(t),u=c.action;if(u==="magnet")this.dragMagnet(t,e,n);else{if(u==="move"){const d=c.targetView||this;d.dragNode(t,e,n),d.notify("node:moving",{e:t,x:e,y:n,view:d,cell:d.cell,node:d.cell})}this.notifyMouseMove(t,e,n),this.notifyPortEvent("node:port:mousemove",t,{x:e,y:n})}this.setEventData(t,c)}onMouseUp(t,e,n){const c=this.getEventData(t),u=c.action;u==="magnet"?this.stopMagnetDragging(t,e,n):(this.notifyMouseUp(t,e,n),this.notifyPortEvent("node:port:mouseup",t,{x:e,y:n}),u==="move"&&(c.targetView||this).stopNodeDragging(t,e,n));const f=c.targetMagnet;f&&this.onMagnetClick(t,f,e,n),this.checkMouseleave(t)}onMouseOver(t){super.onMouseOver(t),this.notify("node:mouseover",this.getEventArgs(t)),this.notifyPortEvent("node:port:mouseenter",t),this.notifyPortEvent("node:port:mouseover",t)}onMouseOut(t){super.onMouseOut(t),this.notify("node:mouseout",this.getEventArgs(t)),this.notifyPortEvent("node:port:mouseleave",t),this.notifyPortEvent("node:port:mouseout",t)}onMouseEnter(t){this.updateClassName(t),super.onMouseEnter(t),this.notify("node:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("node:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,c){super.onMouseWheel(t,e,n,c),this.notify("node:mousewheel",Object.assign({delta:c},this.getEventArgs(t,e,n)))}onMagnetClick(t,e,n,c){const u=this.graph;u.view.getMouseMovedCount(t)>u.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:e},this.getEventArgs(t,n,c)))}onMagnetDblClick(t,e,n,c){this.notify("node:magnet:dblclick",Object.assign({magnet:e},this.getEventArgs(t,n,c)))}onMagnetContextMenu(t,e,n,c){this.notify("node:magnet:contextmenu",Object.assign({magnet:e},this.getEventArgs(t,n,c)))}onMagnetMouseDown(t,e,n,c){this.startMagnetDragging(t,n,c)}onCustomEvent(t,e,n,c){this.notify("node:customevent",Object.assign({name:e},this.getEventArgs(t,n,c))),super.onCustomEvent(t,e,n,c)}prepareEmbedding(t){const e=this.graph,c=this.getEventData(t).cell||this.cell,u=e.findViewByCell(c),f=e.snapToGrid(t.clientX,t.clientY);this.notify("node:embed",{e:t,node:c,view:u,cell:c,x:f.x,y:f.y,currentParent:c.getParent()})}processEmbedding(t,e){const n=e.cell||this.cell,c=e.graph||this.graph,u=c.options.embedding,f=u.findParent;let d=typeof f=="function"?Ke(f,c,{view:this,node:this.cell}).filter(_=>Cn.isCell(_)&&this.cell.id!==_.id&&!_.isDescendantOf(this.cell)):c.model.getNodesUnderNode(n,{by:f});if(u.frontOnly&&d.length>0){const _=Xm(d,"zIndex"),C=Ky(Object.keys(_).map(D=>parseInt(D,10)));C&&(d=_[C])}d=d.filter(_=>_.visible);let v=null;const b=e.candidateEmbedView,E=u.validate;for(let _=d.length-1;_>=0;_-=1){const C=d[_];if(b&&b.cell.id===C.id){v=b;break}else{const D=C.findView(c);if(E&&Ke(E,c,{child:this.cell,parent:D.cell,childView:this,parentView:D})){v=D;break}}}this.clearEmbedding(e),v&&v.highlight(null,{type:"embedding"}),e.candidateEmbedView=v;const S=c.snapToGrid(t.clientX,t.clientY);this.notify("node:embedding",{e:t,cell:n,node:n,view:c.findViewByCell(n),x:S.x,y:S.y,currentParent:n.getParent(),candidateParent:v?v.cell:null})}clearEmbedding(t){const e=t.candidateEmbedView;e&&(e.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null)}finalizeEmbedding(t,e){this.graph.startBatch("embedding");const n=e.cell||this.cell,c=e.graph||this.graph,u=c.findViewByCell(n),f=n.getParent(),d=e.candidateEmbedView;if(d?(d.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null,(f==null||f.id!==d.cell.id)&&d.cell.insertChild(n,void 0,{ui:!0})):f&&f.unembed(n,{ui:!0}),c.model.getConnectedEdges(n,{deep:!0}).forEach(v=>{v.updateParent({ui:!0})}),u&&d){const v=c.snapToGrid(t.clientX,t.clientY);u.notify("node:embedded",{e:t,cell:n,x:v.x,y:v.y,node:n,view:c.findViewByCell(n),previousParent:f,currentParent:n.getParent()})}this.graph.stopBatch("embedding")}getDelegatedView(){let t=this.cell,e=this;for(;e&&!t.isEdge();){if(!t.hasParent()||e.can("stopDelegateOnDragging"))return e;t=t.getParent(),e=this.graph.findViewByCell(t)}return null}validateMagnet(t,e,n){if(e.getAttribute("magnet")!=="passive"){const c=this.graph.options.connecting.validateMagnet;return c?Ke(c,this.graph,{e:n,magnet:e,view:t,cell:t.cell}):!0}return!1}startMagnetDragging(t,e,n){if(!this.can("magnetConnectable"))return;t.stopPropagation();const c=t.currentTarget,u=this.graph;this.setEventData(t,{targetMagnet:c}),this.validateMagnet(this,c,t)?(u.options.magnetThreshold<=0&&this.startConnectting(t,c,e,n),this.setEventData(t,{action:"magnet"}),this.stopPropagation(t)):this.onMouseDown(t,e,n),u.view.delegateDragEvents(t,this)}startConnectting(t,e,n,c){this.graph.model.startBatch("add-edge");const u=this.createEdgeFromMagnet(e,n,c);u.setEventData(t,u.prepareArrowheadDragging("target",{x:n,y:c,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(t,{edgeView:u}),u.notifyMouseDown(t,n,c)}getDefaultEdge(t,e){let n;const c=this.graph.options.connecting.createEdge;return c&&(n=Ke(c,this.graph,{sourceMagnet:e,sourceView:t,sourceCell:t.cell})),n}createEdgeFromMagnet(t,e,n){const c=this.graph,u=c.model,f=this.getDefaultEdge(this,t);return f.setSource(Object.assign(Object.assign({},f.getSource()),this.getEdgeTerminal(t,e,n,f,"source"))),f.setTarget(Object.assign(Object.assign({},f.getTarget()),{x:e,y:n})),f.addTo(u,{async:!1,ui:!0}),f.findView(c)}dragMagnet(t,e,n){const c=this.getEventData(t),u=c.edgeView;if(u)u.onMouseMove(t,e,n),this.autoScrollGraph(t.clientX,t.clientY);else{const f=this.graph,d=f.options.magnetThreshold,v=this.getEventTarget(t),b=c.targetMagnet;if(d==="onleave"){if(b===v||b.contains(v))return}else if(f.view.getMouseMovedCount(t)<=d)return;this.startConnectting(t,b,e,n)}}stopMagnetDragging(t,e,n){const u=this.eventData(t).edgeView;u&&(u.onMouseUp(t,e,n),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(t,e,n){this.notify("node:unhandled:mousedown",{e:t,x:e,y:n,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(t,e,n,c,u){let f=[u];const d=this.graph.getPlugin("selection");if(d&&d.isSelectionMovable()){const v=d.getSelectedCells();v.includes(u)&&(f=v.filter(b=>b.isNode()))}f.forEach(v=>{this.notify(t,{e,x:n,y:c,cell:v,node:v,view:v.findView(this.graph)})})}getRestrictArea(t){const e=this.graph.options.translating.restrict,n=typeof e=="function"?Ke(e,this.graph,t):e;return typeof n=="number"?this.graph.transform.getGraphArea().inflate(n):n===!0?this.graph.transform.getGraphArea():n||null}startNodeDragging(t,e,n){const c=this.getDelegatedView();if(c==null||!c.can("nodeMovable"))return this.notifyUnhandledMouseDown(t,e,n);this.setEventData(t,{targetView:c,action:"move"});const u=o.create(c.cell.getPosition());c.setEventData(t,{moving:!1,offset:u.diff(e,n),restrict:this.getRestrictArea(c)})}dragNode(t,e,n){const c=this.cell,u=this.graph,f=u.getGridSize(),d=this.getEventData(t),v=d.offset,b=d.restrict;d.moving||(d.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",t,e,n,this.cell)),this.autoScrollGraph(t.clientX,t.clientY);const E=i.snapToGrid(e+v.x,f),S=i.snapToGrid(n+v.y,f);c.setPosition(E,S,{restrict:b,deep:!0,ui:!0}),u.options.embedding.enabled&&(d.embedding||(this.prepareEmbedding(t),d.embedding=!0),this.processEmbedding(t,d))}stopNodeDragging(t,e,n){const c=this.getEventData(t);c.embedding&&this.finalizeEmbedding(t,c),c.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",t,e,n,this.cell)),c.moving=!1,c.embedding=!1}autoScrollGraph(t,e){const n=this.graph.getPlugin("scroller");n&&n.autoScroll(t,e)}}(function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.isNodeView=="function"&&typeof c.isEdgeView=="function"&&typeof c.confirmUpdate=="function"&&typeof c.update=="function"&&typeof c.findPortElem=="function"&&typeof c.resize=="function"&&typeof c.rotate=="function"&&typeof c.translate=="function"}a.isNodeView=t})(Bo||(Bo={})),Bo.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),Bo.registry.register("node",Bo,!0);var X_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class cc extends kr{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.labelDestroyFn={}}get[Symbol.toStringTag](){return cc.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const t=this.sourceView;if(!t){const n=this.cell.getSource();return new s(n.x,n.y)}const e=this.sourceMagnet;return t.isEdgeElement(e)?new s(this.sourceAnchor.x,this.sourceAnchor.y):t.getBBoxOfElement(e||t.container)}get targetBBox(){const t=this.targetView;if(!t){const n=this.cell.getTarget();return new s(n.x,n.y)}const e=this.targetMagnet;return t.isEdgeElement(e)?new s(this.targetAnchor.x,this.targetAnchor.y):t.getBBoxOfElement(e||t.container)}isEdgeView(){return!0}confirmUpdate(t,e={}){let n=t;if(this.hasAction(n,"source")){if(!this.updateTerminalProperties("source"))return n;n=this.removeAction(n,"source")}if(this.hasAction(n,"target")){if(!this.updateTerminalProperties("target"))return n;n=this.removeAction(n,"target")}return this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","labels","tools"]),n):(n=this.handleAction(n,"update",()=>this.update(e)),n=this.handleAction(n,"labels",()=>this.onLabelsChange(e)),n=this.handleAction(n,"tools",()=>this.renderTools()),n)}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}renderMarkup(){const t=this.cell.markup;if(t){if(typeof t=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(t)}throw new TypeError("Invalid edge markup.")}renderJSONMarkup(t){const e=this.parseJSONMarkup(t,this.container);this.selectors=e.selectors,this.container.append(e.fragment)}customizeLabels(){if(this.labelContainer){const t=this.cell,e=t.labels;for(let n=0,c=e.length;n<c;n+=1){const u=e[n],f=this.labelCache[n],d=this.labelSelectors[n],v=this.graph.options.onEdgeLabelRendered;if(v){const b=v({edge:t,label:u,container:f,selectors:d});b&&(this.labelDestroyFn[n]=b)}}}}destroyCustomizeLabels(){const t=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let e=0,n=t.length;e<n;e+=1){const c=this.labelDestroyFn[e],u=this.labelCache[e],f=this.labelSelectors[e];c&&u&&f&&c({edge:this.cell,label:t[e],container:u,selectors:f})}this.labelDestroyFn={}}renderLabels(){const t=this.cell,e=t.getLabels(),n=e.length;let c=this.labelContainer;if(this.labelCache={},this.labelSelectors={},n<=0)return c&&c.parentNode&&c.parentNode.removeChild(c),this;c?this.empty(c):(c=Ni("g"),this.addClass(this.prefixClassName("edge-labels"),c),this.labelContainer=c);for(let u=0,f=e.length;u<f;u+=1){const d=e[u],v=this.normalizeLabelMarkup(this.parseLabelMarkup(d.markup));let b,E;if(v)b=v.node,E=v.selectors;else{const _=t.getDefaultLabel(),C=this.normalizeLabelMarkup(this.parseLabelMarkup(_.markup));b=C.node,E=C.selectors}b.setAttribute("data-index",`${u}`),c.appendChild(b);const S=this.rootSelector;if(E[S])throw new Error("Ambiguous label root selector.");E[S]=b,this.labelCache[u]=b,this.labelSelectors[u]=E}return c.parentNode==null&&this.container.appendChild(c),this.updateLabels(),this.customizeLabels(),this}onLabelsChange(t={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(t)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(t={}){const e=this.cell.previous("labels");if(e==null)return!0;if("propertyPathArray"in t&&"propertyValue"in t){const n=t.propertyPathArray||[],c=n.length;if(c>1){const u=n[1];if(e[u]){if(c===2)return typeof t.propertyValue=="object"&&Aa(t.propertyValue,"markup");if(n[2]!=="markup")return!1}}}return!0}parseLabelMarkup(t){return t?typeof t=="string"?this.parseLabelStringMarkup(t):this.parseJSONMarkup(t):null}parseLabelStringMarkup(t){const e=sn.createVectors(t),n=document.createDocumentFragment();for(let c=0,u=e.length;c<u;c+=1){const f=e[c].node;n.appendChild(f)}return{fragment:n,selectors:{}}}normalizeLabelMarkup(t){if(t==null)return;const e=t.fragment;if(!(e instanceof DocumentFragment)||!e.hasChildNodes())throw new Error("Invalid label markup.");let n;const c=e.childNodes;return c.length>1||c[0].nodeName.toUpperCase()!=="G"?n=sn.create("g").append(e):n=sn.create(c[0]),n.addClass(this.prefixClassName("edge-label")),{node:n.node,selectors:t.selectors}}updateLabels(){if(this.labelContainer){const t=this.cell,e=t.labels,n=this.can("edgeLabelMovable"),c=t.getDefaultLabel();for(let u=0,f=e.length;u<f;u+=1){const d=this.labelCache[u],v=this.labelSelectors[u];d.setAttribute("cursor",n?"move":"default");const b=e[u],E=Yn({},c.attrs,b.attrs);this.updateAttrs(d,E,{selectors:v,rootBBox:b.size?s.fromSize(b.size):void 0})}}}renderTools(){const t=this.cell.getTools();return this.addTools(t),this}update(t={}){this.cleanCache(),this.updateConnection(t);const e=this.cell.getAttrs(),{text:n}=e,c=X_(e,["text"]);return c!=null&&this.updateAttrs(this.container,c,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(t),this}removeRedundantLinearVertices(t={}){const e=this.cell,n=e.getVertices(),c=[this.sourceAnchor,...n,this.targetAnchor],u=c.length,f=new T(c);f.simplify({threshold:.01});const d=f.points.map(b=>b.toJSON()),v=d.length;return u===v?0:(e.setVertices(d.slice(1,v-1),t),u-v)}getTerminalView(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalAnchor(t){switch(t){case"source":return o.create(this.sourceAnchor);case"target":return o.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalConnectionPoint(t){switch(t){case"source":return o.create(this.sourcePoint);case"target":return o.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalMagnet(t,e={}){switch(t){case"source":{if(e.raw)return this.sourceMagnet;const n=this.sourceView;return n?this.sourceMagnet||n.container:null}case"target":{if(e.raw)return this.targetMagnet;const n=this.targetView;return n?this.targetMagnet||n.container:null}default:throw new Error(`Unknown terminal type '${t}'`)}}updateConnection(t={}){const e=this.cell;if(t.translateBy&&e.isFragmentDescendantOf(t.translateBy)){const n=t.tx||0,c=t.ty||0;this.routePoints=new T(this.routePoints).translate(n,c).points,this.translateConnectionPoints(n,c),this.path.translate(n,c)}else{const n=e.getVertices(),c=this.findAnchors(n);this.sourceAnchor=c.source,this.targetAnchor=c.target,this.routePoints=this.findRoutePoints(n);const u=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=u.source,this.targetPoint=u.target;const f=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,f.source||this.sourcePoint,f.target||this.targetPoint)}this.cleanCache()}findAnchors(t){const e=this.cell,n=e.source,c=e.target,u=t[0],f=t[t.length-1];return c.priority&&!n.priority?this.findAnchorsOrdered("target",f,"source",u):this.findAnchorsOrdered("source",u,"target",f)}findAnchorsOrdered(t,e,n,c){let u,f;const d=this.cell,v=d[t],b=d[n],E=this.getTerminalView(t),S=this.getTerminalView(n),_=this.getTerminalMagnet(t),C=this.getTerminalMagnet(n);if(E){let D;e?D=o.create(e):S?D=C:D=o.create(b),u=this.getAnchor(v.anchor,E,_,D,t)}else u=o.create(v);if(S){const D=o.create(c||u);f=this.getAnchor(b.anchor,S,C,D,n)}else f=o.isPointLike(b)?o.create(b):new o;return{[t]:u,[n]:f}}getAnchor(t,e,n,c,u){const f=e.isEdgeElement(n),d=this.graph.options.connecting;let v=typeof t=="string"?{name:t}:t;if(!v){const S=f?(u==="source"?d.sourceEdgeAnchor:d.targetEdgeAnchor)||d.edgeAnchor:(u==="source"?d.sourceAnchor:d.targetAnchor)||d.anchor;v=typeof S=="string"?{name:S}:S}if(!v)throw new Error("Anchor should be specified.");let b;const E=v.name;if(f){const S=pd.registry.get(E);if(typeof S!="function")return pd.registry.onNotFound(E);b=Ke(S,this,e,n,c,v.args||{},u)}else{const S=gd.registry.get(E);if(typeof S!="function")return gd.registry.onNotFound(E);b=Ke(S,this,e,n,c,v.args||{},u)}return b?b.round(this.POINT_ROUNDING):new o}findRoutePoints(t=[]){const e=this.graph.options.connecting.router||Rl.presets.normal,n=this.cell.getRouter()||e;let c;if(typeof n=="function")c=Ke(n,this,t,{},this);else{const u=typeof n=="string"?n:n.name,f=typeof n=="string"?{}:n.args||{},d=u?Rl.registry.get(u):Rl.presets.normal;if(typeof d!="function")return Rl.registry.onNotFound(u);c=Ke(d,this,t,f,this)}return c==null?t.map(u=>o.create(u)):c.map(u=>o.create(u))}findConnectionPoints(t,e,n){const c=this.cell,u=this.graph.options.connecting,f=c.getSource(),d=c.getTarget(),v=this.sourceView,b=this.targetView,E=t[0],S=t[t.length-1];let _;if(v&&!v.isEdgeElement(this.sourceMagnet)){const D=this.sourceMagnet||v.container,L=E||n,B=new l(L,e),H=f.connectionPoint||u.sourceConnectionPoint||u.connectionPoint;_=this.getConnectionPoint(H,v,D,B,"source")}else _=e;let C;if(b&&!b.isEdgeElement(this.targetMagnet)){const D=this.targetMagnet||b.container,L=d.connectionPoint||u.targetConnectionPoint||u.connectionPoint,B=S||e,H=new l(B,n);C=this.getConnectionPoint(L,b,D,H,"target")}else C=n;return{source:_,target:C}}getConnectionPoint(t,e,n,c,u){const f=c.end;if(t==null)return f;const d=typeof t=="string"?t:t.name,v=typeof t=="string"?{}:t.args,b=md.registry.get(d);if(typeof b!="function")return md.registry.onNotFound(d);const E=Ke(b,this,c,e,n,v||{},u);return E?E.round(this.POINT_ROUNDING):f}findMarkerPoints(t,e,n){const c=S=>{const _=this.cell.getAttrs(),C=Object.keys(_);for(let D=0,L=C.length;D<L;D+=1){const B=_[C[D]];if(B[`${S}Marker`]||B[`${S}-marker`]){const H=B.strokeWidth||B["stroke-width"];if(H)return parseFloat(H);break}}return null},u=t[0],f=t[t.length-1];let d,v;const b=c("source");b&&(d=e.clone().move(u||n,-b));const E=c("target");return E&&(v=n.clone().move(f||e,-E)),this.sourceMarkerPoint=d||e.clone(),this.targetMarkerPoint=v||n.clone(),{source:d,target:v}}findPath(t,e,n){const c=this.cell.getConnector()||this.graph.options.connecting.connector;let u,f,d;if(typeof c=="string"?u=c:(u=c.name,f=c.args),u){const b=ih.registry.get(u);if(typeof b!="function")return ih.registry.onNotFound(u);d=b}else d=ih.presets.normal;const v=Ke(d,this,e,n,t,Object.assign(Object.assign({},f),{raw:!0}),this);return typeof v=="string"?F.parse(v):v}translateConnectionPoints(t,e){this.sourcePoint.translate(t,e),this.targetPoint.translate(t,e),this.sourceAnchor.translate(t,e),this.targetAnchor.translate(t,e),this.sourceMarkerPoint.translate(t,e),this.targetMarkerPoint.translate(t,e)}updateLabelPositions(){if(this.labelContainer==null)return this;if(!this.path)return this;const e=this.cell,n=e.getLabels();if(n.length===0)return this;const c=e.getDefaultLabel(),u=this.normalizeLabelPosition(c.position);for(let f=0,d=n.length;f<d;f+=1){const v=n[f],b=this.labelCache[f];if(!b)continue;const E=this.normalizeLabelPosition(v.position),S=Yn({},u,E),_=this.getLabelTransformationMatrix(S);b.setAttribute("transform",Ka(_))}return this}updateTerminalProperties(t){const e=this.cell,n=this.graph,c=e[t],u=c&&c.cell,f=`${t}View`;if(!u)return this[f]=null,this.updateTerminalMagnet(t),!0;const d=n.getCellById(u);if(!d)throw new Error(`Edge's ${t} node with id "${u}" not exists`);const v=d.findView(n);return v?(this[f]=v,this.updateTerminalMagnet(t),!0):!1}updateTerminalMagnet(t){const e=`${t}Magnet`,n=this.getTerminalView(t);if(n){let c=n.getMagnetFromEdgeTerminal(this.cell[t]);c===n.container&&(c=null),this[e]=c}else this[e]=null}getLabelPositionAngle(t){const e=this.cell.getLabelAt(t);return e&&e.position&&typeof e.position=="object"&&e.position.angle||0}getLabelPositionArgs(t){const e=this.cell.getLabelAt(t);if(e&&e.position&&typeof e.position=="object")return e.position.options}getDefaultLabelPositionArgs(){const t=this.cell.getDefaultLabel();if(t&&t.position&&typeof t.position=="object")return t.position.options}mergeLabelPositionArgs(t,e){return t===null?null:t===void 0?e===null?null:e:Yn({},e,t)}getConnection(){return this.path!=null?this.path.clone():null}getConnectionPathData(){if(this.path==null)return"";const t=this.cache.pathCache;return Aa(t,"data")||(t.data=this.path.serialize()),t.data||""}getConnectionSubdivisions(){if(this.path==null)return null;const t=this.cache.pathCache;return Aa(t,"segmentSubdivisions")||(t.segmentSubdivisions=this.path.getSegmentSubdivisions()),t.segmentSubdivisions}getConnectionLength(){if(this.path==null)return 0;const t=this.cache.pathCache;return Aa(t,"length")||(t.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),t.length}getPointAtLength(t){return this.path==null?null:this.path.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(t){return this.path==null?null:(Po(t)&&(t=parseFloat(t)/100),this.path.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(t){return this.path==null?null:this.path.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(t){return this.path==null?null:this.path.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(t){return this.path==null?null:this.path.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(t){return this.path==null?null:this.path.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(t){return this.path==null?null:this.path.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(t,e,n,c){const u={distance:0};let f=0,d;typeof n=="number"?(f=n,d=c):d=n,d!=null&&(u.options=d);const v=d&&d.absoluteOffset,b=!(d&&d.absoluteDistance),E=d&&d.absoluteDistance&&d.reverseDistance,S=this.path,_={segmentSubdivisions:this.getConnectionSubdivisions()},C=new o(t,e),D=S.closestPointT(C,_),L=this.getConnectionLength()||0;let B=S.lengthAtT(D,_);b&&(B=L>0?B/L:0),E&&(B=-1*(L-B)||1),u.distance=B;let H;v||(H=S.tangentAtT(D));let J;if(H)J=H.pointOffset(C);else{const V=S.pointAtT(D),ct=C.diff(V);J={x:ct.x,y:ct.y}}return u.offset=J,u.angle=f,u}normalizeLabelPosition(t){return typeof t=="number"?{distance:t}:t}getLabelTransformationMatrix(t){const e=this.normalizeLabelPosition(t),n=e.options||{},c=e.angle||0,u=e.distance,f=u>0&&u<=1;let d=0;const v={x:0,y:0},b=e.offset;b&&(typeof b=="number"?d=b:(b.x!=null&&(v.x=b.x),b.y!=null&&(v.y=b.y)));const E=v.x!==0||v.y!==0||d===0,S=n.keepGradient,_=n.ensureLegibility,C=this.path,D={segmentSubdivisions:this.getConnectionSubdivisions()},L=f?u*this.getConnectionLength():u,B=C.tangentAtLength(L,D);let H,J=c;if(B){if(E)H=B.start,H.translate(v);else{const V=B.clone();V.rotate(-90,B.start),V.setLength(d),H=V.end}S&&(J=B.angle()+c,_&&(J=Wn.normalize((J+90)%180-90)))}else H=C.start,E&&H.translate(v);return Ur().translate(H.x,H.y).rotate(J)}getVertexIndex(t,e){const c=this.cell.getVertices(),u=this.getClosestPointLength(new o(t,e));let f=0;if(u!=null)for(const d=c.length;f<d;f+=1){const v=c[f],b=this.getClosestPointLength(v);if(b!=null&&u<b)break}return f}getEventArgs(t,e,n){const c=this,u=c.cell,f=u;return e==null||n==null?{e:t,view:c,edge:u,cell:f}:{e:t,x:e,y:n,view:c,edge:u,cell:f}}notifyUnhandledMouseDown(t,e,n){this.notify("edge:unhandled:mousedown",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(t,e,n){super.onMouseDown(t,e,n),this.notify("edge:mousedown",this.getEventArgs(t,e,n))}notifyMouseMove(t,e,n){super.onMouseMove(t,e,n),this.notify("edge:mousemove",this.getEventArgs(t,e,n))}notifyMouseUp(t,e,n){super.onMouseUp(t,e,n),this.notify("edge:mouseup",this.getEventArgs(t,e,n))}onClick(t,e,n){super.onClick(t,e,n),this.notify("edge:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){super.onDblClick(t,e,n),this.notify("edge:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){super.onContextMenu(t,e,n),this.notify("edge:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){this.notifyMouseDown(t,e,n),this.startEdgeDragging(t,e,n)}onMouseMove(t,e,n){const c=this.getEventData(t);switch(c.action){case"drag-label":{this.dragLabel(t,e,n);break}case"drag-arrowhead":{this.dragArrowhead(t,e,n);break}case"drag-edge":{this.dragEdge(t,e,n);break}default:break}return this.notifyMouseMove(t,e,n),c}onMouseUp(t,e,n){const c=this.getEventData(t);switch(c.action){case"drag-label":{this.stopLabelDragging(t,e,n);break}case"drag-arrowhead":{this.stopArrowheadDragging(t,e,n);break}case"drag-edge":{this.stopEdgeDragging(t,e,n);break}default:break}return this.notifyMouseUp(t,e,n),this.checkMouseleave(t),c}onMouseOver(t){super.onMouseOver(t),this.notify("edge:mouseover",this.getEventArgs(t))}onMouseOut(t){super.onMouseOut(t),this.notify("edge:mouseout",this.getEventArgs(t))}onMouseEnter(t){super.onMouseEnter(t),this.notify("edge:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("edge:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,c){super.onMouseWheel(t,e,n,c),this.notify("edge:mousewheel",Object.assign({delta:c},this.getEventArgs(t,e,n)))}onCustomEvent(t,e,n,c){if(Pi(t.target,"edge-tool",this.container)){if(t.stopPropagation(),this.can("useEdgeTools")){if(e==="edge:remove"){this.cell.remove({ui:!0});return}this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,n,c)))}this.notifyMouseDown(t,n,c)}else this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,n,c))),super.onCustomEvent(t,e,n,c)}onLabelMouseDown(t,e,n){this.notifyMouseDown(t,e,n),this.startLabelDragging(t,e,n),this.getEventData(t).stopPropagation&&t.stopPropagation()}startEdgeDragging(t,e,n){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(t,e,n);return}this.setEventData(t,{x:e,y:n,moving:!1,action:"drag-edge"})}dragEdge(t,e,n){const c=this.getEventData(t);c.moving||(c.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(e-c.x,n-c.y,{ui:!0}),this.setEventData(t,{x:e,y:n}),this.notify("edge:moving",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(t,e,n){const c=this.getEventData(t);c.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})),c.moving=!1}prepareArrowheadDragging(t,e){const n=this.getTerminalMagnet(t),c={action:"drag-arrowhead",x:e.x,y:e.y,isNewEdge:e.isNewEdge===!0,terminalType:t,initialMagnet:n,initialTerminal:_f(this.cell[t]),fallbackAction:e.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(t),options:e.options};return this.beforeArrowheadDragging(c),c}createValidateConnectionArgs(t){const e=[];e[4]=t,e[5]=this;let n,c=0,u=0;t==="source"?(c=2,n="target"):(u=2,n="source");const f=this.cell[n],d=f.cell;if(d){let v;const b=e[c]=this.graph.findViewByCell(d);b&&(v=b.getMagnetFromEdgeTerminal(f),v===b.container&&(v=void 0)),e[c+1]=v}return(v,b)=>(e[u]=v,e[u+1]=v.container===b?void 0:b,e)}beforeArrowheadDragging(t){t.zIndex=this.cell.zIndex,this.cell.toFront();const e=this.container.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(t)}afterArrowheadDragging(t){t.zIndex!=null&&(this.cell.setZIndex(t.zIndex,{ui:!0}),t.zIndex=null);const e=this.container;e.style.pointerEvents=t.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(t)}validateConnection(t,e,n,c,u,f,d){const v=this.graph.options.connecting,b=v.allowLoop,E=v.allowNode,S=v.allowEdge,_=v.allowPort,C=v.allowMulti,D=v.validateConnection,L=f?f.cell:null,B=u==="target"?n:t,H=u==="target"?c:e;let J=!0;const V=ct=>{const dt=u==="source"?d?d.port:null:L?L.getSourcePortId():null,At=u==="target"?d?d.port:null:L?L.getTargetPortId():null;return Ke(ct,this.graph,{edge:L,edgeView:f,sourceView:t,targetView:n,sourcePort:dt,targetPort:At,sourceMagnet:e,targetMagnet:c,sourceCell:t?t.cell:null,targetCell:n?n.cell:null,type:u})};if(b!=null&&(typeof b=="boolean"?!b&&t===n&&(J=!1):J=V(b)),J&&_!=null&&(typeof _=="boolean"?!_&&H&&(J=!1):J=V(_)),J&&S!=null&&(typeof S=="boolean"?!S&&cc.isEdgeView(B)&&(J=!1):J=V(S)),J&&E!=null&&H==null&&(typeof E=="boolean"?!E&&Bo.isNodeView(B)&&(J=!1):J=V(E)),J&&C!=null&&f){const ct=f.cell,dt=u==="source"?d:ct.getSource(),At=u==="target"?d:ct.getTarget(),le=d?this.graph.getCellById(d.cell):null;if(dt&&At&&dt.cell&&At.cell&&le)if(typeof C=="function")J=V(C);else{const ye=this.graph.model.getConnectedEdges(le,{outgoing:u==="source",incoming:u==="target"});ye.length&&(C==="withPort"?ye.some(Re=>{const Ae=Re.getSource(),Fe=Re.getTarget();return Ae&&Fe&&Ae.cell===dt.cell&&Fe.cell===At.cell&&Ae.port!=null&&Ae.port===dt.port&&Fe.port!=null&&Fe.port===At.port})&&(J=!1):C||ye.some(Re=>{const Ae=Re.getSource(),Fe=Re.getTarget();return Ae&&Fe&&Ae.cell===dt.cell&&Fe.cell===At.cell})&&(J=!1))}}return J&&D!=null&&(J=V(D)),J}allowConnectToBlank(t){const e=this.graph,c=e.options.connecting.allowBlank;if(typeof c!="function")return!!c;const u=e.findViewByCell(t),f=t.getSourceCell(),d=t.getTargetCell(),v=e.findViewByCell(f),b=e.findViewByCell(d);return Ke(c,e,{edge:t,edgeView:u,sourceCell:f,targetCell:d,sourceView:v,targetView:b,sourcePort:t.getSourcePortId(),targetPort:t.getTargetPortId(),sourceMagnet:u.sourceMagnet,targetMagnet:u.targetMagnet})}validateEdge(t,e,n){const c=this.graph;if(!this.allowConnectToBlank(t)){const f=t.getSourceCellId(),d=t.getTargetCellId();if(!(f&&d))return!1}const u=c.options.connecting.validateEdge;return u?Ke(u,c,{edge:t,type:e,previous:n}):!0}arrowheadDragging(t,e,n,c){c.x=e,c.y=n,c.currentTarget!==t&&(c.currentMagnet&&c.currentView&&c.currentView.unhighlight(c.currentMagnet,{type:"magnetAdsorbed"}),c.currentView=this.graph.findViewByElem(t),c.currentView?(c.currentMagnet=c.currentView.findMagnet(t),c.currentMagnet&&this.validateConnection(...c.getValidateConnectionArgs(c.currentView,c.currentMagnet),c.currentView.getEdgeTerminal(c.currentMagnet,e,n,this.cell,c.terminalType))?c.currentView.highlight(c.currentMagnet,{type:"magnetAdsorbed"}):c.currentMagnet=null):c.currentMagnet=null),c.currentTarget=t,this.cell.prop(c.terminalType,{x:e,y:n},Object.assign(Object.assign({},c.options),{ui:!0}))}arrowheadDragged(t,e,n){const c=t.currentView,u=t.currentMagnet;if(!u||!c)return;c.unhighlight(u,{type:"magnetAdsorbed"});const f=t.terminalType,d=c.getEdgeTerminal(u,e,n,this.cell,f);this.cell.setTerminal(f,d,{ui:!0})}snapArrowhead(t,e,n){const c=this.graph,{snap:u,allowEdge:f}=c.options.connecting,d=typeof u=="object"&&u.radius||50,v=typeof u=="object"&&u.anchor||"center",b=c.renderer.findViewsInArea({x:t-d,y:e-d,width:2*d,height:2*d},{nodeOnly:!0});if(f){const ct=c.renderer.findEdgeViewsFromPoint({x:t,y:e},d).filter(dt=>dt!==this);b.push(...ct)}const E=n.closestView||null,S=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;let _,C=Number.MAX_SAFE_INTEGER;const D=new o(t,e);b.forEach(ct=>{if(ct.container.getAttribute("magnet")!=="false"){if(ct.isNodeView())_=v==="center"?ct.cell.getBBox().getCenter().distance(D):ct.cell.getBBox().getNearestPointToPoint(D).distance(D);else if(ct.isEdgeView()){const dt=ct.getClosestPoint(D);dt?_=dt.distance(D):_=Number.MAX_SAFE_INTEGER}_<d&&_<C&&(S===ct.container||this.validateConnection(...n.getValidateConnectionArgs(ct,null),ct.getEdgeTerminal(ct.container,t,e,this.cell,n.terminalType)))&&(C=_,n.closestView=ct,n.closestMagnet=ct.container)}ct.container.querySelectorAll("[magnet]").forEach(dt=>{if(dt.getAttribute("magnet")!=="false"){const At=ct.getBBoxOfElement(dt);_=D.distance(At.getCenter()),_<d&&_<C&&(S===dt||this.validateConnection(...n.getValidateConnectionArgs(ct,dt),ct.getEdgeTerminal(dt,t,e,this.cell,n.terminalType)))&&(C=_,n.closestView=ct,n.closestMagnet=dt)}})});let L;const B=n.terminalType,H=n.closestView,J=n.closestMagnet,V=S!==J;if(E&&V&&E.unhighlight(S,{type:"magnetAdsorbed"}),H){if(!V)return;H.highlight(J,{type:"magnetAdsorbed"}),L=H.getEdgeTerminal(J,t,e,this.cell,B)}else L={x:t,y:e};this.cell.setTerminal(B,L,{},Object.assign(Object.assign({},n.options),{ui:!0}))}snapArrowheadEnd(t){const e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(n,{type:"magnetAdsorbed"}),t.currentMagnet=e.findMagnet(n)),t.closestView=null,t.closestMagnet=null}finishEmbedding(t){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(t.zIndex=null)}fallbackConnection(t){switch(t.fallbackAction){case"remove":this.cell.remove({ui:!0});break;case"revert":default:this.cell.prop(t.terminalType,t.initialTerminal,{ui:!0});break}}notifyConnectionEvent(t,e){const n=t.terminalType,c=t.initialTerminal,u=this.cell[n];if(u&&!mr.equalTerminals(c,u)){const d=this.graph,v=c,b=v.cell?d.getCellById(v.cell):null,E=v.port,S=b?d.findViewByCell(b):null,_=b||t.isNewEdge?null:o.create(c).toJSON(),C=u,D=C.cell?d.getCellById(C.cell):null,L=C.port,B=D?d.findViewByCell(D):null,H=D?null:o.create(u).toJSON();this.notify("edge:connected",{e,previousCell:b,previousPort:E,previousView:S,previousPoint:_,currentCell:D,currentView:B,currentPort:L,currentPoint:H,previousMagnet:t.initialMagnet,currentMagnet:t.currentMagnet,edge:this.cell,view:this,type:n,isNew:t.isNewEdge})}}highlightAvailableMagnets(t){const e=this.graph,n=e.model.getCells();t.marked={};for(let c=0,u=n.length;c<u;c+=1){const f=e.findViewByCell(n[c]);if(!f||f.cell.id===this.cell.id)continue;const d=Array.prototype.slice.call(f.container.querySelectorAll("[magnet]"));f.container.getAttribute("magnet")!=="false"&&d.push(f.container);const v=d.filter(b=>this.validateConnection(...t.getValidateConnectionArgs(f,b),f.getEdgeTerminal(b,t.x,t.y,this.cell,t.terminalType)));if(v.length>0){for(let b=0,E=v.length;b<E;b+=1)f.highlight(v[b],{type:"magnetAvailable"});f.highlight(null,{type:"nodeAvailable"}),t.marked[f.cell.id]=v}}}unhighlightAvailableMagnets(t){const e=t.marked||{};Object.keys(e).forEach(n=>{const c=this.graph.findViewByCell(n);c&&(e[n].forEach(f=>{c.unhighlight(f,{type:"magnetAvailable"})}),c.unhighlight(null,{type:"nodeAvailable"}))}),t.marked=null}startArrowheadDragging(t,e,n){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(t,e,n);return}const u=t.target.getAttribute("data-terminal"),f=this.prepareArrowheadDragging(u,{x:e,y:n});this.setEventData(t,f)}dragArrowhead(t,e,n){const c=this.getEventData(t);this.graph.options.connecting.snap?this.snapArrowhead(e,n,c):this.arrowheadDragging(this.getEventTarget(t),e,n,c)}stopArrowheadDragging(t,e,n){const c=this.graph,u=this.getEventData(t);c.options.connecting.snap?this.snapArrowheadEnd(u):this.arrowheadDragged(u,e,n),this.validateEdge(this.cell,u.terminalType,u.initialTerminal)?(this.finishEmbedding(u),this.notifyConnectionEvent(u,t)):this.fallbackConnection(u),this.afterArrowheadDragging(u)}startLabelDragging(t,e,n){if(this.can("edgeLabelMovable")){const c=t.currentTarget,u=parseInt(c.getAttribute("data-index"),10),f=this.getLabelPositionAngle(u),d=this.getLabelPositionArgs(u),v=this.getDefaultLabelPositionArgs(),b=this.mergeLabelPositionArgs(d,v);this.setEventData(t,{index:u,positionAngle:f,positionArgs:b,stopPropagation:!0,action:"drag-label"})}else this.setEventData(t,{stopPropagation:!0});this.graph.view.delegateDragEvents(t,this)}dragLabel(t,e,n){const c=this.getEventData(t),u=this.cell.getLabelAt(c.index),f=Yn({},u,{position:this.getLabelPosition(e,n,c.positionAngle,c.positionArgs)});this.cell.setLabelAt(c.index,f)}stopLabelDragging(t,e,n){}}(function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag],c=e;return(n==null||n===a.toStringTag)&&typeof c.isNodeView=="function"&&typeof c.isEdgeView=="function"&&typeof c.confirmUpdate=="function"&&typeof c.update=="function"&&typeof c.getConnection=="function"}a.isEdgeView=t})(cc||(cc={})),cc.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),cc.registry.register("edge",cc,!0);var Z_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Ts extends ir{get disposeContainer(){return!1}get options(){return this.graph.options}constructor(t){super(),this.graph=t;const{selectors:e,fragment:n}=or.parseJSONMarkup(Ts.markup);this.background=e.background,this.grid=e.grid,this.svg=e.svg,this.defs=e.defs,this.viewport=e.viewport,this.primer=e.primer,this.stage=e.stage,this.decorator=e.decorator,this.overlay=e.overlay,this.container=this.options.container,this.restore=Ts.snapshoot(this.container),xe(this.container,this.prefixClassName("graph")),pl(this.container,n),this.delegateEvents()}delegateEvents(){const t=this.constructor;return super.delegateEvents(t.events),this}guard(t,e){return t.type==="mousedown"&&t.button===2||this.options.guard&&this.options.guard(t,e)?!0:t.data&&t.data.guarded!==void 0?t.data.guarded:!(e&&e.cell&&Cn.isCell(e.cell)||this.svg===t.target||this.container===t.target||this.svg.contains(t.target))}findView(t){return this.graph.findViewByElem(t)}onDblClick(t){this.options.preventDefaultDblClick&&t.preventDefault();const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const c=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onDblClick(e,c.x,c.y):this.graph.trigger("blank:dblclick",{e,x:c.x,y:c.y})}onClick(t){if(this.getMouseMovedCount(t)<=this.options.clickThreshold){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const c=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onClick(e,c.x,c.y):this.graph.trigger("blank:click",{e,x:c.x,y:c.y})}}isPreventDefaultContextMenu(t){let e=this.options.preventDefaultContextMenu;return typeof e=="function"&&(e=Ke(e,this.graph,{view:t})),e}onContextMenu(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.isPreventDefaultContextMenu(n)&&t.preventDefault(),this.guard(e,n))return;const c=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onContextMenu(e,c.x,c.y):this.graph.trigger("blank:contextmenu",{e,x:c.x,y:c.y})}delegateDragEvents(t,e){t.data==null&&(t.data={}),this.setEventData(t,{currentView:e||null,mouseMovedCount:0,startPosition:{x:t.clientX,y:t.clientY}});const n=this.constructor;this.delegateDocumentEvents(n.documentEvents,t.data),this.undelegateEvents()}getMouseMovedCount(t){return this.getEventData(t).mouseMovedCount||0}onMouseDown(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;this.options.preventDefaultMouseDown&&t.preventDefault();const c=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onMouseDown(e,c.x,c.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(e.type)&&t.preventDefault(),this.graph.trigger("blank:mousedown",{e,x:c.x,y:c.y})),this.delegateDragEvents(e,n)}onMouseMove(t){const e=this.getEventData(t),n=e.startPosition;if(n&&n.x===t.clientX&&n.y===t.clientY||(e.mouseMovedCount==null&&(e.mouseMovedCount=0),e.mouseMovedCount+=1,e.mouseMovedCount<=this.options.moveThreshold))return;const u=this.normalizeEvent(t),f=this.graph.snapToGrid(u.clientX,u.clientY),d=e.currentView;d?d.onMouseMove(u,f.x,f.y):this.graph.trigger("blank:mousemove",{e:u,x:f.x,y:f.y}),this.setEventData(u,e)}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY),u=this.getEventData(t).currentView;if(u?u.onMouseUp(e,n.x,n.y):this.graph.trigger("blank:mouseup",{e,x:n.x,y:n.y}),!t.isPropagationStopped()){const f=new qi(t,{type:"click",data:t.data});this.onClick(f)}t.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(!this.guard(e,n))if(n)n.onMouseOver(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseover",{e})}}onMouseOut(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(!this.guard(e,n))if(n)n.onMouseOut(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseout",{e})}}onMouseEnter(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const c=this.graph.findViewByElem(e.relatedTarget);if(n){if(c===n)return;n.onMouseEnter(e)}else{if(c)return;this.graph.trigger("graph:mouseenter",{e})}}onMouseLeave(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const c=this.graph.findViewByElem(e.relatedTarget);if(n){if(c===n)return;n.onMouseLeave(e)}else{if(c)return;this.graph.trigger("graph:mouseleave",{e})}}onMouseWheel(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const c=e.originalEvent,u=this.graph.snapToGrid(c.clientX,c.clientY),f=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail));n?n.onMouseWheel(e,u.x,u.y,f):this.graph.trigger("blank:mousewheel",{e,delta:f,x:u.x,y:u.y})}onCustomEvent(t){const e=t.currentTarget,n=e.getAttribute("event")||e.getAttribute("data-event");if(n){const c=this.findView(e);if(c){const u=this.normalizeEvent(t);if(this.guard(u,c))return;const f=this.graph.snapToGrid(u.clientX,u.clientY);c.onCustomEvent(u,n,f.x,f.y)}}}handleMagnetEvent(t,e){const n=t.currentTarget,c=n.getAttribute("magnet");if(c&&c.toLowerCase()!=="false"){const u=this.findView(n);if(u){const f=this.normalizeEvent(t);if(this.guard(f,u))return;const d=this.graph.snapToGrid(f.clientX,f.clientY);Ke(e,this.graph,u,f,n,d.x,d.y)}}}onMagnetMouseDown(t){this.handleMagnetEvent(t,(e,n,c,u,f)=>{e.onMagnetMouseDown(n,c,u,f)})}onMagnetDblClick(t){this.handleMagnetEvent(t,(e,n,c,u,f)=>{e.onMagnetDblClick(n,c,u,f)})}onMagnetContextMenu(t){const e=this.findView(t.target);this.isPreventDefaultContextMenu(e)&&t.preventDefault(),this.handleMagnetEvent(t,(n,c,u,f,d)=>{n.onMagnetContextMenu(c,u,f,d)})}onLabelMouseDown(t){const e=t.currentTarget,n=this.findView(e);if(n){const c=this.normalizeEvent(t);if(this.guard(c,n))return;const u=this.graph.snapToGrid(c.clientX,c.clientY);n.onLabelMouseDown(c,u.x,u.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}Z_([ir.dispose()],Ts.prototype,"dispose",null),function(a){const t=`${ri.prefixCls}-graph`;a.markup=[{ns:Dr.xhtml,tagName:"div",selector:"background",className:`${t}-background`},{ns:Dr.xhtml,tagName:"div",selector:"grid",className:`${t}-grid`},{ns:Dr.svg,tagName:"svg",selector:"svg",className:`${t}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":Dr.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${t}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${t}-svg-primer`},{tagName:"g",selector:"stage",className:`${t}-svg-stage`},{tagName:"g",selector:"decorator",className:`${t}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${t}-svg-overlay`}]}]}];function e(n){const c=n.cloneNode();return n.childNodes.forEach(u=>c.appendChild(u)),()=>{for(gl(n);n.attributes.length>0;)n.removeAttribute(n.attributes[0].name);for(let u=0,f=c.attributes.length;u<f;u+=1){const d=c.attributes[u];n.setAttribute(d.name,d.value)}c.childNodes.forEach(u=>n.appendChild(u))}}a.snapshoot=e}(Ts||(Ts={})),function(a){const t=ri.prefixCls;a.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${t}-cell`]:"onMouseEnter",[`mouseleave  .${t}-cell`]:"onMouseLeave",[`mouseenter  .${t}-cell-tools`]:"onMouseEnter",[`mouseleave  .${t}-cell-tools`]:"onMouseLeave",[`mousedown   .${t}-cell [event]`]:"onCustomEvent",[`touchstart  .${t}-cell [event]`]:"onCustomEvent",[`mousedown   .${t}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${t}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${t}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${t}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${t}-cell image`]:"onImageDragStart",[`mousedown   .${t}-edge .${t}-edge-label`]:"onLabelMouseDown",[`touchstart  .${t}-edge .${t}-edge-label`]:"onLabelMouseDown"},a.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(Ts||(Ts={}));const q_=`.x6-graph {
  position: relative;
  overflow: hidden;
  outline: none;
  touch-action: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;class ii extends fe{get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}constructor(t){super(),this.graph=t,this.init()}init(){}}var Y_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class kx extends ii{init(){ri.autoInsertCSS&&dv("core",q_)}dispose(){Sx("core")}}Y_([kx.dispose()],kx.prototype,"dispose",null);var J_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e},am;(function(a){function t(e){const{grid:n,panning:c,mousewheel:u,embedding:f}=e,d=J_(e,["grid","panning","mousewheel","embedding"]),v=e.container;if(v!=null)d.width==null&&(d.width=v.clientWidth),d.height==null&&(d.height=v.clientHeight);else throw new Error("Ensure the container of the graph is specified and valid");const b=Yn({},a.defaults,d),E={size:10,visible:!1};return typeof n=="number"?b.grid={size:n,visible:!1}:typeof n=="boolean"?b.grid=Object.assign(Object.assign({},E),{visible:n}):b.grid=Object.assign(Object.assign({},E),n),["panning","mousewheel","embedding"].forEach(_=>{const C=e[_];typeof C=="boolean"?b[_].enabled=C:b[_]=Object.assign(Object.assign({},b[_]),C)}),b}a.get=t})(am||(am={})),function(a){a.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:ri.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:ri.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection({type:t,sourceView:e,targetView:n}){return(t==="target"?n:e)!=null},createEdge(){return new Vw}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1}}(am||(am={}));var K_=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u},Q_=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class Bx extends ii{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(t){this.grid.visible!==t&&(this.grid.visible=t,this.update())}getGridSize(){return this.grid.size}setGridSize(t){this.grid.size=Math.max(t,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(t){this.clear(),this.instance=null,Object.assign(this.grid,t),this.patterns=this.resolveGrid(t),this.update()}update(t={}){const e=this.grid.size;if(e<=1||!this.grid.visible)return this.clear();const n=this.graph.matrix(),c=this.getInstance(),u=Array.isArray(t)?t:[t];this.patterns.forEach((v,b)=>{const E=`pattern_${b}`,S=n.a||1,_=n.d||1,{update:C,markup:D}=v,L=Q_(v,["update","markup"]),B=Object.assign(Object.assign(Object.assign({},L),u[b]),{sx:S,sy:_,ox:n.e||0,oy:n.f||0,width:e*S,height:e*_});c.has(E)||c.add(E,sn.create("pattern",{id:E,patternUnits:"userSpaceOnUse"},sn.createVectors(D)).node);const H=c.get(E);typeof C=="function"&&C(H.childNodes[0],B);let J=B.ox%B.width;J<0&&(J+=B.width);let V=B.oy%B.height;V<0&&(V+=B.height),Dn(H,{x:J,y:V,width:B.width,height:B.height})});const f=new XMLSerializer().serializeToString(c.root),d=`url(data:image/svg+xml;base64,${btoa(f)})`;this.elem.style.backgroundImage=d}getInstance(){return this.instance||(this.instance=new Ee),this.instance}resolveGrid(t){if(!t)return[];const e=t.type;if(e==null)return[Object.assign(Object.assign({},Ee.presets.dot),t.args)];const n=Ee.registry.get(e);if(n){let c=t.args||[];return Array.isArray(c)||(c=[c]),Array.isArray(n)?n.map((u,f)=>Object.assign(Object.assign({},u),c[f])):[Object.assign(Object.assign({},n),c[0])]}return Ee.registry.onNotFound(e)}dispose(){this.stopListening(),this.clear()}}K_([ii.dispose()],Bx.prototype,"dispose",null);class Hw extends ii{get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get stage(){return this.graph.view.stage}init(){this.resize()}getMatrix(){const t=this.viewport.getAttribute("transform");return t!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=t),Ur(this.viewportMatrix)}setMatrix(t){const e=Ur(t),n=Ka(e);this.viewport.setAttribute("transform",n),this.viewportMatrix=e,this.viewportTransformString=n}resize(t,e){let n=t===void 0?this.options.width:t,c=e===void 0?this.options.height:e;this.options.width=n,this.options.height=c,typeof n=="number"&&(n=Math.round(n)),typeof c=="number"&&(c=Math.round(c)),this.container.style.width=n==null?"":`${n}px`,this.container.style.height=c==null?"":`${c}px`;const u=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},u)),this}getComputedSize(){let t=this.options.width,e=this.options.height;return Lp(t)||(t=this.container.clientWidth),Lp(e)||(e=this.container.clientHeight),{width:t,height:e}}getScale(){return uv(this.getMatrix())}scale(t,e=t,n=0,c=0){if(t=this.clampScale(t),e=this.clampScale(e),n||c){const f=this.getTranslation(),d=f.tx-n*(t-1),v=f.ty-c*(e-1);(d!==f.tx||v!==f.ty)&&this.translate(d,v)}const u=this.getMatrix();return u.a=t,u.d=e,this.setMatrix(u),this.graph.trigger("scale",{sx:t,sy:e,ox:n,oy:c}),this}clampScale(t){const e=this.graph.options.scaling;return hr(t,e.min||.01,e.max||16)}getZoom(){return this.getScale().sx}zoom(t,e){e=e||{};let n=t,c=t;const u=this.getScale(),f=this.getComputedSize();let d=f.width/2,v=f.height/2;if(e.absolute||(n+=u.sx,c+=u.sy),e.scaleGrid&&(n=Math.round(n/e.scaleGrid)*e.scaleGrid,c=Math.round(c/e.scaleGrid)*e.scaleGrid),e.maxScale&&(n=Math.min(e.maxScale,n),c=Math.min(e.maxScale,c)),e.minScale&&(n=Math.max(e.minScale,n),c=Math.max(e.minScale,c)),e.center&&(d=e.center.x,v=e.center.y),n=this.clampScale(n),c=this.clampScale(c),d||v){const b=this.getTranslation(),E=d-(d-b.tx)*(n/u.sx),S=v-(v-b.ty)*(c/u.sy);(E!==b.tx||S!==b.ty)&&this.translate(E,S)}return this.scale(n,c),this}getRotation(){return bx(this.getMatrix())}rotate(t,e,n){if(e==null||n==null){const u=Fn.getBBox(this.stage);e=u.width/2,n=u.height/2}const c=this.getMatrix().translate(e,n).rotate(t).translate(-e,-n);return this.setMatrix(c),this}getTranslation(){return hv(this.getMatrix())}translate(t,e){const n=this.getMatrix();n.e=t||0,n.f=e||0,this.setMatrix(n);const c=this.getTranslation();return this.options.x=c.tx,this.options.y=c.ty,this.graph.trigger("translate",Object.assign({},c)),this}setOrigin(t,e){return this.translate(t||0,e||0)}fitToContent(t,e,n,c){if(typeof t=="object"){const V=t;t=V.gridWidth||1,e=V.gridHeight||1,n=V.padding||0,c=V}else t=t||1,e=e||1,n=n||0,c==null&&(c={});const u=ps(n),f=c.border||0,d=c.contentArea?s.create(c.contentArea):this.getContentArea(c);f>0&&d.inflate(f);const v=this.getScale(),b=this.getTranslation(),E=v.sx,S=v.sy;d.x*=E,d.y*=S,d.width*=E,d.height*=S;let _=Math.max(Math.ceil((d.width+d.x)/t),1)*t,C=Math.max(Math.ceil((d.height+d.y)/e),1)*e,D=0,L=0;(c.allowNewOrigin==="negative"&&d.x<0||c.allowNewOrigin==="positive"&&d.x>=0||c.allowNewOrigin==="any")&&(D=Math.ceil(-d.x/t)*t,D+=u.left,_+=D),(c.allowNewOrigin==="negative"&&d.y<0||c.allowNewOrigin==="positive"&&d.y>=0||c.allowNewOrigin==="any")&&(L=Math.ceil(-d.y/e)*e,L+=u.top,C+=L),_+=u.right,C+=u.bottom,_=Math.max(_,c.minWidth||0),C=Math.max(C,c.minHeight||0),_=Math.min(_,c.maxWidth||Number.MAX_SAFE_INTEGER),C=Math.min(C,c.maxHeight||Number.MAX_SAFE_INTEGER);const B=this.getComputedSize(),H=_!==B.width||C!==B.height;return(D!==b.tx||L!==b.ty)&&this.translate(D,L),H&&this.resize(_,C),new s(-D/E,-L/S,_/E,C/S)}scaleContentToFit(t={}){this.scaleContentToFitImpl(t)}scaleContentToFitImpl(t={},e=!0){let n,c;if(t.contentArea){const H=t.contentArea;n=this.graph.localToGraph(H),c=o.create(H)}else n=this.getContentBBox(t),c=this.graph.graphToLocal(n);if(!n.width||!n.height)return;const u=ps(t.padding),f=t.minScale||0,d=t.maxScale||Number.MAX_SAFE_INTEGER,v=t.minScaleX||f,b=t.maxScaleX||d,E=t.minScaleY||f,S=t.maxScaleY||d;let _;if(t.viewportArea)_=t.viewportArea;else{const H=this.getComputedSize(),J=this.getTranslation();_={x:J.tx,y:J.ty,width:H.width,height:H.height}}_=s.create(_).moveAndExpand({x:u.left,y:u.top,width:-u.left-u.right,height:-u.top-u.bottom});const C=this.getScale();let D=_.width/n.width*C.sx,L=_.height/n.height*C.sy;t.preserveAspectRatio!==!1&&(D=L=Math.min(D,L));const B=t.scaleGrid;if(B&&(D=B*Math.floor(D/B),L=B*Math.floor(L/B)),D=hr(D,v,b),L=hr(L,E,S),this.scale(D,L),e){const H=this.options,J=_.x-c.x*D-H.x,V=_.y-c.y*L-H.y;this.translate(J,V)}}getContentArea(t={}){return t.useCellGeometry!==!1?this.model.getAllCellsBBox()||new s:Fn.getBBox(this.stage)}getContentBBox(t={}){return this.graph.localToGraph(this.getContentArea(t))}getGraphArea(){const t=s.fromSize(this.getComputedSize());return this.graph.graphToLocal(t)}zoomToRect(t,e={}){const n=s.create(t),c=this.graph;e.contentArea=n,e.viewportArea==null&&(e.viewportArea={x:c.options.x,y:c.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(e,!1);const u=n.getCenter();return this.centerPoint(u.x,u.y),this}zoomToFit(t={}){return this.zoomToRect(this.getContentArea(t),t)}centerPoint(t,e){const n=this.getComputedSize(),c=this.getScale(),u=this.getTranslation(),f=n.width/2,d=n.height/2;t=typeof t=="number"?t:f,e=typeof e=="number"?e:d,t=f-t*c.sx,e=d-e*c.sy,(u.tx!==t||u.ty!==e)&&this.translate(t,e)}centerContent(t){const n=this.graph.getContentArea(t).getCenter();this.centerPoint(n.x,n.y)}centerCell(t){return this.positionCell(t,"center")}positionPoint(t,e,n){const c=this.getComputedSize();e=$i(e,Math.max(0,c.width)),e<0&&(e=c.width+e),n=$i(n,Math.max(0,c.height)),n<0&&(n=c.height+n);const u=this.getTranslation(),f=this.getScale(),d=e-t.x*f.sx,v=n-t.y*f.sy;(u.tx!==d||u.ty!==v)&&this.translate(d,v)}positionRect(t,e){const n=s.create(t);switch(e){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}positionCell(t,e){const n=t.getBBox();return this.positionRect(n,e)}positionContent(t,e){const n=this.graph.getContentArea(e);return this.positionRect(n,t)}}var tS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Dv extends ii{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(t={}){let e=t.size||"auto auto",n=t.position||"center";const c=this.graph.transform.getScale(),u=this.graph.translate();if(typeof n=="object"){const f=u.tx+c.sx*(n.x||0),d=u.ty+c.sy*(n.y||0);n=`${f}px ${d}px`}typeof e=="object"&&(e=s.fromSize(e).scale(c.sx,c.sy),e=`${e.width}px ${e.height}px`),this.elem.style.backgroundSize=e,this.elem.style.backgroundPosition=n}drawBackgroundImage(t,e={}){if(!(t instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return}const n=this.optionsCache;if(n&&n.image!==e.image)return;let c;const u=e.opacity,f=e.size;let d=e.repeat||"no-repeat";const v=Mn.registry.get(d);if(typeof v=="function"){const E=e.quality||1;t.width*=E,t.height*=E;const S=v(t,e);if(!(S instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");c=S.toDataURL("image/png"),e.repeat&&d!==e.repeat?d=e.repeat:d="repeat",typeof f=="object"?(f.width*=S.width/t.width,f.height*=S.height/t.height):f===void 0&&(e.size={width:S.width/E,height:S.height/E})}else c=t.src,f===void 0&&(e.size={width:t.width,height:t.height});n!=null&&typeof e.size=="object"&&e.image===n.image&&e.repeat===n.repeat&&e.quality===n.quality&&(n.size=_f(e.size));const b=this.elem.style;b.backgroundImage=`url(${c})`,b.backgroundRepeat=d,b.opacity=u==null||u>=1?"":`${u}`,this.updateBackgroundImage(e)}updateBackgroundColor(t){this.elem.style.backgroundColor=t||""}updateBackgroundOptions(t){this.graph.options.background=t}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(t){const e=t||{};if(this.updateBackgroundOptions(t),this.updateBackgroundColor(e.color),e.image){this.optionsCache=_f(e);const n=document.createElement("img");n.onload=()=>this.drawBackgroundImage(n,t),n.setAttribute("crossorigin","anonymous"),n.src=e.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}tS([ii.dispose()],Dv.prototype,"dispose",null);var eS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class jx extends ii{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&this.widgetOptions.enabled===!0}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),Rr.on(this.graph.container,"mousedown",this.onRightMouseDown),Rr.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new Zp(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),Rr.off(this.graph.container,"mousedown",this.onRightMouseDown),Rr.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}allowPanning(t,e){return t.spaceKey=this.isSpaceKeyPressed,this.pannable&&rc.isMatch(t,this.widgetOptions.modifiers,e)}startPanning(t){const e=this.view.normalizeEvent(t);this.clientX=e.clientX,this.clientY=e.clientY,this.panning=!0,this.updateClassName(),Rr.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Rr.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(t){const e=this.view.normalizeEvent(t),n=e.clientX-this.clientX,c=e.clientY-this.clientY;this.clientX=e.clientX,this.clientY=e.clientY,this.graph.translateBy(n,c)}stopPanning(t){this.panning=!1,this.updateClassName(),Rr.off(document.body,".panning"),Rr.off(window,".panning")}updateClassName(){const t=this.view.container,e=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(xe(t,e),Mi(t,n)):(Mi(t,e),xe(t,n)):(Mi(t,e),Mi(t,n))}onMouseDown({e:t}){if(!this.allowBlankMouseDown(t))return;const e=this.graph.getPlugin("selection"),n=e&&e.allowRubberband(t,!0);(this.allowPanning(t,!0)||this.allowPanning(t)&&!n)&&this.startPanning(t)}onRightMouseDown(t){const e=this.widgetOptions.eventTypes;e!=null&&e.includes("rightMouseDown")&&t.button===2&&this.allowPanning(t,!0)&&this.startPanning(t)}onMouseWheel(t,e,n){this.graph.translateBy(-e,-n)}onSpaceKeyDown(t){t.which===32&&(this.isSpaceKeyPressed=!0)}onSpaceKeyUp(t){t.which===32&&(this.isSpaceKeyPressed=!1)}allowBlankMouseDown(t){const e=this.widgetOptions.eventTypes;return(e==null?void 0:e.includes("leftMouseDown"))&&t.button===0||(e==null?void 0:e.includes("mouseWheelDown"))&&t.button===1}allowMouseWheel(t){var e;return this.pannable&&!t.ctrlKey&&((e=this.widgetOptions.eventTypes)===null||e===void 0?void 0:e.includes("mouseWheel"))}autoPanning(t,e){const c=this.graph.getGraphArea();let u=0,f=0;t<=c.left+10&&(u=-10),e<=c.top+10&&(f=-10),t>=c.right-10&&(u=10),e>=c.bottom-10&&(f=10),(u!==0||f!==0)&&this.graph.translateBy(-u,-f)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}eS([ii.dispose()],jx.prototype,"dispose",null);var nS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Fx extends ii{constructor(){super(...arguments),this.cumulatedFactor=1}get widgetOptions(){return this.options.mousewheel}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new Zp(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}get disabled(){return this.widgetOptions.enabled!==!0}enable(t){(this.disabled||t)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(t){const e=this.widgetOptions.guard;return(e==null||e(t))&&rc.isMatch(t,this.widgetOptions.modifiers)}onMouseWheel(t){const e=this.widgetOptions.guard;if((e==null||e(t))&&rc.isMatch(t,this.widgetOptions.modifiers)){const n=this.widgetOptions.factor||1.2;this.currentScale==null&&(this.startPos={x:t.clientX,y:t.clientY},this.currentScale=this.graph.transform.getScale().sx),t.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*n*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/n)*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const u=this.currentScale;let f=this.graph.transform.clampScale(u*this.cumulatedFactor);const d=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,v=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if(f=hr(f,d,v),f!==u)if(this.widgetOptions.zoomAtMousePosition){const E=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(f,{absolute:!0,center:E.clone()})}else this.graph.zoom(f,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}nS([fe.dispose()],Fx.prototype,"dispose",null);var rS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class $w extends ii{init(){this.resetRenderArea=ga(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea()}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}resetRenderArea(){if(this.options.virtual){const t=this.graph.getGraphArea();this.graph.renderer.setRenderArea(t)}}dispose(){this.stopListening()}}rS([ii.dispose()],$w.prototype,"dispose",null);class iS{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}queueJob(t){if(t.priority&lc.PRIOR)t.cb();else{const e=this.findInsertionIndex(t);e>=0&&this.queue.splice(e,0,t)}}queueFlush(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.scheduleJob())}queueFlushSync(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.flushJobsSync())}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}flushJobs(){this.isFlushPending=!1,this.isFlushing=!0;const t=this.getCurrentTime();let e;for(;(e=this.queue.shift())&&(e.cb(),!(this.getCurrentTime()-t>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}flushJobsSync(){this.isFlushPending=!1,this.isFlushing=!0;let t;for(;t=this.queue.shift();)try{t.cb()}catch(e){console.log(e)}this.isFlushing=!1}findInsertionIndex(t){let e=0,n=this.queue.length,c=n-1;const u=t.priority;for(;e<=c;){const f=(c-e>>1)+e;u<=this.queue[f].priority?e=f+1:(n=f,c=f-1)}return n}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}cancelScheduleJob(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}getCurrentTime(){return typeof performance=="object"&&typeof performance.now=="function"?performance.now():Date.now()-this.initialTime}}var lc;(function(a){a[a.Update=2]="Update",a[a.RenderEdge=4]="RenderEdge",a[a.RenderNode=8]="RenderNode",a[a.PRIOR=1048576]="PRIOR"})(lc||(lc={}));var oS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class qr extends fe{get model(){return this.graph.model}get container(){return this.graph.view.stage}constructor(t){super(),this.views={},this.willRemoveViews={},this.queue=new iS,this.graph=t,this.init()}init(){this.startListening(),this.renderViews(this.model.getCells())}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}onModelReseted({options:t}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();const e=this.model.getCells();this.renderViews(e,Object.assign(Object.assign({},t),{queue:e.map(n=>n.id)}))}onCellAdded({cell:t,options:e}){this.renderViews([t],e)}onCellRemoved({cell:t}){this.removeViews([t])}onCellZIndexChanged({cell:t,options:e}){const n=this.views[t.id];n&&this.requestViewUpdate(n.view,qr.FLAG_INSERT,e,lc.Update,!0)}onCellVisibleChanged({cell:t,current:e}){this.toggleVisible(t,!!e)}requestViewUpdate(t,e,n={},c=lc.Update,u=!0){const f=t.cell.id,d=this.views[f];if(!d)return;d.flag=e,d.options=n,(t.hasAction(e,["translate","resize","rotate"])||n.async===!1)&&(c=lc.PRIOR,u=!1),this.queue.queueJob({id:f,priority:c,cb:()=>{this.renderViewInArea(t,e,n);const E=n.queue;if(E){const S=E.indexOf(t.cell.id);S>=0&&E.splice(S,1),E.length===0&&this.graph.trigger("render:done")}}}),this.getEffectedEdges(t).forEach(E=>{this.requestViewUpdate(E.view,E.flag,n,c,!1)}),u&&this.flush()}setRenderArea(t){this.renderArea=t,this.flushWaitingViews()}isViewMounted(t){if(t==null)return!1;const e=this.views[t.cell.id];return e?e.state===qr.ViewState.MOUNTED:!1}renderViews(t,e={}){t.sort((n,c)=>n.isNode()&&c.isEdge()?-1:0),t.forEach(n=>{const c=n.id,u=this.views;let f=0,d=u[c];if(d)f=qr.FLAG_INSERT;else{const v=this.createCellView(n);v&&(v.graph=this.graph,f=qr.FLAG_INSERT|v.getBootstrapFlag(),d={view:v,flag:f,options:e,state:qr.ViewState.CREATED},this.views[c]=d)}d&&this.requestViewUpdate(d.view,f,e,this.getRenderPriority(d.view),!1)}),this.flush()}renderViewInArea(t,e,n={}){const c=t.cell,u=c.id,f=this.views[u];if(!f)return;let d=0;this.isUpdatable(t)?(d=this.updateView(t,e,n),f.flag=d):f.state===qr.ViewState.MOUNTED?(d=this.updateView(t,e,n),f.flag=d):f.state=qr.ViewState.WAITING,d&&c.isEdge()&&!(d&t.getFlag(["source","target"]))&&this.queue.queueJob({id:u,priority:lc.RenderEdge,cb:()=>{this.updateView(t,e,n)}})}removeViews(t){t.forEach(e=>{const n=e.id,c=this.views[n];c&&(this.willRemoveViews[n]=c,delete this.views[n],this.queue.queueJob({id:n,priority:this.getRenderPriority(c.view),cb:()=>{this.removeView(c.view)}}))}),this.flush()}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}flushWaitingViews(){Object.values(this.views).forEach(t=>{if(t&&t.state===qr.ViewState.WAITING){const{view:e,flag:n,options:c}=t;this.requestViewUpdate(e,n,c,this.getRenderPriority(e),!1)}}),this.flush()}updateView(t,e,n={}){if(t==null)return 0;if(kr.isCellView(t)){if(e&qr.FLAG_REMOVE)return this.removeView(t.cell),0;e&qr.FLAG_INSERT&&(this.insertView(t),e^=qr.FLAG_INSERT)}return e?t.confirmUpdate(e,n):0}insertView(t){const e=this.views[t.cell.id];if(e){const n=t.cell.getZIndex(),c=this.addZPivot(n);this.container.insertBefore(t.container,c),t.cell.isVisible()||this.toggleVisible(t.cell,!1),e.state=qr.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:t})}}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach(t=>{t&&this.removeView(t.view)}),this.views={},this.willRemoveViews={}}removeView(t){const e=t.cell,n=this.willRemoveViews[e.id];n&&t&&(n.view.remove(),delete this.willRemoveViews[e.id],this.graph.trigger("view:unmounted",{view:t}))}toggleVisible(t,e){const n=this.model.getConnectedEdges(t);for(let u=0,f=n.length;u<f;u+=1){const d=n[u];if(e){const v=d.getSourceCell(),b=d.getTargetCell();if(v&&!v.isVisible()||b&&!b.isVisible())continue;this.toggleVisible(d,!0)}else this.toggleVisible(d,!1)}const c=this.views[t.id];c&&bl(c.view.container,{display:e?"unset":"none"})}addZPivot(t=0){this.zPivots==null&&(this.zPivots={});const e=this.zPivots;let n=e[t];if(n)return n;n=e[t]=document.createComment(`z-index:${t+1}`);let c=-1/0;for(const f in e){const d=+f;d<t&&d>c&&(c=d,t-1)}const u=this.container;if(c!==-1/0){const f=e[c];u.insertBefore(n,f.nextSibling)}else u.insertBefore(n,u.firstChild);return n}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach(t=>{t&&t.parentNode&&t.parentNode.removeChild(t)}),this.zPivots={}}createCellView(t){const e={graph:this.graph},n=this.graph.options.createCellView;if(n){const u=Ke(n,this.graph,t);if(u)return new u(t,e);if(u===null)return null}const c=t.view;if(c!=null&&typeof c=="string"){const u=kr.registry.get(c);return u?new u(t,e):kr.registry.onNotFound(c)}return t.isNode()?new Bo(t,e):t.isEdge()?new cc(t,e):null}getEffectedEdges(t){const e=[],n=t.cell,c=this.model.getConnectedEdges(n);for(let u=0,f=c.length;u<f;u+=1){const d=c[u],v=this.views[d.id];if(!v)continue;const b=v.view;if(!this.isViewMounted(b))continue;const E=["update"];d.getTargetCell()===n&&E.push("target"),d.getSourceCell()===n&&E.push("source"),e.push({id:d.id,view:b,flag:b.getFlag(E)})}return e}isUpdatable(t){if(t.isNodeView())return this.renderArea?this.renderArea.isIntersectWithRect(t.cell.getBBox()):!0;if(t.isEdgeView()){const e=t.cell,n=e.getSourceCell(),c=e.getTargetCell();if(this.renderArea&&n&&c)return this.renderArea.isIntersectWithRect(n.getBBox())||this.renderArea.isIntersectWithRect(c.getBBox())}return!0}getRenderPriority(t){return t.cell.isNode()?lc.RenderNode:lc.RenderEdge}dispose(){this.stopListening(),Object.keys(this.views).forEach(t=>{this.views[t].view.dispose()}),this.views={}}}oS([fe.dispose()],qr.prototype,"dispose",null),function(a){a.FLAG_INSERT=1<<30,a.FLAG_REMOVE=1<<29,a.FLAG_RENDER=(1<<26)-1}(qr||(qr={})),function(a){let t;(function(e){e[e.CREATED=0]="CREATED",e[e.MOUNTED=1]="MOUNTED",e[e.WAITING=2]="WAITING"})(t=a.ViewState||(a.ViewState={}))}(qr||(qr={}));var sS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Gx extends ii{constructor(){super(...arguments),this.schedule=new qr(this.graph)}requestViewUpdate(t,e,n={}){this.schedule.requestViewUpdate(t,e,n)}isViewMounted(t){return this.schedule.isViewMounted(t)}setRenderArea(t){this.schedule.setRenderArea(t)}findViewByElem(t){if(t==null)return null;const e=this.options.container,n=typeof t=="string"?e.querySelector(t):t instanceof Element?t:t[0];if(n){const c=this.graph.view.findAttr("data-cell-id",n);if(c){const u=this.schedule.views;if(u[c])return u[c].view}}return null}findViewByCell(t){if(t==null)return null;const e=Cn.isCell(t)?t.id:t,n=this.schedule.views;return n[e]?n[e].view:null}findViewsFromPoint(t){const e={x:t.x,y:t.y};return this.model.getCells().map(n=>this.findViewByCell(n)).filter(n=>n!=null?Fn.getBBox(n.container,{target:this.view.stage}).containsPoint(e):!1)}findEdgeViewsFromPoint(t,e=5){return this.model.getEdges().map(n=>this.findViewByCell(n)).filter(n=>{if(n!=null){const c=n.getClosestPoint(t);if(c)return c.distance(t)<=e}return!1})}findViewsInArea(t,e={}){const n=s.create(t);return this.model.getCells().map(c=>this.findViewByCell(c)).filter(c=>{if(c){if(e.nodeOnly&&!c.isNodeView())return!1;const u=Fn.getBBox(c.container,{target:this.view.stage});return u.width===0?u.inflate(1,0):u.height===0&&u.inflate(0,1),e.strict?n.containsRect(u):n.isIntersectWithRect(u)}return!1})}dispose(){this.schedule.dispose()}}sS([ii.dispose()],Gx.prototype,"dispose",null);var Ww=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class Xw extends ii{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(t){return this.svg.getElementById(t)!=null}filter(t){let e=t.id;const n=t.name;if(e||(e=`filter-${n}-${this.cid}-${Rp(JSON.stringify(t))}`),!this.isDefined(e)){const c=Vr.registry.get(n);if(c==null)return Vr.registry.onNotFound(n);const u=c(t.args||{}),f=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},t.attrs),{id:e});sn.create(or.sanitize(u),f).appendTo(this.defs)}return e}gradient(t){let e=t.id;const n=t.type;if(e||(e=`gradient-${n}-${this.cid}-${Rp(JSON.stringify(t))}`),!this.isDefined(e)){const u=t.stops.map(v=>{const b=v.opacity!=null&&Number.isFinite(v.opacity)?v.opacity:1;return`<stop offset="${v.offset}" stop-color="${v.color}" stop-opacity="${b}"/>`}),f=`<${n}>${u.join("")}</${n}>`,d=Object.assign({id:e},t.attrs);sn.create(f,d).appendTo(this.defs)}return e}marker(t){const{id:e,refX:n,refY:c,markerUnits:u,markerOrient:f,tagName:d,children:v}=t,b=Ww(t,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let E=e;if(E||(E=`marker-${this.cid}-${Rp(JSON.stringify(t))}`),!this.isDefined(E)){d!=="path"&&delete b.d;const S=sn.create("marker",{refX:n,refY:c,id:E,overflow:"visible",orient:f!=null?f:"auto",markerUnits:u||"userSpaceOnUse"},v?v.map(_=>{var{tagName:C}=_,D=Ww(_,["tagName"]);return sn.create(`${C}`||"path",vo(Object.assign(Object.assign({},b),D)))}):[sn.create(d||"path",vo(b))]);this.defs.appendChild(S.node)}return E}remove(t){const e=this.svg.getElementById(t);e&&e.parentNode&&e.parentNode.removeChild(e)}}class Zw extends ii{getClientMatrix(){return Ur(this.view.stage.getScreenCTM())}getClientOffset(){const t=this.view.svg.getBoundingClientRect();return new o(t.left,t.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(t,e){return(typeof t=="number"?this.clientToLocalPoint(t,e):this.clientToLocalPoint(t.x,t.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(t,e){const n=o.create(t,e);return Fn.transformPoint(n,this.graph.matrix())}localToClientPoint(t,e){const n=o.create(t,e);return Fn.transformPoint(n,this.getClientMatrix())}localToPagePoint(t,e){return(typeof t=="number"?this.localToGraphPoint(t,e):this.localToGraphPoint(t)).translate(this.getPageOffset())}localToGraphRect(t,e,n,c){const u=s.create(t,e,n,c);return Fn.transformRectangle(u,this.graph.matrix())}localToClientRect(t,e,n,c){const u=s.create(t,e,n,c);return Fn.transformRectangle(u,this.getClientMatrix())}localToPageRect(t,e,n,c){return(typeof t=="number"?this.localToGraphRect(t,e,n,c):this.localToGraphRect(t)).translate(this.getPageOffset())}graphToLocalPoint(t,e){const n=o.create(t,e);return Fn.transformPoint(n,this.graph.matrix().inverse())}clientToLocalPoint(t,e){const n=o.create(t,e);return Fn.transformPoint(n,this.getClientMatrix().inverse())}clientToGraphPoint(t,e){const n=o.create(t,e);return Fn.transformPoint(n,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(t,e){const c=o.create(t,e).diff(this.getPageOffset());return this.graphToLocalPoint(c)}graphToLocalRect(t,e,n,c){const u=s.create(t,e,n,c);return Fn.transformRectangle(u,this.graph.matrix().inverse())}clientToLocalRect(t,e,n,c){const u=s.create(t,e,n,c);return Fn.transformRectangle(u,this.getClientMatrix().inverse())}clientToGraphRect(t,e,n,c){const u=s.create(t,e,n,c);return Fn.transformRectangle(u,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(t,e,n,c){const u=s.create(t,e,n,c),f=this.getPageOffset();return u.x-=f.x,u.y-=f.y,this.graphToLocalRect(u)}}var aS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Rv extends ii{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:t,magnet:e,options:n={}}){const c=this.resolveHighlighter(n);if(!c)return;const u=this.getHighlighterId(e,c);if(!this.highlights[u]){const f=c.highlighter;f.highlight(t,e,Object.assign({},c.args)),this.highlights[u]={cellView:t,magnet:e,highlighter:f,args:c.args}}}onCellUnhighlight({magnet:t,options:e={}}){const n=this.resolveHighlighter(e);if(!n)return;const c=this.getHighlighterId(t,n);this.unhighlight(c)}resolveHighlighter(t){const e=this.options;let n=t.highlighter;if(n==null){const d=t.type;n=d&&e.highlighting[d]||e.highlighting.default}if(n==null)return null;const c=typeof n=="string"?{name:n}:n,u=c.name,f=sc.registry.get(u);return f==null?sc.registry.onNotFound(u):(sc.check(u,f),{name:u,highlighter:f,args:c.args||{}})}getHighlighterId(t,e){return Uf(t),e.name+t.id+JSON.stringify(e.args)}unhighlight(t){const e=this.highlights[t];e&&(e.highlighter.unhighlight(e.cellView,e.magnet,e.args),delete this.highlights[t])}dispose(){Object.keys(this.highlights).forEach(t=>this.unhighlight(t)),this.stopListening()}}aS([Rv.dispose()],Rv.prototype,"dispose",null);var cS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class qw extends ii{getScroller(){const t=this.graph.getPlugin("scroller");return t&&t.options.enabled?t:null}getContainer(){const t=this.getScroller();return t?t.container.parentElement:this.graph.container.parentElement}getSensorTarget(){const t=this.options.autoResize;if(t)return typeof t=="boolean"?this.getContainer():t}init(){if(this.options.autoResize){const e=this.getSensorTarget();e&&eh.bind(e,()=>{const n=e.offsetWidth,c=e.offsetHeight;this.resize(n,c)})}}resize(t,e){const n=this.getScroller();n?n.resize(t,e):this.graph.transform.resize(t,e)}dispose(){eh.clear(this.graph.container)}}cS([ii.dispose()],qw.prototype,"dispose",null);var lS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u};class Li extends vi{get container(){return this.options.container}get[Symbol.toStringTag](){return Li.toStringTag}constructor(t){super(),this.installedPlugins=new Set,this.options=am.get(t),this.css=new kx(this),this.view=new Ts(this),this.defs=new Xw(this),this.coord=new Zw(this),this.transform=new Hw(this),this.highlight=new Rv(this),this.grid=new Bx(this),this.background=new Dv(this),this.options.model?this.model=this.options.model:(this.model=new As,this.model.graph=this),this.renderer=new Gx(this),this.panning=new jx(this),this.mousewheel=new Fx(this),this.virtualRender=new $w(this),this.size=new qw(this)}isNode(t){return t.isNode()}isEdge(t){return t.isEdge()}resetCells(t,e={}){return this.model.resetCells(t,e),this}clearCells(t={}){return this.model.clear(t),this}toJSON(t={}){return this.model.toJSON(t)}parseJSON(t){return this.model.parseJSON(t)}fromJSON(t,e={}){return this.model.fromJSON(t,e),this}getCellById(t){return this.model.getCell(t)}addNode(t,e={}){return this.model.addNode(t,e)}addNodes(t,e={}){return this.addCell(t.map(n=>Cr.isNode(n)?n:this.createNode(n)),e)}createNode(t){return this.model.createNode(t)}removeNode(t,e={}){return this.model.removeCell(t,e)}addEdge(t,e={}){return this.model.addEdge(t,e)}addEdges(t,e={}){return this.addCell(t.map(n=>mr.isEdge(n)?n:this.createEdge(n)),e)}removeEdge(t,e={}){return this.model.removeCell(t,e)}createEdge(t){return this.model.createEdge(t)}addCell(t,e={}){return this.model.addCell(t,e),this}removeCell(t,e={}){return this.model.removeCell(t,e)}removeCells(t,e={}){return this.model.removeCells(t,e)}removeConnectedEdges(t,e={}){return this.model.removeConnectedEdges(t,e)}disconnectConnectedEdges(t,e={}){return this.model.disconnectConnectedEdges(t,e),this}hasCell(t){return this.model.has(t)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(t){return this.model.getOutgoingEdges(t)}getIncomingEdges(t){return this.model.getIncomingEdges(t)}getConnectedEdges(t,e={}){return this.model.getConnectedEdges(t,e)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(t){return this.model.isRoot(t)}isLeafNode(t){return this.model.isLeaf(t)}getNeighbors(t,e={}){return this.model.getNeighbors(t,e)}isNeighbor(t,e,n={}){return this.model.isNeighbor(t,e,n)}getSuccessors(t,e={}){return this.model.getSuccessors(t,e)}isSuccessor(t,e,n={}){return this.model.isSuccessor(t,e,n)}getPredecessors(t,e={}){return this.model.getPredecessors(t,e)}isPredecessor(t,e,n={}){return this.model.isPredecessor(t,e,n)}getCommonAncestor(...t){return this.model.getCommonAncestor(...t)}getSubGraph(t,e={}){return this.model.getSubGraph(t,e)}cloneSubGraph(t,e={}){return this.model.cloneSubGraph(t,e)}cloneCells(t){return this.model.cloneCells(t)}getNodesFromPoint(t,e){return this.model.getNodesFromPoint(t,e)}getNodesInArea(t,e,n,c,u){return this.model.getNodesInArea(t,e,n,c,u)}getNodesUnderNode(t,e={}){return this.model.getNodesUnderNode(t,e)}searchCell(t,e,n={}){return this.model.search(t,e,n),this}getShortestPath(t,e,n={}){return this.model.getShortestPath(t,e,n)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(t,e={}){return this.model.getCellsBBox(t,e)}startBatch(t,e={}){this.model.startBatch(t,e)}stopBatch(t,e={}){this.model.stopBatch(t,e)}batchUpdate(t,e,n){const c=typeof t=="string"?t:"update",u=typeof t=="string"?e:t,f=typeof e=="function"?n:e;this.startBatch(c,f);const d=u();return this.stopBatch(c,f),d}updateCellId(t,e){return this.model.updateCellId(t,e)}findView(t){return Cn.isCell(t)?this.findViewByCell(t):this.findViewByElem(t)}findViews(t){return s.isRectangleLike(t)?this.findViewsInArea(t):o.isPointLike(t)?this.findViewsFromPoint(t):[]}findViewByCell(t){return this.renderer.findViewByCell(t)}findViewByElem(t){return this.renderer.findViewByElem(t)}findViewsFromPoint(t,e){const n=typeof t=="number"?{x:t,y:e}:t;return this.renderer.findViewsFromPoint(n)}findViewsInArea(t,e,n,c,u){const f=typeof t=="number"?{x:t,y:e,width:n,height:c}:t,d=typeof t=="number"?u:e;return this.renderer.findViewsInArea(f,d)}matrix(t){return typeof t>"u"?this.transform.getMatrix():(this.transform.setMatrix(t),this)}resize(t,e){const n=this.getPlugin("scroller");return n?n.resize(t,e):this.transform.resize(t,e),this}scale(t,e=t,n=0,c=0){return typeof t>"u"?this.transform.getScale():(this.transform.scale(t,e,n,c),this)}zoom(t,e){const n=this.getPlugin("scroller");if(n){if(typeof t>"u")return n.zoom();n.zoom(t,e)}else{if(typeof t>"u")return this.transform.getZoom();this.transform.zoom(t,e)}return this}zoomTo(t,e={}){const n=this.getPlugin("scroller");return n?n.zoom(t,Object.assign(Object.assign({},e),{absolute:!0})):this.transform.zoom(t,Object.assign(Object.assign({},e),{absolute:!0})),this}zoomToRect(t,e={}){const n=this.getPlugin("scroller");return n?n.zoomToRect(t,e):this.transform.zoomToRect(t,e),this}zoomToFit(t={}){const e=this.getPlugin("scroller");return e?e.zoomToFit(t):this.transform.zoomToFit(t),this}rotate(t,e,n){return typeof t>"u"?this.transform.getRotation():(this.transform.rotate(t,e,n),this)}translate(t,e){return typeof t>"u"?this.transform.getTranslation():(this.transform.translate(t,e),this)}translateBy(t,e){const n=this.translate(),c=n.tx+t,u=n.ty+e;return this.translate(c,u)}getGraphArea(){return this.transform.getGraphArea()}getContentArea(t={}){return this.transform.getContentArea(t)}getContentBBox(t={}){return this.transform.getContentBBox(t)}fitToContent(t,e,n,c){return this.transform.fitToContent(t,e,n,c)}scaleContentToFit(t={}){return this.transform.scaleContentToFit(t),this}center(t){return this.centerPoint(t)}centerPoint(t,e,n){const c=this.getPlugin("scroller");return c?c.centerPoint(t,e,n):this.transform.centerPoint(t,e),this}centerContent(t){const e=this.getPlugin("scroller");return e?e.centerContent(t):this.transform.centerContent(t),this}centerCell(t,e){const n=this.getPlugin("scroller");return n?n.centerCell(t,e):this.transform.centerCell(t),this}positionPoint(t,e,n,c={}){const u=this.getPlugin("scroller");return u?u.positionPoint(t,e,n,c):this.transform.positionPoint(t,e,n),this}positionRect(t,e,n){const c=this.getPlugin("scroller");return c?c.positionRect(t,e,n):this.transform.positionRect(t,e),this}positionCell(t,e,n){const c=this.getPlugin("scroller");return c?c.positionCell(t,e,n):this.transform.positionCell(t,e),this}positionContent(t,e){const n=this.getPlugin("scroller");return n?n.positionContent(t,e):this.transform.positionContent(t,e),this}snapToGrid(t,e){return this.coord.snapToGrid(t,e)}pageToLocal(t,e,n,c){return s.isRectangleLike(t)?this.coord.pageToLocalRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.pageToLocalRect(t,e,n,c):this.coord.pageToLocalPoint(t,e)}localToPage(t,e,n,c){return s.isRectangleLike(t)?this.coord.localToPageRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.localToPageRect(t,e,n,c):this.coord.localToPagePoint(t,e)}clientToLocal(t,e,n,c){return s.isRectangleLike(t)?this.coord.clientToLocalRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.clientToLocalRect(t,e,n,c):this.coord.clientToLocalPoint(t,e)}localToClient(t,e,n,c){return s.isRectangleLike(t)?this.coord.localToClientRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.localToClientRect(t,e,n,c):this.coord.localToClientPoint(t,e)}localToGraph(t,e,n,c){return s.isRectangleLike(t)?this.coord.localToGraphRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.localToGraphRect(t,e,n,c):this.coord.localToGraphPoint(t,e)}graphToLocal(t,e,n,c){return s.isRectangleLike(t)?this.coord.graphToLocalRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.graphToLocalRect(t,e,n,c):this.coord.graphToLocalPoint(t,e)}clientToGraph(t,e,n,c){return s.isRectangleLike(t)?this.coord.clientToGraphRect(t):typeof t=="number"&&typeof e=="number"&&typeof n=="number"&&typeof c=="number"?this.coord.clientToGraphRect(t,e,n,c):this.coord.clientToGraphPoint(t,e)}defineFilter(t){return this.defs.filter(t)}defineGradient(t){return this.defs.gradient(t)}defineMarker(t){return this.defs.marker(t)}getGridSize(){return this.grid.getGridSize()}setGridSize(t){return this.grid.setGridSize(t),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(t){return this.grid.draw(t),this}updateBackground(){return this.background.update(),this}drawBackground(t,e){const n=this.getPlugin("scroller");return n!=null&&(this.options.background==null||!e)?n.drawBackground(t,e):this.background.draw(t),this}clearBackground(t){const e=this.getPlugin("scroller");return e!=null&&(this.options.background==null||!t)?e.clearBackground(t):this.background.clear(),this}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(t){return t==null?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():t?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){const t=this.getPlugin("scroller");return t?t.isPannable():this.panning.pannable}enablePanning(){const t=this.getPlugin("scroller");return t?t.enablePanning():this.panning.enablePanning(),this}disablePanning(){const t=this.getPlugin("scroller");return t?t.disablePanning():this.panning.disablePanning(),this}togglePanning(t){return t==null?this.isPannable()?this.disablePanning():this.enablePanning():t!==this.isPannable()&&(t?this.enablePanning():this.disablePanning()),this}use(t,...e){return this.installedPlugins.has(t)||(this.installedPlugins.add(t),t.init(this,...e)),this}getPlugin(t){return Array.from(this.installedPlugins).find(e=>e.name===t)}getPlugins(t){return Array.from(this.installedPlugins).filter(e=>t.includes(e.name))}enablePlugins(t){let e=t;Array.isArray(e)||(e=[e]);const n=this.getPlugins(e);return n==null||n.forEach(c=>{var u;(u=c==null?void 0:c.enable)===null||u===void 0||u.call(c)}),this}disablePlugins(t){let e=t;Array.isArray(e)||(e=[e]);const n=this.getPlugins(e);return n==null||n.forEach(c=>{var u;(u=c==null?void 0:c.disable)===null||u===void 0||u.call(c)}),this}isPluginEnabled(t){var e;const n=this.getPlugin(t);return(e=n==null?void 0:n.isEnabled)===null||e===void 0?void 0:e.call(n)}disposePlugins(t){let e=t;Array.isArray(e)||(e=[e]);const n=this.getPlugins(e);return n==null||n.forEach(c=>{c.dispose(),this.installedPlugins.delete(c)}),this}dispose(t=!0){t&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach(e=>{e.dispose()})}}lS([vi.dispose()],Li.prototype,"dispose",null),function(a){a.View=Ts,a.Renderer=Gx,a.MouseWheel=Fx,a.DefsManager=Xw,a.GridManager=Bx,a.CoordManager=Zw,a.TransformManager=Hw,a.HighlightManager=Rv,a.BackgroundManager=Dv,a.PanningManager=jx}(Li||(Li={})),function(a){a.toStringTag=`X6.${a.name}`;function t(e){if(e==null)return!1;if(e instanceof a)return!0;const n=e[Symbol.toStringTag];return n==null||n===a.toStringTag}a.isGraph=t}(Li||(Li={})),function(a){function t(e,n){const c=e instanceof HTMLElement?new a({container:e}):new a(e);return n!=null&&c.fromJSON(n),c}a.render=t}(Li||(Li={})),function(a){a.registerNode=Cr.registry.register,a.registerEdge=mr.registry.register,a.registerView=kr.registry.register,a.registerAttr=fa.registry.register,a.registerGrid=Ee.registry.register,a.registerFilter=Vr.registry.register,a.registerNodeTool=fd.registry.register,a.registerEdgeTool=dd.registry.register,a.registerBackground=Mn.registry.register,a.registerHighlighter=sc.registry.register,a.registerPortLayout=rh.registry.register,a.registerPortLabelLayout=ud.registry.register,a.registerMarker=Il.registry.register,a.registerRouter=Rl.registry.register,a.registerConnector=ih.registry.register,a.registerAnchor=gd.registry.register,a.registerEdgeAnchor=pd.registry.register,a.registerConnectionPoint=md.registry.register}(Li||(Li={})),function(a){a.unregisterNode=Cr.registry.unregister,a.unregisterEdge=mr.registry.unregister,a.unregisterView=kr.registry.unregister,a.unregisterAttr=fa.registry.unregister,a.unregisterGrid=Ee.registry.unregister,a.unregisterFilter=Vr.registry.unregister,a.unregisterNodeTool=fd.registry.unregister,a.unregisterEdgeTool=dd.registry.unregister,a.unregisterBackground=Mn.registry.unregister,a.unregisterHighlighter=sc.registry.unregister,a.unregisterPortLayout=rh.registry.unregister,a.unregisterPortLabelLayout=ud.registry.unregister,a.unregisterMarker=Il.registry.unregister,a.unregisterRouter=Rl.registry.unregister,a.unregisterConnector=ih.registry.unregister,a.unregisterAnchor=gd.registry.unregister,a.unregisterEdgeAnchor=pd.registry.unregister,a.unregisterConnectionPoint=md.registry.unregister}(Li||(Li={}));var uS=function(a,t,e,n){var c=arguments.length,u=c<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,t,e,n);else for(var d=a.length-1;d>=0;d--)(f=a[d])&&(u=(c<3?f(u):c>3?f(t,e,u):f(t,e))||u);return c>3&&u&&Object.defineProperty(t,e,u),u},hS=function(a,t){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(e[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(a);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(a,n[c])&&(e[n[c]]=a[n[c]]);return e};class wd extends Cr{}(function(a){class t extends Bo{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this)}onCellChangeAny({key:n}){const c=a.shapeMaps[this.cell.shape];if(c){const{effect:u}=c;(!u||u.includes(n))&&this.renderHTMLComponent()}}confirmUpdate(n){const c=super.confirmUpdate(n);return this.handleAction(c,t.action,()=>this.renderHTMLComponent())}renderHTMLComponent(){const n=this.selectors&&this.selectors.foContent;if(n){gl(n);const c=a.shapeMaps[this.cell.shape];if(!c)return;let{html:u}=c;typeof u=="function"&&(u=u(this.cell)),u&&(typeof u=="string"?n.innerHTML=u:pl(n,u))}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this)}}uS([t.dispose()],t.prototype,"dispose",null),a.View=t,function(e){e.action="html",e.config({bootstrap:[e.action],actions:{html:e.action}}),Bo.registry.register("html-view",e,!0)}(t=a.View||(a.View={}))})(wd||(wd={})),function(a){a.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},or.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Cr.registry.register("html",a,!0)}(wd||(wd={})),function(a){a.shapeMaps={};function t(e){const{shape:n,html:c,effect:u,inherit:f}=e,d=hS(e,["shape","html","effect","inherit"]);if(!n)throw new Error("should specify shape in config");a.shapeMaps[n]={html:c,effect:u},Li.registerNode(n,Object.assign({inherit:f||"html"},d),!0)}a.register=t}(wd||(wd={}))},94704:(yo,wn,Nt)=>{"use strict";var Lt,mn=Nt(64836),An=Nt(18698);Lt={value:!0},wn.Z=void 0;var Te=mn(Nt(10434)),Be=mn(Nt(38416)),Jt=Xt(Nt(67294)),kt=mn(Nt(87453)),te=mn(Nt(71961)),Y=mn(Nt(40753)),Q=mn(Nt(93967)),st=Nt(31929),at=mn(Nt(74806)),jt=mn(Nt(60872));function Ht(Ce){if(typeof WeakMap!="function")return null;var Me=new WeakMap,tn=new WeakMap;return(Ht=function(Se){return Se?tn:Me})(Ce)}function Xt(Ce,Me){if(!Me&&Ce&&Ce.__esModule)return Ce;if(Ce===null||An(Ce)!=="object"&&typeof Ce!="function")return{default:Ce};var tn=Ht(Me);if(tn&&tn.has(Ce))return tn.get(Ce);var fe={},Se=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ve in Ce)if(Ve!=="default"&&Object.prototype.hasOwnProperty.call(Ce,Ve)){var rn=Se?Object.getOwnPropertyDescriptor(Ce,Ve):null;rn&&(rn.get||rn.set)?Object.defineProperty(fe,Ve,rn):fe[Ve]=Ce[Ve]}return fe.default=Ce,tn&&tn.set(Ce,fe),fe}var De=function(Ce,Me){var tn={};for(var fe in Ce)Object.prototype.hasOwnProperty.call(Ce,fe)&&Me.indexOf(fe)<0&&(tn[fe]=Ce[fe]);if(Ce!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Se=0,fe=Object.getOwnPropertySymbols(Ce);Se<fe.length;Se++)Me.indexOf(fe[Se])<0&&Object.prototype.propertyIsEnumerable.call(Ce,fe[Se])&&(tn[fe[Se]]=Ce[fe[Se]]);return tn},Ze=function(Me){var tn,fe=Me.percent,Se=Me.size,Ve=Me.className,rn=Me.direction,Ue=Me.responsive,Tn=De(Me,["percent","size","className","direction","responsive"]),Qn=(0,jt.default)(Ue),Zn=Qn.xs,xi=Jt.useContext(st.ConfigContext),Or=xi.getPrefixCls,ki=xi.direction,vn=Jt.useCallback(function(){return Ue&&Zn?"vertical":rn},[Zn,rn]),Bn=Or("steps",Me.prefixCls),oi=Or("",Me.iconPrefix),dr=(0,Q.default)((tn={},(0,Be.default)(tn,"".concat(Bn,"-rtl"),ki==="rtl"),(0,Be.default)(tn,"".concat(Bn,"-with-progress"),fe!==void 0),tn),Ve),ar={finish:Jt.createElement(te.default,{className:"".concat(Bn,"-finish-icon")}),error:Jt.createElement(Y.default,{className:"".concat(Bn,"-error-icon")})},jo=function(Ir){var bo=Ir.node,Cs=Ir.status;if(Cs==="process"&&fe!==void 0){var cr=Se==="small"?32:40,Fo=Jt.createElement("div",{className:"".concat(Bn,"-progress-icon")},Jt.createElement(at.default,{type:"circle",percent:fe,width:cr,strokeWidth:4,format:function(){return null}}),bo);return Fo}return bo};return Jt.createElement(kt.default,(0,Te.default)({icons:ar},Tn,{size:Se,direction:vn(),stepIcon:jo,prefixCls:Bn,iconPrefix:oi,className:dr}))};Ze.Step=kt.default.Step,Ze.defaultProps={current:0,responsive:!0};var hn=Ze;wn.Z=hn},96661:(yo,wn,Nt)=>{"use strict";Nt(17847),Nt(51627),Nt(35246)},51627:(yo,wn,Nt)=>{"use strict";Nt.r(wn)},87453:(yo,wn,Nt)=>{"use strict";Nt.r(wn),Nt.d(wn,{Step:()=>Ht,default:()=>Ze});var Lt=Nt(1413),mn=Nt(4942),An=Nt(45987),Te=Nt(15671),Be=Nt(43144),Jt=Nt(60136),kt=Nt(29388),te=Nt(67294),Y=Nt(50344),Q=Nt(93967),st=Nt.n(Q),at=["className","prefixCls","style","active","status","iconPrefix","icon","wrapperStyle","stepNumber","disabled","description","title","subTitle","progressDot","stepIcon","tailContent","icons","stepIndex","onStepClick","onClick"];function jt(hn){return typeof hn=="string"}var Ht=function(hn){(0,Jt.Z)(Me,hn);var Ce=(0,kt.Z)(Me);function Me(){var tn;return(0,Te.Z)(this,Me),tn=Ce.apply(this,arguments),tn.onClick=function(){var fe=tn.props,Se=fe.onClick,Ve=fe.onStepClick,rn=fe.stepIndex;Se&&Se.apply(void 0,arguments),Ve(rn)},tn}return(0,Be.Z)(Me,[{key:"renderIconNode",value:function(){var fe,Se=this.props,Ve=Se.prefixCls,rn=Se.progressDot,Ue=Se.stepIcon,Tn=Se.stepNumber,Qn=Se.status,Zn=Se.title,xi=Se.description,Or=Se.icon,ki=Se.iconPrefix,vn=Se.icons,Bn,oi=st()("".concat(Ve,"-icon"),"".concat(ki,"icon"),(fe={},(0,mn.Z)(fe,"".concat(ki,"icon-").concat(Or),Or&&jt(Or)),(0,mn.Z)(fe,"".concat(ki,"icon-check"),!Or&&Qn==="finish"&&(vn&&!vn.finish||!vn)),(0,mn.Z)(fe,"".concat(ki,"icon-cross"),!Or&&Qn==="error"&&(vn&&!vn.error||!vn)),fe)),dr=te.createElement("span",{className:"".concat(Ve,"-icon-dot")});return rn?typeof rn=="function"?Bn=te.createElement("span",{className:"".concat(Ve,"-icon")},rn(dr,{index:Tn-1,status:Qn,title:Zn,description:xi})):Bn=te.createElement("span",{className:"".concat(Ve,"-icon")},dr):Or&&!jt(Or)?Bn=te.createElement("span",{className:"".concat(Ve,"-icon")},Or):vn&&vn.finish&&Qn==="finish"?Bn=te.createElement("span",{className:"".concat(Ve,"-icon")},vn.finish):vn&&vn.error&&Qn==="error"?Bn=te.createElement("span",{className:"".concat(Ve,"-icon")},vn.error):Or||Qn==="finish"||Qn==="error"?Bn=te.createElement("span",{className:oi}):Bn=te.createElement("span",{className:"".concat(Ve,"-icon")},Tn),Ue&&(Bn=Ue({index:Tn-1,status:Qn,title:Zn,description:xi,node:Bn})),Bn}},{key:"render",value:function(){var fe,Se=this.props,Ve=Se.className,rn=Se.prefixCls,Ue=Se.style,Tn=Se.active,Qn=Se.status,Zn=Qn===void 0?"wait":Qn,xi=Se.iconPrefix,Or=Se.icon,ki=Se.wrapperStyle,vn=Se.stepNumber,Bn=Se.disabled,oi=Se.description,dr=Se.title,ar=Se.subTitle,jo=Se.progressDot,da=Se.stepIcon,Ir=Se.tailContent,bo=Se.icons,Cs=Se.stepIndex,cr=Se.onStepClick,Fo=Se.onClick,Go=(0,An.Z)(Se,at),xo=st()("".concat(rn,"-item"),"".concat(rn,"-item-").concat(Zn),Ve,(fe={},(0,mn.Z)(fe,"".concat(rn,"-item-custom"),Or),(0,mn.Z)(fe,"".concat(rn,"-item-active"),Tn),(0,mn.Z)(fe,"".concat(rn,"-item-disabled"),Bn===!0),fe)),wi=(0,Lt.Z)({},Ue),Jr={};return cr&&!Bn&&(Jr.role="button",Jr.tabIndex=0,Jr.onClick=this.onClick),te.createElement("div",Object.assign({},Go,{className:xo,style:wi}),te.createElement("div",Object.assign({onClick:Fo},Jr,{className:"".concat(rn,"-item-container")}),te.createElement("div",{className:"".concat(rn,"-item-tail")},Ir),te.createElement("div",{className:"".concat(rn,"-item-icon")},this.renderIconNode()),te.createElement("div",{className:"".concat(rn,"-item-content")},te.createElement("div",{className:"".concat(rn,"-item-title")},dr,ar&&te.createElement("div",{title:typeof ar=="string"?ar:void 0,className:"".concat(rn,"-item-subtitle")},ar)),oi&&te.createElement("div",{className:"".concat(rn,"-item-description")},oi))))}}]),Me}(te.Component),Xt=["prefixCls","style","className","children","direction","type","labelPlacement","iconPrefix","status","size","current","progressDot","stepIcon","initial","icons","onChange"],De=function(hn){(0,Jt.Z)(Me,hn);var Ce=(0,kt.Z)(Me);function Me(){var tn;return(0,Te.Z)(this,Me),tn=Ce.apply(this,arguments),tn.onStepClick=function(fe){var Se=tn.props,Ve=Se.onChange,rn=Se.current;Ve&&rn!==fe&&Ve(fe)},tn}return(0,Be.Z)(Me,[{key:"render",value:function(){var fe,Se=this,Ve=this.props,rn=Ve.prefixCls,Ue=Ve.style,Tn=Ue===void 0?{}:Ue,Qn=Ve.className,Zn=Ve.children,xi=Ve.direction,Or=Ve.type,ki=Ve.labelPlacement,vn=Ve.iconPrefix,Bn=Ve.status,oi=Ve.size,dr=Ve.current,ar=Ve.progressDot,jo=Ve.stepIcon,da=Ve.initial,Ir=Ve.icons,bo=Ve.onChange,Cs=(0,An.Z)(Ve,Xt),cr=Or==="navigation",Fo=ar?"vertical":ki,Go=st()(rn,"".concat(rn,"-").concat(xi),Qn,(fe={},(0,mn.Z)(fe,"".concat(rn,"-").concat(oi),oi),(0,mn.Z)(fe,"".concat(rn,"-label-").concat(Fo),xi==="horizontal"),(0,mn.Z)(fe,"".concat(rn,"-dot"),!!ar),(0,mn.Z)(fe,"".concat(rn,"-navigation"),cr),fe));return te.createElement("div",Object.assign({className:Go,style:Tn},Cs),(0,Y.Z)(Zn).map(function(xo,wi){var Jr=da+wi,Yi=(0,Lt.Z)({stepNumber:"".concat(Jr+1),stepIndex:Jr,key:Jr,prefixCls:rn,iconPrefix:vn,wrapperStyle:Tn,progressDot:ar,stepIcon:jo,icons:Ir,onStepClick:bo&&Se.onStepClick},xo.props);return Bn==="error"&&wi===dr-1&&(Yi.className="".concat(rn,"-next-error")),xo.props.status||(Jr===dr?Yi.status=Bn:Jr<dr?Yi.status="finish":Yi.status="wait"),Yi.active=Jr===dr,(0,te.cloneElement)(xo,Yi)}))}}]),Me}(te.Component);De.Step=Ht,De.defaultProps={type:"default",prefixCls:"rc-steps",iconPrefix:"rc",direction:"horizontal",labelPlacement:"horizontal",initial:0,current:0,status:"process",size:"",progressDot:!1};const Ze=De}}]);
