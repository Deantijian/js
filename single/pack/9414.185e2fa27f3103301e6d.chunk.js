"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[9414],{10593:()=>{},94708:(ne,R,t)=>{t.d(R,{Z:()=>W});var j=t(63239),x=t.n(j),e=t(374),L=t(8799),U=t(88106),S=t(31546),c=t(88239),s=t(85105),H=t.n(s),n=t(99663),oe=t(22600),A=t(49135),re=t(93196),ae=t(45697),P=t.n(ae),a=t(67294),g=t(13714),le=t(71893),se=t(29314),ce=t(93967),E=t.n(ce),V=t(96486),Z=t.n(V),y=t(92138),Y=t(55651),B,q,z,M=["HEX","RGB"],_=["DARK_COLOR","LIGHT_COLOR"],ie=["#000000ff","#333333ff","#5a5a5aff","#757575ff","#9e9e9eff","#bdbdbdff","#ddddddff","#f5f5f5ff","#ffffffff","#2196f3ff","#08c9c9ff","#00c345ff","#fad714ff","#ff9300ff","#f52222ff","#eb2f96ff","#7500eaff","#2d46c4ff","#c9e6fcff","#c3f2f2ff","#c2f1d2ff","#fef6c6ff","#ffe5c2ff","#fdcacaff","#facde6ff","#dec2faff","#ccd2f1ff"],ee=["#333333ff","#757575ff","#2196f3ff","#08c9c9ff","#00c345ff","#fad714ff","#ff9300ff","#f52222ff","#eb2f96ff","#7500eaff","#2d46c4ff"],F={HEX:Y.L_,RGB:Y.Jg},J=le.ZP.span(function(b){var l=b.background;return`
    min-width: 32px;
    height: 32px;
    border-radius: 6px;
    border: 1px solid #d9d9d9;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: #fff;
    padding: 3px;
    .color_box_content {
      width: 100%;
      height: 100%;
      border-radius: 6px;
      background: `+l+`;
    }
    `}),Q=function(l,o){return(0,g.default)(l).toHex8String()===(0,g.default)(o).toHex8String()},te=function(l){return l.startsWith("#")||l.startsWith("rgb")},f=(q=B=function(b){(0,re.default)(l,b);function l(o){(0,n.default)(this,l);var r=(0,A.default)(this,(l.__proto__||H()(l)).call(this,o));z.call(r);var u=o.value,T=o.visible;return r.state=(0,c.default)({},r.initValue(u),{visible:T,themeExpand:!0,defaultExpand:!0,recentExpand:!0,recentColors:JSON.parse(localStorage.getItem("recentColorsMing")||"[]")}),r}return(0,oe.default)(l,[{key:"componentWillReceiveProps",value:function(r){var u=r.value,T=this.state.color;!Q(u,T)&&te(u)&&this.setState(this.initValue(u))}},{key:"render",value:function(){var r=this,u=this.props,T=u.children,D=u.className,K=u.sysColor,G=u.themeColor,fe=u.fromWidget,N=u.popupAlign,C=N===void 0?{}:N,p=this.state,m=p.color,i=p.visible,d=p.type,O=p.defaultExpand,I=p.recentExpand,w=p.recentColors,k=p.themeExpand,ue=[G,(0,y.generate)(G)[0]],de=a.createElement(J,{background:this.getStringColor(m)},a.createElement("span",{className:"color_box_content"}));T&&(de=T);var me=F[d],ve=K?"ColorPickerPanelTriggerMax":"ColorPickerPanelTriggerMin";return a.createElement("span",{className:E()("ColorPickerPanel ming ColorPicker-wrapper",D),onClick:function(v){return v.stopPropagation()}},a.createElement(se.Z,{zIndex:1056,action:["click"],popupVisible:i,onPopupVisibleChange:function(v){if(r.setState({visible:v}),v){var X=r.state.recentColors,pe=JSON.parse(localStorage.getItem("recentColorsMing")||"[]");!Z().isEqual(X,pe)&&r.setState({recentColors:pe})}else r.onClose()},destroyPopupOnHide:!0,popupClassName:E()("ColorPickerPanelTrigger",ve),popupAlign:(0,c.default)({points:["tl","bl"]},C,{overflow:{adjustX:!0,adjustY:!0}}),getPopupContainer:this.getPopupContainer,popup:a.createElement("div",{className:"colorPickerCon"},K&&a.createElement("div",{className:"commonColorPickerWrap"},G&&a.createElement(a.Fragment,null,a.createElement("div",{className:"title",onClick:function(){return r.setState({themeExpand:!k})}},a.createElement("span",{className:E()("icon-expand_more Font20 Gray_9e expandIcon",{rotate90:!k})}),a.createElement("span",{className:"mLeft4"},_l("\u4E3B\u9898"))),this.renderSysColors(k,ue,!0)),a.createElement("div",{className:"title",onClick:function(){return r.setState({defaultExpand:!O})}},a.createElement("span",{className:E()("icon-expand_more Font20 Gray_9e expandIcon",{rotate90:!O})}),a.createElement("span",{className:"mLeft4"},_l("\u5E38\u7528"))),this.renderSysColors(O,fe?ee:ie),a.createElement("div",{className:"title",onClick:function(){return r.setState({recentExpand:!I})}},a.createElement("span",{className:E()("icon-expand_more Font20 Gray_9e expandIcon",{rotate90:!I})}),a.createElement("span",{className:"mLeft4"},_l("\u6700\u8FD1\u4F7F\u7528"))),this.renderSysColors(I,w)),a.createElement("div",{className:"colorPickerWrap",onClick:function(v){return v.stopPropagation()}},a.createElement(me,{color:d==="HEX"?m.toHex8String():m.toRgb(),onChange:this.handleChangeColor}),a.createElement("div",{className:"inputOptionWrap"},a.createElement(S.Z,{className:"selectType",value:d,data:M.map(function(h){return{text:h,value:h}}),onChange:function(v){v!==d&&r.setState({type:v})}}),a.createElement("div",{className:"colorInputWrap"},d==="HEX"?a.createElement("div",{className:"hexColorInputWrap"},a.createElement("span",{className:"prefix"},"#"),a.createElement(Y.ZE,{className:"hexColorInput",color:m.toHex8String(),onChange:function(v){v.length===7&&r.setColor({color:(0,g.default)(v)})}})):a.createElement("div",{className:"rgbInputWrap"},["r","g","b"].map(function(h){return a.createElement(L.Z,{className:"rgbInput",size:"small",step:"1",controls:!1,value:m[h],min:0,max:255,onChange:function(X){X!==null&&r.setColor({color:(0,g.default)((0,c.default)({},m.toRgb(),(0,U.default)({},h,X)))})}})}))),a.createElement(L.Z,{className:"alphaInput",size:"small",step:"1",value:m.toRgb().a,min:0,max:1,controls:!1,formatter:function(v){return Z().round(v*100)+"%"},parser:function(v){return Z().round(v.replace("%","")/100,2)},onChange:function(v){if(v!==null){var X=m.setAlpha(v);r.setColor({color:(0,g.default)(X)})}}})),a.createElement("div",{className:"colorValue",style:{background:this.getStringColor(m)}})))},a.createElement("span",{className:"ColorPicker-input-container",ref:function(v){return r.trigger=v}},(0,a.cloneElement)(de))))}}]),l}(a.Component),B.propTypes={visible:P().bool,children:P().node,className:P().string,value:P().string,onChange:P().func.isRequired,getPopupContainer:P().func,isPopupBody:P().bool,handleClose:P().func,sysColor:P().bool,themeColor:P().string},B.defaultProps={visible:!1,value:"#2196f3",isPopupBody:!1,sysColor:!1,themeColor:"",onChange:function(){},handleClose:function(){}},z=function(){var l=this;this.setRecentColorsLocal=function(o){var r=l.state.recentColors;if(!r.find(function(T){return Q(T,o)})){var u=[];r.length===5?u=Z().slice(r,1,5).concat(o):u=r.concat(o),l.setState({recentColors:u}),localStorage.setItem("recentColorsMing",x()(u))}},this.initValue=function(o){var r=o.startsWith("#");return{color:(0,g.default)(o),type:M[r?0:1]}},this.handleChangeColor=function(o){l.setColor({color:(0,g.default)(o)})},this.setColor=function(o,r){l.setState((0,c.default)({},o),function(){var u=l.state.color.toHex8String();l.props.onChange(r||u)})},this.getPopupContainer=function(){var o=l.props,r=o.isPopupBody,u=o.getPopupContainer;return u?u():r?document.body:document.querySelector(".ColorPickerPanel")},this.getStringColor=function(o){return(0,g.default)(o).toHex8String()},this.getSelectedIconColor=function(o){return(0,g.default)(o).isDark()?"#fff":"rgba(0,0,0,.45)"},this.renderSysColors=function(o,r){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=l.state.color;return a.createElement("div",{className:E()("commonColors",{hide:!o})},r.map(function(D,K){return a.createElement("div",{className:"commonColorItem",style:{background:D},onClick:function(){l.setColor({color:(0,g.default)(D)},u?_[K]:void 0)}},a.createElement("i",{className:E()("icon-done selectedIcon",{hide:!Q(D,T)}),style:{color:l.getSelectedIconColor(D)}}))}))},this.onClose=function(){var o=l.props.handleClose,r=l.state.color.toHex8String();l.setRecentColorsLocal(r),o(r)}},q);const W=f},25096:(ne,R,t)=>{t.d(R,{Z:()=>ce});var j=t(66215),x=t(6100),e=t(25273),L=t(54208),U=t(88106),S=t(88902),c=t.n(S),s=t(88239),H=t(12424),n=t(67294),oe=t(93967),A=t.n(oe),re=t(49365),ae=t(96486),P=t.n(ae),a=t(10593),g=[{label:_l("\u5E38\u7528"),key:"general"},{label:_l("\u529E\u516C"),key:"office"},{label:_l("\u8D22\u52A1"),key:"finance"},{label:_l("\u7269\u4F53"),key:"object"},{label:_l("\u4EBA\u7269"),key:"character"},{label:_l("\u7B26\u53F7"),key:"symbol"},{label:_l("\u81EA\u7136"),key:"nature"},{label:_l("\u670D\u9970"),key:"costume"},{label:_l("\u996E\u98DF"),key:"biteAndSup"},{label:_l("\u6D3B\u52A8"),key:"activity"},{label:_l("\u4EA4\u901A"),key:"traffic"},{label:_l("\u5730\u70B9"),key:"place"}],le=function(){var V=document.querySelector(".iconsScrollViewWrap .isCurrentIcon"),Z=document.querySelector(".iconsScrollViewWrap .nano-content");if(!(!V||!Z)){var y=V.offsetTop;Z.scrollTop=y}};function se(E){var V=E.iconColor,Z=E.hideCustom,y=E.icon,Y=E.projectId,B=E.handleClick,q=(0,n.useState)(!0),z=(0,H.Z)(q,2),M=z[0],_=z[1],ie=(0,n.useState)(0),ee=(0,H.Z)(ie,2),F=ee[0],J=ee[1],Q=(0,n.useState)({isLine:y.startsWith("sys_")?y.endsWith("_line"):!1,currentKey:"general",tab:!y.startsWith("sys_")&&y.length>29?1:0,firstLoad:!0,changeScrollTop:"0"}),te=(0,H.Z)(Q,2),f=te[0],W=te[1],b=(0,n.useState)({systemIconLine:{},systemIcon:{},customIcon:[]}),l=(0,H.Z)(b,2),o=l[0],r=l[1];(0,n.useEffect)(function(){u()},[f.isLine,f.tab]),(0,n.useEffect)(function(){if(!M){if(!f.firstLoad){f.tab===0&&(document.querySelector(".iconsScrollViewWrap .nano-content").scrollTop=f.changeScrollTop);return}W((0,s.default)({},f,{firstLoad:!1})),le()}},[M]);var u=function(){var C=o.systemIconLine,p=o.systemIcon,m=o.customIcon,i=f.isLine,d=f.tab,O=!y.startsWith("sys_")&&y.length>29?1:0;if(!(d===1&&m.length>0||d===0&&i&&c()(C).length>0||d===0&&!i&&c()(p).length>0)){!M&&_(!0);var I={projectId:Y,iconType:d===0};d===0&&(I.isLine=i),re.Z.getIcon(I).then(function(w){var k=d===1?"customIcon":i?"systemIconLine":"systemIcon";r((0,s.default)({},o,(0,U.default)({},k,w))),_(!1)})}},T=function(){g.forEach(function(C,p){g[p].offsetTop=document.getElementById(C.key).offsetTop})},D=P().debounce(function(N){var C=document.querySelector(".iconsScrollViewWrap .nano-content");g[0].hasOwnProperty("offsetTop")||T();var p="general",m=0;g.forEach(function(d,O){C.scrollTop>=d.offsetTop-97&&(p=d.key,m=O)});var i=Math.floor(m/8);i!==F&&J(i),W((0,s.default)({},f,{currentKey:p}))},500),K=function(C){W((0,s.default)({},f,{currentKey:C.key}));var p=document.getElementById(C.key).offsetTop;document.querySelector(".iconsScrollViewWrap .nano-content").scrollTop=p},G=function(){var C=f.isLine,p=f.currentKey,m=C?o.systemIconLine:o.systemIcon;if(M)return n.createElement(L.Z,{className:"mTop10"});if(c()(m).length!==0)return n.createElement(n.Fragment,null,n.createElement(e.Z,{className:"iconsScrollViewWrap",scrollEvent:D,disableParentScroll:!0},n.createElement("div",{className:"systemIcon"},g.map(function(i,d){return n.createElement(n.Fragment,{key:"systemIconType-"+i.key},d!==0&&n.createElement("p",{id:i.key,className:"iconType"},i.label),n.createElement("ul",{className:"iconsWrap",id:d===0?g[0].key:""},m[i.key].map(function(O){var I=O.fileName,w=O.iconUrl,k=y.startsWith("sys_")?y===I:I.replace("sys_","").replace("_line","")===y;return n.createElement("li",{key:I,className:A()({isCurrentIcon:k}),style:{backgroundColor:k?V:"#fff"},onClick:function(){return B({icon:I,iconUrl:w})}},n.createElement("span",{className:I,style:{color:k?"#fff":"#9e9e9e"}}))})))}))),n.createElement("div",{className:"iconTypeList"},F!==0&&n.createElement("div",{className:"preButton",onClick:function(){J(0)}},n.createElement("i",{className:"icon-next-02 font10 Gray_9d"})),n.createElement("div",{className:"iconTypeCon"},n.createElement("ul",{style:{transform:"translateX("+F*-352+"px)"}},g.map(function(i){return n.createElement("li",{className:A()({current:i.key===p}),key:"iconTypeNavList"+i.key,onClick:function(){return K(i)}},i.label)}))),F!==1&&n.createElement("div",{className:"nextButton",onClick:function(){J(1)}},n.createElement("i",{className:"icon-next-02 font10 Gray_9d"}))))},fe=function(){return Z?null:n.createElement(e.Z,{className:"iconsScrollViewWrap"},n.createElement("div",{className:"customIcon"},n.createElement("ul",{className:"iconsWrap"},o.customIcon.map(function(C){var p=C.iconUrl,m=C.fileName,i=y===m;return n.createElement("li",{key:m,className:A()({isCurrentIcon:i}),style:{backgroundColor:i?V:"#fff"},onClick:function(){return B({icon:m,iconUrl:p})}},n.createElement(x.Z,{url:p,fill:i?"#fff":"#9e9e9e"}))}))))};return n.createElement("div",{className:"iconTabs"},n.createElement("div",{className:"navCon"},n.createElement("div",{className:"navTabs"},n.createElement("span",{className:A()("navTab",{active:f.tab===0}),onClick:function(){return f.tab!==0&&W((0,s.default)({},f,{tab:0}))}},_l("\u56FE\u6807")),!Z&&n.createElement("span",{className:A()("navTab",{active:f.tab===1}),onClick:function(){return f.tab!==1&&W((0,s.default)({},f,{tab:1}))}},_l("\u81EA\u5B9A\u4E49"))),f.tab===0&&n.createElement("div",{className:"switchCon"},n.createElement(j.Z,{primaryColor:"#2196f3",checked:f.isLine,onClick:function(C){var p=document.querySelector(".iconsScrollViewWrap .nano-content"),m=(0,s.default)({},f,{isLine:!C,changeScrollTop:p?p.scrollTop:f.scrollTop});if(W(m),!!y.startsWith("sys_")){var i=C?"":"_line",d=y.replace(/(_line)|(_fill)$/,"")+i;y.startsWith("sys_")||(d="sys_"+d),B({icon:d,iconUrl:md.global.FileStoreConfig.pubHost+"/customIcon/"+d+".svg",closeTrigger:!1})}},text:f.isLine?_l("\u7EBF\u6846"):_l("\u586B\u5145")}))),n.createElement("div",{className:"contentCon"},f.tab===0?G():fe()))}const ce=(0,n.memo)(se)},15845:(ne,R,t)=>{t.d(R,{V:()=>e,Z:()=>L});var j=t(96486),x=t.n(j),e="Worksheet";const L={server:function(){return __api_server__.report||md.global.Config.WsReportUrl},ajaxOptions:{url:"",type:"Get",cache:!1,dataType:"json",contentType:"application/json"}}},7452:(ne,R,t)=>{t.d(R,{Z:()=>U});var j=t(63239),x=t.n(j),e=t(15845),L={export:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/export",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportexport",x()(c),$.extend(e.Z,s))},exportReport:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/exportReport",e.Z.ajaxOptions.type="GET",mdyAPI(e.V,"reportexportReport",c,$.extend(e.Z,s))},getReportData:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/get",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportget",x()(c),$.extend(e.Z,s))},getData:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/getData",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportgetData",x()(c),$.extend(e.Z,s))},getFavoriteData:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/getFavoriteData",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportgetFavoriteData",x()(c),$.extend(e.Z,s))},getReportSingleCacheId:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/getReportSingleCacheId",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportgetReportSingleCacheId",x()(c),$.extend(e.Z,s))},getTableData:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/getTableData",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportgetTableData",x()(c),$.extend(e.Z,s))},list:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/list",e.Z.ajaxOptions.type="GET",mdyAPI(e.V,"reportlist",c,$.extend(e.Z,s))},listByPageId:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/listByPageId",e.Z.ajaxOptions.type="GET",mdyAPI(e.V,"reportlistByPageId",c,$.extend(e.Z,s))},refreshData:function(c,s){return e.Z.ajaxOptions.url=e.Z.server()+"/report/refreshData",e.Z.ajaxOptions.type="POST",mdyAPI(e.V,"reportrefreshData",x()(c),$.extend(e.Z,s))}};const U=L}}]);
