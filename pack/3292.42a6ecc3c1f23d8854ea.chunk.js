"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[3292],{43292:(H,C,n)=>{n.r(C),n.d(C,{default:()=>b});var e=n(67294),x=n(25273),R=n(54208),K=n(52262),D=n(65400),p=n(3540),W=n(52945),f=n.n(W),N=n(70801),V=n(85105),k=n.n(V),F=n(99663),T=n(22600),B=n(49135),O=n(93196),v=n(88239),L=n(6100),P=n(66215),E=n(33867),I=n(42723),M=n(93967),y=n.n(M),S=n(95742),Q=n(31261),d=n(61465),U=n(49365),G=n(96486),h=n.n(G),Z=["#e91e63","#ff9800","#4caf50","#00bcd4","#2196f3","#9c27b0","#3f51b5","#455a64"],j=(0,S.W8)(function(u){var r=u.item,m=(0,I.Z)(u,["item"]),t=m.onChangeStatus,a=m.onEdit,l=m.onDelete;return e.createElement("div",{className:"flexRow sourcesItem",key:r.id},e.createElement("div",{className:"valignWrapper"},e.createElement(E.Z,{className:"Font17 Gray_9e pointer",icon:"drag"}),e.createElement(P.Z,{className:"mLeft10",checked:r.status===1,onClick:function(c){t(r.id,c)}})),e.createElement("div",null,e.createElement(L.Z,{size:"22",fill:r.color,url:r.iconUrl})),e.createElement("div",null,r.name),e.createElement("div",{className:"url ellipsis"},r.linkParams?r.linkParams.url:"-"),e.createElement("div",null,e.createElement("span",{className:r.predefined?"Gray_9e":"edit pointer",onClick:function(){a(r.id)}},_l("\u7F16\u8F91")),!r.predefined&&e.createElement("span",{className:"edit pointer mLeft20",onClick:function(){l(r.id)}},_l("\u5220\u9664"))))}),z=(0,S.JN)(function(u){var r=u.sourcesList,m=(0,I.Z)(u,["sourcesList"]);return e.createElement("div",null,r.map(function(t,a){return e.createElement(j,(0,v.default)({key:t.id,index:a,item:t},m))}))}),J=function(u){(0,O.default)(r,u);function r(m){(0,F.default)(this,r);var t=(0,B.default)(this,(r.__proto__||k()(r)).call(this,m));return t.handleSortEnd=function(a){var l=a.oldIndex,s=a.newIndex;if(l!==s){var c=t.state.sourcesList,o=(0,S.Rp)(c,l,s),i={};t.setState({sourcesList:o}),o.forEach(function(g,A){i[g.id]=A}),d.Z.editSourceSort({sortMap:i}).then(function(g){})}},t.handleChangeStatus=function(a,l){var s=t.state.sourcesList,c=l?2:1;d.Z.editSourceStatus({id:a,status:c}).then(function(o){o&&t.setState({sourcesList:s.map(function(i){return i.id===a&&(i.status=c),i})})})},t.handleEdit=function(a){var l=t.state.sourcesList,s=h().find(l,{id:a});t.setState({dialogVisible:!0,creatreItem:{id:a,name:s.name,color:s.color,icon:s.icon,url:s.linkParams.url}})},t.handleDelete=function(a){var l=t.state.sourcesList;N.Z.confirm({title:_l("\u60A8\u786E\u5B9A\u8981\u5220\u9664 ?"),description:_l("\u5220\u9664\u540E\u65E0\u6CD5\u6062\u590D"),onOk:function(){d.Z.removeSource({id:a}).then(function(c){c&&(alert(_l("\u5220\u9664\u6210\u529F")),t.setState({sourcesList:l.filter(function(o){return o.id!==a})}))})}})},t.handleSave=function(){var a=t.state,l=a.creatreItem,s=a.systemIcon;if(h().isEmpty(l.name)){alert(_l("\u8BF7\u8F93\u5165\u540D\u79F0"));return}if(h().isEmpty(l.url)){alert(_l("\u8DF3\u8F6C\u94FE\u63A5"));return}var c={name:l.name,color:l.color,icon:l.icon,linkParams:{url:l.url}};l.id?d.Z.editSource((0,v.default)({id:l.id},c)).then(function(o){o&&t.setState({creatreItem:{},dialogVisible:!1,sourcesList:t.state.sourcesList.map(function(i){return i.id===l.id?(0,v.default)({},i,c,{iconUrl:h().find(s,{fileName:c.icon}).iconUrl}):i})})}):d.Z.addSource((0,v.default)({},c)).then(function(o){o&&(t.setState({dialogVisible:!1,creatreItem:{}}),t.getSources())})},t.shouldCancelStart=function(a){var l=a.target;return!l.classList.contains("icon-drag")},t.state={dialogVisible:!1,sourcesList:[],listLoading:!1,creatreItem:{},systemIcon:[]},t}return(0,T.default)(r,[{key:"componentDidMount",value:function(){var t=this;this.getSources(),U.Z.getIcon({iconType:!0,isLine:!1}).then(function(a){var l=a.general;t.setState({systemIcon:l,creatreItem:{color:Z[0],icon:l[0].fileName}})})}},{key:"getSources",value:function(){var t=this;this.setState({listLoading:!0}),d.Z.getSources().then(function(a){t.setState({listLoading:!1,sourcesList:a})})}},{key:"renderDialog",value:function(){var t=this,a=this.state,l=a.dialogVisible,s=a.creatreItem,c=a.systemIcon;return e.createElement(N.Z,{className:"createSourcesDialog",visible:l,title:s.id?_l("\u7F16\u8F91\u8D44\u6E90"):_l("\u6DFB\u52A0\u8D44\u6E90"),width:520,okText:_l("\u4FDD\u5B58"),onOk:this.handleSave,onCancel:function(){return t.setState({dialogVisible:!1})}},e.createElement("div",{className:"mBottom10 mTop15 Font14"},_l("\u540D\u79F0")),e.createElement("div",{className:"flexRow valignWrapper"},e.createElement(p.Z,{className:"w100",value:s.name,onChange:function(i){t.setState({creatreItem:f()({},s,{name:i})})}})),e.createElement("div",{className:"mBottom10 mTop15 Font14"},_l("\u8DF3\u8F6C\u94FE\u63A5")),e.createElement("div",{className:"flexRow valignWrapper"},e.createElement(p.Z,{className:"w100",value:s.url,onChange:function(i){t.setState({creatreItem:f()({},s,{url:i})})}})),e.createElement("div",{className:"mBottom10 mTop15 Font14"},_l("\u8BBE\u8BA1\u56FE\u6807")),e.createElement("div",{className:"flexRow valignWrapper"},Z.map(function(o,i){return e.createElement("div",{key:i,style:{backgroundColor:o},className:y()("sourcesColor flexRow valignWrapper",{active:o==s.color}),onClick:function(){t.setState({creatreItem:f()({},s,{color:o})})}},o==s.color&&e.createElement(E.Z,{className:"Font17 White",icon:"done"}))})),e.createElement("div",{className:"flexRow valignWrapper mTop15 sourcesIconWrapper"},c.map(function(o,i){return e.createElement("div",{key:i,style:{backgroundColor:s.icon==o.fileName?s.color:null},className:y()("sourcesIcon flexRow valignWrapper pointer"),onClick:function(){t.setState({creatreItem:f()({},s,{icon:o.fileName})})}},e.createElement(L.Z,{url:o.iconUrl,fill:s.icon==o.fileName?"#fff":"#9e9e9e"}))})))}},{key:"render",value:function(){var t=this,a=this.state,l=a.sourcesList,s=a.listLoading;return e.createElement(e.Fragment,null,e.createElement("div",{className:"sourceListContent flex flexColumn h100"},e.createElement("div",null,e.createElement(D.default,{type:"primary",onClick:function(){t.setState({dialogVisible:!0})}},e.createElement(E.Z,{icon:"add"}),_l("\u6DFB\u52A0\u8D44\u6E90"))),e.createElement("div",{className:"flexRow titleWrapper"},e.createElement("div",{className:"title showItem"},_l("\u72B6\u6001")),e.createElement("div",{className:"title"},_l("\u56FE\u6807")),e.createElement("div",{className:"title"},_l("\u540D\u79F0")),e.createElement("div",{className:"title url"},_l("\u8DF3\u8F6C\u5730\u5740")),e.createElement("div",{className:"title"},_l("\u64CD\u4F5C"))),e.createElement(x.Z,{className:"flex"},s?e.createElement("div",{className:"mTop5"},e.createElement(R.Z,{size:"small"})):e.createElement(z,{axis:"xy",helperClass:"sourcesSortableCard",sourcesList:l,onSortEnd:this.handleSortEnd,onChangeStatus:this.handleChangeStatus,onEdit:this.handleEdit,onDelete:this.handleDelete,shouldCancelStart:this.shouldCancelStart}))),this.renderDialog())}}]),r}(e.Component),$=function(r){return e.createElement("div",{className:"privateCardWrap flexColumn h100 mBottom20"},e.createElement("div",{className:"Font17 bold mBottom8"},_l("\u8D44\u6E90")),e.createElement("div",{className:"Gray_9e mBottom28"},_l("\u53EF\u81EA\u5B9A\u4E49\u5DE5\u4F5C\u53F0\u663E\u793A\u7684\u8D44\u6E90\u5217\u8868\u9879")),e.createElement(J,null))};const b=$}}]);
