"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[9664],{60876:(X,P,e)=>{e.d(P,{$B:()=>F,s3:()=>$,tg:()=>R});var v=e(349),S=e.n(v),g=e(85105),L=e.n(g),Y=e(72444),k=e(88239),N=e(88902),C=e.n(N),W=e(96486),O=e.n(W),$=function(u){return O().get(u,["match","params"])},J=function(u){return _.flatten(_Object$keys(u).map(function(I){var h=u[I];return _.includes(["validProject"],I)?h.map(function(j){return _extends({type:I},j)}):_.includes(["aloneApps"],I)?{type:I,projectApps:h}:h.length?{type:I,projectApps:h}:null})).filter(function(I){return!!I})},G=function(u){if((typeof u>"u"?"undefined":(0,Y.default)(u))!=="object"||u===null)return!1;for(var I=u;L()(I)!==null;)I=L()(I);return L()(u)===I},R=function A(){for(var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:C()(u),j=0;j<h.length;j++){var Z=h[j],D=u[Z],H=I[Z];if(G(D)&&G(H))return A(D,H,C()(D));if(!S()(D,H))return!0}return!1},F=function(u){var I=u.isGoodsStatus,h=u.isNew,j=u.fixed,Z=u.isUpgrade;return I?Z?_l("\u5347\u7EA7\u4E2D"):j?_l("\u7EF4\u62A4\u4E2D%01018"):h?_l("\u65B0 !"):null:_l("\u8FC7\u671F")},B=function(u,I){switch(I){case APP_ROLE_TYPE.POSSESS_ROLE:break;case APP_ROLE_TYPE.ADMIN_ROLE:u=_.filter(u,function(h){return!_.includes(["del"],h.type)});break;case APP_ROLE_TYPE.RUNNER_ROLE:u=_.filter(u,function(h){return _.includes(["modify","editIntro","appAnalytics","appLogs","modifyAppLockPassword"],h.type)});break;case APP_ROLE_TYPE.DEVELOPERS_ROLE:u=_.filter(u,function(h){return!_.includes(["copy","export","appAnalytics","appLogs","del"],h.type)});break;case APP_ROLE_TYPE.RUNNER_DEVELOPERS_ROLE:u=_.filter(u,function(h){return!_.includes(["copy","export","del"],h.type)});break;default:break}return u}},44263:(X,P,e)=>{e.d(P,{O$:()=>S,ju:()=>g});var v=30,S=40,g=[{title:_l("\u5F53\u524D\u7528\u6237\u4FE1\u606F"),type:"user",fields:[{text:_l("\u7528\u6237ID"),value:"userId"},{text:_l("\u624B\u673A\u53F7"),value:"phone"},{text:_l("\u90AE\u7BB1"),value:"email"}]},{title:_l("\u7CFB\u7EDF\u4FE1\u606F"),type:"sys",fields:[{text:_l("\u7EC4\u7EC7\u95E8\u724C\u53F7"),value:"projectId"},{text:_l("\u5E94\u7528ID"),value:"appId"},{text:_l("\u5206\u7EC4ID"),value:"groupId"},{text:_l("\u5E94\u7528\u9879ID"),value:"itemId"},{text:_l("UserAgent"),value:"ua"},{text:_l("\u65F6\u95F4\u6233"),value:"timestamp"}]}]},82134:(X,P,e)=>{e.r(P),e.d(P,{addWidget:()=>L,copyWidget:()=>k,delWidget:()=>Y,deleteLinkageFiltersGroup:()=>u,insertTitle:()=>G,updateComponents:()=>F,updateEditPageVisible:()=>W,updateFiltersGroup:()=>B,updateLayout:()=>O,updateLinkageFiltersGroup:()=>A,updateLoading:()=>$,updateModified:()=>R,updatePageInfo:()=>g,updateSaveLoading:()=>J,updateWidget:()=>C,updateWidgetVisible:()=>N});var v=e(79778),S=function(h){return function(j){return{type:h,payload:j}}},g=S(v.sl),L=S(v.hr),Y=S(v.C$),k=S(v.jL),N=S(v._P),C=S(v.hc),W=S(v.S8),O=S(v.Rm),$=S(v.CM),J=S(v.Yz),G=S(v.pb),R=S(v.$z),F=S(v.nj),B=S(v.S0),A=S(v.Rl),u=S(v.qb)},42602:(X,P,e)=>{e.r(P),e.d(P,{addAppSection:()=>St,addFirstAppSection:()=>it,addWorkSheet:()=>K,clearSheetList:()=>dt,copyCustomPage:()=>ht,copySheet:()=>ft,createAppItem:()=>vt,deleteSheet:()=>It,formatLeftSectionDetail:()=>D,getAllAppSectionDetail:()=>at,getSheetList:()=>et,moveSheet:()=>st,refreshSheetList:()=>nt,sortSheetList:()=>ct,updateALLSheetList:()=>V,updateAppItemInfo:()=>lt,updateGuidanceVisible:()=>M,updateSheetIconColor:()=>pt,updateSheetList:()=>rt,updateSheetListAppItem:()=>ot,updateSheetListIsUnfold:()=>ut,updateSheetListLoading:()=>tt});var v=e(52945),S=e.n(v),g=e(88239);if(!/^(1887|7596|7798)$/.test(e.j))var L=e(22013);if(!/^(1887|7596|7798)$/.test(e.j))var Y=e(45231);if(!/^(1887|7596|7798)$/.test(e.j))var k=e(91088);if(!/^(1887|7596|7798)$/.test(e.j))var N=e(49365);if(!/^(1887|7596|7798)$/.test(e.j))var C=e(75599);var W=e(7145),O=e.n(W),$=e(96486),J=e.n($);if(!/^(1887|7596|7798)$/.test(e.j))var G=e(36021);if(!/^(1887|7596|7798)$/.test(e.j))var R=e(70973);if(!/^(1887|7596|7798)$/.test(e.j))var F=e(15308);if(!/^(1887|7596|7798)$/.test(e.j))var B=e(73820);if(!/^(1887|7596|7798)$/.test(e.j))var A=e(82134);if(!/^(1887|7596|7798)$/.test(e.j))var u=e(40979);if(!/^(1887|7596|7798)$/.test(e.j))var I=e(89499);if(!/^(1887|7596|7798)$/.test(e.j))var h=e(97592);var j=e(30381),Z=e.n(j),D=function(n){return n.workSheetInfo.map(function(o){var a=(0,g.default)({},o);if(o.type===2){var p=_.find(n.childSections,{appSectionId:o.workSheetId})||{},r=p.workSheetInfo,i=r===void 0?[]:r,d=p.appSectionId;a.items=i.map(function(l){return l.parentGroupId=d,l})}return a})},H=void 0;function et(t){return function(n,o){if(n({type:"SHEET_LIST_UPDATE_LOADING",loading:!0}),n({type:"SHEET_LIST",data:[]}),H)try{H.abort()}catch(a){}H=k.Z.getAppSectionDetail(t),H.then(function(a){if(_.isEmpty(a)){n({type:"WORKSHEET_APP_SECTION_FAILURE"});return}var p=(0,R.le)(a.appRoleType,a.isLock),r=D(a);a.workSheetInfo.length&&n({type:"SHEET_LIST",data:r});var i=o().sheet.base.worksheetId,d=L.Z.getState().appPkg.currentPcNaviStyle,l=_.find(a.workSheetInfo,{workSheetId:i})||{},f=Z()(md.global.Account.createTime).add(7,"days").format("YYYY-MM-DD"),c=Z()().isBefore(f);if(p&&c&&l.type===0&&d===0&&n(M()),[1,3].includes(d)){var s=L.Z.getState().sheetList.appSectionDetail,m=a.appSectionId,y=s.map(function(T){return T.workSheetId===m?(0,g.default)({},T,{items:r}):T});L.Z.dispatch(V(y))}n({type:"SHEET_LIST_UPDATE_LOADING",loading:!1})})}}function nt(){return function(t,n){var o=n().sheet.base,a=o.appId,p=o.groupId;k.Z.getAppSectionDetail({appId:a,appSectionId:p}).then(function(r){r.workSheetInfo.length&&t({type:"SHEET_LIST",data:D(r)})})}}function at(t,n){return function(o,a){k.Z.getApp({appId:t,getSection:!0}).then(function(p){var r=p.permissionType,i=p.isLock,d=p.sections,l=d===void 0?[]:d,f=(0,R.le)(r,i),c=f?l:l.map(function(s){return(0,g.default)({},s,{workSheetInfo:s.workSheetInfo.filter(function(m){return[1,4].includes(m.status)&&!m.navigateHide})})}).filter(function(s){return s.workSheetInfo&&s.workSheetInfo.length>0});o((0,F.updateIsCharge)(f)),o((0,B.mB)(c)),o((0,F.updateAppPkgData)({appRoleType:r,isLock:i})),o(V(c.map(function(s){return(0,g.default)({},s,{workSheetId:s.appSectionId,workSheetName:s.name,type:2,layerIndex:0,items:D(s)})}))),o(tt(!1)),n&&n()})}}function ot(t,n){return function(o,a){var p=a().sheetList.data,r=function d(l){return l.map(function(f){return f.workSheetId===t?(0,g.default)({},f,n):(0,g.default)({},f,{items:d(f.items||[])})})},i=r(p);o({type:"SHEET_LIST",data:i})}}function rt(t){return{type:"SHEET_LIST",data:t}}function V(t){return{type:"SHEET_ALL_LIST",data:t}}function it(){return function(t,n){var o=n(),a=o.appPkg,p=o.sheetList,r=p.appSectionDetail.map(function(d){return(0,g.default)({},d,{items:(0,h.MR)(d.workSheetId)})}),i=_l("\u672A\u547D\u540D\u5206\u7EC4");if(r.length===1&&_.isEmpty(r[0].name)){t(V(r.map(function(d){return S()(d,{edit:!0,name:i})})));return}k.Z.addAppSection({appId:a.id,name:i}).then(function(d){if(d.data){var l=r.concat({name:i,workSheetId:d.data,edit:!0,items:[]});t(V(l))}})}}function dt(){return{type:"SHEET_LIST",data:[]}}function pt(t){return function(n,o){var a=o().sheetList.data,p=a.map(function(r){return r.iconColor=t,r});n({type:"SHEET_LIST",data:p})}}function ut(t){return function(n,o){n(t?{type:"SHEET_LIST_UPDATE_IS_UNFOLD",isUnfold:!0}:{type:"SHEET_LIST_UPDATE_IS_UNFOLD",isUnfold:!1})}}function lt(t,n,o){return function(a,p){a(n?(0,A.updatePageInfo)({pageName:o}):(0,F.updateWorksheetInfo)({name:o}))}}function ft(t,n){return function(o,a){var p=L.Z.getState().appPkg.projectId,r=(0,g.default)({},t,{chargeId:md.global.Account.accountId,projectId:p,isCopyBtnName:!0,isCopyDesc:!0,isCopyMember:!0,isCopyAdmin:!0,type:0}),i=n.parentGroupId;i&&(r.appSectionId=i,delete n.parentGroupId),Y.Z.copyWorksheet(r).then(function(d){if(d){alert(_l("\u590D\u5236\u6210\u529F"));var l=(0,g.default)({workSheetId:d,workSheetName:r.name,type:0,status:1},n),f=a().sheetList.data;i?(l.parentGroupId=i,o({type:"ADD_LEFT_SUB_ITEM",data:{id:i,data:l}})):o({type:"SHEET_LIST",data:O()(f,{$push:[l]})})}else alert(_l("\u590D\u5236\u5931\u8D25"),2)})}}function st(t){return function(n,o){var a=o().sheetList.data,p=t.sourceAppId,r=t.sourceAppSectionId,i=t.ResultAppSectionId,d=t.workSheetsInfo[0],l=d.workSheetId,f=d.parentGroupId,c=null,s=[];f?(t.sourceAppSectionId=f,c=a.map(function(m){return m.workSheetId===f&&(m.items=m.items.filter(function(y){return y.workSheetId!==l})),m})):(s=_.get(_.find(a,{workSheetId:l}),"items")||[],c=a.filter(function(m){return m.workSheetId!==l})),N.Z.removeWorkSheetAscription(t).then(function(m){if(m){var y=L.Z.getState(),T=y.sheet,w=y.appPkg,U=T.base,E=U.appId,x=U.worksheetId,Q=U.groupId,b=_.find(c,{workSheetId:i});if(b&&(d.parentGroupId=b.workSheetId,b.items=b.items.concat(d)),Q===i&&(d.parentGroupId=void 0,c.push(d)),n({type:"SHEET_LIST",data:c}),l===x||_.find(s,{workSheetId:x}))if(c.length){var z=(0,I.h2)(c);(0,G.T8)("/app/"+p+"/"+r+"/"+(z||""))}else(0,G.T8)("/app/"+p+"/"+r);(!i||[1,3].includes(w.currentPcNaviStyle))&&window.updateAppGroups(),(0,I.oS)(E,r),alert(_l("\u79FB\u52A8\u6210\u529F"))}else alert(_l("\u79FB\u52A8\u5931\u8D25"),2)})}}function It(t){var n=t.appId,o=t.groupId,a=t.worksheetId,p=t.projectId,r=t.type,i=t.parentGroupId;return function(d,l){var f=l().sheetList.data,c=function(m){if(m){var y=null;if(i)y=f.map(function(E){return E.workSheetId===i&&(E.items=E.items.filter(function(x){return x.workSheetId!==a})),E});else{var T=r===2?_.find(f,{workSheetId:a}).items||[]:[];y=f.filter(function(E){return E.workSheetId!==a}),y=y.concat(T.map(function(E){return(0,g.default)({},E,{parentGroupId:void 0})}))}d({type:"SHEET_LIST",data:y});var w=L.Z.getState().sheet.base.worksheetId;if(a===w)if(y.length){var U=(0,I.h2)(y);(0,G.T8)("/app/"+n+"/"+o+"/"+(U||""))}else(0,G.T8)("/app/"+n+"/"+o);alert(_l("\u5220\u9664\u6210\u529F"))}else alert(_l("\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),2)};r===2?k.Z.deleteAppSection({appId:n,appSectionId:a}).then(function(s){s.code===1&&c(s)}):N.Z.removeWorkSheetForApp({appId:n,projectId:p,type:r,isPermanentlyDelete:!1,appSectionId:i||o,workSheetId:a}).then(function(s){s&&((0,I.oS)(n,o),c(s))})}}function ct(t,n,o){return function(a,p){a({type:"SHEET_LIST",data:o}),k.Z.updateSectionChildSort({appId:t,appSectionId:n,workSheetIds:o.filter(_.identity).map(function(r){return r.workSheetId})}).then(function(r){})}}function M(t){return function(n,o){var a=md.global.Account.accountId+"-guidanceHide";_.isBoolean(t)?(C.Z.add({key:a,value:"true"},{silent:!0}).then(function(p){}),n({type:"GUIDANCE_VISIBLE",value:t})):C.Z.get({key:a}).then(function(p){p||n({type:"GUIDANCE_VISIBLE",value:!0})})}}function K(t,n){return function(o,a){var p=t.appId,r=t.appSectionId,i=t.firstGroupId,d=t.name,l=t.projectId,f=t.type;N.Z.addWorkSheet((0,g.default)({},t,{icon:f===0?"table":"dashboard"})).then(function(c){var s=c.pageId,m=c.workSheetId,y=c.templateId;if(f===1&&s){n(c);var T=(0,g.default)({workSheetName:t.name,workSheetId:s,navigateHide:!1,status:1},(0,$.pick)(t,["icon","iconColor","iconUrl","type","configuration","urlTemplate","createType"]));i?(T.parentGroupId=t.appSectionId,o({type:"ADD_LEFT_SUB_ITEM",data:{id:r,data:T}})):o({type:"ADD_LEFT_ITEM",data:T});return}m?(0,u.zF)({sourceName:d,templateId:y,sourceId:m,projectId:l,appconfig:{appId:p,appSectionId:i||r}}):(alert(_l("\u521B\u5EFA\u5DE5\u4F5C\u8868\u5931\u8D25"),2),n&&n(c))}).catch(function(c){n&&n()})}}function St(t,n){return function(o,a){var p=t.appId,r=t.groupId,i=_l("\u672A\u547D\u540D\u5206\u7EC4"),d="8_4_folder",l=md.global.FileStoreConfig.pubHost+"customIcon/"+d+".svg";k.Z.addAppSection({appId:p,name:i,icon:d,parentId:r,rootId:r}).then(function(f){f.data&&o({type:"ADD_LEFT_ITEM",data:{workSheetName:i,workSheetId:f.data,navigateHide:!1,status:1,type:2,icon:d,iconUrl:l,items:[],edit:!0}})})}}var q=!1;function vt(t){return function(n,o){var a=t.appId,p=t.firstGroupId,r=t.groupId,i=t.type,d=t.name,l=t.configuration,f=t.urlTemplate;md.global.Account.isPortal&&(a=md.global.Account.appId);var c=L.Z.getState().appPkg,s=c.iconColor,m=c.projectId,y=i==="worksheet"?0:1,T=i==="customPage"?"dashboard":"table",w=md.global.FileStoreConfig.pubHost+"customIcon/"+T+".svg",U={appId:a,appSectionId:r,firstGroupId:p,name:d,iconColor:s,projectId:m,icon:T,iconUrl:w,type:y,configuration:l,urlTemplate:f,createType:y===1?f?1:0:void 0},E=function(Q){q=!1;var b=Q||{},z=b.pageId;i==="customPage"&&z&&((0,G.T8)("/app/"+a+"/"+(p||r)+"/"+z),L.Z.dispatch((0,A.updatePageInfo)({pageName:d,pageId:z})),f||L.Z.dispatch((0,A.updateEditPageVisible)(!0)))};q=!0,n(K(U,E))}}function ht(t,n){return function(o,a){var p=a(),r=p.sheetList,i=t.parentGroupId;i&&(t.appSectionId=i,delete t.parentGroupId),N.Z.copyCustomPage(t).then(function(d){if(d){alert(_l("\u590D\u5236\u6210\u529F"));var l=(0,g.default)({workSheetId:d,workSheetName:t.name,type:1,status:1,icon:t.icon||"1_0_home",iconColor:t.iconColor||"#616161",iconUrl:t.iconUrl},n);i?(l.parentGroupId=i,o({type:"ADD_LEFT_SUB_ITEM",data:{id:i,data:l}})):o({type:"ADD_LEFT_ITEM",data:l})}else alert(_l("\u590D\u5236\u5931\u8D25"),2)})}}var tt=function(n){return{type:"SHEET_LIST_UPDATE_LOADING",loading:n}}}}]);
