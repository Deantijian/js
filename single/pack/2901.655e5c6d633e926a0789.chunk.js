"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[2901],{68761:(qe,ce)=>{var u;u=!0,ce.Z=R;function X(L,y){return L===y?L!==0||y!==0||1/L===1/y:L!==L&&y!==y}function R(L,y){if(X(L,y))return!0;if(typeof L!="object"||L===null||typeof y!="object"||y===null)return!1;var V=Object.keys(L),q=Object.keys(y);if(V.length!==q.length)return!1;for(var J=0;J<V.length;J++)if(!Object.prototype.hasOwnProperty.call(y,V[J])||!X(L[V[J]],y[V[J]]))return!1;return!0}},42901:(qe,ce,u)=>{u.r(ce),u.d(ce,{default:()=>cn});var X={};u.r(X),u.d(X,{ADD_PARENT_CHILDREN:()=>fe,ADD_STRUCTURES:()=>K,CLEAR_HIGHLIGHT:()=>Re,CLOSE_COLLAPSE:()=>re,FETCH_PARENT:()=>Lt,OPEN_COLLAPSE:()=>pe,REMOVE_PARENT_CHILDREN:()=>oe,REMOVE_STRUCTURE:()=>Ne,REPLACE_STRUCTURE:()=>St,SUBORDINATES_FAILURE:()=>_e,SUBORDINATES_REQUEST:()=>he,SUBORDINATES_SUCCESS:()=>Tt,UPDATE_CURRENT_CHILDREN:()=>Se,UPDATE_ENTITY_CHILDS:()=>Q,UPDATE_FIRST_LEVEL_LOADING:()=>ge,UPDATE_HIGHLIGHT:()=>ve,UPDATE_IS_LOADING:()=>le,addSubordinates:()=>Pe,fetchParent:()=>xt,fetchRootSubordinates:()=>Ee,fetchSubordinates:()=>ee,initRoot:()=>De,loadMore:()=>Ue,removeStructure:()=>He,replaceStructure:()=>Fe,updateCollapse:()=>ie});var R=u(69288),L=u(54208),y=u(12424),V=u(46593),q=u.n(V),J=u(85105),j=u.n(J),D=u(99663),P=u(22600),F=u(49135),H=u(93196),t=u(67294),B=u(59911),h=u(88239),et=u(93967),b=u.n(et),de=u(86515),tt=u(36964),nt=u.n(tt),at=u(72557),Z=u(15577),rt=u(86559),ye=u(36021),ot=u(96486),N=u.n(ot),lt=function(c){(0,H.default)(a,c);function a(){(0,D.default)(this,a);var o=(0,F.default)(this,(a.__proto__||j()(a)).call(this));return o.state={password:"",disabled:!1},o}return(0,P.default)(a,[{key:"handleSubmit",value:function(){var e=this;this.setState({disabled:!0});var n=this.props,r=n.projectId,l=n.companyName,i=N().throttle(function(s){s.ret===0&&B.Z.validateExitProject({password:(0,Z.HI)(e.state.password),projectId:r,ticket:s.ticket,randStr:s.randstr,captchaType:md.global.getCaptchaType()}).then(function(d){d===2?(alert(_l("\u5BC6\u7801\u9519\u8BEF"),3),$("inputBox").val("").focus()):d===4?R.Z.confirm({title:t.createElement("spam",{className:"Font15 Bold"},_l("\u60A8\u662F\u7EC4\u7EC7\u3010%0\u3011\u8D85\u7EA7\u7BA1\u7406\u5458",l)),description:t.createElement("span",{className:"Font13 Gray"},_l("\u8BF7\u5148\u6CE8\u9500\u7EC4\u7EC7\u6216\u4EA4\u63A5\u540E\u65B9\u53EF\u6CE8\u9500\u3002")),okText:_l("\u524D\u5F80\u6CE8\u9500"),showCancel:!1,onOk:function(){(0,ye.T8)("/admin/sysinfo/"+r)}}):(e.props.closeDialog(),e.props.transferAdminProject(r,l,e.state.password,d))}).finally(function(){e.setState({disabled:!1})})},1e4,{leading:!0});md.global.getCaptchaType()===1?new rt.Z(i):new TencentCaptcha(md.global.Config.CaptchaAppId.toString(),i).show()}},{key:"render",value:function(){var e=this,n=this.state.disabled;return t.createElement("div",{className:"pTop15 pBottom15 TxtLeft"},t.createElement("div",{className:"mBottom15"},t.createElement(at.Z,{onChange:function(l){var i=l.password;return e.setState({password:i})}})),t.createElement("div",null,t.createElement("button",{type:"button",disabled:n,className:b()("btn ming Button Button--primary w100",{"Button--disabled":n}),onClick:function(){n||e.handleSubmit()}},_l("\u786E\u8BA4"))))}}]),a}(t.Component),ue=u(75809),it=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.toLogout=function(){var n=e.props,r=n.projectId,l=n.companyName;R.Z.confirm({title:t.createElement("spam",{className:"Font15 Bold"},_l("\u60A8\u662F\u7EC4\u7EC7\u3010%0\u3011\u8D85\u7EA7\u7BA1\u7406\u5458",l)),description:t.createElement("span",{className:"Font13 Gray"},_l("\u8BF7\u5148\u6CE8\u9500\u7EC4\u7EC7\u6216\u4EA4\u63A5\u540E\u65B9\u53EF\u6CE8\u9500\u3002")),okText:_l("\u524D\u5F80\u6CE8\u9500"),showCancel:!1,onOk:function(){navigateTo("/admin/sysinfo/"+r)}})},e.state={userInfo:{}},e}return(0,P.default)(a,[{key:"handleSelct",value:function(){var e=this;(0,ue.Z)({title:_l("\u6307\u5B9A\u7BA1\u7406\u5458"),zIndex:100,showMoreInvite:!1,SelectUserSettings:{projectId:this.props.projectId,filterAll:!0,filterFriend:!0,filterOtherProject:!0,filterAccountIds:[md.global.Account.accountId],unique:!0,callback:function(r){e.setState({userInfo:r[0]})}}})}},{key:"handleExit",value:function(){var e=this,n=this.state.userInfo.accountId;if(this.props.needTransfer&&!n){alert("\u8BF7\u6307\u5B9A\u6210\u5458");return}var r=$("#submitBtn");r.removeClass("Button--primary").addClass("Button--disabled").prop("disabled",!0),B.Z.exitProject({projectId:this.props.projectId,newAdminAccountId:n}).then(function(l){switch(l){case 1:alert(_l("\u9000\u51FA\u6210\u529F")),e.props.closeDialog(),e.props.getData();break;case 3:e.props.transferAdminProject(e.props.projectId,e.props.companyName,thi.props.password,l);break;case 4:e.toLogout();break;case 2:default:alert(_l("\u64CD\u4F5C\u5931\u8D25"),3);break}}).finally(function(){r.addClass("Button--primary").removeClass("Button--disabled").prop("disabled",!1)})}},{key:"render",value:function(){var e=this,n=this.props,r=n.needTransfer,l=n.companyName,i=this.state.userInfo;return t.createElement(t.Fragment,null,r?t.createElement("div",{className:"mTop15 mBottom20 borderBox"},t.createElement("p",null,_l("\u4F60\u662F\u8BE5\u7EC4\u7EC7\u552F\u4E00\u7BA1\u7406\u5458\uFF0C\u9700\u8981\u5148\u79FB\u4EA4\u7BA1\u7406\u8EAB\u4EFD\u518D\u9000\u51FA")),t.createElement("p",null,_l("\u9000\u51FA\u540E\uFF0C\u7BA1\u7406\u5458\u53EF\u4EE5\u5728\u540E\u53F0\u4EA4\u63A5\u6216\u5206\u914D\u60A8\u8D1F\u8D23\u7684\u5269\u4F59\u5DE5\u4F5C")),t.createElement("div",null,t.createElement("span",{className:"icon-addapplication Font32 ThemeColor3 ThemeHoverColor2 TxtMiddle Hand",onClick:function(){return e.handleSelct()}}),i.accountId?t.createElement("span",{className:"userTag TxtMiddle"},t.createElement("span",{className:"user","data-accountid":i.accountId},t.createElement("img",{src:i.avatar}),t.createElement("span",{className:"userfullname"},(0,Z.u1)(i.fullname)))):t.createElement("span",{className:"userTag TxtMiddle"},_l("\u672A\u6307\u5B9A"))),t.createElement("button",{type:"button",className:"ming Button Button--primary Button--medium w100 exitProject",onClick:function(){return e.handleExit()}},_l("\u786E\u5B9A"))):t.createElement("div",{className:"mTop15 mBottom20 borderBox"},t.createElement("p",null,_l("\u4F60\u786E\u8BA4\u8981\u9000\u51FA\uFF1A%0 ?",l)),t.createElement("p",null,_l("\u9000\u51FA\u540E\uFF0C\u7BA1\u7406\u5458\u53EF\u4EE5\u5728\u540E\u53F0\u4EA4\u63A5\u6216\u5206\u914D\u60A8\u8D1F\u8D23\u7684\u5269\u4F59\u5DE5\u4F5C")),t.createElement("button",{type:"button",id:"submitBtn",className:"ming Button Button--primary Button--medium w100 exitProject",onClick:function(){return e.handleExit()}},_l("\u786E\u5B9A"))))}}]),a}(t.Component),dn=u(67272),st=u(51024),ct=[{label:_l("\u59D3\u540D"),key:"fullname"},{label:_l("\u90E8\u95E8"),key:"departmentInfos"},{label:_l("\u804C\u4F4D"),key:"jobInfos"},{label:_l("\u5DE5\u4F5C\u5730\u70B9"),key:"workSite"},{label:_l("\u5DE5\u53F7"),key:"jobNumber"}],dt=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.state={contactPhone:e.props.userInfo.contactPhone},e}return(0,P.default)(a,[{key:"renderResult",value:function(e){var n=this.props.userInfo,r=n[e.key];switch(e.key){case"departmentInfos":return r.length?this.getItems(r,"departmentName"):_l("\u672A\u586B\u5199");case"jobInfos":return r.length?this.getItems(r,"jobName"):_l("\u672A\u586B\u5199");default:return r||_l("\u672A\u586B\u5199")}}},{key:"getItems",value:function(e,n){var r=e.map(function(l){return l[n]});return r.join(" ; ")}},{key:"handleSubmit",value:function(){var e=this,n=this.props,r=n.userInfo,l=n.updateData,i=l===void 0?function(){}:l;if(!this.state.contactPhone){alert(_l("\u5DE5\u4F5C\u7535\u8BDD\u4E0D\u80FD\u4E3A\u7A7A"),2);return}B.Z.editUserCardContactPhone({projectId:this.props.userInfo.projectId,contactPhone:this.state.contactPhone}).then(function(s){s?(e.props.closeDialog(),alert(_l("\u4FDD\u5B58\u6210\u529F")),i((0,h.default)({},r,{contactPhone:e.state.contactPhone}))):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})}},{key:"render",value:function(){var e=this,n=this.state.contactPhone;return t.createElement("div",{className:"editEnterpriseCardInfo clearfix"},t.createElement("div",{className:"Font17 Bold Gray"},_l("\u7F16\u8F91\u540D\u7247")),t.createElement("div",{className:"Gray_9e mTop6"},_l("\u540D\u7247\u662F\u60A8\u5728\u8BE5\u7EC4\u7EC7\u4E0B\u7684\u4E2A\u4EBA\u4FE1\u606F\uFF0C\u53EA\u5728\u672C\u7EC4\u7EC7\u4E2D\u5C55\u793A\u3002")),t.createElement("div",{className:"mTop24"},ct.map(function(r){return t.createElement(t.Fragment,null,t.createElement("div",{className:"Gray_75"},r.label),t.createElement("div",{className:"mTop6 mBottom16 Gray"},e.renderResult(r)))}),t.createElement("div",{className:"Gray_75"},_l("\u5DE5\u4F5C\u7535\u8BDD")),t.createElement(st.default,{className:"mTop6",placeholder:_l("\u5DE5\u4F5C\u7535\u8BDD"),value:n,onChange:function(l){return e.setState({contactPhone:l.target.value})}})),t.createElement("div",{className:"mTop32 Right"},t.createElement("span",{className:"Font14 Gray_9e mRight32 Hover_49 Hand",onClick:function(){return e.props.closeDialog()}},_l("\u53D6\u6D88")),t.createElement("button",{type:"button",className:"ming Button Button--primary submitBtn",onClick:function(){return e.handleSubmit()}},_l("\u786E\u8BA4"))))}}]),a}(t.Component),te=u(86735),ut=u(1952),ne=u(71893),mt=(0,te.Z)([`
  .promptTitle {
    color: #ff9a2e;
  }
  .mui-dialog-default-title {
    font-size: 24px !important;
  }
  .mui-dialog-close-btn {
    right: 22px !important;
    top: 20px !important;
    .Icon {
      width: 20px !important;
      height: 20px !important;
      color: #757575 !important;
    }
  }
  .mui-dialog-header {
    padding: 32px 24px 16px 55px !important;
  }
  .mui-dialog-body {
    padding: 0 55px 22px !important;
  }
  .methodWrap {
    margin-bottom: 48px;
  }
  .methodItem {
    border: 1px solid #e8e8e8;
    border-radius: 8px;
    margin-right: 25px;
    padding: 42px 30px 20px 25px;
    box-sizing: border-box;
    &:hover {
      cursor: pointer;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.08);
    }
    &:last-child {
      margin-right: 0px;
    }
    .title {
      font-size: 19px;
      margin-top: 20px;
      margin-bottom: 10px;
    }
  }
`],[`
  .promptTitle {
    color: #ff9a2e;
  }
  .mui-dialog-default-title {
    font-size: 24px !important;
  }
  .mui-dialog-close-btn {
    right: 22px !important;
    top: 20px !important;
    .Icon {
      width: 20px !important;
      height: 20px !important;
      color: #757575 !important;
    }
  }
  .mui-dialog-header {
    padding: 32px 24px 16px 55px !important;
  }
  .mui-dialog-body {
    padding: 0 55px 22px !important;
  }
  .methodWrap {
    margin-bottom: 48px;
  }
  .methodItem {
    border: 1px solid #e8e8e8;
    border-radius: 8px;
    margin-right: 25px;
    padding: 42px 30px 20px 25px;
    box-sizing: border-box;
    &:hover {
      cursor: pointer;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.08);
    }
    &:last-child {
      margin-right: 0px;
    }
    .title {
      font-size: 19px;
      margin-top: 20px;
      margin-bottom: 10px;
    }
  }
`]),pt=(0,ne.ZP)(R.Z)(mt),ft=[{type:"payOnline",icon:"icon-wechat_pay",iconColor:"#15BA11",title:_l("\u5728\u7EBF\u652F\u4ED8"),description:_l("\u9002\u5408\u5BF9HAP\u4EA7\u54C1\u5DF2\u7ECF\u5B8C\u6210\u8BD5\u7528\u7684\u4E2D\u5C0F\u4F01\u4E1A\u5BA2\u6237")},{type:"partner",icon:"icon-thumb_up_alt",iconColor:"#FF9800",title:_l("\u4ECE\u4E13\u4E1A\u4F19\u4F34\u8D2D\u4E70"),description:_l("\u9002\u5408\u9700\u8981\u884C\u4E1A\u89E3\u51B3\u65B9\u6848\u548C\u5E94\u7528\u642D\u5EFA\u652F\u6301\u7684\u4F01\u4E1A\u5BA2\u6237")},{type:"consultant",icon:"icon-history_edu",iconColor:"#2196F3",title:_l("\u8054\u7CFB\u987E\u95EE\u8D2D\u4E70"),description:_l("\u9002\u5408\u5177\u5907\u81EA\u4E3B\u642D\u5EFA\u5E94\u7528\u80FD\u529B\u7684\u5BA2\u6237")}];function ht(c){var a=c.onCancel,o=c.projectId,e=c.select,n=c.isTrial,r=function(i){i.type==="payOnline"?location.assign("/upgrade/choose?projectId="+o+"&goToPost=true"+(e?"&select="+e:"")):i.type==="partner"?window.open(md.global.Config.WebUrl+"partnerlist"):window.open("https://www.mingdao.com/form/fdff452c554747f3aa64484fdfe7a0d4?source=content2821432"),a()};return t.createElement(pt,{title:t.createElement("div",{className:"flexRow alignItemsCenter"},_l("\u9009\u62E9\u8D2D\u4E70\u65B9\u5F0F"),n&&t.createElement("span",{className:"promptTitle Font15 bold mLeft10"},_l("\u60A8\u7684\u7EC4\u7EC7\u76EE\u524D\u5C1A\u5728\u8BD5\u7528\u671F\uFF0C\u8D2D\u4E70\u4E4B\u540E\u8BA2\u5355\u5C06\u7ACB\u5373\u751F\u6548"))),visible:!0,width:1160,showFooter:!1,onCancel:a},t.createElement("div",{className:"methodWrap flexRow"},ft.map(function(l){return t.createElement("div",{key:l.type,className:"methodItem flex Hand",onClick:function(){return r(l)}},t.createElement("i",{className:"ming Icon icon-default icon Font40 "+l.icon,style:{color:l.iconColor}}),t.createElement("div",{className:"title bold"},l.title),t.createElement("div",{className:"Gray_75 Font16"},l.description))})),t.createElement("div",{className:"TxtCenter Gray_75 Font16"},_l("*\u4EFB\u4F55\u8D2D\u4E70\u6E20\u9053\u4E0B\uFF0CHAP\u4EA7\u54C1\u6388\u6743\u7684\u4EF7\u683C\u90E8\u5206\u90FD\u662F\u4E00\u81F4\u7684")))}var vt=function(a){return(0,ut.Z)(ht,(0,h.default)({},a))},gt=[{icon:"icon-edit_17",label:_l("\u7F16\u8F91\u7EC4\u7EC7\u540D\u7247"),click:"handleEdit",key:"editCard"},{icon:"icon-enterprise_tool",label:_l("\u7EC4\u7EC7\u7BA1\u7406"),click:"handleGoAdmin",key:"manage"},{icon:"icon-manage",label:_l("\u6211\u7684\u6C47\u62A5\u5173\u7CFB"),click:"handleRelation",key:"reportRelation"},{icon:"icon-exit",label:_l("\u9000\u51FA\u7EC4\u7EC7"),click:"handleExit",key:"exit"}],Et=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.transferAdminProject=function(n,r,l,i){R.Z.confirm({dialogClasses:"dialogBoxTransferAdminProject",title:_l("\u63D0\u793A"),noFooter:!0,children:t.createElement(it,{needTransfer:i===3,companyName:r,projectId:n,password:l,closeDialog:function(){$(".dialogBoxTransferAdminProject.mui-dialog-container").parent().remove()},transferAdminProject:e.transferAdminProject,getData:function(){return e.props.getData()}})})},e.cancelApplication=function(n){R.Z.confirm({title:_l("\u53D6\u6D88\u7533\u8BF7"),onOk:function(){B.Z.revokedJoinProject({projectId:n.projectId}).then(function(l){e.props.getData(),l?alert(_l("\u53D6\u6D88\u6210\u529F")):alert(_l("\u53D6\u6D88\u5931\u8D25"),2)})}})},e.state={showItem:!1,loading:!1,userInfo:{}},e}return(0,P.default)(a,[{key:"formatProjectStatus",value:function(e){var n=de.Z.PROJECT_STATUS_TYPES,r=de.Z.USER_STATUS,l=e.userStatus,i=e.projectStatus,s={buttonState:"default",editCard:!1,reportRelation:!1,exit:!1,manage:!1};if(l===r.UNAUDITED)s.buttonState="review";else switch(i===n.FREE&&(s.buttonState="open"),i){case n.FREE:case n.TRIAL:case n.PAID:s=(0,h.default)({},s,{editCard:!0,manage:!0,reportRelation:!0,exit:!0});break;case n.TOPAID:case n.REPAID:s.exit=!0;break;default:s.exit=!0;break}return s}},{key:"handleChangeShow",value:function(e){var n=this;e.target.className.includes("childTag")||this.setState({showItem:!this.state.showItem},function(){n.state.showItem&&n.getAuthInfo()})}},{key:"getAuthInfo",value:function(){var e=this,n=this.props.card;this.setState({loading:!0}),B.Z.getUserCard({projectId:n.projectId}).then(function(r){r&&e.setState({userInfo:r.user,loading:!1})})}},{key:"handleEdit",value:function(e){var n=this;R.Z.confirm({dialogClasses:"editInfoEnterprise",noFooter:!0,children:t.createElement(dt,{userInfo:e,updateData:function(l){return n.setState({userInfo:l})},closeDialog:function(){$(".editInfoEnterprise.mui-dialog-container").parent().remove()}})})}},{key:"handleExit",value:function(e){R.Z.confirm({title:_l("\u63D0\u793A"),dialogClasses:"dialogBoxValidate",noFooter:!0,children:t.createElement(lt,{projectId:e.projectId,companyName:e.companyName,closeDialog:function(){$(".dialogBoxValidate.mui-dialog-container").parent().remove()},transferAdminProject:this.transferAdminProject})})}},{key:"handleRelation",value:function(e){(0,ye.T8)("/personal?type=reportRelation&projectId="+e.projectId)}},{key:"handleGoAdmin",value:function(e){window.location.href="/admin/home/"+e.projectId}},{key:"handleCopyTextSuccess",value:function(){return alert(_l("\u590D\u5236\u6210\u529F")),!1}},{key:"getItems",value:function(e,n){var r=e.map(function(l){return l[n]});return r.join(" ; ")}},{key:"renderOption",value:function(e){var n=this,r=this.props.card;switch(e){case"open":return md.global.Config.IsLocal?void 0:t.createElement("span",{className:"openNowBtn",onClick:function(){return n.handleOpenCard(r)}},_l("\u8D2D\u4E70"));case"review":return t.createElement("span",null,t.createElement("span",{className:"ThemeColor3 Hover_49 Hand",onClick:function(){return n.handleReview(r)}},_l("\u5F85\u5BA1\u6838")),t.createElement("span",{className:"cancelApplication Hover_49 Hand mLeft24",onClick:function(){return n.cancelApplication(r)}},_l("\u53D6\u6D88\u7533\u8BF7")));case"default":return t.createElement("span",{className:"Gray_9e"},r.isProjectAdmin?r.isCreateUser?_l("\u7BA1\u7406\u5458")+_l("(\u521B\u5EFA\u4EBA)"):_l("\u7BA1\u7406\u5458"):_l("\u666E\u901A\u6210\u5458"))}}},{key:"handleOpenCard",value:function(e){vt({projectId:e.projectId})}},{key:"handleReview",value:function(e){B.Z.sendSystemMessageToAdmin({projectId:e.projectId,msgType:1}).then(function(n){n?alert(_l("\u5DF2\u63D0\u9192\u7BA1\u7406\u5458\u5BA1\u6838")):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)}).catch()}},{key:"render",value:function(){var e=this,n=this.state,r=n.showItem,l=n.userInfo,i=n.loading,s=l.departmentInfos,d=s===void 0?[]:s,p=l.jobInfos,m=p===void 0?[]:p,f=this.props.card,v=f.currentLicense,g=v===void 0?{}:v,T=this.formatProjectStatus(f),S=f.projectStatus===de.Z.PROJECT_STATUS_TYPES.FREE||f.projectStatus===de.Z.PROJECT_STATUS_TYPES.TOPAID;return t.createElement("div",{className:b()("enterpriseCardItem",{active:r}),onClick:function(G){return e.handleChangeShow(G)}},t.createElement("div",{className:"cardItemHeader Hand"},t.createElement("div",{className:"cardItemLeft"},t.createElement("div",{className:"Font17 Bold mBottom12 Gray"},f.companyName),t.createElement("div",{className:"cardItemInfo"},t.createElement("div",{className:b()("itemTag",S?"grayActive":"active")},g.version?g.version.name:_l("\u514D\u8D39\u7248")),t.createElement("div",{className:"mLeft24 mRight24 itemDivice"}),t.createElement("div",{className:"Gray_75 hover_blue"},t.createElement(nt(),{component:"span","data-clipboard-text":f.projectCode,onSuccess:this.handleCopyTextSuccess.bind(this)},t.createElement("span",{className:"childTag"},_l("\u7EC4\u7EC7\u95E8\u724C\u53F7\uFF1A%0",f.projectCode)),t.createElement("span",{className:"icon-content-copy Font12 mLeft5 childTag"}))))),t.createElement("div",{className:"cardItemRight"},this.renderOption(T.buttonState),t.createElement("span",{className:b()("Font20 mLeft24 Gray_70",r?"icon-expand_more":"icon-navigate_next")}))),t.createElement("div",{className:b()("infoContent",r?"extendInfo":"closeInfo")},i?t.createElement(L.Z,null):t.createElement(t.Fragment,null,t.createElement("div",{className:"extendItemBox"},t.createElement("div",{className:"extendItemLabel Gray_75"},_l("\u7EC4\u7EC7\u540D\u7247")),t.createElement("div",{className:"extendRight"},t.createElement("div",{className:"flexRow mBottom8"},t.createElement("div",{className:"extendRightLabel"},_l("\u59D3\u540D")),t.createElement("div",null,l.fullname||_l("\u672A\u586B\u5199"))),t.createElement("div",{className:"flexRow mBottom8"},t.createElement("div",{className:"extendRightLabel"},_l("\u90E8\u95E8")),t.createElement("div",null,d.length>0?this.getItems(d,"departmentName"):_l("\u672A\u586B\u5199"))),t.createElement("div",{className:"flexRow"},t.createElement("div",{className:"extendRightLabel"},_l("\u804C\u4F4D")),t.createElement("div",null,m.length>0?this.getItems(m,"jobName"):_l("\u672A\u586B\u5199"))))),t.createElement("div",{className:"extendItemBox Gray_75"},gt.map(function(A,G){return t.createElement("span",{key:G,className:b()("flexRow mRight40",T[A.key]?"Hand Gray hover_blue":"Gray_9e"),onClick:function(){return T[A.key]?e[A.click](l):null}},t.createElement("span",{className:b()("mRight12 LineHeight20 childTag",A.icon)}),A.key==="manage"?t.createElement("span",{className:"childTag"},f.hasRole?A.label:_l("\u7533\u8BF7\u7BA1\u7406\u6743\u9650")):t.createElement("span",{className:"childTag"},A.label))})))))}}]),a}(t.Component),It=function(c){(0,H.default)(a,c);function a(){return(0,D.default)(this,a),(0,F.default)(this,(a.__proto__||j()(a)).apply(this,arguments))}return(0,P.default)(a,[{key:"renderOption",value:function(e){var n=this;switch(e.status){case 0:return t.createElement("li",{className:"Left LineHeight25 TxtLeft mLeft20"},_l("\u5DF2\u52A0\u5165"));case 1:return t.createElement("li",{className:"Left LineHeight25 TxtLeft mLeft20"},_l("\u5DF2\u62D2\u7EDD"));case 2:return t.createElement("li",{className:"Left LineHeight25 TxtLeft mLeft20"},_l("\u5F85\u5BA1\u6279"));case 3:return t.createElement("li",{className:"Left LineHeight25 TxtLeft mLeft20"},_l("\u52A0\u5165\u5931\u8D25"));case 4:return t.createElement("li",{className:"Left LineHeight25 TxtLeft mLeft20"},_l("\u5DF2\u5931\u6548"));case 5:return t.createElement("li",{className:"Left LineHeight25 TxtLeft mLeft20"},_l("\u5DF2\u9000\u51FA"));default:return t.createElement(t.Fragment,null,t.createElement("li",{className:"Left LineHeight25 TxtLeft ThemeColor3 btnForAuthListAdd Hand mLeft20",onClick:function(){return n.handleAdd(e)}},_l("\u52A0\u5165")),t.createElement("li",{className:"Left LineHeight25 TxtLeft ThemeColor3 btnForAuthListRefused Hand mLeft20",onClick:function(){return n.handleCancel(e)}},_l("\u62D2\u7EDD")))}}},{key:"handleAdd",value:function(e){var n=this;this.props.updateAuthCount();var r=e.projectId,l=e.token;B.Z.checkJoinProjectByTokenWithCard({projectId:r,token:l}).then(function(i){switch(i.joinProjectResult){case 1:location.href="/enterpriseRegister?type=editInfo&projectId="+r+"&token="+l;break;case 3:n.props.existUserNotice(i.userCard.user.status);break;default:alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)}n.props.closeDialog()})}},{key:"handleCancel",value:function(e){var n=this;this.props.updateAuthCount();var r=e.projectId,l=e.token;B.Z.refuseJoin({projectId:r,token:l}).then(function(i){i?alert(_l("\u60A8\u5DF2\u6210\u529F\u62D2\u7EDD\u8BE5\u7EC4\u7EC7\u7684\u9080\u8BF7")):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2),n.props.closeDialog()})}},{key:"render",value:function(){var e=this,n=this.props.list,r=n===void 0?[]:n;return t.createElement("div",{className:"overflowHidden pAll10"},t.createElement("span",{className:"Normal Gray14 Left Width250"},_l("\u7EC4\u7EC7")),t.createElement("span",{className:"Normal Gray14 Left mLeft20"},_l("\u64CD\u4F5C")),t.createElement("div",{className:"Clear"}),t.createElement("ul",{className:"pTop10"},r.length?t.createElement(t.Fragment,null,r.map(function(l){return t.createElement(t.Fragment,null,t.createElement("li",{className:"Left LineHeight25 Width250 overflow_ellipsis"},l.companyName),e.renderOption(l))})):t.createElement("li",{class:"Left LineHeight25 w100"},_l("\u6682\u65E0\u9080\u8BF7\u8BB0\u5F55\uFF01"))))}}]),a}(t.Component),Y=u(33867),k=u(14898),me=u(99924),Ct=u(30539),yt=u(70264),ae=u(50533);const bt={expansionInfos:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mdyAPI("AdminManage","ExpansionInfos",a,o)},getHidBalance:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mdyAPI("AdminManage","GetHidBalance",a,o)},projectExpireDays:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mdyAPI("AdminManage","ProjectExpireDays",a,o)},announcement:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mdyAPI("AdminManage","Announcement",a,o)}};var x={params:null,projectId:null,project:null};x.AdminController=bt,x.templates={withTopMenu:'<div class="subMenuList"></div><div class="mainContent"><div class="h100" style="overflow-y: auto;"></div></div>',withSubMenu:'<div class="subMenuList"></div><div class="mainContent"><div class="h100" style="overflow-y: auto;"><div class="card mTop0 mAll20"><div class="subMenu"></div><div class="moduleContent"></div></div></div>'},x.getParams=function(){var c=location.pathname.split("/"),a=$.inArray("admin",c),o=[];c.forEach(function(e,n){n>=a&&o.push(e)}),x.params=o,x.projectId=x.params[2]},x.setPageTitle=function(c){document.title=x.getTitle(c)},x.getTitle=function(c){var a=(0,Z.vo)(x.projectId,!0),o=(0,Z.u1)(a&&a.companyName||"");return[_l("\u7EC4\u7EC7\u7BA1\u7406"),c,o].join(" - ")},x.EVENTS={transitionEnd:"transitionend"},x.abortRequest=function(c){c&&c.abort&&c.abort()},x.AUTHORITY_DICT={PROJECT_ADMIN:"PROJECT_ADMIN",APK_ADMIN:"APK_ADMIN",HAS_PERMISSIONS:"HAS_PERMISSIONS",NOT_MEMBER:"NOT_MEMBER",OLD_VERSION:"OLD_VERSION",SHOW_MANAGER:"SHOW_MANAGER"},x.DATE_FILTER=[{id:"today",text:_l("\u4ECA\u5929")},{id:"currentWeek",text:_l("\u6700\u8FD1\u4E03\u5929")},{id:"currentMonth",text:_l("\u672C\u6708")},{id:"prevMonth",text:_l("\u4E0A\u6708")},{id:"custom",text:_l("\u81EA\u5B9A\u4E49\u65E5\u671F")}];const C=x;var ke=u(60967),Nt=u(45697),I=u.n(Nt),un=u(68761),be="",pe="OPEN_COLLAPSE",re="CLOSE_COLLAPSE",K="ADD_STRUCTURES",Ne="REMOVE_STRUCTURE",St="REPLACE_STRUCTURE",fe="ADD_PARENT_CHILDREN",oe="REMOVE_PARENT_CHILDREN",Se="UPDATE_CURRENT_CHILDREN",Lt="FETCH_PARENT",he="SUBORDINATES_REQUEST",Tt="SUBORDINATES_SUCCESS",_e="SUBORDINATES_FAILURE",Q="UPDATE_ENTITY_CHILDS",Re="CLEAR_HIGHLIGHT",ve="UPDATE_HIGHLIGHT",le="UPDATE_IS_LOADING",ge="UPDATE_FIRST_LEVEL_LOADING",je=20,De=function(){return function(a){var o=(0,Z.vo)(C.projectId,!0);a({type:K,payload:{source:[{projectId:C.projectId,fullname:o.companyName,accountId:be}]}})}},ie=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:be,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{type:o?pe:re,payload:{id:a}}},Pe=function(a){var o=a.id,e=a.accounts,n=a.callback;return function(r,l){k.Z.addStructure({projectId:C.projectId,isTop:o===be,parentId:o,accountIds:N().map(e,function(i){return i.accountId})}).then(function(i){if(i&&i.success){var s=i.failedAccountIds,d=e;s&&s.length&&(d=N().filter(e,function(S){return s.indexOf(S.accountId)===-1}));var p=l().entities.users,m=p===void 0?{}:p,f=m[o]||{},v=f.subordinates,g=v===void 0?[]:v,T=f.subTotalCount;n&&n(),r({type:K,payload:{source:d}}),o&&g.length!==T?r(ee(o)):r({type:Q,payload:{id:o,source:d,totalCount:o?m[o].subTotalCount+N().map(e,function(S){return S.accountId}).length:m[o].subTotalCount}}),o?N().map(e,function(S){return S.accountId}).forEach(function(S){r(ee(S))}):r(Ee("")),r(ie(o))}else alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})}},Fe=function(a){var o=a.account,e=a.parentId,n=a.replacedAccountId,r=a.callback;return function(l){var i=o.accountId;k.Z.replaceUserStructure({projectId:C.projectId,replacedAccountId:n,accountId:i}).then(function(s){if(s){var d=o.accountId;r&&r(),l({type:K,payload:{source:[o]}}),l({type:oe,payload:{id:e,removeId:n}}),l({type:fe,payload:{id:e,addId:d}}),l({type:Se,payload:{id:d,replacedAccountId:n}})}else alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})}},He=function(a){var o=a.parentId,e=a.accountId,n=a.callback;return function(r){k.Z.removeParentID({projectId:C.projectId,accountId:e}).then(function(l){l?(n&&n(),r({type:oe,payload:{id:o,removeId:e}}),r({type:Ne,payload:{id:e}})):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})}},Ee=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return function(e){return e({type:he,payload:{id:a}}),o<=1&&e({type:le,payload:{data:!0}}),o>1&&e({type:ge,payload:{data:!0}}),k.Z.pagedGetAccountList({projectId:C.projectId,pageIndex:o,pageSize:je,parentId:a||""}).then(function(n){var r=n.totalCount,l=n.pagedDatas;e({type:K,payload:{source:l}}),e({type:Q,payload:{id:a,source:l,pageIndex:o,moreLoading:!1,totalCount:r}}),e({type:le,payload:{data:!1}}),e({type:ge,payload:{data:!1}})},function(n){e({type:_e,payload:{id:a,error:n}}),e({type:le,payload:{data:!1}})})}},ee=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return function(e){return e({type:Q,payload:{id:a,source:[],moreLoading:!0}}),k.Z.pagedGetAccountList({projectId:C.projectId,pageIndex:o,pageSize:je,parentId:a||""}).then(function(n){var r=n.pagedDatas,l=n.totalCount;return e({type:K,payload:{source:r}}),e({type:Q,payload:{id:a,source:r,pageIndex:o,moreLoading:!1,totalCount:l}}),r})}},xt=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function(e,n){return k.Z.getParentsByAccountId({accountId:a,projectId:C.projectId,isDirect:o}).then(function(r){if(r&&r.length){var l=N().map(r,function(i){return i.accountId});l.reverse().forEach(function(i){e(ee(i)).then(function(s){var d=n().entities.users,p=N().reduce(s,function(m,f){var v=f.accountId,g=(d[v]||{}).subordinates;return m.concat(g||[])},[]);return p}).then(function(s){N().forEach(l.concat(s),function(d){e(ie(d))}),e({type:ve,payload:{highLightId:a,highLightRootId:l[0]}})})})}else e({type:ve,payload:{highLightId:a,highLightRootId:a}})})}},Ue=function(a,o){return function(e){e(a?ee(a,o):Ee(a,o))}};function At(c){return me.Z.setStructureForAll((0,h.default)({projectId:C.projectId},c)).then(function(a){return a},function(){return alert(_l("\u64CD\u4F5C\u5931\u8D25"),2),q().reject()})}function kt(c){return me.Z.setStructureSelfEdit((0,h.default)({projectId:C.projectId},c)).then(function(a){return a},function(){return alert(_l("\u64CD\u4F5C\u5931\u8D25"),2),q().reject()})}function we(c){var a=c.title,o=c.accountId,e=c.unique,n=c.isSetParent,r=c.callback;(0,ue.Z)({fromAdmin:!0,SelectUserSettings:{filterAll:!0,filterFriend:!0,filterOthers:!0,filterOtherProject:!0,unique:!!e,showTabs:["structureUsers"],extraTabs:[{id:"structureUsers",name:"\u6240\u6709\u4EBA",type:4,page:!0,actions:{getUsers:function(i){return i=$.extend({},i,{accountId:o,projectId:C.projectId,isSetParent:n}),k.Z.getAllowChooseUsers(i)}}}],callback:function(i){typeof r=="function"&&r(i)}}})}function _t(c){var a=c.keywords,o=c.pageIndex,e=o===void 0?1:o,n=c.pageSize,r=n===void 0?100:n;return k.Z.getStructureUsers({projectId:C.projectId,keywords:a,pageIndex:e,pageSize:r})}var Rt=u(15405),jt=u(33126),Oe,Be,Dt=(0,jt.Z)(Rt.Z),Pt=(Be=Oe=function(c){(0,H.default)(a,c);function a(){return(0,D.default)(this,a),(0,F.default)(this,(a.__proto__||j()(a)).apply(this,arguments))}return(0,P.default)(a,[{key:"render",value:function(){var e=this;return t.createElement(Dt,{component:"ul",className:"itemOpList",onClickAway:function(){return e.props.toggleList()}},this.props.showAddBtn?t.createElement("li",{className:"ThemeHoverBGColor3 Hand",onClick:function(){return e.props.add()}},_l("\u6DFB\u52A0\u4E0B\u5C5E")):null,t.createElement("li",{className:"ThemeHoverBGColor3 Hand",onClick:function(){return e.props.replace()}},_l("\u66FF\u6362\u6210\u5458")),t.createElement("li",{className:"ThemeHoverBGColor3 Hand",onClick:function(){return e.props.remove()}},_l("\u79FB\u51FA\u6210\u5458")))}}]),a}(t.Component),Oe.propTypes={toggleList:I().func,showAddBtn:I().bool,add:I().func,remove:I().func,replace:I().func},Be);function Ze(c){var a=c.avatar,o=c.fullname,e=c.department,n=c.job,r=c.subordinates,l=c.clickHandler,i=c.subTotalCount,s=l?{onClick:l}:{};return t.createElement("div",(0,h.default)({className:"userItem"},s),t.createElement("img",{src:a,className:"avatar"}),t.createElement("div",{className:"info"},t.createElement("div",{className:"name"},o),t.createElement("div",{className:"department"},e),t.createElement("div",{className:"job"},n)),i&&i>0?t.createElement("div",{className:"subordinateCount"},t.createElement("span",{className:"icon-charger Gray_a TxtMiddle Font14"}),t.createElement("span",{className:"TxtMiddle Gray mLeft5"},i)):null)}Ze.propTypes={avatar:I().string,fullname:I().string,department:I().string,job:I().string,subordinates:I().arrayOf(I().string),clickHandler:I().func};const Ft=Ze;var Me,Ge,Ht=(Ge=Me=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.state={isDisabled:o.status!==1,showOpList:!1},e.timer=null,e}return(0,P.default)(a,[{key:"renderOpList",value:function(){var e=this,n=function(f){f===void 0?e.setState({showOpList:!e.state.showOpList}):e.setState({showOpList:!1})},r=this.props,l=r.add,i=r.replace,s=r.remove,d=r.status,p={toggleList:function(){n(!1)},showAddBtn:!this.state.isDisabled,add:l,replace:i,remove:s};return t.createElement("div",{className:"opList"},t.createElement(Y.Z,{icon:"more_horiz",className:"itemOperator",onClick:function(){n()}}),this.state.showOpList?t.createElement(Pt,p):null)}},{key:"render",value:function(){var e=this,n=this.props,r=n.status,l=n.isHighLight,i=n.auth,s=this.state.isDisabled,d=b()("node",{disabled:s,ThemeHoverBorderColor3:!s,"ThemeBGColor6 ThemeBorderColor3":l});return t.createElement("div",{className:"InlineBlock Relative pRight40 nodeWrapper",onMouseLeave:function(){e.setState({showOpList:!1})}},t.createElement("div",{className:d},t.createElement(Ft,this.props)),i?this.renderOpList():null)}}]),a}(t.Component),Me.propTypes={id:I().string,name:I().string,add:I().func,remove:I().func,replace:I().func},Ge);function Ut(c){return t.createElement("div",{className:"noData TxtCenter"},t.createElement("div",null,t.createElement(Y.Z,{icon:"manage",className:"icon InlineBlock"})),t.createElement("div",{className:"pTop20 Font17 Gray_9e"},_l("\u6682\u65E0\u4E0B\u5C5E")),t.createElement("div",{className:"mTop10 Font15 Gray_9e"},_l("\u70B9\u51FB\u4E0A\u65B9 + \u6DFB\u52A0\u4E0B\u5C5E")))}var Le,$e,wt=(0,te.Z)([`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
`],[`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
`]),Ot=ne.ZP.div(wt),Bt=($e=Le=function(c){(0,H.default)(a,c);function a(){return(0,D.default)(this,a),(0,F.default)(this,(a.__proto__||j()(a)).apply(this,arguments))}return(0,P.default)(a,[{key:"renderChilds",value:function(){var e=this,n=this.props,r=n.subordinates,l=n.collapsed,i=n.id,s=n.auth,d=n.pageIndex,p=n.dispatch,m=n.moreLoading,f=n.subTotalCount,v=n.firstLevelLoading,g=n.dataFromProps,T=g===void 0?!1:g,S=n.data,A=S===void 0?{}:S,G=n.onChangeData,se=n.disableMore,Ae=se===void 0?!1:se;if(r&&!l)return t.createElement("div",{className:"childNodeList"},r.map(function(Ce,W){var E={id:Ce,parentId:i,level:e.props.level+1,isFirst:W===0,isLast:W===r.length-1,auth:s};return T&&(E.onChangeData=G,E.data=A,E.dataFromProps=T),t.createElement(Te,(0,h.default)({},E,{key:E.id}))}),!Ae&&f>r.length&&t.createElement("div",{className:"loadMore Hand",onClick:function(){m||p(Ue(i,d+1))}},!i&&v||i&&m?_l("\u52A0\u8F7D\u4E2D"):_l("\u66F4\u591A")))}},{key:"toggle",value:function(){var e=this.props,n=e.dispatch,r=e.id,l=e.collapsed,i=e.subordinates,s=e.hasSub;n(ie(r,l)),l&&s&&!i&&n(ee(r))}},{key:"renderToggleButton",value:function(){var e=this,n=this.props,r=n.collapsed,l=n.id,i=n.hasSub,s=n.dataFromProps,d=n.onChangeData,p=n.data,m=n.subordinates;if(i||m&&m.length){var f=r?"plus":"minus";return t.createElement(Y.Z,{className:"toggleButton",icon:f,onClick:function(){s?d({type:"EXPEND",value:!r,id:l}):e.toggle()}})}}},{key:"add",value:function(){var e=this.props,n=e.id,r=e.dispatch,l=e.dataFromProps,i=e.onChangeData;we({title:_l("\u6DFB\u52A0\u4E0B\u5C5E"),accountId:n,callback:function(d){var p={id:n,accounts:d};l&&(p.callback=function(){return i({type:"ADD",value:d,id:n})}),r(Pe(p))}})}},{key:"replace",value:function(){var e=this.props,n=e.id,r=e.parentId,l=e.dispatch,i=e.onChangeData,s=e.dataFromProps;we({title:_l("\u66FF\u6362\u6210\u5458"),accountId:n,unique:!0,callback:function(p){var m={parentId:r,account:p[0],replacedAccountId:n};s&&(m.callback=function(){return i({type:"REPLACE",value:p[0],id:r})}),l(Fe(m))}})}},{key:"remove",value:function(){var e=this.props,n=e.id,r=e.parentId,l=e.fullname,i=e.dispatch,s=e.dataFromProps,d=e.onChangeData;R.Z.confirm({title:_l("\u786E\u8BA4\u79FB\u9664 %0 ?",l),description:_l("\u79FB\u9664\u540E\uFF0C\u5176\u4E0B\u5C5E\u6210\u5458\u4E5F\u5C06\u4ECE\u6C47\u62A5\u5173\u7CFB\u4E2D\u79FB\u9664"),onOk:function(){var m={parentId:r,accountId:n};s&&(m.callback=function(){return d({type:"REMOVE",id:r,values:n})}),i(He(m))}})}},{key:"renderItem",value:function(){var e=this.props,n=e.auth,r=e.id,l=e.fullname,i=e.avatar,s=e.department,d=e.job,p=e.status,m=e.subordinates,f=e.isHighLight,v=e.subTotalCount,g={id:r,fullname:l,avatar:i,department:s,job:d,subordinates:m,status:p,isHighLight:f,auth:n,subTotalCount:v,add:this.add.bind(this),replace:this.replace.bind(this),remove:this.remove.bind(this)};return t.createElement(Ht,g)}},{key:"shouldComponentUpdate",value:function(e){return!N().isEqual(this.props,e)}},{key:"render",value:function(){var e=this,n=this.props,r=n.isFirst,l=n.isLast,i=n.id,s=n.subordinates,d=n.auth,p=n.isLoading,m=n.pageIndex;return p&&!i&&m===1?t.createElement(Ot,null,t.createElement(L.Z,null)):i?t.createElement("div",{className:b()("nodeItem",{last:l,first:r}),ref:function(v){e.node=v}},this.renderItem(),this.renderToggleButton(),this.renderChilds()):t.createElement("div",{className:"rootNodeItem"},t.createElement("div",{className:"Font24 pLeft8"},t.createElement(Y.Z,{icon:"company",className:"TxtMiddle Gray_9e"}),t.createElement("span",{className:"Font16 TxtMiddle mLeft10 mRight10"},this.props.fullname),d?t.createElement("span",{className:"Hand Font14 TxtMiddle Gray_9e",onClick:this.add.bind(this)},t.createElement(Y.Z,{className:"Font24 mRight10 TxtMiddle",icon:"add-member2"}),t.createElement("span",{className:"TxtMiddle"},_l("\u6DFB\u52A0\u4E0B\u5C5E"))):null),s&&s.length?t.createElement("div",{className:"rootNodeSheet"}):t.createElement(Ut,null),this.renderChilds())}}]),a}(t.Component),Le.propTypes={subordinates:I().arrayOf(I().string),isFirst:I().bool,isLast:I().bool},Le.defaultProps={isFirst:!0,isLast:!0},$e),Te=(0,ae.$j)(function(c,a){var o=c.entities.users,e=c.highLightId,n=c.isLoading,r=c.firstLevelLoading,l=a.dataFromProps?(0,h.default)({},a.data[a.id],{disableMore:a.data[a.id].disableMore}):o[a.id];return(0,h.default)({},l,{level:a.level,isHighLight:e===a.id,isLoading:n,firstLevelLoading:a.dataFromProps?a.firstLevelLoading:r})})(Bt);Te.defaultProps={id:"",level:0};const We=Te;var Zt=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.promise=null,e.selectUser=function(n){n.stopPropagation(),(0,ue.Z)({sourceId:0,fromType:0,fromAdmin:!0,SelectUserSettings:{filterAll:!0,filterFriend:!0,filterOthers:!0,filterOtherProject:!0,projectId:C.projectId,inProject:!0,unique:!0,callback:function(l){var i=l[0];e.props.onChange(i)}}})},e.state={keywords:"",loading:!1,showList:!1,result:[]},e.debounced=N().debounce(function(){e.promise&&e.promise.abort&&e.promise.abort();var n=e.state.keywords;e.promise=_t({keywords:n}),e.promise.then(function(r){if(r&&r.allCount){var l=r.list,i=r.allCount,s=e.state.result;e.setState({isLoading:!1,showList:!0,result:l})}else e.setState({isLoading:!1,showList:!0,result:[]})})},500),e}return(0,P.default)(a,[{key:"componentWillUnmount",value:function(){this.debounced&&this.debounced.cancel()}},{key:"render",value:function(){return t.createElement("div",{className:"searchUserBox Relative Hand",onClick:this.selectUser},t.createElement("span",{className:"Left icon-charger Font16 selectIcon mRight8"}),t.createElement("span",{className:"Font13"},_l("\u67E5\u770B\u6210\u5458")))}}]),a}(t.Component);const ze=(0,ae.$j)()(Zt);var Mt=(0,te.Z)([`
  .userItem {
    display: flex;
    flex-direction: row;
    padding: 10px 0;
    height: 60px;
    box-sizing: initial;
    .avatar {
      margin-left: 10px;
      flex: 0 0 48px;
      height: 48px;
      border-radius: 50%;
      align-self: center;
    }
    .info {
      flex: 1 0 0%;
      margin-left: 16px;
      padding-right: 10px;
      display: flex;
      flex-direction: column;
      .name,
      .department,
      .job {
        flex: 1 0 0%;
        max-width: 155px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        color: #9e9e9e;
        font-size: 12px;
      }
      .name {
        font-size: 15px;
        max-width: 135px;
        margin-bottom: 4px;
        color: #333;
      }
    }
    .subordinateCount {
      position: absolute;
      right: 50px;
      top: 10px;
    }
  }
`],[`
  .userItem {
    display: flex;
    flex-direction: row;
    padding: 10px 0;
    height: 60px;
    box-sizing: initial;
    .avatar {
      margin-left: 10px;
      flex: 0 0 48px;
      height: 48px;
      border-radius: 50%;
      align-self: center;
    }
    .info {
      flex: 1 0 0%;
      margin-left: 16px;
      padding-right: 10px;
      display: flex;
      flex-direction: column;
      .name,
      .department,
      .job {
        flex: 1 0 0%;
        max-width: 155px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        color: #9e9e9e;
        font-size: 12px;
      }
      .name {
        font-size: 15px;
        max-width: 135px;
        margin-bottom: 4px;
        color: #333;
      }
    }
    .subordinateCount {
      position: absolute;
      right: 50px;
      top: 10px;
    }
  }
`]),Gt=(0,te.Z)([`
  width: 100%;
  height: 100%;
  position: relative;
  .alignwrap {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
  }
  .iconWrap {
    width: fit-content;
    padding: 30px;
    border-radius: 50%;
    background: #f5f5f5;
    margin: auto;
    .icon {
      color: #aaa;
      font-size: 90px;
    }
  }
`],[`
  width: 100%;
  height: 100%;
  position: relative;
  .alignwrap {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
  }
  .iconWrap {
    width: fit-content;
    padding: 30px;
    border-radius: 50%;
    background: #f5f5f5;
    margin: auto;
    .icon {
      color: #aaa;
      font-size: 90px;
    }
  }
`]),$t=(0,te.Z)([`
  padding-right: 16px;
`],[`
  padding-right: 16px;
`]),Wt=ne.ZP.div(Mt),zt=ne.ZP.div(Gt),Vt=ne.ZP.div($t);function Jt(c){var a=c.user,o=c.handleClose,e=c.auth,n=c.selectSearchUser,r=c.id,l=(0,t.useState)([]),i=(0,y.Z)(l,2),s=i[0],d=i[1],p=(0,t.useState)([]),m=(0,y.Z)(p,2),f=m[0],v=m[1],g=(0,t.useState)(!0),T=(0,y.Z)(g,2),S=T[0],A=T[1];(0,t.useEffect)(function(){r&&G()},[r]);var G=function(){A(!0),k.Z.getTreesByAccountId({projectId:C.projectId,accountId:a.accountId}).then(function(E){if(A(!1),v(E.map(function(U){return U.accountId})),E.length===0){d([]);return}var w=(0,Z.vo)(C.projectId,!0),M={"":{id:"",accountId:"",collapsed:!1,fullname:w.companyName,moreLoading:!1,projectId:C.projectId,subTotalCount:1,subordinates:[E[0].accountId],disableMore:!0,dataFromProps:!0}};E.forEach(function(U,O){M[U.accountId]=(0,h.default)({},U,{id:U.accountId,accountId:U.accountId,collapsed:O+1===E.length,fullname:U.fullname,moreLoading:!1,subordinates:O+1===E.length?void 0:[E[O+1].accountId],dataFromProps:!0,auth:O+1===E.length?e:!1,disableMore:!0})}),d(M)})},se=function(E){var w=E.id,M=E.pageIndex;k.Z.pagedGetAccountList({projectId:C.projectId,pageIndex:M,pageSize:20,parentId:w||""}).then(function(U){var O=U.pagedDatas,Xe={};O.forEach(function(z,mn){Xe[z.accountId]=(0,h.default)({},z,{id:z.accountId,collapsed:z.hasSub,subordinates:void 0,dataFromProps:!0,firstLevelLoading:M===1})}),s[w].subordinates=M===1?O.map(function(z){return z.accountId}):_.union(s[w].subordinates||[],O.map(function(z){return z.accountId})),s[w].moreLoading=s[w].subordinates&&s[w].subordinates.length!==0&&s[w].subTotalCount>s[w].subordinates.length,d((0,h.default)({},s,Xe))})},Ae=function(E){var w=E.type,M=E.value,U=E.id;switch(w){case"EXPEND":var O=s[U];s[U].collapsed=M,O.hasSub&&!M&&(!O.subordinates||O.subordinates.length===0)?se({id:U,pageIndex:1}):d((0,h.default)({},s));break;case"REPLACE":case"REMOVE":case"ADD":G();break}},Ce=function(){return t.createElement(zt,null,t.createElement("div",{className:"alignwrap"},S?t.createElement(L.Z,null):t.createElement(t.Fragment,null,t.createElement("div",{className:"iconWrap"},t.createElement(Y.Z,{icon:"manage",className:""})),t.createElement("div",{className:"pTop20 Font15 Gray_9e"},_l("\u6210\u5458\u6682\u65E0\u6C47\u62A5\u5173\u7CFB")))))};return t.createElement(R.Z,{type:"fixed",title:t.createElement(Vt,null,t.createElement("span",{className:"Font17 LineHeight32 Bold"},"\u201C"+a.fullname+"\u201D "+_l("\u7684\u6C47\u62A5\u5173\u7CFB")),e&&t.createElement(ze,{onChange:function(E){n(E)}})),visible:!0,width:1e3,footer:null,handleClose:o},s.length===0?Ce():t.createElement(Wt,{className:"rootBoardBox"},s[""]&&t.createElement(We,(0,h.default)({},s[""],{data:s,dataFromProps:!0,pageIndex:1,level:0,key:"searchNode"+s[""].id,onChangeData:function(E){return Ae(E)}}))))}var Yt=(0,ae.$j)(function(c,a){var o=c.entities.users,e=o[a.id];return(0,h.default)({},e,{users:o,auth:a.auth})})(Jt);const Kt=Yt;var Ve,Je,Qt=(Je=Ve=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.changeSubordinate=function(n){kt({isAllowStructureSelfEdit:!n}).then(function(){e.setState({allowStructureSelfEdit:!n})})},e.changeReporting=function(n){At({forAll:!n}).then(function(){e.setState({authForAll:!n})})},e.state={auth:o.from!="myReport",authForAll:!1,searchUser:void 0,nodeDialogVisible:!1},e}return(0,P.default)(a,[{key:"componentWillMount",value:function(){var e=this,n=this.props.dispatch;n(De()),n(Ee("")),n(ie()),me.Z.getStructureForAll({projectId:C.projectId}).then(function(r){e.setState({authForAll:r.allowStructureForAll,allowStructureSelfEdit:r.allowStructureSelfEdit})})}},{key:"render",value:function(){var e=this,n=this.props,r=n.isProjectAdmin,l=n.highLightRootId,i=this.state,s=i.auth,d=i.authForAll,p=i.allowStructureSelfEdit,m=i.searchUser,f=i.nodeDialogVisible;return t.createElement(t.Fragment,null,s&&t.createElement("div",{className:"rootBoardHeader flexRow"},t.createElement("div",{className:"Font17 flex Bold"},_l("\u6C47\u62A5\u5173\u7CFB"),t.createElement(yt.Z,{text:t.createElement("span",{className:"White"},_l("\u5728\u5DE5\u4F5C\u8868\u548C\u5DE5\u4F5C\u6D41\u7684\u6C47\u62A5\u5173\u7CFB\u68C0\u7D22\u65F6\uFF0C\u82E5\u5F53\u524D\u7528\u6237\u7684\u6240\u6709\u4E0B\u7EA7\u7528\u6237\u603B\u6570\u8D85\u8FC72000\uFF08\u542B\uFF09\uFF0C\u7CFB\u7EDF\u5C06\u9ED8\u8BA4\u4EC5\u83B7\u53D6\u5F53\u524D\u7528\u6237\u7684\u201C\u76F4\u5C5E\u4E0B\u4E00\u7EA7\u201D\u6240\u6709\u7528\u6237\u3002")),action:["hover"],popupPlacement:"top"},t.createElement("i",{className:"icon-info_outline Gray_9e mLeft5"}))),r&&t.createElement(t.Fragment,null,t.createElement("span",{"data-tip":_l("\u52FE\u9009\u540E\u5141\u8BB8\u5458\u5DE5\u5728\u300C\u4E2A\u4EBA\u8D26\u6237/\u6211\u7684\u7EC4\u7EC7/\u6211\u7684\u6C47\u62A5\u5173\u7CFB\u300D\u4E2D\u7BA1\u7406\u4E0B\u5C5E"),className:"rootBoardHeaderTips"},t.createElement(ke.Z,{checked:p,onClick:this.changeSubordinate,className:"mLeft15"},_l("\u5141\u8BB8\u5458\u5DE5\u81EA\u884C\u7BA1\u7406\u4E0B\u5C5E"))),t.createElement("span",{"data-tip":_l("\u52FE\u9009\u540E\u5141\u8BB8\u5458\u5DE5\u5728\u300C\u4E2A\u4EBA\u8D26\u6237/\u6211\u7684\u7EC4\u7EC7/\u6211\u7684\u6C47\u62A5\u5173\u7CFB\u300D\u4E2D\u67E5\u770B\u6C47\u62A5\u5173\u7CFB"),className:"rootBoardHeaderTips"},t.createElement(ke.Z,{checked:d,onClick:this.changeReporting,className:"mLeft15"},_l("\u5168\u5458\u53EF\u4EE5\u67E5\u770B\u6C47\u62A5\u5173\u7CFB"))))),t.createElement("div",{className:b()("mainContent rootBoard box-sizing",{rootBoardBox:s})},t.createElement("div",{className:"card pAll20 box-sizing mLeft16 mRight16 h100"},s&&t.createElement(ze,{onChange:function(g){return e.setState({searchUser:g,nodeDialogVisible:!0})}}),f&&t.createElement(Kt,{auth:s,id:m.accountId,user:m,handleClose:function(){e.setState({nodeDialogVisible:!1,searchUser:void 0})},selectSearchUser:function(g){e.setState({searchUser:g})}}),t.createElement("div",{className:"wrapper",ref:function(g){e.wrapper=g}},t.createElement(We,{auth:s})))))}}]),a}(t.Component),Ve.defaultProps={isProjectAdmin:!0},Je);const Xt=(0,ae.$j)()(Qt);var Ye=u(22010),qt=u(53894),Ke=u(88106),Ie=u(69082),xe=new Ie.V_("users",{idAttribute:"accountId",defaults:{collapsed:!0,pageIndex:1,moreLoading:!1}});xe.define({subordinates:(0,Ie.CT)(xe)});function Qe(c){return c?(0,Ie.Fv)(c,(0,Ie.CT)(xe)):{}}var en=function(a,o){var e=o.type,n=o.payload,r=void 0;switch(e){case he:return(0,h.default)({},a);case Q:var l=n.source,i=n.id,s=n.moreLoading,d=n.pageIndex,p=n.totalCount,m=Qe(l).result;return(0,h.default)({},a,{subordinates:N().uniqBy((a.subordinates||[]).concat(m)),moreLoading:s||!1,pageIndex:d||a.pageIndex,subTotalCount:p||a.subTotalCount||0});case pe:case re:return(0,h.default)({},a,{collapsed:e===re});case oe:var f=n.removeId;return r=a.subordinates,(0,h.default)({},a,{subordinates:N().filter(r,function(g){return g!==f}),subTotalCount:a.subTotalCount-1});case fe:var v=n.addId;return r=a.subordinates,(0,h.default)({},a,{subordinates:r.concat(v),subTotalCount:N().isUndefined(a.subTotalCount)?0:a.subTotalCount+1})}},tn=function(a){var o=a.source,e=Qe(o);return e.entities.users},nn={entities:{users:{}},highLightId:null,isLoading:!1,highLightRootId:null};const an=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nn,a=arguments[1],o=a.type,e=a.payload;if(X[o]===void 0)return c;var n=c.entities.users,r=c.highLightId,l=c.highLightRootId,i=void 0,s=void 0;switch(o){case K:return(0,h.default)({},c,{entities:{users:(0,h.default)({},c.entities.users,tn(e))},highLightId:r});case Ne:i=e.id;var d=(0,h.default)({},n);return delete d[i],(0,h.default)({},c,{entities:{users:d}});case he:case Q:case fe:case oe:case pe:case re:return i=e.id,s=n[i],(0,h.default)({},c,{entities:(0,h.default)({},c.entities,{users:s?(0,h.default)({},n,(0,Ke.default)({},i,en(s,a))):n})});case Se:i=e.id,s=n[i];var p=n[e.replacedAccountId]||{},m=p.subordinates,f=p.subTotalCount,v=f===void 0?0:f;return(0,h.default)({},c,{entities:{users:(0,h.default)({},n,(0,Ke.default)({},i,(0,h.default)({},s,{subTotalCount:s.subTotalCount?s.subTotalCount+v:v,subordinates:s.subordinates?s.subordinates.concat(m):m})))},highLightId:r});case Re:return(0,h.default)({},c,{highLightId:null,highLightRootId:null});case ve:return(0,h.default)({},c,{highLightId:e.highLightId,highLightRootId:e.highLightRootId});case le:return(0,h.default)({},c,{isLoading:e.data});case ge:return(0,h.default)({},c,{firstLevelLoading:e.data});default:return c}},rn=(0,Ye.MT)(an,(0,Ye.md)(qt.Z));var on=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return o.from&&o.projectId?C.projectId=o.projectId:C.setPageTitle(_l("\u6C47\u62A5\u5173\u7CFB")),e}return(0,P.default)(a,[{key:"componentDidMount",value:function(){$("html").addClass("AppAdminReportRelation")}},{key:"componentWillUnmount",value:function(){$("html").removeClass("AppAdminReportRelation")}},{key:"render",value:function(){var e=this.props.from;return t.createElement(ae.zt,{store:rn},t.createElement(Xt,{from:e}))}}]),a}(t.Component),ln=[{label:_l("\u6211\u7684\u6C47\u62A5\u5173\u7CFB"),key:"report"},{label:_l("\u7EC4\u7EC7\u6C47\u62A5\u5173\u7CFB"),key:"enterprise"}],sn=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.state={activeBar:"report",isAdmin:!1,companyName:"",allowStructureSelfEdit:!1,allowStructureForAll:!1,parents:[],me:{},children:[],loading:!1,pageIndex:1,projectId:(0,Z.A_)().projectId},e}return(0,P.default)(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:function(){var e=this;this.setState({loading:!0});var n="";N().every(md.global.Account.projects,function(r){r.projectId===e.state.projectId&&(n=r.companyName)}),q().all([this.fetchAdmin(),this.fetchAllow(),this.fetchSubordinates()]).then(function(r){var l=(0,y.Z)(r,3),i=l[0],s=l[1],d=l[2],p=d.parent,m=p===void 0?{}:p,f=d.mySelf,v=f===void 0?{}:f,g=d.subordinates,T=g===void 0?[]:g,S=d.subTotalCount,A=d.isLimited;!N().isEmpty(v)&&e.state.pageIndex===1?e.setState({companyName:n,isAdmin:i,allowStructureForAll:s.allowStructureForAll,allowStructureSelfEdit:s.allowStructureSelfEdit,parents:N().isEmpty(m)?[]:[m],me:v,children:T,loading:!1,subTotalCount:S,isLimited:A}):alert(_l("\u83B7\u53D6\u5931\u8D25"),2)})}},{key:"fetchRender",value:function(e){var n=this;this.fetchSubordinates(e).then(function(r){var l=r.parent,i=l===void 0?{}:l,s=r.mySelf,d=s===void 0?{}:s,p=r.subordinates,m=p===void 0?[]:p,f=r.subTotalCount;!N().isEmpty(d)&&e===1?n.setState({parent:i,me:d,children:m,subTotalCount:f}):alert(_l("\u83B7\u53D6\u5931\u8D25"),2)})}},{key:"fetchSubordinates",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return k.Z.myStructures({projectId:this.state.projectId,pageIndex:e})}},{key:"fetchAdmin",value:function(){return Ct.Z.isProjectAdmin({projectId:this.state.projectId})}},{key:"fetchAllow",value:function(){return me.Z.getStructureForAll({projectId:this.state.projectId})}},{key:"handleChangeBar",value:function(e){this.setState({activeBar:e})}},{key:"handleAddSub",value:function(){var e=this.state.projectId,n=this,r=md.global.Account.accountId;(0,ue.Z)({title:_l("\u6DFB\u52A0\u4E0B\u5C5E"),showMoreInvite:!1,SelectUserSettings:{projectId:e,filterAll:!0,filterFriend:!0,filterOthers:!0,filterOtherProject:!0,unique:!1,showTabs:["structureUsers"],extraTabs:[{id:"structureUsers",name:"\u6240\u6709\u4EBA",type:4,page:!0,actions:{getUsers:function(i){return i=$.extend({},i,{accountId:r,projectId:e}),k.Z.getAllowChooseUsers(i)}}}],callback:function(i){k.Z.addStructure({accountIds:N().map(i,function(s){var d=s.accountId;return d}),parentId:r,isTop:!1,projectId:e}).then(function(s){s&&s.success?n.fetchRender(1):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})}}})}},{key:"handleDelBtn",value:function(e){var n=e.accountId,r=e.fullname,l=this.state.projectId,i=this;R.Z.confirm({title:_l("\u786E\u8BA4\u79FB\u9664 %0 ?",r),description:_l("\u79FB\u9664\u540E\uFF0C\u5176\u4E0B\u5C5E\u6210\u5458\u4E5F\u5C06\u4ECE\u6C47\u62A5\u5173\u7CFB\u4E2D\u79FB\u9664"),onOk:function(){k.Z.removeParentID({accountId:n,projectId:l}).then(function(d){d?(i.setState({pageIndex:1}),i.fetchRender(1)):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})}})}},{key:"handleGoAdmin",value:function(){location.href="/admin/reportRelation/"+this.state.projectId}},{key:"renderContent",value:function(){var e=this,n=this.state,r=n.isAdmin,l=n.parents,i=n.me,s=n.children,d=n.allowStructureSelfEdit,p=n.subTotalCount,m=n.loadMoreLoading,f=n.isLimited;return t.createElement("div",{className:"layoutWrapper"},t.createElement("div",null,t.createElement("div",{className:"listTitle"},_l("\u76F4\u5C5E\u4E0A\u7EA7")),t.createElement("div",{className:b()("list parents")},l.length?this.renderList(l):t.createElement("div",{className:"node Font16 LineHeight80 TxtCenter"},_l("\u6CA1\u6709\u914D\u7F6E\u4E0A\u53F8")))),t.createElement("div",null,t.createElement("div",{className:"mBottom40"}),t.createElement("div",{className:"list"},this.renderBuildItem(i))),t.createElement("div",null,t.createElement("div",{className:b()("listTitle",{Hidden:!d&&!s.length})},_l("\u6211\u7684\u4E0B\u5C5E")),t.createElement("div",{className:"list children"},s.length?this.renderList(s):null,d&&!f&&t.createElement("div",{className:"node Font16 LineHeight80 Gray_bd addSub Hand",onClick:function(){return e.handleAddSub()}},t.createElement("span",{className:"Font24 mRight15 mLeft24 TxtMiddle icon-add-member2"}),t.createElement("span",{className:"TxtMiddle"},_l("\u6DFB\u52A0\u6211\u7684\u4E0B\u5C5E"))),p>s.length&&t.createElement("div",{className:"Hand loadMore",onClick:function(){m||e.setState({pageIndex:e.state.pageIndex+1,loadMoreLoading:!0},function(){e.fetchSubordinates(e.state.pageIndex).then(function(g){var T=g.subordinates,S=T===void 0?[]:T;e.setState({children:e.state.children.concat(S),loadMoreLoading:!1})})})}},m?_l("\u52A0\u8F7D\u4E2D"):_l("\u66F4\u591A")))))}},{key:"renderList",value:function(e){var n=this;return e.map(function(r){return n.renderBuildItem(r)})}},{key:"renderBuildItem",value:function(e){var n=this,r=this.state,l=r.allowStructureSelfEdit,i=r.subTotalCount;return t.createElement("div",{className:b()("node",e.status===4?"disabled":"ThemeHoverBorderColor3")},t.createElement("div",{className:"userItem"},t.createElement("img",{src:e.avatar,className:"avatar"}),t.createElement("div",{className:"info"},t.createElement("div",{className:"name"},e.fullname),t.createElement("div",{className:"department"},e.department),t.createElement("div",{className:"job"},e.job)),e.accountId===md.global.Account.accountId&&i?t.createElement("div",{className:"subordinateCount"},t.createElement("span",{className:"icon-charger Gray_a TxtMiddle Font14"}),t.createElement("span",{className:"TxtMiddle Gray mLeft5"},i)):null,l?t.createElement("span",{className:"icon-close delBtn",onClick:function(){return n.handleDelBtn(e)}}):null))}},{key:"render",value:function(){var e=this,n=this.state,r=n.allowStructureForAll,l=n.isAdmin,i=n.activeBar,s=n.loading;return s?t.createElement(L.Z,null):t.createElement("div",{className:"reportRelationEnterprise"},t.createElement("div",{className:"reportHeader"},t.createElement("div",{className:"headerIcon"},t.createElement(Y.Z,{icon:"backspace",className:"Hand mRight18 TxtMiddle Font24 Hover_49",onClick:function(){return(0,ye.T8)("/personal?type=enterprise")}}),t.createElement("span",{className:"Font17 Bold"},_l("\u6211\u7684\u6C47\u62A5\u5173\u7CFB"))),t.createElement("div",{className:b()("headerOption",{Hidden:!r})},ln.map(function(d){return t.createElement("div",{className:b()("headerOptionItem",{active:i===d.key}),key:d.key,onClick:function(){return e.handleChangeBar(d.key)}},d.label)})),t.createElement("div",null,t.createElement("span",{className:b()("ThemeColor3 Hand Hover_49",{Hidden:!l}),onClick:function(){return e.handleGoAdmin()}},_l("\u53BB\u7BA1\u7406\u540E\u53F0\u67E5\u770B")))),t.createElement("div",{className:"reportContent"},i==="report"?this.renderContent():t.createElement(on,{projectId:this.state.projectId,from:"myReport"})))}}]),a}(t.Component),cn=function(c){(0,H.default)(a,c);function a(o){(0,D.default)(this,a);var e=(0,F.default)(this,(a.__proto__||j()(a)).call(this,o));return e.state={pageIndex:1,pageSize:500,list:[],count:0,token:"",loading:!1,isEnterprise:!1,authCount:0,dialog:{visible:!1,data:null}},e}return(0,P.default)(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;(0,Z.A_)().type==="enterprise"?(this.setState({loading:!0}),q().all([this.getList(),this.getUntreatAuthList()]).then(function(n){var r=(0,y.Z)(n,2),l=r[0],i=r[1];e.setState({list:l.list,count:l.allCount,isEnterprise:l.allCount>0,authCount:i.count,loading:!1})})):this.setState({isEnterprise:(0,Z.A_)().type})}},{key:"getList",value:function(){return B.Z.getProjectList({pageIndex:this.state.pageIndex,pageSize:this.state.pageSize})}},{key:"getUntreatAuthList",value:function(){return B.Z.getUntreatAuthList({})}},{key:"renderListCard",value:function(){var e=this,n=this.state.list;return t.createElement(t.Fragment,null,n&&n.map(function(r){return t.createElement(Et,{card:r,key:r.projectId,getData:function(){return e.getData()}})}))}},{key:"handleAdd",value:function(){location.href="/enterpriseRegister?type=add"}},{key:"handleInvitation",value:function(){var e=this;B.Z.getMyAuthList({}).then(function(n){n.list?e.setState({dialog:{visible:!0,data:n.list}}):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)}).catch()}},{key:"existUserNotice",value:function(e){switch(e){case 1:alert(_l("\u60A8\u5DF2\u662F\u8BE5\u7EC4\u7EC7\u6210\u5458"),3);break;case 2:alert(_l("\u60A8\u5DF2\u88AB\u8BE5\u7EC4\u7EC7\u62D2\u7EDD\u52A0\u5165"),3);break;case 3:alert(_l("\u60A8\u5DF2\u662F\u8BE5\u7EC4\u7EC7\u6210\u5458\uFF0C\u8BF7\u7B49\u5F85\u5BA1\u6279"),3);break;case 4:alert(_l("\u60A8\u5DF2\u4ECE\u8BE5\u7EC4\u7EC7\u9000\u51FA\uFF0C\u9700\u8054\u7CFB\u8BE5\u7EC4\u7EC7\u7684\u7EC4\u7EC7\u7BA1\u7406\u5458\u8FDB\u884C\u6062\u590D"),3);break;default:alert(_l("\u60A8\u5DF2\u662F\u8BE5\u7EC4\u7EC7\u7684\u6210\u5458"),3)}}},{key:"handleCreate",value:function(){md.global.Account.superAdmin||md.global.Config.IsPlatformLocal&&md.global.SysSettings.enableCreateProject?window.open("/enterpriseRegister?type=create"):alert("\u6743\u9650\u4E0D\u8DB3\uFF0C\u65E0\u6CD5\u521B\u5EFA\u7EC4\u7EC7",3)}},{key:"renderContent",value:function(){var e=this,n=this.state.authCount;return(0,Z.A_)().type==="enterprise"?t.createElement("div",{className:"enterpriceContainer"},t.createElement("div",{className:"enterpriseHeader"},t.createElement("div",{className:"Gray Font17 Bold"},_l("\u6211\u7684\u7EC4\u7EC7")),t.createElement("div",{className:"flexRow"},t.createElement("div",{className:"Gray_75 Font14 Hand Relative LineHeight32",onClick:function(){return e.handleInvitation()}},t.createElement("span",{className:"hover_blue"},_l("\u6211\u7684\u53D7\u9080\u4FE1\u606F")),t.createElement("span",{className:b()("invitationNew",{Hidden:!n})},n)),(md.global.Config.IsLocal&&md.global.Account.superAdmin||!md.global.Config.IsLocal)&&t.createElement("div",{className:"Font14 Hand mLeft40 mRight30 itemCreat",onClick:function(){return e.handleCreate()}},_l("\u521B\u5EFA\u7EC4\u7EC7")),t.createElement("button",{type:"button",className:"ming Button Button--primary itemJoin",onClick:function(){return e.handleAdd()}},_l("\u52A0\u5165\u7EC4\u7EC7")))),t.createElement("div",{className:"enterpriseContent"},this.renderListCard())):t.createElement(sn,null)}},{key:"render",value:function(){var e=this,n=this.state,r=n.loading,l=n.isEnterprise,i=n.authCount,s=n.dialog;return r?t.createElement(L.Z,{className:"mTop40"}):t.createElement(t.Fragment,null,l?this.renderContent():t.createElement("div",{className:"noEnterpriceContainer"},t.createElement("div",{className:"withoutEnterpriseHeader"},t.createElement("span",{className:"Font17 Gray Bold"},_l("\u6211\u7684\u7EC4\u7EC7")),t.createElement("span",null,t.createElement("span",{className:"Hand MyInvitation Relative LineHeight30 Fong14",onClick:function(){return e.handleInvitation()}},_l("\u6211\u7684\u53D7\u9080\u4FE1\u606F"),t.createElement("span",{className:b()("invitationNew",{Hidden:!i})},i>99?"99+":i)),t.createElement("span",{className:"Font14 Hand mLeft40 mRight30 itemCreat InlineBlock",onClick:function(){return e.handleCreate()}},_l("\u521B\u5EFA\u7EC4\u7EC7")),t.createElement("span",{className:"addBtn Hand",onClick:function(){return e.handleAdd()}},_l("\u52A0\u5165\u7EC4\u7EC7")))),t.createElement("div",{className:"withoutEnterpriseTopBox TxtCenter clearfix"},t.createElement("span",{className:"icon-business1 mBottom40 Font56"}),t.createElement("span",null,_l("\u60A8\u8FD8\u6CA1\u6709\u52A0\u5165\u4EFB\u4F55\u7EC4\u7EC7\uFF0C\u8BF7"),t.createElement("span",{className:"Hand mLeft5 mRight5 highLight InlineBlock",onClick:function(){return e.handleCreate()}},_l("\u521B\u5EFA")),_l("\u6216"),t.createElement("span",{className:"Hand mLeft5 highLight InlineBlock",onClick:function(){return e.handleAdd()}},_l("\u52A0\u5165\u7EC4\u7EC7"))))),t.createElement(R.Z,{showFooter:!1,visible:s.visible,onCancel:function(){return e.setState({dialog:{visible:!1,data:null}})}},t.createElement(It,{list:s.data,updateAuthCount:function(){return e.setState({authCount:e.state.authCount-1})},existUserNotice:this.existUserNotice,closeDialog:function(){return e.setState({dialog:{visible:!1,data:null}})}})))}}]),a}(t.Component)}}]);
