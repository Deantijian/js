"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[4558],{4558:(bt,ee,d)=>{d.r(ee),d.d(ee,{default:()=>Nt});var O={};d.r(O),d.d(O,{getPositionList:()=>Qe,getUserList:()=>pe,updateCurrentPosition:()=>ue,updateIsImportRole:()=>ot,updateIsLoading:()=>qe,updatePositionList:()=>de,updatePositionPageInfo:()=>me,updateProjectId:()=>Xe,updateSearchValue:()=>et,updateSelectUserIds:()=>nt,updateUserPageIndex:()=>tt,updateUserloading:()=>at});var ye=d(85105),b=d.n(ye),C=d(99663),S=d(22600),L=d(49135),k=d(93196),t=d(67294),Ne=d(51197),j=d(88239),W=d(12424),Ee=d(46593),V=d.n(Ee),Ct=d(34279),te=d(64749),ae=d(88106),be=d(63047),Ce=d(51156),Se=d(93967),D=d.n(Se),Z=d(28829),R=d(29208),Le=d(96486),I=d.n(Le),ke={1:_l("\u4FEE\u6539\u7EC4\u7EC7\u540D\u79F0"),2:_l("\u6240\u5728\u5730"),3:_l("\u8BBE\u7F6E\u6240\u5728\u884C\u4E1A")},je={companyDisplayName:function(s){if($.trim(s)==="")return{msg:_l("\u4F01\u4E1A\u7B80\u79F0\u4E0D\u80FD\u4E3A\u7A7A")}},companyName:function(s){if($.trim(s)==="")return{msg:_l("\u4F01\u4E1A\u5168\u79F0\u4E0D\u80FD\u4E3A\u7A7A")}}},Pe=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.renderOrgName=function(){var a=e.state,o=a.errors,i=a.companyDisplayName,r=a.companyName,l=a.companyNameEnglish;return t.createElement("div",{className:"org-name-form"},t.createElement("div",{className:"formGroup"},t.createElement("span",{className:"formLabel"},_l("\u7B80\u79F0"),t.createElement("span",{className:"TxtMiddle Red"},"*")),t.createElement("div",{className:"formDescribe"},_l("\u7528\u4E8E\u7F51\u7AD9\u9875\u5934\u7684\u663E\u793A\uFF0C\u8BF7\u5C3D\u91CF\u7B80\u77ED")),t.createElement("input",{type:"text",className:D()("formControl",{error:o.companyDisplayName&&o.companyDisplayName.msg}),defaultValue:i,onChange:e.handleFieldInput.bind(e,"companyDisplayName"),onBlur:e.handleFieldBlur.bind(e,"companyDisplayName"),onFocus:e.clearError.bind(e,"companyDisplayName")}),t.createElement("div",{className:D()("Block Red errorBox",{Hidden:o.companyDisplayName&&o.companyDisplayName.msg})},o.companyDisplayName&&o.companyDisplayName.msg)),t.createElement("div",{className:"formGroup"},t.createElement("span",{className:"formLabel"},_l("\u5168\u79F0"),t.createElement("span",{className:"TxtMiddle Red"},"*")),t.createElement("div",{className:"formDescribe"},_l("\u7528\u4E8E\u8D26\u5355\u548C\u53D1\u7968\u62AC\u5934\uFF0C\u8BF7\u786E\u4FDD\u51C6\u786E")),t.createElement("input",{type:"text",className:D()("formControl",{error:o.companyName&&o.companyName.msg}),defaultValue:r,onChange:e.handleFieldInput.bind(e,"companyName"),onBlur:e.handleFieldBlur.bind(e,"companyName"),onFocus:e.clearError.bind(e,"companyName")}),t.createElement("div",{className:D()("Block Red errorBox",{Hidden:o.companyName&&o.companyName.msg})},o.companyName&&o.companyName.msg)),t.createElement("div",{className:"formGroup"},t.createElement("span",{className:"formLabel"},_l("\u82F1\u6587\u5168\u79F0")),t.createElement("input",{type:"text",className:"formControl",defaultValue:l,onChange:e.handleFieldInput.bind(e,"companyNameEnglish")})))},e.state={visible:!0,title:"",companyDisplayName:e.props.companyDisplayName,companyName:e.props.companyName,companyNameEnglish:e.props.companyNameEnglish,errors:{},industryId:e.props.industryId,geographyId:e.props.geographyId,geographyName:e.props.geographyName,industryName:e.props.industryName},e}return(0,S.default)(s,[{key:"componentDidMount",value:function(){this.setState({title:ke[this.props.visibleType]})}},{key:"handleFieldBlur",value:function(e){var a=this,o=this.state.errors,i=o===void 0?{}:o,r=this.state[e],l=je[e](r);l&&(i[e]=l,this.setState({errors:i})),R.Z.checkSensitive({content:r}).then(function(c){c&&a.setState({errors:(0,j.default)({},i,(0,ae.default)({},e,_l("\u8F93\u5165\u5185\u5BB9\u5305\u542B\u654F\u611F\u8BCD\uFF0C\u8BF7\u91CD\u65B0\u586B\u5199")))})})}},{key:"handleFieldInput",value:function(e,a){this.setState((0,ae.default)({},e,a.target.value))}},{key:"clearError",value:function(e){var a=this.state.errors;delete a[e],this.setState({errors:a})}},{key:"valueUpdate",value:function(e){e&&e.length&&this.setState({geographyName:e.map(function(a){return a.name}).join("/"),geographyId:I().get(e[e.length-1],"id")})}},{key:"renderOrgGeography",value:function(){var e=this,a=this.state.geographyName;return t.createElement(Ce.Z,{callback:function(i){e.valueUpdate(i)}},t.createElement("input",{type:"text",placeholder:_l("\u8BF7\u9009\u62E9\u6240\u5728\u5730"),value:a,className:"ming Input w100",readOnly:!0}))}},{key:"handleIndustryChange",value:function(e,a){this.setState({industryId:e,industryName:a.children})}},{key:"renderOrgIndustry",value:function(){var e=this.state.industryId?this.state.industryId+"":void 0,a=this.props.industries;return t.createElement(te.default,{className:"w100",placeholder:_l("\u8BF7\u9009\u62E9\u6240\u5728\u884C\u4E1A"),value:e,onChange:this.handleIndustryChange.bind(this)},a&&a.map(function(o){return t.createElement(te.default.Option,{value:o.id,key:o.id},o.name)}))}},{key:"handleFieldSubmit",value:function(){var e=this;if(!(this.state.errors&&I().keys(this.state.errors).length)){var a=this.state,o=a.companyDisplayName,i=a.companyNameEnglish,r=a.companyName,l=a.industryName,c=a.industryId,u=a.geographyName,f=a.geographyId;V().all([R.Z.checkSensitive({content:o}),R.Z.checkSensitive({content:r})]).then(function(m){m.find(function(g){return g})?alert(_l("\u8F93\u5165\u5185\u5BB9\u5305\u542B\u654F\u611F\u8BCD\uFF0C\u8BF7\u91CD\u65B0\u586B\u5199"),3):Z.Z.setProjectInfo({companyName:r,companyDisplayName:o,companyNameEnglish:i,industryId:c,geographyId:f,projectId:e.props.projectId}).then(function(g){g==0?alert(_l("\u8BBE\u7F6E\u5931\u8D25"),2):g==1?(e.props.updateValue({companyDisplayName:o,companyNameEnglish:i,companyName:r,industryId:c,industryName:l,geographyId:f,geographyName:u}),alert(_l("\u8BBE\u7F6E\u6210\u529F"))):g==3&&alert(_l("\u60A8\u8F93\u5165\u7684\u4FE1\u606F\u542B\u6709\u7981\u7528\u8BCD\u6C47"),3)})})}}},{key:"renderBodyContent",value:function(){switch(this.props.visibleType){case 1:return this.renderOrgName();case 2:return this.renderOrgGeography();case 3:return this.renderOrgIndustry()}}},{key:"hideDialog",value:function(){var e=this;this.setState({visible:!1},function(){e.props.updateValue({visibleType:0})})}},{key:"render",value:function(){var e=this,a=this.state,o=a.visible,i=a.title;return t.createElement(be.Z,{visible:o,title:t.createElement("span",{className:"Font17 Bold"},i),cancelText:_l("\u53D6\u6D88"),okText:_l("\u786E\u5B9A"),width:"480",overlayClosable:!1,onCancel:function(){e.hideDialog()},onOk:function(){return e.handleFieldSubmit()}},this.renderBodyContent())}}]),s}(t.Component),y=d(64712),T=d(54208),x=d(99924),De=d(36964),ne=d.n(De),oe=d(17915),Te=d(15216),St=d(16461),J=d(15577),xe=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.openAllowProjectCodeJoin=function(a){var o=a.showDialogSettingInviteRules;e.setState({showDialogSettingInviteRules:o}),o||e.getPrivacy()},e.industries=[],e.state={logo:"",code:"",homeImage:"",subDomain:"",companyDisplayName:"",companyName:"",companyNameEnglish:"",industryId:"",industryName:"",geographyName:"",geographyId:"",visibleType:0,isUploading:!1,isLoading:!1,uploadLoading:!1,showDialogSettingInviteRules:!1},e}return(0,S.default)(s,[{key:"componentDidMount",value:function(){this.getAllData(),this.getPrivacy()}},{key:"componentWillReceiveProps",value:function(e){e.level!==this.props.level&&(this.getAllData(),this.getPrivacy())}},{key:"getAllData",value:function(){var e=this;this.setState({isLoading:!0}),V().all([this.getSysColor(),this.getSubDomainInfo(),this.getCommonInfo(),this.getIndustryList()]).then(function(a){var o=(0,W.Z)(a,4),i=o[0],r=i.homeImage,l=i.logo,c=o[1],u=o[2],f=u.companyDisplayName,m=u.companyName,g=u.companyNameEnglish,v=u.geographyId,E=u.industryId,h=o[3].industries,N=h===void 0?[]:h;e.industries=N;var U=I().find(N,function(_){return _.id===E.toString()})||{},B=U.name;v&&R.Z.getCitysByParentID({parentId:v}).then(function(_){e.setState({geographyName:I().get(_.values,"displayText")})}),e.setState({homeImage:r+"?imageView2/2/w/194/h/52/q/90",logo:l,subDomain:c&&c.subDomain||"",companyDisplayName:f,companyName:m,companyNameEnglish:g,geographyId:v,industryId:E,industryName:B,isLoading:!1},function(){y.Z.project.licenseType!==0&&e.postUploader()})})}},{key:"getLicenseType",value:function(){return Z.Z.getProjectLogOff({projectId:y.Z.projectId})}},{key:"getSysColor",value:function(){return x.Z.getSysColor({projectId:y.Z.projectId})}},{key:"getSubDomainInfo",value:function(){return x.Z.getSubDomain({projectId:y.Z.projectId})}},{key:"getCommonInfo",value:function(){return Z.Z.getProjectInfo({projectId:y.Z.projectId})}},{key:"getIndustryList",value:function(){return R.Z.loadIndustry({})}},{key:"getPrivacy",value:function(){var e=this;x.Z.getPrivacy({projectId:y.Z.projectId}).then(function(a){var o=a.allowProjectCodeJoin,i=a.regCode;e.setState({allowProjectCodeJoin:o,code:i})})}},{key:"toggleComp",value:function(e){this.props.setLevel(e)}},{key:"updateValue",value:function(e){this.setState((0,j.default)({},e,{visibleType:0}))}},{key:"updateVisible",value:function(e){this.setState({visibleType:e})}},{key:"postUploader",value:function(){if(!this.state.uploadLoading){var e=this;$("#hideUploadImage").uploadAttachment({filterExtensions:"gif,png,jpg,jpeg,bmp",pluploadID:"#upload_image",multiSelection:!1,maxTotalSize:4,folder:"ProjectLogo",onlyFolder:!0,onlyOne:!0,styleType:"0",tokenType:4,checkProjectLimitFileSizeUrl:"",filesAdded:function(){e.setState({uploadLoading:!0})},callback:function(o){if(o.length>0){var i=o[0],r=i.serverName+i.filePath+i.fileName+i.fileExt,l=i.fileName+i.fileExt;e.setLogo(r,l)}}})}}},{key:"setLogo",value:function(e,a){var o=this;x.Z.setLogo({logoName:a,projectId:y.Z.projectId}).then(function(i){i?o.setState({logo:e,uploadLoading:!1}):(o.setState({uploadLoading:!1}),alert(_l("\u4FDD\u5B58\u5931\u8D25"),2))})}},{key:"handleCopyTextSuccess",value:function(){alert(_l("\u590D\u5236\u6210\u529F"))}},{key:"render",value:function(){var e=this,a=this.state,o=a.logo,i=a.companyDisplayName,r=a.companyName,l=a.companyNameEnglish,c=a.geographyId,u=a.industryId,f=a.industryName,m=a.geographyName,g=a.visibleType,v=a.subDomain,E=a.homeImage,h=a.code,N=a.isLoading,U=a.allowProjectCodeJoin,B=a.showDialogSettingInviteRules,_=[1,2,3].indexOf(g)>-1,q=(0,J.vo)(y.Z.projectId),ve=q.isSuperAdmin;return t.createElement("div",{className:"orgManagementWrap"},t.createElement("div",{className:"orgManagementHeader"},t.createElement("span",{className:"Font17"},_l("\u57FA\u7840\u4FE1\u606F"))),t.createElement("div",{className:"orgManagementContent"},N?t.createElement(T.Z,null):t.createElement("div",{className:"common-info"},_&&t.createElement(Pe,{projectId:y.Z.projectId,visibleType:g,companyDisplayName:i,companyName:r,companyNameEnglish:l,geographyId:c,geographyName:m,industryName:f,industryId:u,industries:this.industries,updateValue:this.updateValue.bind(this)}),t.createElement("div",{className:"common-info-row"},t.createElement("div",{className:"common-info-row-label"},_l("\u7EC4\u7EC7LOGO"),y.Z.project.licenseType===0&&t.createElement(Ne.Z,{className:"mTop2"})),t.createElement("div",{className:"common-info-row-content"},t.createElement("div",{className:"Hand"},t.createElement("input",{id:"hideUploadImage",type:"file",className:"Hidden"}),t.createElement("div",{className:"logoBoxBorder"},t.createElement("img",{src:o,alt:"avatar"}),t.createElement("div",{className:"logoIconBox",id:"upload_image",onClick:function(){if(y.Z.project.licenseType===0){oe.Z.freeUpdateDialog();return}}},t.createElement("span",{className:"Font15 icon-upload_pictures"})))),t.createElement("div",{className:"set-describe mTop10"},_l("\u63A8\u8350\u5C3A\u5BF8 400*180 px\uFF0C\u663E\u793A\u5728\u5DE5\u4F5C\u53F0\u3001\u6253\u5370\u3001\u5206\u4EAB\u548C\u4F01\u4E1A\u57DF\u540D\u9875\u9762\uFF0C\u5927\u5C0F\u5EFA\u8BAE\u5728512KB\u4EE5\u5185")))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u7EC4\u7EC7\u540D\u79F0")),i&&t.createElement("span",{className:"mRight16"},i),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:this.updateVisible.bind(this,1)},_l("\u4FEE\u6539"))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u7EC4\u7EC7\u95E8\u724C\u53F7")),t.createElement("div",{className:"common-info-row-content"},t.createElement(ne(),{className:"adminHoverColor Hand",component:"span","data-clipboard-text":h,onSuccess:this.handleCopyTextSuccess.bind(this)},t.createElement("span",null,h),t.createElement("span",{className:"icon-content-copy Font12 mLeft5"})),U?t.createElement("div",{className:"set-describe mTop4"},_l("\u6210\u5458\u53EF\u8F93\u5165\u7EC4\u7EC7\u95E8\u724C\u53F7\u52A0\u5165\u7EC4\u7EC7")):t.createElement("div",{className:"set-describe mTop4"},_l("\u60A8\u5DF2\u5173\u95ED\u641C\u7D22\u7EC4\u7EC7\u95E8\u724C\u53F7\u52A0\u5165"),t.createElement("span",{className:"mLeft8 open-setting-rules-Txt",onClick:function(){return e.openAllowProjectCodeJoin({showDialogSettingInviteRules:!0})}},_l("\u53BB\u5F00\u542F"))))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u7EC4\u7EC7\u7F16\u53F7(ID)")),t.createElement("div",{className:"common-info-row-content"},t.createElement(ne(),{className:"adminHoverColor Hand",component:"span","data-clipboard-text":y.Z.projectId,onSuccess:this.handleCopyTextSuccess.bind(this)},t.createElement("span",null,y.Z.projectId),t.createElement("span",{className:"icon-content-copy Font12 mLeft5"})),t.createElement("div",{className:"set-describe mTop4"},_l("\u7EC4\u7EC7\u552F\u4E00\u8EAB\u4EFD\u7F16\u53F7\uFF0C\u7528\u4E8E\u6C9F\u901A\u53CD\u9988\u95EE\u9898\u65F6\u4F7F\u7528")))),t.createElement("div",{className:"split-line"}),t.createElement("div",{className:"common-info-row"},t.createElement("div",{className:"common-info-row-label"},_l("\u6240\u5728\u5730")),m&&t.createElement("span",{className:"mRight16"},m),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:this.updateVisible.bind(this,2)},c?_l("\u4FEE\u6539"):_l("\u8BBE\u7F6E"))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u6240\u5728\u884C\u4E1A")),f&&t.createElement("span",{className:"mRight16"},f),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:this.updateVisible.bind(this,3)},u?_l("\u4FEE\u6539"):_l("\u8BBE\u7F6E"))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u6269\u5C55\u4FE1\u606F")),t.createElement("div",{className:"common-info-row-content"},t.createElement("div",null,v?t.createElement("span",{className:"Font13"},v):t.createElement("span",{className:"set-describe"},_l("\u53EF\u81EA\u5B9A\u4E49\u7EC4\u7EC7\u522B\u540D\u548C\u767B\u5F55\u80CC\u666F\u56FE\u7247")),t.createElement("button",{type:"button",className:"ming Button Button--link mLeft12 ThemeColor3 adminHoverColor",onClick:function(){if(y.Z.project.licenseType===0){oe.Z.freeUpdateDialog();return}e.toggleComp(2)}},_l("\u8BBE\u7F6E"))),E&&t.createElement("img",{src:E,className:"domain-review"}))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u804C\u4F4D\u5217\u8868")),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:this.toggleComp.bind(this,5)},_l("\u8BBE\u7F6E"))),t.createElement("div",{className:"common-info-row mTop24"},t.createElement("div",{className:"common-info-row-label"},_l("\u5DE5\u4F5C\u5730\u70B9")),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:this.toggleComp.bind(this,3)},_l("\u8BBE\u7F6E"))))),B&&t.createElement(Te.Z,{showDialogSettingInviteRules:B,setValue:this.openAllowProjectCodeJoin,projectId:y.Z.projectId}))}}]),s}(t.Component),F=d(70801),Lt=d(67272),se=d(51024),P=d(33867),we=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.images=[],e.state={subDomain:"",domainName:"",dialogName:"",homeImage:"",currentHomeImage:"",isCustomImage:!1,visible:!1,isUploading:!1,isLoading:!1},e}return(0,S.default)(s,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),V().all([this.getSubDomainInfo(),this.getSysColor()]).then(function(a){var o=(0,W.Z)(a,2),i=o[0],r=o[1].homeImage,l=md.global.FileStoreConfig.pictureHost+"ProjectLogo/";e.images=new Array(5).fill(1).map(function(u,f){return l+"HomeImage_1"+(f+1)+".jpg?imageView2/2/w/194/h/52/q/90"}),console.log(e.images);var c=r.split("/")||[];e.setState({subDomain:i&&i.subDomain||"",homeImage:c[c.length-1],domainName:i&&i.subDomain||"",dialogName:i&&i.subDomain||"",currentHomeImage:r,isCustomImage:r?e.testHomeImage(r):!1,isLoading:!1},function(){e.createUploader()})})}},{key:"createUploader",value:function(){var e=this;e.state.isUploading||$(e.upload).uploadAttachment({filterExtensions:"gif,png,jpg,jpeg,bmp",pluploadID:"#upload_file",multiSelection:!1,maxTotalSize:2,folder:"ProjectLogo",fileNamePrefix:"HomeImage_",onlyFolder:!0,onlyOne:!0,styleType:"0",tokenType:4,checkProjectLimitFileSizeUrl:"",filesAdded:function(){e.setState({isUploading:!0})},callback:function(o){if(o.length>0){var i=o[0],r=i.serverName+i.filePath+i.fileName+i.fileExt;e.setState({homeImage:i.fileName+i.fileExt,currentHomeImage:r+"?imageView2/2/w/192/h/50/q/90",isCustomImage:e.testHomeImage(i.fileName),isUploading:!1})}}})}},{key:"getSysColor",value:function(){return x.Z.getSysColor({projectId:y.Z.projectId})}},{key:"getSubDomainInfo",value:function(){return x.Z.getSubDomain({projectId:y.Z.projectId})}},{key:"updateVisible",value:function(e,a){var o=this;this.setState({visible:e},function(){a==="update"&&o.setState({domainName:o.state.dialogName})})}},{key:"testHomeImage",value:function(e){var a=["HomeImage_11","HomeImage_12","HomeImage_13","HomeImage_14","HomeImage_15","HomeImage_16"],o=I().findIndex(a,function(i){return e.includes(i)});return o<0}},{key:"updateHomeImage",value:function(e,a){this.setState({homeImage:"HomeImage_1"+(a+1)+".jpg",currentHomeImage:e,isCustomImage:this.testHomeImage("HomeImage_1"+(a+1))})}},{key:"handleChange",value:function(e){this.setState({dialogName:$.trim(e.target.value)})}},{key:"handleSubmit",value:function(){var e=this;if(this.state.subDomain){this.handleHomeImageSubmit().then(function(a){a?(alert(_l("\u8BBE\u7F6E\u6210\u529F")),e.props.setLevel(1)):alert(_l("\u8BBE\u7F6E\u5931\u8D25"),2)});return}V().all([this.handleHomeImageSubmit(),this.handleSubDomainSubmit()]).then(function(a){var o=(0,W.Z)(a,2),i=o[0],r=o[1];i&&r===1?(alert(_l("\u8BBE\u7F6E\u6210\u529F")),e.props.setLevel(1)):r===2?alert(_l("\u60A8\u8BBE\u7F6E\u7684\u522B\u540D\u5DF2\u7ECF\u88AB\u5360\u7528"),3):(!i||r===3)&&alert(_l("\u8BBE\u7F6E\u5931\u8D25"),2)})}},{key:"handleHomeImageSubmit",value:function(){return x.Z.setCustomeHomeImage({imageName:this.state.homeImage,projectId:y.Z.projectId})}},{key:"handleSubDomainSubmit",value:function(){return x.Z.setSubDomin({subDomain:this.state.domainName,projectId:y.Z.projectId})}},{key:"render",value:function(){var e=this,a=this.state,o=a.subDomain,i=a.domainName,r=a.isLoading,l=a.currentHomeImage,c=a.visible,u=a.isCustomImage;return t.createElement("div",{className:"orgManagementWrap"},t.createElement("div",{className:"orgManagementHeader justifyContentLeft"},t.createElement(P.Z,{icon:"backspace",className:"Hand mRight18 TxtMiddle Font24 adminHeaderIconColor",onClick:function(){return e.props.setLevel(1)}}),t.createElement("span",{className:"Font17"},_l("\u6269\u5C55\u4FE1\u606F\u8BBE\u7F6E"))),t.createElement("div",{className:"orgManagementContent"},r?t.createElement(T.Z,null):t.createElement("div",{className:"sub-domain"},t.createElement(F.Z,{visible:c,title:_l("\u8BBE\u7F6E\u7EC4\u7EC7\u522B\u540D"),cancelText:_l("\u53D6\u6D88"),okText:_l("\u786E\u5B9A"),width:"480",overlayClosable:!1,onCancel:this.updateVisible.bind(this,!1),onOk:function(){e.updateVisible(!1,"update")}},t.createElement(se.default,{defaultValue:i,className:"w100 mTop25",ref:function(m){return e.inputValue=m},onChange:this.handleChange.bind(this)})),t.createElement("div",{className:"common-info-row"},t.createElement("div",{className:"common-info-row-label"},_l("\u7EC4\u7EC7\u522B\u540D")),t.createElement("div",{className:"common-info-row-content"},t.createElement("div",null,i?t.createElement("span",{className:"color_b"},i):t.createElement("span",{className:"domain-describe"},_l("\u53EF\u901A\u8FC7\u8BBE\u7F6E\u7EC4\u7EC7\u522B\u540D\u6765\u5B9E\u73B0\u66F4\u591A\u7684\u4F7F\u7528\u573A\u666F\uFF08\u5982\uFF1ALDAP \u767B\u5F55\u65F6\u6307\u5B9A\u7EC4\u7EC7\uFF09\u3002")),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:this.updateVisible.bind(this,!0)},i?_l("\u4FEE\u6539"):_l("\u8BBE\u7F6E"))))),t.createElement("div",{className:"split-line"}),t.createElement("div",{className:"common-info-row Font14 Bold"},_l("\u767B\u5F55\u80CC\u666F\u56FE\u7247")),t.createElement("div",{className:"common-info-row mTop40"},t.createElement("div",{className:"common-info-row-label"},_l("\u7CFB\u7EDF\u9ED8\u8BA4")),t.createElement("div",{className:"common-images"},this.images.map(function(f,m){return t.createElement("img",{key:m,src:f,className:"Hand homeImage "+(l.indexOf("HomeImage_1"+(m+1)+".jpg")>-1?"ThemeBorderColor3":""),onClick:e.updateHomeImage.bind(e,f,m)})}))),t.createElement("div",{className:"common-info-row mTop40"},t.createElement("div",{className:"common-info-row-label"},_l("\u81EA\u5B9A\u4E49")),t.createElement("div",null,t.createElement("div",{className:"avatar-uploader",id:"upload_file"},t.createElement("input",{ref:function(m){return e.upload=m},type:"hidden"}),u?t.createElement("img",{src:l,alt:"avatar"}):t.createElement("span",{className:"icon-upload_pictures Font16 TxtMiddle"})),t.createElement("div",{className:"domain-describe mTop16"},_l("\u63A8\u8350\u5C3A\u5BF8 1920*900\uFF0C2 M\u4EE5\u5185")))),t.createElement("div",{className:"common-info-row pTop54"},t.createElement("div",{className:"common-info-row-label"}),t.createElement("button",{className:"ming Button Button--primary Button--small",type:"button",onClick:function(){return e.handleSubmit()}},_l("\u4FDD\u5B58"))))))}}]),s}(t.Component),kt=d(31277),Ue=d(31929),jt=d(12438),_e=d(89552),Pt=d(80176),Me=d(2307),H=d(95881),Ze=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.dialogtype=e.props.workSiteId?"\u7F16\u8F91":"\u521B\u5EFA",e.state={workSiteName:""},e}return(0,S.default)(s,[{key:"componentWillReceiveProps",value:function(e){var a=this;this.setState({workSiteName:e.workSiteId?e.workSiteName:""}),setTimeout(function(){$(a.processName).focus()},300)}},{key:"handleChange",value:function(e){this.setState({workSiteName:e.target.value})}},{key:"handleOk",value:function(){var e=this;this.state.workSiteName?R.Z.checkSensitive({content:this.state.workSiteName}).then(function(a){if(a){e.showMes(_l("\u8F93\u5165\u5185\u5BB9\u5305\u542B\u654F\u611F\u8BCD\uFF0C\u8BF7\u91CD\u65B0\u586B\u5199"));return}else{var o=e.props.workSiteId?"updateWorkSiteName":"addWorkSite";H.Z[o]({workSiteId:e.props.workSiteId,workSiteName:$.trim(e.state.workSiteName),projectId:e.props.projectId}).then(function(i){i===1?(alert(_l("%0\u6210\u529F",e.dialogtype)),e.setState({workSiteName:""}),e.props.updateValue(!0)):i===2?e.showMes(_l("\u6B64\u5DE5\u4F5C\u5730\u70B9\u5DF2\u5B58\u5728")):alert(_l("%0\u5931\u8D25",e.dialogtype))})}}):this.showMes(_l("\u5DE5\u4F5C\u5730\u70B9\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"))}},{key:"showMes",value:function(e){$(".existResult").fadeIn().html(e),setTimeout(function(){$(".existResult").fadeOut().html("")},3e3)}},{key:"render",value:function(){var e=this;return t.createElement(F.Z,{visible:this.props.visible,title:_l("%0\u5DE5\u4F5C\u5730\u70B9",this.dialogtype),cancelText:_l("\u53D6\u6D88"),okText:_l("\u786E\u5B9A"),width:"413",overlayClosable:!1,onCancel:function(){e.props.updateValue()},onOk:function(){return e.handleOk()}},t.createElement("input",{ref:function(o){e.processName=o},onChange:function(o){return e.handleChange(o)},type:"text",placeholder:_l("\u8BF7\u8F93\u5165\u5DE5\u4F5C\u5730\u70B9\u540D\u79F0"),className:"ming Input Input--default w100",maxLength:"64",defaultValue:this.state.workSiteName}),t.createElement("div",{className:"pTop10"},t.createElement("div",{className:"existResult"})))}}]),s}(t.Component),Dt=d(25130),G=d(64713),Re=function(p){(0,k.default)(s,p);function s(){(0,C.default)(this,s);var n=(0,L.default)(this,(s.__proto__||b()(s)).call(this));return n.state={toMergerIds:""},n}return(0,S.default)(s,[{key:"onChange",value:function(e){this.setState({toMergerIds:e.target.value})}},{key:"handleSave",value:function(){var e=this,a={workSiteId:this.state.toMergerIds,toMergerIds:this.props.selectedRowKeys,projectId:this.props.projectId};this.state.toMergerIds?confirm(_l("\u786E\u8BA4\u5408\u5E76\u6240\u9009\u62E9\u7684\u5DE5\u4F5C\u5730\u70B9\uFF1F"))&&H.Z.mergeWorkSites(a).then(function(o){o?(alert(_l("\u5408\u5E76\u6210\u529F"),1),e.setState({toMergerIds:""}),e.props.closeMergeDialog(!0)):alert(_l("\u5408\u5E76\u5931\u8D25"),2)}):alert(_l("\u8BF7\u9009\u62E9\u5408\u5E76\u5230\u54EA\u4E2A\u5DE5\u4F5C\u5730\u70B9"),3)}},{key:"render",value:function(){var e=this,a=this.props.options,o=a===void 0?[]:a;return t.createElement(F.Z,{visible:this.props.visible,title:_l("\u5408\u5E76\u5DE5\u4F5C\u5730\u70B9"),cancelText:_l("\u53D6\u6D88"),okText:_l("\u786E\u5B9A"),width:"413",overlayClosable:!1,onCancel:function(){e.props.closeMergeDialog()},onOk:function(){return e.handleSave()}},t.createElement("div",{className:"warpMerge"},t.createElement("div",null,_l("\u5408\u5E76\u5230")),t.createElement(G.default.Group,{className:"content",onChange:this.onChange.bind(this),value:this.state.toMergerIds},o.map(function(i){return t.createElement(G.default,{className:"mTop10",value:i.workSiteId,key:i.workSiteId},i.workSiteName)}))))}}]),s}(t.Component),ie=d(25273),re=d(75809),He=function(p){(0,k.default)(s,p);function s(){(0,C.default)(this,s);var n=(0,L.default)(this,(s.__proto__||b()(s)).call(this));return n.onScrollEnd=I().throttle(function(){var e=n.state,a=e.isLoadMore,o=e.isLoading;o||!a||n.setState({pageIndex:n.state.pageIndex+1,isLoadMore:!1},function(){n.getUserList()})}),n.renderUserList=function(){var e=n.state,a=e.userList,o=e.isSearch,i=e.isLoading;return i?t.createElement("div",{className:"content pBottom10 Font13"},t.createElement(T.Z,{className:"top30"})):t.createElement("div",{className:"content pBottom10 Font13"},t.createElement(ie.Z,{onScrollEnd:n.onScrollEnd},a.length?a.map(function(r){return t.createElement("div",{className:"contentUser",key:r.accountId},t.createElement("img",{className:"mLeft10 headIcon",src:r.avatar,alt:"",onError:function(){return md.global.FileStoreConfig.pictureHost.replace(/\/$/,"")+"/UserAvatar/default.gif"}}),t.createElement("div",{className:"contentName overflow_ellipsis"},t.createElement("span",{className:"mLeft5"},r.fullname)),t.createElement("div",{className:"contentJob overflow_ellipsis"},t.createElement("span",null,r.job)),t.createElement("div",{className:"contentOperate",onClick:n.deleteUser.bind(n,r.accountId)},t.createElement("span",{className:"ThemeHoverColor3 icon-delete2 deleteMember Gray_9 Hand Font18"})))}):"",i?t.createElement("div",{className:"content pBottom10 Font13"},t.createElement(T.Z,{className:"top30"})):I().isEmpty(a)?t.createElement("div",{className:"Gray_6 mTop20 TxtCenter"},_l("\u8BE5\u5DE5\u4F5C\u5730\u70B9\u8FD8\u6CA1\u6709\u6210\u5458")):""),o&&t.createElement("div",{className:"nullContent"},t.createElement("div",null,t.createElement("span",{className:"TxtCenter icon-search icon"})),t.createElement("div",{className:"Gray_6 mTop20 TxtCenter"},_l("\u641C\u7D22\u65E0\u7ED3\u679C"))))},n.handleSearch=I().throttle(function(e){n.setState({memberKeywords:e.target.value},n.getUserList)},200),n.state={userList:[],isSearch:!1,memberKeywords:"",members:[],isLoading:!1,pageSize:50,pageIndex:1,isLoadMore:!1},n}return(0,S.default)(s,[{key:"componentDidMount",value:function(){this.getUserList()}},{key:"componentWillReceiveProps",value:function(e){e.workSiteId!==this.props.workSiteId&&this.getUserList()}},{key:"getUserList",value:function(){var e=this,a=this.props.workSiteId,o=this.state,i=o.memberKeywords,r=o.pageIndex,l=r===void 0?1:r,c=o.pageSize,u=o.userList,f=u===void 0?[]:u;this.setState({isLoading:!0}),H.Z.getWorkSiteUsers({workSiteId:a,projectId:this.props.projectId,keywords:i,pageIndex:l,pageSize:c}).then(function(m){var g=l>1?f.concat(m.list):m.list;e.setState({isLoading:!1,isLoadMore:m.list.length>=c,userList:g,members:I().map(g,function(v){return v.accountId})})})}},{key:"handleAdd",value:function(){var e=this;(0,re.Z)({fromAdmin:!0,SelectUserSettings:{showTabs:["conactUser","department","group","subordinateUser"],projectId:e.props.projectId,inProject:!0,filterAll:!0,filterFriend:!0,filterOthers:!0,filterAccountIds:e.state.members,filterOtherProject:!0,dataRange:0,callback:function(o){H.Z.addWorkSiteUser({workSiteId:e.props.workSiteId,accountIds:I().map(o,function(i){return i.accountId}),projectId:e.props.projectId}).then(function(i){i?(e.getUserList(),e.props.getData()):alert(_l("\u6DFB\u52A0\u5931\u8D25"),2)})}}})}},{key:"deleteUser",value:function(e){var a=this,o={accountId:e,projectId:this.props.projectId};H.Z.deleteWorkSiteUser(o).then(function(i){i?(a.getUserList(),a.props.getData()):alert(_l("\u5220\u9664\u5931\u8D25"),2)})}},{key:"render",value:function(){var e=this,a=this.props.userCount;return t.createElement(F.Z,{visible:this.props.visible,title:_l("\u6DFB\u52A0\u6210\u5458(%0)",a),width:"480",overlayClosable:!1,footer:null,onCancel:function(){return e.props.closeMenberDialog()}},t.createElement("div",{className:"editMemberDialog",id:"editMemberDialog"},t.createElement("div",{className:"Relative"},t.createElement("input",{type:"text",className:"ming Input w100 pLeft30",placeholder:_l("\u641C\u7D22"),onChange:this.handleSearch}),t.createElement("span",{className:"btnSearch icon-search Gray_9"})),t.createElement("div",{id:"memberList",className:"mTop10"},this.renderUserList()),t.createElement("div",{className:"pTop20 pBottom15"},t.createElement("span",{className:"Hand addMember ThemeColor3 ThemeHoverColor2 Font14",onClick:this.handleAdd.bind(this)},t.createElement("span",{className:"icon-addapplication Font30 mRight20 TxtMiddle"}),t.createElement("span",{className:"TxtMiddle"},_l("\u6DFB\u52A0\u6210\u5458"))))))}}]),s}(t.Component),Be=d(71411),$e=function(p){(0,k.default)(s,p);function s(){(0,C.default)(this,s);var n=(0,L.default)(this,(s.__proto__||b()(s)).call(this));return n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.state={keywords:"",data:[],selectedRowKeys:[],siteVisible:!1,mergeVisible:!1,memberVisible:!1,workSiteName:"",workSiteId:"",pageIndex:1,pageSize:50},n.columns=[{title:_l("\u540D\u79F0"),dataIndex:"workSiteName"},{title:_l("\u6210\u5458\u6570"),dataIndex:"userCount"},{title:_l("\u64CD\u4F5C"),dataIndex:"workSiteId",key:"workSiteId",render:function(a,o){return t.createElement("div",{className:"ThemeColor3"},t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:n.showSiteDialog.bind(n,o)},_l("\u7F16\u8F91")),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 mLeft24 mRight24 adminHoverColor",onClick:n.showMemberDialog.bind(n,o)},_l("\u6DFB\u52A0\u6210\u5458")),t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 adminHoverColor",onClick:n.deleteSite.bind(n,o.workSiteId)},_l("\u5220\u9664")))}}],n}return(0,S.default)(s,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){var e=this,a=this.state,o=a.pageIndex,i=a.pageSize;this.setState({loading:!0});var r={projectId:y.Z.projectId,keywords:this.state.keywords,pageIndex:o,pageSize:i};H.Z.getWorkSites(r).then(function(l){l?e.setState({data:l.list,loading:!1,allCount:l.allCount}):alert(_l("\u52A0\u8F7D\u5931\u8D25"),3)})}},{key:"showSiteDialog",value:function(e){var a=e.workSiteName,o=e.workSiteId;this.setState({siteVisible:!0,workSiteName:a,workSiteId:o})}},{key:"showMergeDialog",value:function(){this.state.selectedRowKeys.length>1?this.setState({mergeVisible:!0}):alert(_l("\u8BF7\u81F3\u5C11\u9009\u62E92\u4E2A\u8981\u5408\u5E76\u7684\u5DE5\u4F5C\u5730\u70B9"),3,1e3)}},{key:"closeMergeDialog",value:function(e){var a=this;this.setState({mergeVisible:!1,selectedRowKeys:e?[]:this.state.selectedRowKeys},function(){e&&a.getData()})}},{key:"deleteSite",value:function(e){var a=this,o={workSiteIds:$.isArray(e)?e:[e],projectId:y.Z.projectId};o.workSiteIds.length>0&&F.Z.confirm({title:_l("\u786E\u8BA4\u5220\u9664\u6240\u9009\u62E9\u7684\u5DE5\u4F5C\u5730\u70B9\uFF1F"),onOk:function(){H.Z.deleteWorkSites(o).then(function(r){r?(alert(_l("\u5220\u9664\u6210\u529F")),a.setState({selectedRowKeys:[]},function(){return a.getData()})):alert(_l("\u5220\u9664\u5931\u8D25"),2)})}})}},{key:"showMemberDialog",value:function(e){this.setState({memberVisible:!0,workSiteId:e.workSiteId,userCount:e.userCount})}},{key:"closeMenberDialog",value:function(){this.setState({memberVisible:!1,workSiteId:""})}},{key:"updateValue",value:function(e){this.setState({siteVisible:!1,workSiteName:"",workSiteId:""}),e&&this.getData()}},{key:"handleKeyDown",value:function(e){e.nativeEvent.keyCode===13&&this.getData()}},{key:"handleChange",value:function(e){this.setState({keywords:$.trim(e.target.value)})}},{key:"handleClear",value:function(){var e=this;this.setState({keywords:""},function(){e.getData()})}},{key:"render",value:function(){var e=this,a=this.state,o=a.keywords,i=a.loading,r=a.selectedRowKeys,l=a.data,c=a.siteVisible,u=a.workSiteId,f=a.workSiteName,m=a.mergeVisible,g=a.memberVisible,v=a.userCount,E=v===void 0?0:v,h=a.pageSize,N=a.pageIndex,U=N===void 0?1:N,B=a.allCount,_=B===void 0?0:B,q={selectedRowKeys:r,onChange:this.onSelectChange},ve={icon:"icon-map",desc:_l("\u65E0\u5DE5\u4F5C\u5730\u70B9")},K=function(){return t.createElement(Be.Z,{detail:ve})};return t.createElement("div",{className:"orgManagementWrap"},t.createElement("div",{className:"orgManagementHeader justifyContentLeft"},t.createElement(P.Z,{icon:"backspace",className:"Hand mRight18 TxtMiddle Font24 adminHeaderIconColor",onClick:function(){return e.props.setLevel(1)}}),t.createElement("span",{className:"Font17"},_l("\u5DE5\u4F5C\u5730\u70B9"))),t.createElement("div",{className:"orgManagementContent"},t.createElement("div",{className:"itemMain userManageWorkSite"},t.createElement(Ze,{visible:c,projectId:y.Z.projectId,workSiteId:u,workSiteName:f,updateValue:this.updateValue.bind(this)}),t.createElement(Re,{visible:m,selectedRowKeys:r,options:l,workSiteId:r,projectId:y.Z.projectId,closeMergeDialog:this.closeMergeDialog.bind(this)}),g&&t.createElement(He,{visible:g,workSiteId:u,userCount:E,projectId:y.Z.projectId,closeMenberDialog:this.closeMenberDialog.bind(this),getData:this.getData.bind(this)}),t.createElement("div",{className:"clearfix pBottom35 pTop25 pLeft25 pRight25"},t.createElement("div",{className:"Left"},r.length?t.createElement("div",{className:"workSiteToolbox"},t.createElement("span",{className:"Font16"},_l("\u5DF2\u9009\u62E9 %0 \u6761",r.length)),t.createElement("div",{className:"iconText ThemeColor3 mLeft32 adminHoverColor",onClick:this.showMergeDialog.bind(this)},t.createElement("span",{className:"icon icon-sp_filter_none_white"}),t.createElement("span",null,_l("\u5408\u5E76"))),t.createElement("div",{className:"iconText mLeft24 adminHoverDeleteColor",onClick:this.deleteSite.bind(this,r)},t.createElement("span",{className:"icon icon-delete2"}),t.createElement("span",null,_l("\u5220\u9664")))):t.createElement("button",{className:"ming Button Button--primary Button--small itemCreate",onClick:this.showSiteDialog.bind(this)},_l("\u65B0\u5EFA"))),t.createElement("div",{className:"searchContainer Right Relative",ref:function(M){return e.box=M}},t.createElement("span",{className:"icon-search btnSearch ThemeColor9",title:_l("\u641C\u7D22"),onClick:this.handleKeyDown.bind(this)}),t.createElement("input",{value:o,onKeyDown:this.handleKeyDown.bind(this),onChange:function(M){return e.handleChange(M)},type:"text",className:"searchInput ThemeColor10",placeholder:_l("\u641C\u7D22")}),o&&t.createElement("span",{className:"Font14 icon-closeelement-bg-circle Gray_c Hand Absolute",style:{top:"8px",right:"8px"},onClick:function(){return e.handleClear()}}))),t.createElement("div",{className:"dataView"},t.createElement(Ue.default,{renderEmpty:K},t.createElement(_e.default,{indicator:t.createElement(T.Z,null),spinning:i},t.createElement(Me.Z,{rowSelection:q,rowKey:function(M){return M.workSiteId},columns:this.columns,dataSource:l,pagination:_>h?{position:["bottomCenters"],pageSize:h,total:_,current:U,onChange:function(M){e.setState({pageIndex:M},function(){e.getData()})},itemRender:function(M,Ie,Et){return Ie==="prev"?t.createElement("a",{className:"page"},_l("\u4E0A\u4E00\u9875")):Ie==="next"?t.createElement("a",{className:"page"},_l("\u4E0B\u4E00\u9875")):Et}}:!1,scroll:{y:"calc(100vh - 345px)"}})))))))}}]),s}(t.Component),Ae=d(72557),Fe=d(30381),le=d.n(Fe),Oe=se.default.TextArea,ce=[_l("\u6211\u8981\u79BB\u804C\u4E86"),_l("\u6211\u662F\u8FD9\u4E2A\u7EC4\u7EC7\u7684\u6700\u540E\u4E00\u4E2A\u7528\u6237"),_l("\u672A\u80FD\u6EE1\u8DB3\u6211\u7684\u9700\u6C42"),_l("\u4EA7\u54C1\u4EF7\u683C\u592A\u8D35\u4E86"),_l("\u6211\u627E\u5230\u4E86\u5176\u4ED6\u66FF\u4EE3\u4EA7\u54C1\u4E86"),_l("\u5176\u4ED6\u539F\u56E0")],Ve=function(p){(0,k.default)(s,p);function s(){(0,C.default)(this,s);var n=(0,L.default)(this,(s.__proto__||b()(s)).call(this));return n.removeProjectTrialLicense=function(e){Z.Z.removeProjectTrialLicense({projectId:y.Z.projectId}).then(function(a){e(a)})},n.state={licenseType:0,expireDays:0,password:"",step:1,disabled:!1,reasonNumber:-1,reason:"",postDate:"",logoffs:[],isShow:!1,isLoading:!1},n}return(0,S.default)(s,[{key:"componentDidMount",value:function(){this.getData()}},{key:"componentDidUpdate",value:function(){$("input.ant-input").attr("autocomplete","new-password")}},{key:"getData",value:function(){var e=this;this.setState({isLoading:!0}),V().all([this.getLicenseType(),this.getExpireDays()]).then(function(a){var o=(0,W.Z)(a,2),i=o[0],r=i.licenseType,l=i.logoffs,c=o[1],u=c.expireDays,f=c.isTrial,m=l[0]||{};e.setState({expireDays:f?u:0,licenseType:r,logoffs:l,password:"",disabled:!1,reasonNumber:-1,reason:"",step:m.type===1?3:1,postDate:m.createTime,isLoading:!1})})}},{key:"getExpireDays",value:function(){return y.Z.AdminController.projectExpireDays({projectId:y.Z.projectId})}},{key:"getLicenseType",value:function(){return Z.Z.getProjectLogOff({projectId:y.Z.projectId})}},{key:"handlePostPassword",value:function(){var e=this,a=this.state,o=a.password,i=a.licenseType;if(!o)return alert(_l("\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"),3,1e3);this.setState({disabled:!0});var r=this;(0,J.Gv)({password:o,success:function(){I().includes([0,1],i)?e.setState({step:2,disabled:!1}):i==2&&e.removeProjectTrialLicense(function(c){c?alert(_l("\u9000\u51FA\u4ED8\u8D39\u7248\u8BD5\u7528\u6210\u529F"),1,2e3,function(){window.location.href="/personal?type=enterprise"}):(e.setState({disabled:!1}),alert(_l("\u9000\u51FA\u4ED8\u8D39\u7248\u8BD5\u7528\u5931\u8D25"),3))})}})}},{key:"onChange",value:function(e){this.setState({reasonNumber:e.target.value})}},{key:"handleTextChange",value:function(e){this.setState({reason:e.target.value})}},{key:"handleSubmit",value:function(){var e=this,a=this.state,o=a.reasonNumber,i=a.reason,r=o===5?i:ce[o];if(!r){this.setState({reasonNumber:5},function(){alert(_l("\u8BF7\u8F93\u5165\u5185\u5BB9"),3)});return}this.setState({disabled:!0}),Z.Z.applyCancelProject({reason:i,projectId:y.Z.projectId}).then(function(l){e.setState({disabled:!1}),l?e.setState({step:3,reasonNumber:-1,reason:"",postDate:le()().format("YYYY-MM-DD HH:mm:ss")}):alert(_l("\u7533\u8BF7\u5931\u8D25"),2)})}},{key:"handleUnSubmit",value:function(){var e=this;Z.Z.removeApplyCancelProject({projectId:y.Z.projectId}).then(function(a){a?(alert(_l("\u5DF2\u53D6\u6D88\u6CE8\u9500")),e.getData()):alert(_l("\u53D6\u6D88\u6CE8\u9500\u5931\u8D25"),2)})}},{key:"showList",value:function(){this.setState({isShow:!this.state.isShow})}},{key:"render",value:function(){var e=this,a=this.state,o=a.isShow,i=a.expireDays,r=a.password,l=a.licenseType,c=a.step,u=a.disabled,f=a.reason,m=a.reasonNumber,g=a.postDate,v=a.logoffs,E=a.isLoading;return t.createElement("div",{className:"orgManagementWrap"},t.createElement("div",{className:"orgManagementHeader justifyContentLeft"},t.createElement(P.Z,{icon:"backspace",className:"Hand mRight18 TxtMiddle Font24",onClick:function(){c===1||c===3?e.props.setLevel(1):e.setState({step:e.state.step-1})}}),t.createElement("span",{className:"Font17"},_l("\u6CE8\u9500\u7EC4\u7EC7"))),t.createElement("div",{className:"orgManagementContent"},E?t.createElement(T.Z,null):t.createElement("div",{className:"closeNet"},t.createElement("div",{id:"stepOne",className:c===1?"":"Hidden"},t.createElement("div",{className:"Bold Font24 title"},t.createElement("i",{className:"icon-error error Font28 mRight8"}),l===2?_l("\u9000\u51FA\u4ED8\u8D39\u7248\u8BD5\u7528"):_l("\u7533\u8BF7\u6CE8\u9500")),t.createElement("div",{className:"mTop16 Font13 subTitle"},l===2?_l("\u4ED8\u8D39\u7248\u8BD5\u7528\u8FD8\u6709%0\u5929\uFF0C\u9000\u51FA\u8BD5\u7528\u540E\u5C06\u65E0\u6CD5\u6062\u590D\u3002",i||0):_l("\u6CE8\u9500\u540E\uFF0C\u5173\u4E8E\u8BE5\u7EC4\u7EC7\u7684\u6240\u6709\u6570\u636E\u5C06\u88AB\u5220\u9664")),t.createElement("div",{className:"mTop30"},t.createElement(Ae.Z,{className:"verifyPasswordInput",showSubTitle:!0,onChange:function(N){var U=N.password;return e.setState({password:U})}}),t.createElement("button",{type:"button",className:"ming Button Button--primary confirmBtn Block",onClick:this.handlePostPassword.bind(this)},_l("\u786E\u5B9A")))),t.createElement("div",{id:"stepTwo",className:c===2?"":"Hidden"},t.createElement("div",{className:"Bold Font24 title"},t.createElement("i",{className:"icon-error error Font28 mRight8"}),_l("\u7533\u8BF7\u6CE8\u9500")),t.createElement("div",{className:"mTop16 Font13 subTitle"},_l("\u63D0\u4EA4\u7533\u8BF7\u540E\u90E8\u7F72\u987E\u95EE\u5C06\u5C3D\u5FEB\u4E0E\u60A8\u8054\u7CFB\u529E\u7406\u6CE8\u9500\u624B\u7EED")),t.createElement("div",{className:"mTop20"},t.createElement(G.default.Group,{className:"content",onChange:this.onChange.bind(this),value:m,disabled:u},ce.map(function(h,N){return t.createElement(G.default,{className:"mTop20",value:N,key:N},h)})),t.createElement("div",{className:"mTop10 inputText"},t.createElement(Oe,{className:m===5?"":"Hidden",value:f,onChange:this.handleTextChange.bind(this),placeholder:_l("\u8BF7\u8F93\u5165\u5176\u4ED6\u539F\u56E0")})),t.createElement("div",{className:"pTop10"},t.createElement("button",{type:"button",className:"ming Button Button--primary confirmBtn Block",onClick:this.handleSubmit.bind(this)},_l("\u63D0\u4EA4\u7533\u8BF7"))))),t.createElement("div",{id:"stepThree",className:c===3?"":"Hidden"},t.createElement("div",{className:"Bold Font24 title"},_l("\u5DF2\u63D0\u4EA4\u6CE8\u9500\u7EC4\u7EC7\u7533\u8BF7")),t.createElement("div",{className:"mTop20 Font13 subTitle"},_l("\u90E8\u7F72\u987E\u95EE\u5C06\u5C3D\u5FEB\u4E0E\u60A8\u8054\u7CFB\u529E\u7406\u9000\u51FA\u624B\u7EED")),t.createElement("div",{className:"mTop32 "},t.createElement("div",{className:"rowDetail"},t.createElement("div",{className:"rowLabel"},_l("\u7533\u8BF7\u4EBA")),t.createElement("span",null,md.global.Account.fullname)),t.createElement("div",{className:"mTop12 rowDetail"},t.createElement("div",{className:"rowLabel"},_l("\u7533\u8BF7\u65F6\u95F4")),t.createElement("span",null,g))),t.createElement("div",{className:"pTop10"},t.createElement("button",{type:"button",className:"ming Button Button--primary confirmBtn Block",onClick:this.handleUnSubmit.bind(this)},_l("\u53D6\u6D88\u7533\u8BF7")))),t.createElement("div",{className:"hisListContainer "+(l==1?"":"Hidden")},t.createElement("div",{className:"mTop20 ThemeColor3"},t.createElement("span",{className:"Hand",onClick:this.showList.bind(this)},_l("\u7533\u8BF7\u8BB0\u5F55"),t.createElement("i",{className:(o?"icon-arrow-down":"icon-arrow-up")+" font8"}))),t.createElement("div",{className:"tableViewContent mTop10 "+(o?"":"hidden")},t.createElement("table",{className:"LineHeight40 w100"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{className:"pLeft20 tableUser"},_l("\u7533\u8BF7\u4EBA")),t.createElement("th",{className:"tableOption"},_l("\u64CD\u4F5C")),t.createElement("th",{className:"tableTime"},_l("\u7533\u8BF7\u65F6\u95F4"))))),t.createElement("div",{className:"closeNetTableContent"},t.createElement("table",{className:"w100 LineHeight40"},t.createElement("tbody",null,v.length?v.map(function(h,N){return t.createElement("tr",{key:N},t.createElement("td",{className:"pLeft20 tableUser"},h.createUser&&h.createUser.fullname),t.createElement("td",{className:"tableOption "+(h.type==1?"":"Gray_c")},h.type===1?_l("\u7533\u8BF7\u6CE8\u9500"):_l("\u53D6\u6D88\u6CE8\u9500")),t.createElement("td",{className:"tableTime"},h.createTime))}):""))))))))}}]),s}(t.Component),Tt=d(59768),We=d(82891),xt=d(60954),Y=d(12386),Ge=d(63239),ze=d.n(Ge),X=d(74127),Q=d(96841),w=d(6953),Ke=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.handleSubmit=function(){var a=e.props,o=a.filed,i=a.positionList,r=a.projectId,l=a.currentPosition,c=e.state,u=c.exsistCurrentName,f=c.submitLoading,m=e.state.jobName.trim();R.Z.checkSensitive({content:m}).then(function(g){if(g)return e.setState({submitLoading:!1}),alert(_l("\u8F93\u5165\u5185\u5BB9\u5305\u542B\u654F\u611F\u8BCD\uFF0C\u8BF7\u91CD\u65B0\u586B\u5199"),3);o==="edit"?w.Z.editJobName({jobName:m,projectId:r,jobId:l.jobId}).then(function(v){if(v){alert(_l("\u4FEE\u6539\u6210\u529F"));var E=(0,j.default)({},l,{jobName:m});e.props.updateCurrentPosition(E);var h=i.map(function(N){return N.jobId===l.jobId?(0,j.default)({},N,{jobName:m}):N});e.props.updatePositionList(h)}else alert(_l("\u4FEE\u6539\u5931\u8D25"),2);e.props.onCancel(),e.setState({submitLoading:!1})}).catch(function(v){e.setState({submitLoading:!1})}):w.Z.addJob({jobName:m,projectId:r}).then(function(v){if(v){alert(_l("\u521B\u5EFA\u6210\u529F"));var E=i&&!I().isEmpty(i)&&i[0]||{};e.props.updateCurrentPosition(E),e.props.getPositionList()}else alert(_l("\u521B\u5EFA\u5931\u8D25"),2);e.props.onCancel(),e.setState({submitLoading:!1})}).catch(function(v){e.setState({submitLoading:!1})})})},e.footer=function(){var a=e.props,o=a.filed,i=a.positionList,r=a.projectId,l=a.currentPosition,c=e.state,u=c.exsistCurrentName,f=c.submitLoading,m=e.state.jobName.trim();return t.createElement("div",{className:"createPositionDialogFooter"},o==="edit"?t.createElement("span",{className:"LineHeight20 Left mTop5 Hand deleteBtn",onClick:function(){w.Z.deleteJobs({jobIds:[l.jobId],projectId:r}).then(function(v){v?(alert(_l("\u5220\u9664\u6210\u529F")),e.props.getPositionList(),e.props.onCancel()):alert(_l("\u804C\u4F4D\u5B58\u5728\u6210\u5458\uFF0C\u65E0\u6CD5\u5220\u9664"),2)})}},t.createElement("i",{class:"icon-task-new-delete Font16 mRight10"}),t.createElement("span",null,_l("\u5220\u9664"))):"",t.createElement("span",{class:"noText ThemeHoverColor3 Hand",onClick:function(){return e.props.onCancel()}},_l("\u53D6\u6D88")),t.createElement("span",{class:D()("nyesText ",{ThemeBGColor3:!u,boderRadAll_3:!u,disabledComfrim:u||f}),onClick:function(){if(m){if(u||f)return;if(i.find(function(v){return v.jobName===m})){alert(_l("\u8BE5\u804C\u4F4D\u540D\u79F0\u5DF2\u5B58\u5728"),3),e.setState({exsistCurrentName:!0});return}}else{alert(_l("\u8BF7\u8F93\u5165\u804C\u4F4D\u540D\u79F0"),3);return}e.setState({submitLoading:!0},e.handleSubmit)}},_l("\u4FDD\u5B58")))},e.state={jobName:n.filed==="edit"?n.currentPosition.jobName:""},e}return(0,S.default)(s,[{key:"render",value:function(){var e=this,a=this.props,o=a.filed,i=a.showRoleDialog,r=this.state.jobName;return t.createElement(F.Z,{title:o==="create"?_l("\u65B0\u5EFA\u804C\u4F4D"):_l("\u7F16\u8F91\u804C\u4F4D"),footer:this.footer(),className:"createPositionDialog",onCancel:function(){return e.props.onCancel()},visible:i},t.createElement("div",null,t.createElement("div",{className:"mTop5 mBottom12 Font14"},_l("\u804C\u4F4D\u540D\u79F0")),t.createElement("input",{class:"inputBox",maxLength:32,value:r,placeholder:_l("\u8BF7\u586B\u5199\u804C\u4F4D\u540D\u79F0"),onChange:function(c){e.setState({jobName:c.target.value,exsistCurrentName:!1})}})))}}]),s}(t.Component);const Je=Ke;var Ye=d(10929),z=50,Xe=function(s){return function(n){n({type:"CHANGE_PROJECT_ID",projectId:s})}},Qe=function(){return function(s,n){var e=n().orgManagePage.position,a=e.positionPageInfo,o=a===void 0?{}:a,i=e.projectId,r=e.positionList,l=r===void 0?[]:r,c=e.searchValue,u=o.pageIndex,f=c?{keywords:c}:{pageIndex:u||1,pageSize:z};w.Z.getJobs((0,j.default)({projectId:i},f)).then(function(m){var g=m.list&&!I().isEmpty(m.list)&&m.list[0]||{},v=(0,j.default)({},o),E=u>1?l.concat(m.list):m.list;v.isMore=m.list&&m.list.length>=z,s(me((0,j.default)({},o,{isMore:m.list&&m.list.length>=z}))),s(de(E)),s({type:"UPDATE_IS_LOADING",isLoading:!1}),(u===1||c)&&(s(ue(g)),s(pe({jobId:g.jobId})))})}},qe=function(s){return function(n){n({type:"UPDATE_IS_LOADING",isLoading:s})}},de=function(s){return function(n){n({type:"UPDATE_POSITION_LIST",positionList:s||[]})}},me=function(s){return function(n){n({type:"UPDATE_POSITION_PAGE_INFO",data:s})}},ue=function(s){return function(n){n({type:"UPDATE_CURRENT_POSITION",currentPosition:s})}},et=function(s){return function(n){n({type:"UPDATE_SEARCH_VALUE",searchValue:s})}},tt=function(s){return function(n){n({type:"UPDATE_USER_PAGE_INDEX",userPageIndex:s})}},pe=function(s){return function(n,e){var a=s.jobId,o=a===void 0?"":a,i=e().orgManagePage.position,r=i.projectId,l=i.userPageIndex;n({type:"UPDATE_USER_LOADING",userLoading:!0}),w.Z.pagedJobAccounts({jobId:o,pageIndex:l||1,pageSize:z,projectId:r}).then(function(c){var u=c.list,f=u===void 0?[]:u,m=c.allCount;n({type:"UPDATE_USER_LIST",userList:f}),n({type:"UPDATE_USER_LOADING",userLoading:!1}),n({type:"UPDATE_USER_COUNT",allUserCount:m})})}},at=function(s){return function(n){n({type:"UPDATE_USER_LOADING",userLoading:s})}},nt=function(s){return function(n){n({type:"UPDATE_SELECT_USER_IDS",selectUserIds:s})}},ot=function(s){return function(n){n({type:"UPDATE_IS_IMPORT_ROLE",data:s})}},st=d(57853),it=d(85315),fe=d(20845),rt=d(86735),lt=d(5017),ct=(0,rt.Z)([`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  .iconWrap {
    width: 132px;
    height: 132px;
    border-radius: 50%;
    background-color: #f5f5f5;
    margin-bottom: 32px;
    position: relative;
    .icon {
      font-size: 50px;
      color: #c2c3c3;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translateX(-50%) translateY(-50%);
    }
  }
  .tipTxt {
    max-width: 312px;
    margin: 0 auto;
    text-align: center;
    line-height: 20px;
  }
`],[`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  .iconWrap {
    width: 132px;
    height: 132px;
    border-radius: 50%;
    background-color: #f5f5f5;
    margin-bottom: 32px;
    position: relative;
    .icon {
      font-size: 50px;
      color: #c2c3c3;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translateX(-50%) translateY(-50%);
    }
  }
  .tipTxt {
    max-width: 312px;
    margin: 0 auto;
    text-align: center;
    line-height: 20px;
  }
`]),dt=lt.ZP.div(ct),ge=function(p){(0,k.default)(s,p);function s(n){return(0,C.default)(this,s),(0,L.default)(this,(s.__proto__||b()(s)).call(this,n))}return(0,S.default)(s,[{key:"render",value:function(){var e=this.props,a=e.icon,o=e.tipTxt;return t.createElement(dt,null,t.createElement("div",{className:"iconWrap"},t.createElement(P.Z,{icon:a})),t.createElement("div",{className:"tipTxt"},o||_l("\u6570\u636E\u7A7A")))}}]),s}(t.Component),mt=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.renderThead=function(){var a=e.props,o=a.selectUserIds,i=o===void 0?[]:o,r=a.userList,l=r===void 0?[]:r,c=l.filter(function(f){return i.some(function(m){return m===f.accountId})})||[],u=!I().isEmpty(i)&&c.length===l.length;return t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{className:"checkBoxCol"},t.createElement(fe.Z,{clearselected:!I().isEmpty(c)&&!u,checked:u||!I().isEmpty(c),onClick:function(m){var g=[];!m||!I().isEmpty(i)&&i.length!==l.length?g=l.map(function(v){return v.accountId}):g=[],e.props.updateSelectUserIds(g)}})),t.createElement("th",{className:"nameCol"},_l("\u59D3\u540D")),t.createElement("th",{className:"departmentCol"},_l("\u90E8\u95E8"))))},e.renderCon=function(){var a=e.props,o=a.userList,i=o===void 0?[]:o,r=a.selectUserIds,l=r===void 0?[]:r;return i.map(function(c){return t.createElement("tr",{key:c.accountId},t.createElement("td",{className:"checkBoxCol"},t.createElement(fe.Z,{checked:I().includes(l,c.accountId),onClick:function(f){var m=[].concat((0,it.Z)(l));f?m=m.filter(function(g){return c.accountId!==g}):m.push(c.accountId),e.props.updateSelectUserIds(m)}})),t.createElement("td",{className:"nameCol"},t.createElement("div",{className:"flexRow"},t.createElement(st.Z,{className:"circle",user:{userHead:c.avatar,accountId:c.accountId},size:32,projectId:e.props.projectId}),t.createElement("a",{href:"/user_"+c.accountId,className:"Gray overflow_ellipsis mLeft10 LineHeight32 name",title:c.fullname},c.fullname))),t.createElement("td",{className:"departmentCol",title:c.departments.map(function(u,f){return c.departments.length-1>f?u.name+";":""+u.name})},c.departments.map(function(u,f){return c.departments.length-1>f?u.name+";":""+u.name})))})},e}return(0,S.default)(s,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.userList,a=e===void 0?[]:e;return t.createElement(t.Fragment,null,t.createElement("div",{className:"useTableHeader"},t.createElement("table",{className:"fixedTable usersTable",cellSpacing:"0"},this.renderThead(this.props))),t.createElement("div",{className:"userTableBody"},I().isEmpty(a)?t.createElement(ge,{tipTxt:_l("\u6570\u636E\u7A7A"),icon:"Empty_data"}):t.createElement("table",{className:"usersTable overflowTable",cellSpacing:"0"},t.createElement("tbody",null,this.renderCon()))))}}]),s}(t.Component);const ut=(0,Q.$j)(function(p){var s=p.orgManagePage.position,n=s.userList,e=s.selectUserIds;return{userList:n,selectUserIds:e}},function(p){return(0,X.DE)((0,j.default)({},I().pick(O,["updateProjectId","getPositionList","updateCurrentPosition","updateSelectUserIds"])),p)})(mt);var pt=d(76795),he=50,ft=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.addUser=function(){var a=e.props,o=a.projectId,i=a.currentPosition,r=i===void 0?{}:i,l=a.selectUserIds,c=l===void 0?[]:l,u={unique:!1,projectId:o,filterAll:!0,filterFriend:!0,filterOthers:!0,filterOtherProject:!0,dataRange:2,callback:function(m){w.Z.addJobUser({projectId:o,jobId:r.jobId,accountIds:I().map(m,function(g){return g.accountId})}).then(function(g){g?(e.props.getUserList({jobId:r.jobId}),alert(_l("\u6DFB\u52A0\u6210\u529F"))):alert(_l("\u6DFB\u52A0\u5931\u8D25"),2)})}};(0,re.Z)({fromAdmin:!0,SelectUserSettings:u})},e.removeUsers=function(){var a=e.props,o=a.selectUserIds,i=o===void 0?[]:o,r=a.currentPosition,l=r===void 0?{}:r,c=a.projectId;I().isEmpty(i)||w.Z.deleteJobUsers({projectId:c,accountIds:i,jobId:l.jobId}).then(function(u){u?(e.props.getUserList({jobId:l.jobId}),e.props.updateSelectUserIds([]),alert(_l("\u79FB\u51FA\u6210\u529F"))):alert(_l("\u79FB\u9664\u5931\u8D25"),2)})},e.handleExportUser=function(){var a=e.props,o=a.projectId,i=a.selectUserIds,r=i===void 0?[]:i;I().isEmpty(r)||(0,pt.C)({projectId:o,accountIds:r,updateSelectUserIds:function(){e.props.updateSelectUserIds([])}})},e.changPage=function(a){var o=e.props.currentPosition;e.props.updateUserPageIndex(a),e.props.getUserList({pageIndex:a,jobId:o.jobId})},e.state={},e}return(0,S.default)(s,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,a=e.currentPosition,o=e.allUserCount,i=e.userPageIndex,r=e.userLoading,l=e.selectUserIds,c=e.projectId;return t.createElement(t.Fragment,null,t.createElement("div",{className:"positionContentHeader Font15"},t.createElement("span",{className:"Bold"},a.jobName),o?t.createElement("span",{className:"Gray_9e mLeft10"},o):""),t.createElement("div",{className:"actUserBox"},t.createElement("div",{className:"actBtn addUser Hand",onClick:this.addUser},_l("\u6DFB\u52A0\u6210\u5458")),t.createElement("div",{className:D()("actBtn",{disabledBtn:I().isEmpty(l)}),onClick:this.removeUsers},_l("\u79FB\u51FA")),t.createElement("div",{className:D()("actBtn",{disabledBtn:I().isEmpty(l)}),onClick:this.handleExportUser},_l("\u5BFC\u51FA"))),t.createElement("div",{className:"userList"},r?t.createElement(T.Z,{className:"mTop30"}):t.createElement(ut,{projectId:c})),!r&&o>he&&t.createElement(Ye.Z,{total:o,pageIndex:i,pageSize:he,onChange:this.changPage}))}}]),s}(t.Component);const gt=(0,Q.$j)(function(p){var s=p.orgManagePage.position,n=s.currentPosition,e=s.userList,a=s.allUserCount,o=s.userPageIndex,i=s.userLoading,r=s.selectUserIds,l=s.projectId;return{currentPosition:n,userList:e,allUserCount:a,userPageIndex:o,userLoading:i,selectUserIds:r,projectId:l}},function(p){return(0,X.DE)((0,j.default)({},I().pick(O,["getUserList","updateUserPageIndex","updateSelectUserIds"])),p)})(ft);var ht=d(23553),vt=d(70714),It=function(p){(0,k.default)(s,p);function s(n){(0,C.default)(this,s);var e=(0,L.default)(this,(s.__proto__||b()(s)).call(this,n));return e.exportJobList=function(){var a=e.props.projectId,o=(0,J.vo)(a,!0).companyName||"";fetch(md.global.Config.AjaxApiUrl+"download/exportProjectJobList",{method:"POST",headers:{"content-type":"application/json",Authorization:"md_pss_id "+(0,vt.qz)()},body:ze()({userStatus:"1",projectId:a})}).then(function(i){return i.blob()}).then(function(i){var r=le()().format("YYYYMMDDHHmmss"),l=o+"_"+_l("\u804C\u4F4D")+"_"+r+".xlsx",c=document.createElement("a");c.href=window.URL.createObjectURL(i),c.download=l,c.click(),window.URL.revokeObjectURL(c.href)})},e.onScrollEnd=function(){var a=e.props,o=a.positionPageInfo,i=o===void 0?{}:o,r=a.isLoading,l=a.searchValue,c=i.isMore;!c||r||(e.props.updatePositionPageInfo({pageIndex:i.pageIndex+1,isMore:!1}),l?e.handleSearch(l):e.props.getPositionList())},e.createAndEdit=function(a){e.setState({showRoleDialog:!0,filed:a})},e.handleSearch=I().throttle(function(a){var o=e.props,i=o.projectId,r=o.positionPageInfo,l=r===void 0?{}:r,c=o.positionList,u=c===void 0?[]:c,f=l.pageIndex,m=f===void 0?1:f;if(!a){e.props.updatePositionPageInfo((0,j.default)({},l,{pageIndex:1})),e.props.getPositionList();return}e.props.updateSearchValue(a),e.ajaxObj=w.Z.getJobs({projectId:i,keywords:a,pageIndex:m,pageSize:50}),e.ajaxObj.then(function(g){var v=g.list&&!I().isEmpty(g.list)&&g.list[0]||{},E=(0,j.default)({},l),h=m>1?u.concat(g.list):g.list;E.isMore=g.list&&g.list.length>=50,e.props.updateIsLoading(!1),e.props.updatePositionPageInfo((0,j.default)({},l,{isMore:g.list&&g.list.length>=50})),e.props.updatePositionList(h),m===1&&(e.props.updateCurrentPosition(v),e.props.getUserList({jobId:v.jobId}))})}),e.renderImportInfo=function(){return t.createElement("div",{className:"importPositionWrap"},t.createElement(ht.Z,{importType:"position",txt:_l("\u804C\u4F4D"),clickBackList:function(){e.props.updateIsImportRole(!1)},downLoadUrl:"/staticfiles/template/positionImport.xlsx",updateList:function(){e.props.updatePositionPageInfo({pageIndex:1,isMore:!1}),e.props.getPositionList()}}))},e.state={showRoleDialog:!1},e.ajaxObj=null,e}return(0,S.default)(s,[{key:"componentDidMount",value:function(){this.props.updatePositionPageInfo({pageIndex:1,isMore:!1}),this.props.updateProjectId(y.Z.projectId),this.props.getPositionList()}},{key:"componentWillUnmount",value:function(){this.props.updateUserloading(!0)}},{key:"render",value:function(){var e=this,a=this.props,o=a.positionList,i=o===void 0?[]:o,r=a.isLoading,l=r===void 0?!1:r,c=a.currentPosition,u=a.projectId,f=a.isImportRole,m=a.searchValue,g=this.state,v=g.showRoleDialog,E=g.filed;return f?this.renderImportInfo():t.createElement("div",{className:"orgManagementWrap"},t.createElement("div",{className:"orgManagementHeader justifyContentLeft"},t.createElement(P.Z,{icon:"backspace",className:"Hand mRight18 TxtMiddle Font24 adminHeaderIconColor",onClick:function(){return e.props.setLevel(1)}}),t.createElement("span",{className:"Font17"},_l("\u804C\u4F4D"))),t.createElement("div",{className:"orgManagementContent"},t.createElement("div",{className:"itemMain positionContent"},t.createElement("div",{className:"PositionL"},t.createElement("div",{className:"searchContainer"},t.createElement(P.Z,{icon:"search",className:" btnSearch ThemeColor9"}),t.createElement("input",{defaultValue:m,ref:function(N){return e.input=N},onChange:function(N){e.props.updateSearchValue(N.target.value),e.ajaxObj&&e.ajaxObj.abort&&(e.ajaxObj.abort(),e.ajaxObj=null),e.props.updateIsLoading(!0),e.handleSearch(N.target.value)},onFocus:function(){e.props.updatePositionPageInfo((0,j.default)({},e.props.positionPageInfo,{pageIndex:1}))},type:"text",className:"searchInput ThemeColor10 w100",placeholder:_l("\u641C\u7D22")}),m?t.createElement("span",{className:"Font14 icon-closeelement-bg-circle Gray_c Hand Absolute",style:{top:"8px",right:"8px"},onClick:this.handleClear}):null),t.createElement("input",{type:"text",style:{width:0,height:0,border:0}}),t.createElement("div",{className:"actBox flexRow"},t.createElement("span",{className:"creatRole themeColor Hand",onClick:function(){return e.createAndEdit("create")}},t.createElement(P.Z,{icon:"add",className:"Font20 TxtMiddle mRight10"}),_l("\u521B\u5EFA\u804C\u4F4D")),t.createElement(We.default,{overlayClassName:"createMoreDropDown",trigger:["click"],placement:"bottomLeft",overlay:t.createElement(Y.default,null,t.createElement(Y.default.Item,{key:"0",onClick:function(){e.props.updateIsImportRole(!0)}},_l("\u5BFC\u5165\u804C\u4F4D")),t.createElement(Y.default.Item,{key:"1",disabled:I().isEmpty(i),onClick:this.exportJobList},_l("\u5BFC\u51FA\u804C\u4F4D")))},t.createElement(P.Z,{icon:"moreop",className:"Gray_75 Hand Font20 TxtMiddle iconHover"}))),t.createElement("div",{className:"positionList"},t.createElement(ie.Z,{onScrollEnd:this.onScrollEnd},l?t.createElement(T.Z,null):I().isEmpty(i)?t.createElement("div",{className:"Gray_9e pLeft24 mTop16"},_l("\u6682\u65E0\u804C\u4F4D\uFF0C\u53EF"),t.createElement("span",{className:"Hand",style:{color:"#2196F3"},onClick:function(){e.props.updateIsImportRole(!0)}},_l("\u6279\u91CF\u5BFC\u5165"))):i.map(function(h){return t.createElement("div",{key:h.jobId,className:D()("positionItem",{current:c.jobId===h.jobId}),onClick:function(){h.jobId!==c.jobId&&(e.props.updateUserPageIndex(1),e.props.updateCurrentPosition(h),e.props.updateSelectUserIds([]),e.props.getUserList({jobId:h.jobId}))}},t.createElement(P.Z,{className:"Font16 Gray_9e mRight10",icon:"limit-principal"}),t.createElement("span",{className:D()("overflow_ellipsis WordBreak jobName")},h.jobName),t.createElement(P.Z,{className:"Font16 Gray_9e Right editIcon",icon:"edit_17",onClick:function(U){e.createAndEdit("edit"),h.jobId!==c.jobId&&(e.props.updateUserPageIndex(1),e.props.updateCurrentPosition(h),e.props.updateSelectUserIds([]),e.props.getUserList({jobId:h.jobId}))}}))})))),t.createElement("div",{className:"PositionR"},I().isEmpty(i)?t.createElement(ge,{tipTxt:_l("\u53EF\u4EE5\u6839\u636E\u6210\u5458\u5C5E\u6027\u53BB\u521B\u5EFA\u804C\u4F4D\uFF0C\u5982\uFF0C\u6280\u672F\u3001\u751F\u4EA7\u3001\u9500\u552E\u8BBE\u7F6E\u540E\u5E94\u7528\u548C\u5DE5\u4F5C\u6D41\u53EF\u4EE5\u76F4\u63A5\u9009\u62E9\u804C\u4F4D"),icon:"Empty_Noposition"}):t.createElement(gt,null)),v&&t.createElement(Je,{showRoleDialog:v,filed:E,onCancel:function(){e.setState({showRoleDialog:!1})},updateCurrentPosition:this.props.updateCurrentPosition,positionList:i,projectId:u,currentPosition:c,getPositionList:this.props.getPositionList,updatePositionList:this.props.updatePositionList}))))}}]),s}(t.Component);const yt=(0,Q.$j)(function(p){var s=p.orgManagePage.position,n=s.positionList,e=s.isLoading,a=s.currentPosition,o=s.projectId,i=s.isImportRole,r=s.positionPageInfo,l=s.searchValue;return{positionList:n,isLoading:e,currentPosition:a,projectId:o,isImportRole:i,positionPageInfo:r,searchValue:l}},function(p){return(0,X.DE)((0,j.default)({},I().pick(O,["updateProjectId","getPositionList","updateCurrentPosition","getUserList","updateUserPageIndex","updateSelectUserIds","updateSearchValue","updateIsImportRole","updatePositionPageInfo","updatePositionList","updateIsLoading","updateUserloading"])),p)})(It);var Nt=function(p){(0,k.default)(s,p);function s(){(0,C.default)(this,s);var n=(0,L.default)(this,(s.__proto__||b()(s)).call(this));return n.renderBodyContent=function(){var e=n.state.level;switch(e){case 1:return t.createElement(xe,{setLevel:n.setLevel,level:e});case 2:return t.createElement(we,{setLevel:n.setLevel});case 3:return t.createElement($e,{setLevel:n.setLevel});case 4:return t.createElement(Ve,{setLevel:n.setLevel});case 5:return t.createElement(yt,{setLevel:n.setLevel})}},n.setLevel=function(e){n.setState({level:e})},y.Z.setPageTitle(_l("\u57FA\u7840\u4FE1\u606F")),n.state={level:1},n}return(0,S.default)(s,[{key:"componentWillMount",value:function(){this.props.location.search==="?destroy"&&this.setState({level:4}),this.props.location.search==="?level3"&&this.setState({level:3}),this.props.location.search==="?level5"&&this.setState({level:5})}},{key:"render",value:function(){return t.createElement("div",{className:"orgManagementWrap"},this.renderBodyContent())}}]),s}(t.Component)}}]);
