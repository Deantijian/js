"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[5626],{55626:(Se,j,s)=>{s.r(j),s.d(j,{default:()=>fe});var z=s(54208),Y=s(66946),X=s(66215),J=s(51197),Q=s(20845),q=s(88902),_=s.n(q),Ce=s(52262),Z=s(65400),ee=s(26581),A=s(33867),Ee=s(67272),b=s(51024),M=s(88239),S=s(88106),G=s(9122),T=s(85315),be=s(34279),L=s(64749),te=s(85105),O=s.n(te),R=s(99663),F=s(22600),U=s(49135),K=s(93196),t=s(67294),ae=s(93967),E=s.n(ae),B=[{label:_l("\u7528\u6237\u76EE\u5F55\u7C7B\u578B"),key:"type",compType:"select",errorMsg:_l("\u8BF7\u9009\u62E9\u7528\u6237\u76EE\u5F55\u7C7B\u578B")},{label:_l("\u670D\u52A1\u5668IP"),key:"serverIP",desc:_l("\u5982\uFF1A192.168.1.1"),errorMsg:_l("\u8BF7\u8F93\u5165LDAP\u670D\u52A1\u5668IP")},{label:_l("\u7AEF\u53E3"),key:"port",desc:"enableSSL",errorMsg:_l("\u8BF7\u8F93\u5165LDAP Server\u7AEF\u53E3\u53F7")},{label:_l("\u8D26\u6237"),key:"user",desc:_l("\u8BFB\u53D6LDAP Server \u9884\u586B\u7528\u6237\u5982\uFF1ACN=Admin,CN=Users,DC=XXX,DC=YYY"),errorMsg:_l("\u8BF7\u8F93\u5165\u8D26\u6237")},{label:_l("\u5BC6\u7801"),key:"password",compType:"password",errorMsg:_l("\u8BF7\u8F93\u5165\u5BC6\u7801")},{label:_l("\u8D26\u6237\u641C\u7D22\u8303\u56F4"),key:"searchScope",compType:"tab",desc:_l("\u6EE1\u8DB3\u641C\u7D22\u8303\u56F4\u7684\u8D26\u6237\u53EF\u767B\u5F55\u5E73\u53F0")},{label:"BaseDN",key:"domainPath",desc:_l("\u67E5\u627E\u7528\u6237\u4FE1\u606F\u8DEF\u5F84\uFF0C\u5982\uFF1Adc=XXX,dc=YYY")},{label:_l("DN/\u7EC4\u540D"),key:"DNGroup",compType:"group"}],P=[{label:_l("\u7528\u6237\u5E10\u53F7"),key:"searchFilter",desc:_l("LDAP Server \u767B\u5F55\u8D26\u6237\u5B57\u6BB5\uFF0C\u7528\u4E8E\u4E0E\u7CFB\u7EDF\u7528\u6237\u4FE1\u606F\u5339\u914D\u5B57\u6BB5"),errorMsg:_l("\u8BF7\u8F93\u5165LDAP Server\u8D26\u6237\u5B57\u6BB5\u540D\u79F0")},{label:_l("Email"),key:"emailAttr",desc:_l("LDAP Server \u767B\u5F55\u8D26\u6237\u5B57\u6BB5\uFF0C\u7528\u4E8E\u4E0E\u7CFB\u7EDF\u7528\u6237\u4FE1\u606F\u5339\u914D\u5B57\u6BB5"),errorMsg:_l("\u8BF7\u8F93\u5165LDAP Server\u90AE\u7BB1\u5B57\u6BB5\u540D\u79F0")},{label:_l("\u7528\u6237\u59D3\u540D"),key:"fullnameAttr",desc:_l("\u540C\u6B65\u81F3\u7CFB\u7EDF\u7528\u6237\u59D3\u540D\u3002\u672A\u586B\u5199\u65F6\uFF0C\u9ED8\u8BA4\u53D6displayname\u7684\u503C")},{label:_l("\u90E8\u95E8"),key:"departmentAttr",desc:_l("\u540C\u6B65\u81F3\u7CFB\u7EDF\u7528\u6237\u90E8\u95E8\u3002\u672A\u586B\u5199\u65F6\uFF0C\u9ED8\u8BA4\u53D6department\u7684\u503C")},{label:_l("\u804C\u4F4D"),key:"jobAttr",desc:_l("\u540C\u6B65\u81F3\u7CFB\u7EDF\u7528\u6237\u804C\u4F4D\u3002\u672A\u586B\u5199\u65F6\uFF0C\u9ED8\u8BA4\u53D6title\u7684\u503C")},{label:_l("\u8054\u7CFB\u7535\u8BDD"),key:"workphoneAttr",desc:_l("\u540C\u6B65\u81F3\u7CFB\u7EDF\u7528\u6237\u8054\u7CFB\u7535\u8BDD\u3002\u672A\u586B\u5199\u65F6\uFF0C\u9ED8\u8BA4\u53D6telephoneNumber\u7684\u503C")}],v=s(99924),u=s(64712),W=s(70801),ne=s(12424),re=s(86735);const V={addAuthorization:function(d){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mdyAPI("Authorization","AddAuthorization",d,n)},getAuthorizationByType:function(d){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mdyAPI("Authorization","GetAuthorizationByType",d,n)}};var le=s(20640),se=s.n(le),oe=s(5017),ie=(0,re.Z)([`
  height: 232px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`],[`
  height: 232px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`]),Le=oe.ZP.div(ie),ce=function(k){(0,K.default)(d,k);function d(n){(0,R.default)(this,d);var e=(0,U.default)(this,(d.__proto__||O()(d)).call(this,n));return e.updateKey=function(){V.addAuthorization({projectId:e.props.projectId,type:e.state.type}).then(function(a){var l=a.appKey,o=a.secretKey,r=a.sign,i=a.type;l&&o&&r?(alert(_l("\u64CD\u4F5C\u6210\u529F")),e.setState({visible:!1,appKey:l,secretKey:o,sign:r,type:i}),e.props.handleChangeVisible(!0)):alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})},e.state={visible:!1,appKey:"",secretKey:"",sign:"",type:null},e}return(0,F.default)(d,[{key:"componentDidMount",value:function(){this.getSecretKey()}},{key:"getSecretKey",value:function(){var e=this;V.getAuthorizationByType({projectId:this.props.projectId,type:1}).then(function(a){var l=(0,ne.Z)(a,1),o=l[0],r=o===void 0?{}:o;e.setState({appKey:r.appKey,secretKey:r.secretKey,sign:r.sign,type:r.type})})}},{key:"handleChangeVisible",value:function(e){this.setState({visible:e})}},{key:"render",value:function(){var e=this,a=this.state.visible;return t.createElement(t.Fragment,null,a?t.createElement(W.Z,{visible:a,title:t.createElement("span",{className:"updateTitle"},_l("\u786E\u5B9A\u8981\u91CD\u65B0\u751F\u6210\uFF1F")),cancelText:_l("\u53D6\u6D88"),okText:_l("\u786E\u5B9A"),width:"480",overlayClosable:!1,onCancel:function(){e.handleChangeVisible(!1)},onOk:function(){return G.Z.confirm({onOk:e.updateKey})}},t.createElement("div",{className:"subLabel"},_l("\u91CD\u65B0\u751F\u6210\u5C06\u4F1A\u5F71\u54CD\u5230\u5DF2\u7ECF\u4F7F\u7528\u8BE5\u5BC6\u94A5\u4FE1\u606F\u7684\u670D\u52A1\uFF0C\u8BF7\u786E\u8BA4\u64CD\u4F5C"))):t.createElement(W.Z,{visible:this.props.visible,title:t.createElement("span",null,_l("\u67E5\u770B\u5BC6\u94A5")),width:"480",footer:null,overlayClosable:!1,onCancel:function(){e.props.handleChangeVisible(!1)}},t.createElement("div",{className:"keyBox"},[{text:"AppKey",key:"appKey"},{text:"SecretKey",key:"secretKey"},{text:_l("Sign\uFF08\u6CE8\uFF1A\u53EA\u9488\u5BF9\u5E94\u7528\u4E0B\u7684\u63A5\u53E3\u751F\u6548\uFF0C\u5176\u4ED6\u4F9D\u7136\u4F7F\u7528\u4F01\u4E1A\u6388\u6743\u6A21\u5F0F\uFF09"),key:"sign"}].map(function(l,o){return t.createElement(t.Fragment,{key:o},t.createElement("div",{className:E()("keyLabel",{mTop24:o!==0})},l.text),t.createElement("div",{className:"subLabel flexRow mTop5"},t.createElement("div",{className:"Gray_75 breakAll"},e.state[l.key]),t.createElement("span",{className:"ThemeColor3 ThemeHoverColor2 mLeft15 pointer",style:{whiteSpace:"nowrap"},onClick:function(){se()(e.state[l.key]),alert(_l("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F"))}},_l("\u590D\u5236"))))}),t.createElement("div",null,t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 mTop16 adminHoverColor",onClick:this.handleChangeVisible.bind(this,!0)},_l("\u91CD\u65B0\u751F\u6210"))))))}}]),d}(t.Component),D=s(15577),me=s(77863),ue=s(96486),I=s.n(ue),de={index:_l("\u5176\u4ED6"),effective:_l("LDAP\u767B\u5F55"),sso:_l("SSO")},pe=[{key:"effective",label:_l("LDAP\u767B\u5F55"),showSetting:!0,description:_l("\u5728\u4ED8\u8D39\u7248\u4E0B\uFF0C\u60A8\u53EF\u4EE5\u96C6\u6210LDAP\u7528\u6237\u76EE\u5F55\uFF0C\u5B9E\u73B0\u7EDF\u4E00\u8EAB\u4EFD\u8BA4\u8BC1\u7BA1\u7406 \uFF08\u9700\u786E\u4FDD\u5458\u5DE5\u7684\u8D26\u53F7\u5DF2\u548C\u90AE\u7BB1\u7ED1\u5B9A\uFF09"),featureId:me.UU.LDAPIntergration,showCustomName:!0},{key:"sso",label:_l("SSO\u767B\u5F55"),showSetting:!0,description:_l("\u5728\u4ED8\u8D39\u7248\u672C\u4E0B\uFF0C\u60A8\u53EF\u4EE5\u901A\u8FC7\u7EC4\u7EC7\u7684\u4E8C\u7EA7\u57DF\u540D\uFF0C\u4EE5SSO\u767B\u5F55\u65B9\u5F0F\u767B\u5F55\u5230\u5E73\u53F0"),showCustomName:!0},{key:"enabledMDLogin",label:_l("\u5E73\u53F0\u5E10\u53F7\u767B\u5F55"),description:_l("\u5F53\u7EC4\u7EC7\u542F\u7528\u4E86LDAP\uFF0CSSO\u6216\u7B2C\u4E09\u65B9\u5E73\u53F0\u96C6\u6210\u5E10\u53F7\u767B\u5F55\u65F6\uFF0C\u53EF\u4EE5\u5173\u95ED\u672C\u5E73\u53F0\u8D26\u53F7\u767B\u5F55")},{key:"orgKey",label:_l("\u5F00\u653E\u63A5\u53E3"),showSetting:!1,docLink:"https://www.showdoc.com.cn/mingdao",description:_l("\u6B64\u5BC6\u94A5\u662F\u7528\u4E8E\u8BBF\u95EE\u4F01\u4E1A\u6388\u6743\u5F00\u653E\u63A5\u53E3\u7684\u51ED\u8BC1")}],fe=function(k){(0,K.default)(d,k);function d(){(0,R.default)(this,d);var n=(0,U.default)(this,(d.__proto__||O()(d)).call(this));return n.getMDLoginSetting=function(){v.Z.getMDLoginSetting({projectId:u.Z.projectId}).then(function(e){var a=e.enabledMDLogin;n.setState({enabledMDLogin:a})})},n.updateSSO=function(){v.Z.setSso({projectId:u.Z.projectId,isOpenSso:n.state.sso}).then(function(e){e||alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})},n.setMDLoginSetting=function(){v.Z.setMDLoginSetting({projectId:u.Z.projectId,enabledMDLogin:n.state.enabledMDLogin}).then(function(e){e||alert(_l("\u64CD\u4F5C\u5931\u8D25"),2)})},n.handleUpdateItemCheck=function(e){n.setState({enableSSL:!e,port:e?389:636})},n.selectTypeComp=function(e){return t.createElement(L.default,{className:"errorInput"+e,value:n.state[e]+"",placeholder:_l("\u8BF7\u9009\u62E9\u7528\u6237\u76EE\u5F55\u7C7B\u578B"),onChange:n.handleUpdateItemSelect.bind(n),onFocus:n.clearError.bind(n,e)},t.createElement(L.default.Option,{value:"1"},"Microsoft Active Directory"),t.createElement(L.default.Option,{value:"2"},"Novell eDirectory Server"),t.createElement(L.default.Option,{value:"3"},"OpenLDAP"),t.createElement(L.default.Option,{value:"4"},"Generic Directory Server"),t.createElement(L.default.Option,{value:"5"},"Sun Directory Server Premium Edition"))},n.addDNGroup=function(){var e=[].concat((0,T.Z)(n.state.DNGroupList));e.push({dn:"",groupName:""}),n.setState({DNGroupList:e})},n.handleChangeVisible=function(e){n.setState({keyVisible:e})},n.getSsoSettings=function(){v.Z.getSsoSettings({projectId:u.Z.projectId}).then(function(e){e&&n.setState({ssoWebUrl:e.ssoWebUrl,ssoAppUrl:e.ssoAppUrl,sso:e.isOpenSso,ssoCustomName:e.ssoName||"SSO",ssoDefaultCustomName:e.ssoName||"SSO"})})},n.checkHasKey=function(){G.Z.confirm({onOk:function(){n.handleChangeVisible(!0)}})},n.saveCustomName=function(e){var a=n.state[e+"CustomName"];if(!a){alert(_l("\u540D\u79F0\u4E0D\u5F97\u4E3A\u7A7A"),2);return}if(n.setState((0,S.default)({},"set"+e+"Name",!1)),!I().isEqual(a,n.state[e+"DefaultCustomName"])){var l=e==="sso"?v.Z.setSsoName:v.Z.updateLdapName,o=e==="sso"?{ssoName:a}:{ldapName:a};l((0,M.default)({projectId:u.Z.projectId},o)).then(function(r){r?(alert(_l("\u4FEE\u6539\u6210\u529F")),n.setState((0,S.default)({},e+"DefaultCustomName",a))):alert(_l("\u4FEE\u6539\u5931\u8D25"),2)}).catch(function(r){alert(_l("\u4FEE\u6539\u5931\u8D25"),2),n.setState((0,S.default)({},e+"CustomName",n.state[e+"DefaultCustomName"]))})}},n.renderSSO=function(){var e=n.state,a=e.ssoWebUrl,l=e.ssoAppUrl,o=e.saveSSO;return t.createElement("div",{className:"formBox"},t.createElement("div",{className:"formModuleTitle"},_l("SSO\u94FE\u63A5\u5730\u5740")),t.createElement("div",{className:"formItem pLeft30 pRight20"},t.createElement("div",{className:"formLabel TxtLeft"},_l("WEB-PC\u7AEF")),t.createElement("div",{className:"formRight"},t.createElement(b.default,{value:a,onChange:function(i){n.setState({ssoWebUrl:i.target.value})}}),o&&!I().trim(a)&&t.createElement("div",{className:"errorMsg"},_l("\u8BF7\u8F93\u5165WEB-PC\u7AEF")))),t.createElement("div",{className:"formItem pLeft30 pRight20"},t.createElement("div",{className:"formLabel TxtLeft"},_l("WEB-\u79FB\u52A8\u7AEF"),t.createElement(ee.Z,{popupPlacement:"bottom",text:t.createElement("span",null,_l("\u82E5\u201DWEB-\u79FB\u52A8\u7AEF\u201C\u672A\u586B\u5199\uFF0C\u901A\u8FC7WEB-\u79FB\u52A8\u7AEF\u767B\u5F55\u65F6\uFF0C\u7CFB\u7EDF\u9ED8\u8BA4\u4F7F\u7528\u201DWEB-PC\u7AEF\u201C\u5730\u5740\u767B\u5F55"))},t.createElement(A.Z,{icon:"info",className:"Gray_9e mLeft10"}))),t.createElement("div",{className:"formRight"},t.createElement(b.default,{value:l,onChange:function(i){return n.setState({ssoAppUrl:i.target.value})}}))),t.createElement("div",{className:"TxtRight pRight20"},t.createElement(Z.default,{type:"primary",className:"mTop20",onClick:function(){n.setState({saveSSO:!0}),I().trim(n.state.ssoWebUrl)&&v.Z.setSsoUrl({projectId:u.Z.projectId,ssoWebUrl:I().trim(n.state.ssoWebUrl),ssoAppUrl:n.state.ssoAppUrl}).then(function(i){i?alert(_l("\u4FDD\u5B58\u6210\u529F")):alert(_l("\u4FDD\u5B58\u5931\u8D25"),2)})}},_l("\u4FDD\u5B58"))))},u.Z.setPageTitle(_l("\u5176\u4ED6")),n.state={level:"index",keyVisible:!1,effective:!1,type:0,port:389,serverIP:"",user:"",password:"",domainPath:"",enableSSL:"",searchFilter:"",emailAttr:"",fullnameAttr:"",departmentAttr:"",jobAttr:"",workphoneAttr:"",saveDisabled:!1,loading:!1,isSaveWebProxy:!1,searchRange:0,DNGroupList:[{dn:"",groupName:""}],effectiveCustomName:"LDAP",ssoCustomName:"SSO",enabledMDLogin:!1},n}return(0,F.default)(d,[{key:"componentDidMount",value:function(){this.getSettings(),this.getSsoSettings(),this.getMDLoginSetting()}},{key:"getSettings",value:function(){var e=this;this.setState({loading:!0}),v.Z.getProjectLdapSetting({projectId:u.Z.projectId}).then(function(a){var l=a.dnGroup||{},o=[];_()(l).forEach(function(r){o.push({dn:r,groupName:l[r]})}),a&&e.setState({effective:a.effective,type:a.type||"",serverIP:a.serverIP,port:a.port,user:a.user,password:a.password,domainPath:a.domainPath,DNGroupList:I().isEmpty(o)?[{dn:"",groupName:""}]:o,searchRange:a.searchRange||0,enableSSL:a.enableSSL,searchFilter:a.searchFilter||"",emailAttr:a.emailAttr||"",fullnameAttr:a.fullnameAttr||"",departmentAttr:a.departmentAttr||"",jobAttr:a.jobAttr||"",workphoneAttr:a.workphoneAttr||"",initSyncInfo:{fullnameAttr:a.fullnameAttr||"",departmentAttr:a.departmentAttr||"",jobAttr:a.jobAttr||"",workphoneAttr:a.workphoneAttr||""},loading:!1,effectiveCustomName:a.name||"LDAP",effectiveDefaultCustomName:a.name||"LDAP"})})}},{key:"updateLDAPState",value:function(){v.Z.updateLdapState({isEffect:this.state.effective,projectId:u.Z.projectId}).then(function(e){e||alert(_l("\u64CD\u4F5C\u5931\u8D25"),3)})}},{key:"enableForm",value:function(e){var a=this;this.setState((0,S.default)({},e,!this.state[e]),function(){e==="effective"&&a.updateLDAPState(),e==="sso"&&a.updateSSO(),e==="enabledMDLogin"&&a.setMDLoginSetting()})}},{key:"toggleComp",value:function(e){this.setState({level:e,isSaveWebProxy:!1})}},{key:"handleUpdateItem",value:function(e,a){this.setState((0,S.default)({},a,e.target.value))}},{key:"handleUpdateItemSelect",value:function(e){this.setState({type:e,searchFilter:e==="1"?"sAMAccountName":"cn",emailAttr:"mail",fullnameAttr:"displayName"})}},{key:"handleCheck",value:function(){var e=this,a=this.state,l=a.DNGroupList,o=l===void 0?[]:l,r=a.searchRange,i=!1,p=B.concat(P);p&&p.map(function(c){var m=c.key,C=c.errorMsg;C&&(e.state[m]?m==="port"&&isNaN(e.state.port)?(i=!1,$(".errorInputport").addClass("errorInput"),$("#errorMsgport").text(_l("\u7AEF\u53E3\u53F7\u5FC5\u987B\u4E3A\u6570\u5B57"))):i=!0:(i=!1,$(".errorInput"+m).addClass("errorInput"),$("#errorMsg"+m).text(C)))});var g=r===0||r===1&&o.every(function(c){return!!c.dn&&!!c.groupName});return i&&g}},{key:"clearError",value:function(e){$(".errorInput"+e).removeClass("errorInput"),$("#errorMsg"+e).text("")}},{key:"renderCompType",value:function(e){var a=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"input",o=this.state,r=o.searchRange,i=o.DNGroupList,p=i===void 0?[]:i,g=o.checkDnGroupEmpty;switch(l){case"select":return this.selectTypeComp(e);case"password":return t.createElement(b.default.Password,{className:"passwordInput errorInput"+e,autocomplete:"new-password",value:this.state[e],onChange:function(m){return a.handleUpdateItem(m,e)},onFocus:this.clearError.bind(this,e)});case"input":return t.createElement(b.default,{className:"errorInput"+e,value:this.state[e],onChange:function(m){return a.handleUpdateItem(m,e)},onFocus:this.clearError.bind(this,e)});case"tab":return t.createElement("div",{className:"searchRange flexRow"},[{key:0,tab:"BaseDN"},{key:1,tab:_l("DN/\u7EC4\u540D")}].map(function(c){return t.createElement("div",{key:c.key,className:E()("flex",{active:r===c.key}),onClick:function(){a.setState({searchRange:c.key})}},c.tab)}));case"group":return t.createElement("div",{className:"DNGroup w100"},t.createElement("div",{className:"Gray_9e Font12 mTop8"},_l("\u6839\u636E\u7EC4\u5728\u5BF9\u5E94\u7684DN\u68C0\u7D22\u8D26\u6237")),t.createElement("div",{className:"groupItem"},t.createElement("div",{className:"flex"},"DN"),t.createElement("div",{className:"flex mLeft12"},_l("\u7EC4\u540D"))),p.map(function(c,m){return t.createElement("div",{className:"groupItem mBottom16"},t.createElement("div",{className:"flex"},t.createElement(b.default,{style:{height:36},value:c.dn,onChange:function(h){var f=[].concat((0,T.Z)(p));f[m].dn=h.target.value,a.setState({DNGroupList:f})}}),g&&!c.groupName&&r===1&&t.createElement("div",{className:E()("TxtMiddle Red")},_l("\u8BF7\u8F93\u5165DN"))),t.createElement("div",{className:"flex mLeft12"},t.createElement(b.default,{style:{height:36},value:c.groupName,onChange:function(h){var f=[].concat((0,T.Z)(p));f[m].groupName=h.target.value,a.setState({DNGroupList:f,checkDnGroupEmpty:!1})}}),g&&!c.groupName&&r===1&&t.createElement("div",{className:E()("TxtMiddle Red")},_l("\u8BF7\u8F93\u5165\u7EC4\u540D"))),p.length>1&&t.createElement(A.Z,{icon:"remove_circle_outline",className:"minus mLeft15",onClick:function(){var h=[].concat((0,T.Z)(p));h.splice(m,1),a.setState({DNGroupList:h,checkDnGroupEmpty:!1})}}))}),t.createElement("span",{className:"Hand ThemeColor",onClick:this.addDNGroup},t.createElement(A.Z,{icon:"plus",className:"mRight5"})," ",_l("\u6DFB\u52A0")))}}},{key:"renderFormCommon",value:function(e){var a=this,l=this.state.searchRange;return t.createElement(t.Fragment,null,e&&e.map(function(o){var r=o.label,i=o.key,p=o.compType,g=o.errorMsg,c=o.desc;if(!(i==="domainPath"&&l!==0)&&!(i==="DNGroup"&&l!==1))return t.createElement("div",{className:"formItem",key:i},t.createElement("div",{className:"formLabel"},t.createElement("span",{className:E()("TxtMiddle Red",g?"":"hidden")},"*"),r),t.createElement("div",{className:"formRight"},t.createElement("div",{className:"formInput"},a.renderCompType(i,p),c==="enableSSL"?t.createElement(Q.Z,{text:_l("\u4F7F\u7528\u5B89\u5168\u94FE\u63A5"),className:"mLeft16",checked:a.state[c],onClick:a.handleUpdateItemCheck}):t.createElement("span",{className:"formItemDesc"},c)),t.createElement("div",{className:"errorMsg",id:"errorMsg"+i})))}))}},{key:"renderLdap",value:function(){var e=this;return t.createElement("div",{className:"formBox"},t.createElement("div",{className:"formModuleTitle"},_l("\u670D\u52A1\u5668\u8BBE\u7F6E\uFF08\u5E26*\u4E3A\u5FC5\u586B\u9879\uFF09")),this.renderFormCommon(B),t.createElement("div",{className:"splitLine"}),t.createElement("div",{className:"formModuleTitle"},_l("\u7528\u6237 schema")),this.renderFormCommon(P.slice(0,2)),t.createElement("div",{className:"formModuleTitle"},_l("\u540C\u6B65\u4FE1\u606F")),this.renderFormCommon(P.slice(2)),t.createElement(Z.default,{type:"primary",onClick:function(){return e.handleSubmit()},disabled:this.state.saveDisabled},this.state.saveDisabled?_l("\u4FDD\u5B58\u4E2D"):_l("\u4FDD\u5B58")))}},{key:"handleSubmit",value:function(){var e=this,a=this.handleCheck(),l=this.state,o=l.type,r=l.port,i=l.enableSSL,p=l.serverIP,g=l.user,c=l.password,m=l.searchRange,C=l.searchFilter,h=l.emailAttr,f=l.fullnameAttr,y=l.departmentAttr,he=l.jobAttr,ve=l.workphoneAttr,ge=l.domainPath,H=l.DNGroupList,x=H===void 0?[]:H,ye=x.every(function(N){return!!N.dn&&!!N.groupName});if(!a||m===1&&ye?this.setState({checkDnGroupEmpty:!0}):this.setState({checkDnGroupEmpty:!1}),a){this.setState({saveDisabled:!0});var w={};x.filter(function(N){return!!N.dn}).forEach(function(N){return w[""+N.dn]=N.groupName});var Ne=this.state.searchRange===0?{domainPath:ge,dnGroup:{}}:{dnGroup:w,domainPath:""};v.Z.updateProjectLdapSetting((0,M.default)({ldapType:parseInt(o),port:r,enableSSL:i,serverIP:p,user:g,password:c,searchRange:m,searchFilter:C,emailAttr:h,fullnameAttr:f,departmentAttr:y,jobAttr:he,workphoneAttr:ve,projectId:u.Z.projectId},Ne)).then(function(N){N?(alert(_l("\u4FDD\u5B58\u6210\u529F")),e.setState({saveDisabled:!1,domainPath:m===0?e.state.domainPath:"",DNGroupList:m===1?x:[{dn:"",groupName:""}]})):(alert(_l("\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u786E\u4FDD\u7CFB\u7EDF\u80FD\u591F\u6B63\u5E38\u8BBF\u95EE\u60A8\u7684\u670D\u52A1\u5668"),2),e.setState({saveDisabled:!1}))}).catch(function(N){e.setState({saveDisabled:!1})})}}},{key:"renderIndex",value:function(){var e=this,a=(0,D.vo)(u.Z.projectId,!0),l=a.licenseType;return t.createElement(t.Fragment,null,pe.map(function(o){var r=o.key,i=o.featureId,p=o.docLink,g=o.showSetting,c=o.description,m=o.showCustomName,C=o.label,h=(0,D.XH)(u.Z.projectId,i);if(!(o.featureId&&!h))return t.createElement("div",{className:"toolItem"},t.createElement("div",{className:"toolItemLabel"},o.label,(h==="2"||r==="sso"&&l===0)&&t.createElement(J.Z,null)),t.createElement("div",{className:"toolItemRight"},t.createElement("div",null,r!=="orgKey"&&t.createElement(X.Z,{checked:e.state[r],onClick:function(){if(h==="2"){(0,D.j0)(u.Z.projectId,i);return}if(r==="sso"&&l===0)return(0,D.Yg)({projectId:u.Z.projectId,explainText:_l("\u8BF7\u5347\u7EA7\u81F3\u4ED8\u8D39\u7248\u89E3\u9501\u5F00\u542F"),isFree:!0});e.enableForm(r)}}),r==="orgKey"&&t.createElement("div",null,t.createElement("button",{type:"button",className:"ming Button Button--link ThemeColor3 pLeft0 adminHoverColor Block",onClick:e.checkHasKey},_l("\u67E5\u770B\u5BC6\u94A5"))),g&&t.createElement("button",{type:"button",className:E()("ming Button Button--link mLeft24 ThemeColor3 mTop2 TxtTop adminHoverColor",{hidden:!e.state[r]}),onClick:function(){if(h==="2"){(0,D.j0)(u.Z.projectId,i);return}if(r==="sso"&&l===0)return(0,D.Yg)({projectId:u.Z.projectId,explainText:_l("\u8BF7\u5347\u7EA7\u81F3\u4ED8\u8D39\u7248\u89E3\u9501\u5F00\u542F"),isFree:!0});switch(r){default:e.toggleComp(r)}}},_l("\u8BBE\u7F6E"))),t.createElement("div",{className:"toolItemDescribe"},c,p&&t.createElement(Y.Z,{text:_l("\u67E5\u770B\u6587\u6863"),type:3,href:p})),m&&t.createElement("div",{className:"customNameWrap mTop8"},t.createElement("span",{className:"Gray_9e"},_l("\u81EA\u5B9A\u4E49\u540D\u79F0\uFF1A")),e.state["set"+r+"Name"]?t.createElement("input",{ref:function(y){return e.customNameInput=y},value:e.state[r+"CustomName"],className:"customNameInput",onChange:function(y){return e.setState((0,S.default)({},r+"CustomName",y.target.value))}}):t.createElement("span",{className:"name"},e.state[r+"CustomName"]),e.state["set"+r+"Name"]?t.createElement(t.Fragment,null,t.createElement("span",{className:"ThemeColor Hand mLeft16 mRight20",onClick:function(){return e.saveCustomName(r)}},_l("\u4FDD\u5B58")),t.createElement("span",{className:"ThemeColor Hand",onClick:function(){var y;e.setState((y={},(0,S.default)(y,"set"+r+"Name",!1),(0,S.default)(y,r+"CustomName",e.state[r+"DefaultCustomName"]),y))}},_l("\u53D6\u6D88"))):e.state[r]?t.createElement(A.Z,{icon:"edit",className:"Font12 mLeft8 Gray_9e Hover_21 Hand",onClick:function(){setTimeout(function(){e.customNameInput.focus()},500),e.setState((0,S.default)({},"set"+r+"Name",!0))}}):"")))}))}},{key:"renderContent",value:function(){switch(this.state.level){case"index":return this.renderIndex();case"effective":return this.renderLdap();case"sso":return this.renderSSO()}}},{key:"setLevel",value:function(e){this.setState({level:e})}},{key:"render",value:function(){var e=this,a=this.state,l=a.level,o=a.loading,r=a.keyVisible,i=de[l];return o?t.createElement(z.Z,null):t.createElement("div",{className:"otherToolBox orgManagementWrap"},r&&t.createElement(ce,{projectId:u.Z.projectId,visible:r,handleChangeVisible:this.handleChangeVisible}),t.createElement("div",{className:"orgManagementHeader"},t.createElement(A.Z,{icon:"backspace",className:E()("Hand mRight10 TxtMiddle Font24 adminHeaderIconColor",{hidden:l==="index"}),onClick:function(){return e.toggleComp("index")}}),t.createElement("span",{className:"Font17"},i),t.createElement("div",{className:"flex"})),t.createElement("div",{className:"orgManagementContent toolContentBox"},this.renderContent()))}}]),d}(t.Component)}}]);
