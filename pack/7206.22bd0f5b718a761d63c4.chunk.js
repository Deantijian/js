"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[7206],{37206:(ee,E,t)=>{t.r(E),t.d(E,{default:()=>X});var ae=t(10524),I=t(31059),T=t(97553),N=t(33867),R=t(54208),B=t(9122),j=t(12424),S=t(46593),w=t.n(S),F=t(85105),A=t.n(F),x=t(99663),O=t(22600),H=t(49135),L=t(93196),e=t(67294),r=t(64712),o=t(53614),h=t(48025),D=t(93967),p=t.n(D),U=t(88239),M=t(70801),W=t(86735),G=t(1952),K=t(5017),V=(0,W.Z)([`
  .mui-dialog-header {
    padding: 0;
  }
  .confirmBtn {
    padding: 3px 10px;
    border: 0;
    cursor: pointer;
    display: inline-block;
    line-height: 20px;
    margin-bottom: 0;
    text-align: center;
    vertical-align: middle;
    color: #fff;
    background-color: #1e88e5;
    &:hover {
      background-color: #1565c0;
    }
  }
`],[`
  .mui-dialog-header {
    padding: 0;
  }
  .confirmBtn {
    padding: 3px 10px;
    border: 0;
    cursor: pointer;
    display: inline-block;
    line-height: 20px;
    margin-bottom: 0;
    text-align: center;
    vertical-align: middle;
    color: #fff;
    background-color: #1e88e5;
    &:hover {
      background-color: #1565c0;
    }
  }
`]),$=(0,K.ZP)(M.Z)(V);function z(y){var d=y.url,n=y.onCancel,a=n===void 0?function(){}:n;return e.createElement($,{title:"",visible:!0,onCancel:a,showFooter:!1},e.createElement("div",{className:"BorderBottom BorderGrayColor LineHeight40 TxtCenter Font16"},_l("\u4ED8\u6B3E\u662F\u5426\u6210\u529F\uFF1F")),e.createElement("div",{className:"mTop20 Font16 Gray_3 mBottom10"},_l("\u4ED8\u6B3E\u662F\u5426\u6210\u529F\uFF1F")),e.createElement("div",{className:"LineHeight30"},_l("\u6211\u4EEC\u5C06\u5728\u6536\u5230\u6B3E\u9879\u540E\u768415\u5206\u949F\u5185\u4E3A\u60A8\u5B8C\u6210\u64CD\u4F5C")),e.createElement("div",null,_l("\u5982\u60A8\u5DF2\u5B8C\u6210\u4ED8\u6B3E\u800C\u672A\u5B8C\u6210\u64CD\u4F5C\uFF0C\u8BF7\u8054\u7CFB\u6211\u4EEC")),e.createElement("a",{className:"mTop20 confirmBtn",href:d,onClick:a},_l("\u786E\u5B9A")),e.createElement("div",{className:"mTop20 BorderBottom ThemeBorderColor3 mBottom20"}),e.createElement("div",null,_l("\u4ED8\u6B3E\u9047\u5230\u95EE\u9898")),e.createElement("div",null,e.createElement("span",{className:"LineHeight25"},_l("\u514D\u8D39\u54A8\u8BE2\u70ED\u7EBF"),"\uFF1A"),e.createElement("span",{className:"ThemeColor3 LineHeight25"},md.global.Config.ServiceTel)))}var P=function(d){return(0,G.Z)(z,(0,U.default)({},d))},v=t(15577),J=r.Z.params,m=J[3],Q=[{name:_l("\u4F59\u989D\u4ED8\u6B3E"),id:"balancePay",icon:"icon-sp_account_balance_wallet_white Font24"},{name:_l("\u652F\u4ED8\u5B9D\u4ED8\u6B3E"),id:"aliPay",icon:"icon-order-alipay Font24"},{name:_l("\u5FAE\u4FE1\u652F\u4ED8"),id:"wechartPay",icon:"icon-wechat_pay Font24"},{name:_l("\u94F6\u884C\u8F6C\u8D26"),id:"bankPay",icon:"icon-credit-card Font24"}],X=function(y){(0,L.default)(d,y);function d(){(0,x.default)(this,d);var n=(0,H.default)(this,(d.__proto__||A()(d)).call(this));return n.balancePay=function(){confirm(_l("\u786E\u5B9A\u4EE5\u3010\u4F59\u989D\u4ED8\u6B3E\u3011\u65B9\u5F0F\u8FDB\u884C\u672C\u6B21\u4ED8\u6B3E\uFF1F"))&&(n.setState({isPay:!0}),alert({msg:_l("\u6B63\u5728\u63D0\u4EA4\uFF0C\u8BF7\u7A0D\u5019..."),type:1,timeout:!1,key:"pay"}),h.Z.balancePayOrder({projectId:r.Z.projectId,orderId:m,password:(0,v.HI)(n.state.password)}).then(function(a){a.isSuccess?alert({msg:_l("\u4ED8\u6B3E\u6210\u529F"),type:1,key:"pay",timeout:1e3,callback:function(){window.location.href="/admin/billinfo/"+r.Z.projectId}}):(n.setState({isPay:!1}),a.validateResult==2?alert({msg:_l("\u5BC6\u7801\u9519\u8BEF"),type:3,key:"pay"}):a.validateResult==3?alert({msg:_l("\u4F59\u989D\u4E0D\u8DB3"),type:3,key:"pay"}):alert({msg:_l("\u64CD\u4F5C\u5931\u8D25"),type:2,key:"pay"}))}))},r.Z.setPageTitle(_l("\u7B49\u5F85\u652F\u4ED8")),n.state={balance:0,balanceNotEnough:!1,payStyleArr:[],payStyle:"aliPay",currRecordObj:{},needEmail:!1,password:"",loading:!0},n}return(0,O.default)(d,[{key:"componentDidMount",value:function(){if(!m)return alert(_l("\u4F20\u5165\u53C2\u6570\u65E0\u6548"),3),!1;var a=this;w().all([r.Z.AdminController.getHidBalance({projectId:r.Z.projectId}),h.Z.getTransactionRecordByOrderId({projectId:r.Z.projectId,orderId:m})]).then(function(l){var c=(0,j.Z)(l,2),s=c[0],i=c[1];a.setState({balance:parseFloat(s)||0,currRecordObj:i},function(){i?a.viewByCurrRecordObj():window.location.href="/admin/billinfo/"+r.Z.projectId})})}},{key:"viewByCurrRecordObj",value:function(){var a=this.state,l=a.currRecordObj,c=a.balance,s=o.Z.orderRecordType||{},i=s.ReCharge,u=s.Ultimate,g=s.Enterprise;if(l){var b=l.status,f=l.recordType,k=l.price;if(b!==o.Z.orderRecordStatus.wating)return window.location.href="/admin/billinfo/"+r.Z.projectId,!1;var C=Q.filter(function(Z){return Z.id==="balancePay"&&_.includes([i,u,g],f)?!1:k===0||[25,26].includes(f)&&md.global.Config.IsLocal?!_.includes(["aliPay","wechartPay","bankPay"],Z.id):!0}),Y=C[0].id,q=parseFloat(k)>parseFloat(c);this.setState({payStyleArr:C,balanceNotEnough:q,payStyle:Y,loading:!1})}}},{key:"handleBack",value:function(){window.location.href="/admin/billinfo/"+r.Z.projectId}},{key:"renderTitle",value:function(){var a="";switch(this.state.currRecordObj.recordType){case o.Z.orderRecordType.MemberPackage:a=_l("\u611F\u8C22\u60A8\u8D2D\u4E70\u7528\u6237\u5305");break;case o.Z.orderRecordType.OAPackage:a=_l("\u611F\u8C22\u60A8\u8D2D\u4E70OA");break;case o.Z.orderRecordType.ApprovePackage:a=_l("\u611F\u8C22\u60A8\u8D2D\u4E70\u5BA1\u6279");break;case o.Z.orderRecordType.ReCharge:a=_l("\u611F\u8C22\u60A8\u8D2D\u4E70\u5145\u503C\u5305");break;case o.Z.orderRecordType.Upgrade:a=_l("\u611F\u8C22\u60A8\u5F00\u901A\u6807\u51C6\u7248");break;case o.Z.orderRecordType.DayPackage:a=_l("\u611F\u8C22\u60A8\u5F00\u901A\u4E00\u5929\u5305");break;case o.Z.orderRecordType.UpgradeEnterpriseAndOA:a=_l("\u611F\u8C22\u60A8\u5F00\u901A\u6807\u51C6\u7248+OA");break;case o.Z.orderRecordType.EnterpriseAndApprove:a=_l("\u611F\u8C22\u60A8\u5F00\u901A\u6807\u51C6\u7248+\u5BA1\u6279");break;case o.Z.orderRecordType.Enterprise:a=_l("\u611F\u8C22\u60A8\u5F00\u901A\u4E13\u4E1A\u7248");break;case o.Z.orderRecordType.Ultimate:a=_l("\u611F\u8C22\u60A8\u5F00\u901A\u65D7\u8230\u7248");break;case o.Z.orderRecordType.APK:a=_l("\u611F\u8C22\u60A8\u8D2D\u4E70\u5E94\u7528\u62D3\u5C55\u5305");break;case o.Z.orderRecordType.WORKFLOW:a=_l("\u611F\u8C22\u60A8\u8D2D\u4E70\u5DE5\u4F5C\u6D41\u62D3\u5C55\u5305");break;default:break}return a}},{key:"renderPayTypes",value:function(){var a=this,l=this.state,c=l.payStyleArr,s=l.payStyle;return e.createElement(e.Fragment,null,c.map(function(i){return e.createElement("div",{key:i.id,className:p()("itemBoxContent",{active:i.id===s}),onClick:function(){a.setState({payStyle:i.id})}},e.createElement("span",{className:p()("Font12 mRight8",i.icon,i.id==="bankPay"?"bankPayColor":i.id==="wechartPay"?"wxPayColor":"otherPayColor")}),e.createElement("span",null,i.name))}))}},{key:"handleHelp",value:function(){window.open("https://d557778d685be9b5.share.mingdao.net/public/form/b9cfd9d0f4a84f6798cf0d3235fc4ead?source=package_payment")}},{key:"handleCheckBox",value:function(a){this.setState({needEmail:a.target.checked})}},{key:"handlePay",value:function(){var a=this;this.state.payStyle=="bankPay"?this.bankPay():this.state.payStyle=="balancePay"?B.Z.confirm({onOk:function(c){return a.setState({password:c},a.balancePay)}}):this.state.payStyle=="wechartPay"?confirm(_l("\u786E\u5B9A\u4EE5\u3010\u5FAE\u4FE1\u652F\u4ED8\u3011\u65B9\u5F0F\u8FDB\u884C\u672C\u6B21\u4ED8\u6B3E\uFF1F"))&&(window.open("/wechatPay/"+r.Z.projectId+"/"+m),P({url:"/admin/billinfo/"+r.Z.projectId})):this.state.payStyle=="aliPay"&&this.aliPay()}},{key:"bankPay",value:function(){window.open((0,v.Z6)(md.global.Config.AjaxApiUrl+"download/downloadBankInfo?projectId="+r.Z.projectId+"&orderId="+m+"&sendEmail="+this.state.needEmail))}},{key:"aliPay",value:function(){if(confirm(_l("\u786E\u5B9A\u4EE5\u3010\u652F\u4ED8\u5B9D\u4ED8\u6B3E\u3011\u65B9\u5F0F\u8FDB\u884C\u672C\u6B21\u4ED8\u6B3E\uFF1F"))){window.open((0,v.Z6)(md.global.Config.AjaxApiUrl+"pay/alipay?projectId="+r.Z.projectId+"&orderNumber="+m));var a={url:"/admin/billinfo/"+r.Z.projectId};P({url:"/admin/billinfo/"+r.Z.projectId}),h.Z.addThreePartPayOrderLog({projectId:r.Z.projectId,orderId:m})}}},{key:"render",value:function(){var a=this,l=this.state,c=l.payStyle,s=l.balanceNotEnough,i=l.currRecordObj,u=l.needEmail,g=l.isPay,b=l.loading;return b?e.createElement(R.Z,null):e.createElement("div",{className:"warpCenter waitingPay"},e.createElement("div",{className:"valueAddServerHeader"},e.createElement(N.Z,{icon:"backspace",className:"Hand mRight18 TxtMiddle Font24",onClick:function(){return a.handleBack()}}),e.createElement("span",{className:"Font17 Bold"},_l("\u652F\u4ED8\u8BA2\u5355"))),e.createElement("div",{className:"warpMainView"},e.createElement("div",{className:"Font24 Bold color_b"},this.renderTitle()),e.createElement("div",{className:"payItemRow mTop40"},e.createElement("div",{className:"payItemLabel"},_l("\u652F\u4ED8\u65B9\u5F0F")),e.createElement("div",{className:"payItemResult"},this.renderPayTypes())),e.createElement("div",{className:"warpPayBottom"},e.createElement("div",{className:p()("warpShowBankAcountInfo mTop30",{Hidden:c!=="bankPay"})},e.createElement("div",{className:"color_b Font13 LineHeight26"},_l("\u6536\u6B3E\u8D26\u53F7\u4FE1\u606F")),e.createElement("div",{className:"color_b Font13 LineHeight26"},_l("\u7528\u6237\u540D\uFF1A"),e.createElement("span",null,_l("\u4E0A\u6D77\u4E07\u4F01\u660E\u9053\u8F6F\u4EF6\u6709\u9650\u516C\u53F8"))),e.createElement("div",{className:"color_b Font13 LineHeight26"},"\xA0\xA0\xA0",_l("\u8D26\u53F7\uFF1A"),e.createElement("span",null,"641967782")),e.createElement("div",{className:"color_b Font13 LineHeight26"},_l("\u5F00\u6237\u884C\uFF1A"),e.createElement("span",null,_l("\u6C11\u751F\u94F6\u884C\u4E0A\u6D77\u5927\u5B81\u652F\u884C")))),e.createElement("div",{className:p()("warpShowBankAcountInfo",{Hidden:c!=="balancePay"})},s?e.createElement("span",{className:"Block Red mTop15"},_l("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u7684\u4F59\u989D\u4E0D\u8DB3\uFF01")):"")),e.createElement("div",{className:"payItemRow mTop30"},e.createElement("div",{className:"payItemLabel"},_l("\u603B\u8BA1")),e.createElement("div",{className:"payItemResult Font24 Bold color_b"},"\uFFE5",Math.abs(i.price))),e.createElement("div",{className:"mTop40 flexRow alignItemsCenter"},e.createElement(T.ZP,{type:"primary",disabled:c==="balancePay"&&s||g,className:"nextBtn",onClick:function(){return a.handlePay()}},c==="bankPay"?_l("\u4FDD\u5B58\u4ED8\u6B3E\u4FE1\u606F"):_l("\u7ACB\u5373\u652F\u4ED8")),!md.global.Config.IsLocal&&_.includes(["bankPay","balancePay"],c)&&e.createElement("div",{className:"warpSendBankInfoEmail mLeft20"},e.createElement(I.default,{onChange:this.handleCheckBox.bind(this),checked:u},_l("\u540C\u65F6\u90AE\u4EF6\u7ED9\u6211")))),!md.global.Config.IsLocal&&e.createElement("div",{className:"Gray_9 mTop24"},e.createElement("div",null,_l("\u6211\u4EEC\u5C06\u5728\u6536\u5230\u6B3E\u9879\u540E\u768415\u5206\u949F\u5185\u4E3A\u60A8\u5B8C\u6210\u670D\u52A1")),_l("\u5982\u6709\u7591\u95EE\uFF0C"),e.createElement("span",{className:"ThemeColor3 Hand",onClick:this.handleHelp.bind(this)},_l("\u8BF7\u4E0E\u6211\u4EEC\u8054\u7CFB")))))}}]),d}(e.Component)}}]);
