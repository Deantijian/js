"use strict";(self.webpackChunkmingdao_web=self.webpackChunkmingdao_web||[]).push([[6426],{26426:(k,E,t)=>{t.r(E),t.d(E,{default:()=>b});var w=t(80426),y=t(59012),j=t.n(y),q=t(63627),T=t(81982),O=t.n(T),_=t(20148),M=t(60385),S=t.n(M),tt=t(77040),F=t(94301),L=t.n(F),A=t(33867),et=t(66814),z=t(91880),U=t.n(z),nt=t(48388),B=t(29914),H=t.n(B),x=t(85105),N=t.n(x),V=t(99663),D=t(22600),P=t(49135),Z=t(93196),a=t(67294),W=t(50533),C=t(49365),G=function(e,d){return function(s,l){s({type:"MOBILE_ROLE_LIST_FETCH_START"}),C.Z.getAppRoleSummary({appId:e}).then(function(p){var I=p.roleInfos,m=I===void 0?[]:I;s({type:"UPDATE_ROLE_LIST",data:{list:m}}),s({type:"MOBILE_ROLE_LIST_FETCH_SUCCESS"})})}},J=function(e){var d=e.projectId,s=e.appId,l=e.sourceAppRoleId,p=e.resultAppRoleIds,I=e.userIds,m=e.departmentIds,f=e.projectOrganizeIds,h=e.jobIds,R=e.departmentTreeIds;return function(u){C.Z.removeUserToRole({projectId:d,appId:s,sourceAppRoleId:l,resultAppRoleIds:p,userIds:I,departmentIds:m,projectOrganizeIds:f,jobIds:h,departmentTreeIds:R}).then(function(g){u(g?{type:"MOBILE_ROLE_MOVE_FETCH_SUCCESS"}:{type:"MOBILE_ROLE_MOVE_FETCH_FAIL"})})}},K=t(93967),Q=t.n(K),X=t(96486),c=t.n(X),v=null,Y=function(i){(0,Z.default)(e,i);function e(d){(0,V.default)(this,e);var s=(0,P.default)(this,(e.__proto__||N()(e)).call(this,d)),l=d.match.params;return s.state={checkId:l.roleId,departmentsInfos:[],users:[]},s}return(0,D.default)(e,[{key:"componentDidMount",value:function(){var s=this.props.match.params;$("html").addClass("changeRoleCon"),this.props.dispatch({type:"MOBILE_ROLE_MOVE_FETCH_START"}),this.props.dispatch(G(s.appId,s.roleId,s.accountId))}},{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"MOBILE_ROLE_MOVE_FETCH_START"}),$("html").removeClass("changeRoleCon"),v?v.close():v=null}},{key:"render",value:function(){var s=this,l=this.props,p=l.isRoleListLoading,I=l.roleList,m=l.moveRoleFetch,f=c().map(this.state.users,function(n){var r=n.accountId;return r}),h=c().map(this.state.departmentsInfos,function(n){var r=n.departmentId;return r}),R=c().map(this.state.departmentsInfos,function(n){var r=n.departmentId;return r}),u=c().map(this.state.projectOrganizeInfos,function(n){var r=n.projectOrganizeId;return r}),g=c().map(this.state.jobInfos,function(n){var r=n.jobId;return r}),o=this.props.match.params;return m?(this.props.history.push("/mobile/members/"+o.appId),""):p?a.createElement(U(),{justify:"center",align:"center",className:"h100"},a.createElement(H(),{size:"large"})):a.createElement(a.Fragment,null,a.createElement(L(),{style:{overflow:"scroll",background:"#fff"}},I.list.filter(function(n){return!c().includes([100,2,1],n.roleType)}).map(function(n,r){if(n.canSetMembers)return a.createElement(L().Item,{key:n.roleId,extra:s.state.checkId===n.roleId?a.createElement(A.Z,{icon:"ok",className:"Font28 isCheck"}):"",onClick:function(){o.roleId!==n.roleId&&s.setState({checkId:n.roleId,users:n.users,departmentsInfos:n.departmentsInfos})}},a.createElement("span",{className:Q()("Gray Font16")},n.name))})),a.createElement(j(),{size:"md"},a.createElement(O(),{type:"primary",className:"mTop20",onClick:function(){s.state.checkId?s.props.dispatch(J({projectId:o.projectId==="individual"?"":o.projectId,appId:o.appId,sourceAppRoleId:o.roleId,resultAppRoleIds:[s.state.checkId],userIds:o.accountId==="undefined"?f:f.concat(o.accountId==="undefined"?null:o.accountId),departmentIds:o.departmentId==="undefined"?h:h.concat(o.departmentId),departmentTreeIds:o.departmentTreeId==="undefined"?R:R.concat(o.departmentTreeId),projectOrganizeIds:o.projectOrganizeId==="undefined"?u:u.concat(o.projectOrganizeId),jobIds:o.jobId==="undefined"?g:g.concat(o.jobId)})):v=S().alert("",_l("\u8BF7\u9009\u62E9\u8981\u66F4\u6362\u7684\u89D2\u8272"),[{text:_l("\u786E\u5B9A"),onPress:function(){}}])}},_l("\u786E\u5B9A"))))}}]),e}(a.Component);const b=(0,W.$j)(function(i){var e=i.mobile,d=e.roleList,s=e.isRoleListLoading,l=e.moveRoleFetch;return{roleList:d,moveRoleFetch:l,isRoleListLoading:s}})(Y)}}]);
